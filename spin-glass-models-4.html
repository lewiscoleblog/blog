<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Spin Glass Models 4: Ising Model - Simulation | Lewis Cole Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Spin Glass Models 4: Ising Model - Simulation" />
<meta name="author" content="Lewis Cole (2020)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model." />
<meta property="og:description" content="In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model." />
<link rel="canonical" href="https://www.lewiscoleblog.com/spin-glass-models-4" />
<meta property="og:url" content="https://www.lewiscoleblog.com/spin-glass-models-4" />
<meta property="og:site_name" content="Lewis Cole Blog" />
<meta property="og:image" content="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-24T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Lewis Cole (2020)"},"description":"In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model.","@type":"BlogPosting","headline":"Spin Glass Models 4: Ising Model - Simulation","dateModified":"2020-03-24T00:00:00-05:00","datePublished":"2020-03-24T00:00:00-05:00","image":"https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lewiscoleblog.com/spin-glass-models-4"},"url":"https://www.lewiscoleblog.com/spin-glass-models-4","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.lewiscoleblog.com/feed.xml" title="Lewis Cole Blog" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Spin Glass Models 4: Ising Model - Simulation | Lewis Cole Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Spin Glass Models 4: Ising Model - Simulation" />
<meta name="author" content="Lewis Cole (2020)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model." />
<meta property="og:description" content="In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model." />
<link rel="canonical" href="https://www.lewiscoleblog.com/spin-glass-models-4" />
<meta property="og:url" content="https://www.lewiscoleblog.com/spin-glass-models-4" />
<meta property="og:site_name" content="Lewis Cole Blog" />
<meta property="og:image" content="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-24T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Lewis Cole (2020)"},"description":"In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model.","@type":"BlogPosting","headline":"Spin Glass Models 4: Ising Model - Simulation","dateModified":"2020-03-24T00:00:00-05:00","datePublished":"2020-03-24T00:00:00-05:00","image":"https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lewiscoleblog.com/spin-glass-models-4"},"url":"https://www.lewiscoleblog.com/spin-glass-models-4","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://www.lewiscoleblog.com/feed.xml" title="Lewis Cole Blog" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Lewis Cole Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/welcome/">Welcome</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Spin Glass Models 4: Ising Model - Simulation</h1><p class="page-description">In this blog post we will introduce ways of simulating the Ising models introduced in the previous post. We start by looking at a fairly basic MCMC implementation. From this we will introduce a computational technique that has implications way beyond spin glasses. We will end with a more modern higher performance approach to simulating the Ising model.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-24T00:00:00-05:00" itemprop="datePublished">
        Mar 24, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Lewis Cole (2020)</span></span>
       <!-- • <span class="read-time" title="Estimated read time">
    
    
      26 min read
    
</span>-->
    </p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Spin-Glass">Spin-Glass</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Magnet">Magnet</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Ising">Ising</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Edwards-Anderson">Edwards-Anderson</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#MCMC">MCMC</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Simulated-Annealing">Simulated-Annealing</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Wolff">Wolff</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Setup">Setup </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Interactions">Interactions </a></li>
<li class="toc-entry toc-h2"><a href="#Mixing,-Convergence,-etc.">Mixing, Convergence, etc. </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Local-Update-Methods">Local Update Methods </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Metropolis-Hastings">Metropolis-Hastings </a></li>
<li class="toc-entry toc-h2"><a href="#Gibbs-Sampling">Gibbs Sampling </a></li>
<li class="toc-entry toc-h2"><a href="#Glauber-Dynamics-(and-Heat-Bath)">Glauber Dynamics (and Heat-Bath) </a></li>
<li class="toc-entry toc-h2"><a href="#Simulated-Annealing-and-Simulated-Tempering">Simulated Annealing and Simulated Tempering </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Cluster-Update-Methods">Cluster Update Methods </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Wolff-Algorithm">Wolff Algorithm </a></li>
<li class="toc-entry toc-h2"><a href="#Swendsen-Wang-Algorithm">Swendsen-Wang Algorithm </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-24-Spin-Glass-Models-4.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>This is the fourth blog post in a series - you can find the previous blog post <a href="https://lewiscoleblog.com/spin-glass-models-4">here</a></p>
<hr>
<h1 id="Setup">
<a class="anchor" href="#Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup<a class="anchor-link" href="#Setup"> </a>
</h1>
<p>In this blog we will limit ourselves to trying to find minimum energy states of the Ising model - we could use these schemes in order to estimate other thermodynamic properties also. The models will be in 2-dimensions on a square lattice since the results of these will be easier to display, it should be fairly obvious how we could modify this code for other dimensions. We will also use Gaussian distributed interaction strengths since we do not require mathematical tractability when we are simulating.</p>
<h2 id="Interactions">
<a class="anchor" href="#Interactions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Interactions<a class="anchor-link" href="#Interactions"> </a>
</h2>
<p>Unlike the Sherrington-Kirkpatrick model we will have to be a bit "clever" in defining the interaction strengths. I have decided to do this using 4 (NxN) arrays representing the up, down, left and right interaction strengths. This is a bit wasteful in terms of memory use but I think it is worth the trade-off to improve readability of the code. We then have the following symmetries:</p>
<div class="highlight"><pre><span></span><span class="n">up</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">down</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
<span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
<p>Where these indices exist, for the boundary coniditons we will take the following:</p>
<div class="highlight"><pre><span></span><span class="n">up</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">down</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
<p>For all possible $i, j$. This is a fixed boundary condition, the edge cases will have only 3 neighbours and corner cases only 2. This can introduce some instability for small spin-glasses but this is fine for our purposes. Modifying this to allow for periodic boundary conditions (i.e. a toroidal geometry) would not be particularly difficult.</p>
<h2 id="Mixing,-Convergence,-etc.">
<a class="anchor" href="#Mixing,-Convergence,-etc." aria-hidden="true"><span class="octicon octicon-link"></span></a>Mixing, Convergence, etc.<a class="anchor-link" href="#Mixing,-Convergence,-etc."> </a>
</h2>
<p>The methods presented below are Markov-Chain Monte-Carlo (MCMC) methods. These methods are notoriously finicky and require parameter tuning, running multiple chains, etc. in order to ensure good performance. As to not get distracted in this blog post I will not mention these concerns but please keep them in mind when reading on. For now we will run a single chain and look at the results it produces, in practice one would not do this.</p>
<h1 id="Local-Update-Methods">
<a class="anchor" href="#Local-Update-Methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Local Update Methods<a class="anchor-link" href="#Local-Update-Methods"> </a>
</h1>
<p>We begin by looking at local update methods. In the Sherrington-Kirkpatrick blog post we looked at one such (very bad) method: the greedy gradient descent. Local update methods mean at each simulation step we update 1 site only.</p>
<h2 id="Metropolis-Hastings">
<a class="anchor" href="#Metropolis-Hastings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Metropolis-Hastings<a class="anchor-link" href="#Metropolis-Hastings"> </a>
</h2>
<p>First we look at the "classic" approach to simulating the Ising model. In many texts and online references this will be the only method that is presented, it leads some to believe (incorrectly) that the simulation method is somehow part of the Ising model itself. This is the method I presented (without elaboration) in my Cython/Numba blog post.</p>
<p>We present Metropolis-Hastings in it's most general form first (our application to the Ising model will appear below):</p>
<ol>
<li>Initialize the system in state $x_t$</li>
<li>Sample a new proposed state from some distribution $Q(x'_{t+1} | x_t)$</li>
<li>Accept this new state with probability $min\left[\alpha, 1 \right]$, else $x_{t+1} = x_t$, where:

$$ \alpha = \frac{P(x'_{t+1})Q(x_t |x'_{t+1})} {P(x_t)Q(x'_{t+1} |x_{t})} $$
</li>
<li>Repeat steps 2. and 3.</li>
</ol>
<p>In this context $P(.)$ represents the probability distribution we wish to estimate. We notice that this does not need to be standardized (i.e. we can ignore any difficult partition functions) so this is a (relatively) easy algorithm to implement. We find that the sequence $x_t$ forms a Markov-Chain - hence the term Markov-Chain Monte Carlo (MCMC).</p>
<p>We can see that that Metropolis-Hastings consists of 2 steps: a proposal step then an acceptance/rejection step. We see that there are essentially no constraints on $Q(.)$ so we can use something easy to sample from. We only need to be careful that it has a support that contains the support of $P(.)$ - otherwise we will not be able to sample all possible values as required. Selecting a suitable $Q(.)$ is at the heart of the algorithm however, the best performance will be where $Q$ and $P$ are very similar. Since $P$ is generally unknown in advance this often requires a bit of trial and error. There are many ways to test whether the algorithm is doing a "good job" but we will not cover them here (in a later set of blog posts I should probably go deeper into MCMC methods - here we're just concerned with the Ising model in particular).</p>
<p>Moving back to the Ising model picture, we can apply the Metropolis-Hastings methodology via:</p>
<ol>
<li>First pick a random site</li>
<li>Calculate the change in energy associated with "flipping" this sites spin (going from +1 to -1 or vice versa)</li>
<li>If the energy decreases accept the flipped state and start again with a new site</li>
<li>If energy increases accept the flipped state with some acceptance probability or keep the same state </li>
<li>Begin again</li>
</ol>
<p>We can see that in contrast to the "greedy hill climber" approach in the Sherrington-Kirkpatrick blog post we are not simply declining into a local minima, there is some probability that we can jump to a state of higher energy and escape a local minima to find a "better" one. In theory if we wait long enough we should find ourselves in a global minimum state. We now derive the acceptance probability as given by Metropolis-Hastings:</p>
<p>Recall that the Gibbs distribution for the Ising model with a given configuration is:

$$ P(\sigma) = \frac{exp(-\beta H_{\sigma})}{Z_{\beta}} $$
</p>
<p>Since we are uniformly selecting new states the $Q(.)$ terms in $\alpha$ cancel. If we denote the propsed state as: $\hat{\sigma}$ then the relative likelihood is:

$$ \alpha = \frac{P(\hat{\sigma})}{P(\sigma)} = \frac{exp(-\beta H_{\hat{\sigma}})}{exp(-\beta H_{\sigma})} = exp\left(-\beta \left(H_{\hat{\sigma}} - H_{\sigma}\right)\right) = exp(-\beta \Delta H)  $$
</p>
<p>To summarise by Metropolis-Hastings we then accept the new configuration with probability:

$$ p_{flip} = min\left[1, exp(-\beta \Delta H) \right] $$
</p>
<p>In this particular case we can calculate $\Delta H$ quite efficiently since we are changing the spin of only 1 site, the contributions of all other sites "cancels out". We can write this down as:

$$ \Delta H = 2\sigma_{i,j} \sum_{(x,y) \in \langle i, j \rangle} J_{x,y} \sigma_{x,y} $$
</p>
<p>This introduces some efficiency in a code implementation since we do not have to calculate the energy of the whole configuration each time we want to update a site's spin.</p>
<p>An example implementation of this can be seen below:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># An implementation of an Ising spin-glass of size NxN</span>
<span class="c1"># With fixed boundary conditions using Metropolis-Hastings</span>
<span class="c1"># Connectivity is initialized as a Gaussian distribution N(0, s^2/N)</span>
<span class="c1"># Updates occur at randomly selected sites</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Fix random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Set size of model N and initial spins</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="c1"># Fix number of timesteps and some containers</span>
<span class="n">timesteps</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">timesteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">timesteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize interaction arrays</span>
<span class="c1"># Have 4 arrays: up, down, left right</span>
<span class="c1"># These represent the interaction strengths to the </span>
<span class="c1"># up/down/left/right neighbours of a site</span>
<span class="c1"># There is a symmetry between these matrices</span>
<span class="c1"># This is not the most memory efficient solution</span>
<span class="n">s_h</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s_v</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="n">up</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_v</span>
<span class="n">down</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,:]</span>
<span class="n">left</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_h</span>
<span class="n">right</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]</span>

<span class="n">mag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spins</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">up_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">down_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">left_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">right_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">up</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">up_neighbour</span> <span class="o">+</span> <span class="n">down</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">down_neighbour</span> <span class="o">+</span> <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">left_neighbour</span> <span class="o">+</span> <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">right_neighbour</span><span class="p">)</span>

<span class="c1"># Avoid double count - each neighbour pair</span>
<span class="c1"># counted twice in above since loop over each site</span>
<span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">2</span>

<span class="c1"># Fix beta (inverse temerature) - from analysis we know that</span>
<span class="c1"># system in glassy-phase for T&lt;s so beta&gt;1/s. Performance</span>
<span class="c1"># of random updates isn't good so don't select temperature</span>
<span class="c1"># too low</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Define proposal step</span>
<span class="k">def</span> <span class="nf">proposal</span><span class="p">(</span><span class="n">s_array</span><span class="p">):</span>
    <span class="n">_N</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">energy_change</span><span class="p">(</span><span class="n">spin_site</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">spin_site</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">spin_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">up_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">down_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">left_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">right_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">dE_tmp</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">up_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">up_neighbour</span> <span class="o">+</span> <span class="n">down_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">down_neighbour</span> <span class="o">+</span> <span class="n">left_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">left_neighbour</span> <span class="o">+</span> <span class="n">right_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">right_neighbour</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dE_tmp</span>

<span class="k">def</span> <span class="nf">acceptance</span><span class="p">(</span><span class="n">bt</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">energy</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">bt</span><span class="o">*</span><span class="n">energy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>


<span class="c1"># Define update step</span>
<span class="n">dE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dM</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">bt</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">dE</span>
    <span class="k">global</span> <span class="n">dM</span>
    
    <span class="c1"># Proposal Step</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">proposal</span><span class="p">(</span><span class="n">s_array</span><span class="p">)</span>
    
    <span class="c1"># Calculate energy change</span>
    <span class="n">dE</span> <span class="o">=</span> <span class="n">energy_change</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">bt</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">)</span>
    <span class="n">dM</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s_array</span><span class="p">[</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    
    <span class="c1"># Acceptance step</span>
    <span class="n">accept</span> <span class="o">=</span> <span class="n">acceptance</span><span class="p">(</span><span class="n">bt</span><span class="p">,</span> <span class="n">dE</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">accept</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">s_array</span><span class="p">[</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dM</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">s_array</span>

<span class="k">def</span> <span class="nf">_main_loop</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="n">s_temp</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
        <span class="n">update_step</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">s_temp</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">)</span>
        <span class="n">s_temp</span> <span class="o">=</span> <span class="n">update_step</span>
        <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dE</span>
        <span class="n">mag</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dM</span>

<span class="c1">#### Run Main Loop</span>
<span class="n">_main_loop</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span> <span class="n">spins</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">mag</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># plot magnetism and energy evolving in time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time step"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Magnetism"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Energy"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gibbs-Sampling">
<a class="anchor" href="#Gibbs-Sampling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gibbs Sampling<a class="anchor-link" href="#Gibbs-Sampling"> </a>
</h2>
<p>Many presentations of the Ising model only show the Metropolis-Hastings scheme, as such there is a misconception that the Metropolis-Hastings sampling is somehow part of the Ising model itself. This is not true, an alternative to Metropolis-Hastings is Gibbs-Sampling. We can describe Gibbs-Sampling in general terms as:</p>
<ol>
<li>Pick an initial state $\pmb{x_t} = \left(x^1_t, x^2_t, ... , x^N_t\right)$</li>
<li>For each $N$ dimension sample: $x^i_{t+1} \sim P\left(x^i_{t+1} | x^i_{t+1}, x^2_{t+1}, ... , x^{i-1}_{t+1}, x^{i+1}_t, ... x^N_i\right)$ and define next state as: $\pmb{x_{i+1}} = \left(x_1^{i+1}, x_2^{i+1}, ... , x_N^{i+1}\right)$</li>
<li>Repeat sampling for each successive state</li>
</ol>
<p>We can see this is just a special case of Metropolis-Hastings, if we denote $\pmb{x_t^{-j}} = \left(x_t^1, x_t^2, ... , x_t^{j-1}, x_t^{j+1}, ..., x_t^N\right)$ (all components apart from the jth). Then we can set: 

$$Q(x_{t+1}^j \pmb{x_t^{-j}} | \pmb{x_t} ) = P(x_{t+1}^j | \pmb{x_t^{-j}})$$

In the Metropolis-Hastings scheme, the acceptance probablilty then becomes:
\begin{align}
min\left[1 , \frac{Q(x_{t+1}^j \pmb{x_t^{-j}} | \pmb{x_t} ) P(\pmb{x_t})}{Q(\pmb{x_t} | x_{t+1}^j \pmb{x_t^{-j}} ) P(x_{t+1}^j \pmb{x_t^{-j}})} \right] &amp; = min \left[1 , \frac{P(\pmb{x_t})P(x_{t+1}^j | \pmb{x_t^{-j}})}{P(x_{t+1}^j \pmb{x_t^{-j}})P(x_{t}^j | \pmb{x_t^{-j}})} \right] \\
&amp;= min\left[1 , \frac{P(x_{t}^j | \pmb{x_t^{-j}})P(\pmb{x_t^{-j}})P(x_{t+1}^j | \pmb{x_t^{-j}})}{P(x_{t+1}^j | \pmb{x_t^{-j}})P(\pmb{x_t^{-j}})P(x_{t}^j | \pmb{x_t^{-j}})} \right] \\
&amp;= min \left[1, 1 \right] = 1
\end{align}
Which results in the Gibbs procedure as described above.</p>
<p>We can implement Gibbs sampling in the context of an Ising model as:</p>
<ol>
<li>Pick a random site $(i,j)$</li>
<li>Set spin to +1 with probability $p_{ij}$, or -1 with probability $(1-p_{ij})$</li>
<li>Begin again</li>
</ol>
<p>The probability is defined as:

$$ p_{ij} = \frac{1}{1+ exp(- \beta \Delta H / \sigma_{i,j})} $$
</p>
<p>At lower temperatures this should behave similarly to the Metropolis-Hastings. However the Metropolis-Hastings method has approximately twice the probability of accepting energetically unfavourable states, as such the Gibbs might be less efficient.</p>
<p>Note: this is true for the Ising model with methods as descibed - it is note a general point on Gibbs/Metropolis-Hastings. When sampling from higher dimensional distributions Gibbs samplers sample each dimension independently whereas Metropolis-Hastings samples points from the high-dimensional space. In some situations the Gibbs sampler can perform significantly better.</p>
<p>Since this is only a minor update to the Metropolis-Hastings code we will not present it here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Glauber-Dynamics-(and-Heat-Bath)">
<a class="anchor" href="#Glauber-Dynamics-(and-Heat-Bath)" aria-hidden="true"><span class="octicon octicon-link"></span></a>Glauber Dynamics (and Heat-Bath)<a class="anchor-link" href="#Glauber-Dynamics-(and-Heat-Bath)"> </a>
</h2>
<p>Another confusion I have seen is that Metropolis-Hastings is the only acceptance-rejection scheme. This is not true, we can also define alternative acceptance probabilites. One such example is Glauber dynamics where we can express the acceptance probability as:

$$ p_{flip} = \frac{1}{2}\left( 1 - tanh\left( \beta \Delta H / 2\right) \right)\frac{exp(-\beta \Delta H/2)}{exp(\beta \Delta H/2) + exp(-\beta \Delta H/2)} $$

We will not derive this here nor simulate using Glauber dynamics (but we could modify 1 or 2 lines of the code above to ahcieve this), it is just to illustrate another option. For the Ising model Glauber dynamics has a lower acceptance probability for all possible states, as such its performance is likely to be slightly worse than Metropolis-Hastings.</p>
<p>For the Ising model Glauber-Dynamics is identical to the Heat-Bath method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simulated-Annealing-and-Simulated-Tempering">
<a class="anchor" href="#Simulated-Annealing-and-Simulated-Tempering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simulated Annealing and Simulated Tempering<a class="anchor-link" href="#Simulated-Annealing-and-Simulated-Tempering"> </a>
</h2>
<p>We now move onto our first "improvement" to the Metropolis-Hastings scheme: simulated annealing.</p>
<p>The concept is very simple and takes inspiration from physical systems. Essentially we just start the system in a high temperature and gradually cool it down. This makes intuitive sense since at higher temperatures we have an increased chance of jumping out of local-minima and get closer to a better overall minima. However we will struggle to actually locate the minima at high temperature for the same reason. In contrast with a low temperature we will be able to locate a nearby local-minima very accurately but will not be able to jump out of it to find a better one. By starting off "hot" the samples will jump between many local minima, as we slowly cool down there should be fewer jumps between local minima and it should eventually get stuck in the domain of a "good" local minima (not far from the global minima ideally) as we cool the temperature further we should get closer and closer to that minima. This is similar to the process of annealing metals by heating them then cooling them to reorganize the crystalline structure.</p>
<p>Simulated annealing has proved very useful in the field of combinatorial optimization in situations where we want to quickly generate "good" solutions (not necessarily "best"). Variations on the idea can be seen in many areas (e.g. variable learning rate algorithms in deep learning can be thought of as a form of simulated annealing). We can also note there is nothing in the method that is particular to Metropolis-Hastings (or the other variations presented) - it can be used with pretty much any simulation method.</p>
<p>We have not descibed "how" we would want to decrease the temperature over time. This is part of the "issue" with simulated annealing (and many MCMC algorithms in general) - there is just as much art as their is science to implementing them. There are no real hard fast rules for getting good results, one in essense has to just try various options until something works (or on well studied problems borrow schemes from others).</p>
<p>We will take a simple approach where we decrease temperature by 10% every 500 steps starting from a temperature of 4 (this was chosen arbitrarily - it is not a suggestion of what might work well in this situation!) We can make use of the code example above for Metropolis-Hastings to give a compact implementation of:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># An implementation of a Metropolis-Hastings algorithm</span>
<span class="c1"># with simulated annealing applied to a 2d Ising spin glass</span>

<span class="c1"># Fix random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Set size of model N and initial spins</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="c1"># Set up initial beta</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span>

<span class="k">def</span> <span class="nf">_main_loop_SA</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">bt_initial</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="n">s_temp</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">bt_live</span> <span class="o">=</span> <span class="n">bt_initial</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ts</span> <span class="o">%</span> <span class="mi">500</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bt_live</span> <span class="o">*=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">0.9</span>
        <span class="n">update_step</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">bt_live</span><span class="p">,</span> <span class="n">s_temp</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">)</span>
        <span class="n">s_temp</span> <span class="o">=</span> <span class="n">update_step</span>
        <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">energy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dE</span>
        <span class="n">mag</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dM</span>

<span class="c1">#### Run Main Loop</span>
<span class="n">_main_loop_SA</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">spins</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="n">mag</span> <span class="o">=</span> <span class="n">mag</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># plot magnetism and energy evolving in time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time step"</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Magnetism"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Energy"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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I8Hs0EMtgN17rx37ULU4DRvCtGm2IvsVV1ib39FHw4gRyed1c865LPOgl6ZIdaf/O57EvvvCI4/A//yPHQ8aZG18vlSRcy4EHvRSNGECvPTSjueLimybStD7d1b6ItUSDz9s05eddZYdt2xpf5CSknDz5ZzLK96ml6YRI6zwMn++raAQkahNL4/+1MmpWg/PF1+MnisqgilTbFXeDh2qNhDSOZc13qbntqtMSc9hAe2FF2D1anjsMevduXkz7L+/je/705/CzqFzLod50EtTqm16jzyS/bzUKs2awSWX2Ji+996D//zH1um7917o3NlehxwCK1aEnVPnXA5Jf16uPBcp6X38sfXK/+ADm5UrXocO1Zqt2iV2baaxY227YoUtXPvkk75un3MuY7xNL01PPQUXX2z7qsmbo15/HU49NaNvnduWLrXVGwD69bMpcZo3DzdPzuWpXGrT85Jemho3Ti2d982opDZtYMwY+6Xw4ou2P3CgFZk7d4Zdd01+X1GRTZkTKYY751zAg16aIm16FfHpJ6vglFNs1P9ll8FHH1V+qfn994czz4Tbb89O/pxztY5Xb6Zp69boRNPJqjfPPhueey71AOmSKC21NZrmzUt8fcMGawucNQu+/96WtgCbHaZ7dwt+O+8MB2ZlmS7nclYuVW960MuASKDbvDlxjVr8GD5XTX76Ce6/36pH58yJnu/a1YLf7rvbLxJvbHWuXB70aqlsB70LL4Snn97x+vLlNgGJC8m2bfDVV7BwIQwbZus8TZkCGzfa9TPPtLWiCgqir4YN4fjjvfOMc3jQq7WyFfQ+/NAWD2jSxGbainjmGTjgAOt34WoYVZg7F3r0iAa/RPr337Feum5duO8++8KdywMe9GqpbAW9n36y2rJ4Y8ZYXwxXg5WWWjvg1q322rbNto89Zg2x8Y20339vaQD23tu2p54aXW7DuRzkQa+WylbQW73apo2Mt3gxtG2b8bdzYdq2zVYFnj3bjidPts41S5cm/uXjXA7IpaDn05BlQHznlbVrrfbMA14OqlMHbrvN6q6feQbOP9/Ot2kDd91lDbiRkqBzDhFpISLviMjcYLtDEUFEjhGRL2JeJSJyRlby4yW99JWWlm322brV/m10eWD9erjxRls6KaJePRs8X1oK111nawrus4+NbfH56FwtlE5JT0T+BqxU1aEichOwk6om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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the system settled down to a lower energy state more quickly and smoothly than with the vanilla Metropolis-Hastings scheme.</p>
<p>Although simulated annealing can improve on vanilla Metropolis-Hastings it can still struggle to find a global minima of the system. There are various "hacks" that can further improve this however - one such example being the concept of restarting. Again this is a very "obvious" thing to try - we store the "best" state we've visited so far in a simulation, if we "get stuck" somewhere above this energy level we "jump back" to this best state and try again.</p>
<p>We can extend the simulated annealing idea further to the concept of "simulated tempering". Here we treat the temperature of the system as a variable in itself, the teperature can go up as well as down during the simulation. This can further improve convergence properties since it allows the system to escape energy boundaries more easily by increasing temperature. This can remove the need to use restarting since a higher temperature is always available as an option at all times.</p>
<p>One such simulated tempering scheme is "parallel tempering" - as the name suggests this involves running many Markov-Chains in parallel and "jumping" between chains as the algorithm progresses. In some instances the cost of running multiple chains is less than the improvement in performance. Again however there is an art to selecting the correct number of chains and temperatures to run in parallel, most times there is no substitute for just trying things and running tests on the results. For the interests of brevity we will not present a full code here - but we note that for 2 chains at temperatures $T_1$ and $T_2$ our proposed update is to switch the states between the two chains (or swap temperatures of the 2 chains) the acceptance probability is then:

$$p_{flip} = min\left[1, exp((H_1-H_2)(\beta_1 - \beta_2)) \right] $$

Where $H_1$ is the energy as defined by the Hamiltonian for chain with temperature $T_1 = 1/\beta_1$ and similar for $H_2$. This can be easily adapted to more chains and temperatures.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Cluster-Update-Methods">
<a class="anchor" href="#Cluster-Update-Methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cluster Update Methods<a class="anchor-link" href="#Cluster-Update-Methods"> </a>
</h1>
<p>We now have a few options for simulating the Ising model, however they are by no means perfect. The issue still remains of falling into local optima instead of a global optima. From our previous mathematical study we know that energy minima for the Ising model are "far away" from each other, that is they have very little overlapping spins. By flipping individual spins 1 by 1 it is very hard to make the chains explore the energy landscape fully. The natural way to solve this is to flip multiple spins simultaneously at each step. From the general definition of the Metropolis-Hastings method there is nothing stopping us in following this line of reasoning.</p>
<p>Unfortunately this makes things much harder, the complications arise in finding a valid scheme for flipping multiple spins at once. We have glossed over the mathematical foundations of MCMC here but the proposal/acceptance probabilities need to be selected in "smart way"  in order for the resulting Markov chain to have certain properties. When looking at more than 1 spin at a time in the Ising model this proved fairly difficult. This is evidenced by the original Metropolis-Hastings scheme being proposed in 1953 yet the first multi-spin method not being proposed and justified until the late 1980s.</p>
<h2 id="Wolff-Algorithm">
<a class="anchor" href="#Wolff-Algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wolff Algorithm<a class="anchor-link" href="#Wolff-Algorithm"> </a>
</h2>
<p>The main idea of the algorithm is to look for "clusters" of spin sites with the same spin. We then decide to flip the spin of all the sites within this cluster at once. We then pick a new cluster and repeat this process as necessary. The pseudocode for this algorithm as it applies to the Ising model is:</p>
<ol>
<li>A site $x$ with spin $\sigma_x$ is selected at random and added to an empty cluster</li>
<li>For each neighbour $y$ of $x$ such that $\sigma_y = \sigma_x$ we add $y$ to the cluster stack with probability $p_{xy} = 1 - exp(-2\beta J_{xy})$ else move onto next neighbour</li>
<li>After all neighbours are exhausted select next site in the cluster stack and repeat the previous step until the cluster stack is exhausted</li>
<li>Once the cluster is fully specified flip the spins of all sites in the cluster and begin again</li>
</ol>
<p>We can see that like the Gibbs sampling algorithm, here the Wolff algorithm is "rejection free" - that is all proposed sites are flipped. We also note that there is nothing in this method that is incompatible with simulated annealing/tempering - these techniques are often used together.</p>
<p>Some of the more computer-science focussed readers may be thinking: "creating clusters is computationally expensive, will a brute force local update method not be better?" Which is a valid concern; there a 2 things to consider here - firstly there are many efficient cluster generating algorithms from percolation theory which can help speed up this process (we presented a very simple method above for clarity.) And secondly the local update methods will take a very long time to make "big jumps" away from the current configuration - even though there is some probability to make unfavourable movements most of the time these will not be accepted, to jump to a different local energy minima we would need many such unfavourable moves which means we could be waiting for a very long time! This is why spin glass models form a good test bed for optimization algorithms as they are one of the simplest to define models with "difficult" energy landscapes.</p>
<p>We should find this algorithm performs better in general, especially near the 2nd order phase transition whereby successive samples become increasingly correlated (whereas we would want more independent samples). We will try and produce plots of the 2nd order themodynamic variables: heat capacity and susceptibility. We should expect to see an approximate discontinuity at the critical temperature. To do this we will re-run the Wolff algorithm multiple times for each target temperature. For each target temperature we will run 1500 "burn" steps and then evaluate our variables over the next 2500 steps. This should be long enough to get some reasonable results.</p>
<p>Note that the Wolff algorithm does not "converge" to a low energy state like the preceeding algorithms, instead it samples from the entire space in a "smart way" - even if it finds itself in the global energy minima there is still a relatively high probability of escaping. As such the graphs we produced before will look more "wiggly" - I've heard the term "fat caterpillar" used to describe the graph of a well mixed MCMC algorithm. If we were interested in finding a ground state we could keep track of the configuration corresponding to the lowest observed energy state so far (we will not do this in our code however).</p>
<p>In the example below we'll run a constant $J=1$ to try and reproduce the heat capacity we found analytically in the previous blog post as a proof of concept. I will leave the functionality for general interaction strengths should you wish to experiment.</p>
<p>An implementation of this method can be seen below (note: this is a very slow code since we're using Python lists! It would be a prime candidate for being sped up using Cython/Numba/etc.):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># An implementation of the Wolff algorithm</span>
<span class="c1"># With simulated annealing applied to a </span>
<span class="c1"># 2d Ising spin glass</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Fix random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Set size of model NxN and initial spins</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">spins_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="c1"># Fix time-steps</span>
<span class="n">burn</span> <span class="o">=</span> <span class="mi">1500</span>
<span class="n">evaluation</span> <span class="o">=</span> <span class="mi">2500</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="n">burn</span> <span class="o">+</span> <span class="n">evaluation</span>

<span class="c1"># Initialize interaction arrays</span>
<span class="c1"># Have 4 arrays: up, down, left right</span>
<span class="c1"># These represent the interaction strengths to the </span>
<span class="c1"># up/down/left/right neighbours of a site</span>
<span class="c1"># There is a symmetry between these matrices</span>
<span class="c1"># This is not the most memory efficient solution</span>
<span class="n">s_h</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s_v</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="c1"># Using J=1 constant so graphs are easier to generate</span>
<span class="c1"># Replace with comments to give an EA spin glass</span>
<span class="n">up</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#np.random.rand(N-1,N) * s_v</span>
<span class="n">down</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">,:]</span>
<span class="n">left</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#np.random.rand(N,N-1) * s_h</span>
<span class="n">right</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]</span>

<span class="c1"># Create function to find neigbour sites</span>
<span class="k">def</span> <span class="nf">nbr_udlr</span><span class="p">(</span><span class="n">s_site</span><span class="p">,</span> <span class="n">s_array</span><span class="p">):</span>
    <span class="n">_N</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">up_site</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">down_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">_N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">up_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">down_site</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">up_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">down_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">left_site</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">right_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">left_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">right_site</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">left_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">right_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">up_site</span><span class="p">,</span> <span class="n">down_site</span><span class="p">,</span> <span class="n">left_site</span><span class="p">,</span> <span class="n">right_site</span><span class="p">]</span>

<span class="c1"># Create function to return interactions strength</span>
<span class="k">def</span> <span class="nf">int_strength</span><span class="p">(</span><span class="n">s_site</span><span class="p">,</span> <span class="n">udlr</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">udlr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">up_array</span><span class="p">[</span><span class="n">s_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">udlr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">down_array</span><span class="p">[</span><span class="n">s_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">udlr</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left_array</span><span class="p">[</span><span class="n">s_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">udlr</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">right_array</span><span class="p">[</span><span class="n">s_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">energy_calc</span><span class="p">(</span><span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="n">_N</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">up_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="n">down_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">up_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="n">down_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">left_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">right_neighbour</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">left_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">right_neighbour</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        
            <span class="n">energy</span> <span class="o">+=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">up_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">up_neighbour</span> <span class="o">+</span> <span class="n">down_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">down_neighbour</span> <span class="o">+</span> <span class="n">left_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">left_neighbour</span> <span class="o">+</span> <span class="n">right_array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">right_neighbour</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">energy</span><span class="o">/</span><span class="mi">2</span>
    
<span class="k">def</span> <span class="nf">wolff_step</span><span class="p">(</span><span class="n">bt</span><span class="p">,</span> <span class="n">s_array</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">):</span>
    <span class="n">_N</span> <span class="o">=</span> <span class="n">s_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_site</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">initial_site</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initial_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">old_spin</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">initial_site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initial_site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_site</span><span class="p">]</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_site</span><span class="p">]</span>
    
    <span class="k">while</span> <span class="n">stack</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">site</span> <span class="o">=</span> <span class="n">stack</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">))]</span>
       
        <span class="c1"># Cycle neigbours</span>
        <span class="n">nbr</span> <span class="o">=</span> <span class="n">nbr_udlr</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">s_array</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">nbr_live</span> <span class="o">=</span> <span class="n">nbr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nbr_live</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">nbr_spin</span> <span class="o">=</span> <span class="n">s_array</span><span class="p">[</span><span class="n">nbr_live</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nbr_live</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">nbr_spin</span> <span class="o">==</span> <span class="n">old_spin</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nbr_live</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cluster</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">bt</span><span class="o">*</span><span class="n">int_strength</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">up_array</span><span class="p">,</span> <span class="n">down_array</span><span class="p">,</span> <span class="n">left_array</span><span class="p">,</span> <span class="n">right_array</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
                        <span class="n">cluster</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nbr_live</span><span class="p">)</span>
                        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nbr_live</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">cluster</span><span class="p">:</span>
        <span class="n">s_array</span><span class="p">[</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">site</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">s_array</span>

<span class="c1">###### Main Code</span>
<span class="c1"># Create useful constants</span>
<span class="n">N1</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span>
<span class="n">N2</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">*</span><span class="n">evaluation</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="n">N</span>

<span class="c1"># Define temp ranges</span>
<span class="n">temp_steps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">temp_min</span> <span class="o">=</span> <span class="mf">1.75</span>
<span class="n">temp_max</span> <span class="o">=</span> <span class="mf">2.75</span>

<span class="n">temp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">temp_min</span><span class="p">,</span> <span class="n">temp_max</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">temp_steps</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">)</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">temp_steps</span><span class="p">):</span>
    <span class="n">spins</span> <span class="o">=</span> <span class="n">spins_initial</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">M1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">E1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">E2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">temp_array</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_steps</span><span class="p">):</span>
        <span class="n">spins</span> <span class="o">=</span> <span class="n">wolff_step</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">spins</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">burn</span><span class="p">:</span>
            <span class="n">mag_tmp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
            <span class="n">M1</span> <span class="o">+=</span> <span class="n">mag_tmp</span>
            <span class="n">M2</span> <span class="o">+=</span> <span class="n">mag_tmp</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">energy_tmp</span> <span class="o">=</span> <span class="n">energy_calc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
            <span class="n">E1</span> <span class="o">+=</span> <span class="n">energy_tmp</span>
            <span class="n">E2</span> <span class="o">+=</span> <span class="n">energy_tmp</span><span class="o">**</span><span class="mi">2</span>   

        <span class="n">M</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">M1</span> <span class="o">/</span> <span class="n">N1</span>
        <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">E1</span> <span class="o">/</span> <span class="n">N1</span>
        <span class="n">C</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">E2</span><span class="o">/</span><span class="n">N1</span> <span class="o">-</span> <span class="n">E1</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">N2</span><span class="p">)</span><span class="o">*</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">X</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">M2</span><span class="o">/</span><span class="n">N1</span> <span class="o">-</span> <span class="n">M1</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">N2</span><span class="p">)</span><span class="o">*</span><span class="n">beta</span>

<span class="c1"># Create plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">'hspace'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">'wspace'</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp_array</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'Red'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Magnetism"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"T"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Magnetism"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp_array</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'Blue'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Energy"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"T"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Energy"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp_array</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'Red'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Susceptibility"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"T"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Susceptibility"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp_array</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'Blue'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Heat Capacity"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">"T"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"Heat Capacity"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plots here are a bit noisy but they loosely match our previous theoretical findings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Swendsen-Wang-Algorithm">
<a class="anchor" href="#Swendsen-Wang-Algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Swendsen-Wang Algorithm<a class="anchor-link" href="#Swendsen-Wang-Algorithm"> </a>
</h2>
<p>Another cluster algorithm is the Swendsen-Wang. Unlike the Wolff algorithm Swendsen-Wang looks at multiple clusters concurrently and applies a spin-flip to all clusters. It was propsed 2 years prior to the Wolff method.</p>
<p>In pseudo code it can be presented as:</p>
<ol>
<li>From an initialized spin configuration for each neighbour pair of sites $\langle x, y \rangle$ we specify a bond: $b_{x,y} \in \{0, 1 \}$ Where we sample according to:
\begin{align}
&amp; \mathbb{P}(b_{x,y} = 0 | \sigma_x \neq \sigma_y) = 1 \\
&amp; \mathbb{P}(b_{x,y} = 1 | \sigma_x \neq \sigma_y) = 0 \\
&amp; \mathbb{P}(b_{x,y} = 0 | \sigma_x = \sigma_y) = exp(-2 \beta J_{xy})  \\
&amp; \mathbb{P}(b_{x,y} = 1 | \sigma_x = \sigma_y) = 1 - exp(-2 \beta J_{xy}) 
\end{align}</li>
<li>Generate clusters using bonds. If there exists a bond between sites $b_{x,y} = 1$ then the sites belong to same cluster</li>
<li>For each cluster with probability 1/2 flip all spins within the cluster to get a new configuration</li>
<li>Repeat process of generating bonds and clusters</li>
</ol>
<p>We can see this is slightly different to the Wolff algorithm since it looks at multiple clusters within a given step. The performance of the Swendsen-Wang is slightly worse than that of the Wolff since it has a lower probability of flipping large clusters (in the case of Ising models). Both algorithms have been adpated and used to alternative spin glass models (as well as models outside of spin glasses).</p>
<p>We won't present an implementation of this method here since we already looked at the Wolff algorithm for an example of a cluster algorithm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h1>
<p>In this blog post we have looked at a variety of MCMC methods for simulating Ising models. We started by looking at various local update methods, which we now know do not behave optimally. We extended these ideas to cluster update methods which can show better performance for Ising models. We also looked at the very intuitive simulated annealing and simulated tempering methods, which have been used in optimization problems far outside the realms of spin glass models or even statsitical physics in general.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/spin-glass-models-4" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A blog about maths, probability, modelling and computing.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/lewiscoleblog" title="lewiscoleblog"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/jazzcoffeestuff" title="jazzcoffeestuff"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
