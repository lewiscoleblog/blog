<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://www.lewiscoleblog.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://www.lewiscoleblog.com/" rel="alternate" type="text/html" /><updated>2020-04-25T02:08:52-05:00</updated><id>https://www.lewiscoleblog.com/feed.xml</id><title type="html">Lewis Cole Blog</title><subtitle>A blog about maths, probability, modelling and computing.</subtitle><entry><title type="html">Spin Glass Models 4: Ising Model - Simulation</title><link href="https://www.lewiscoleblog.com/spin-glass-models-4" rel="alternate" type="text/html" title="Spin Glass Models 4: Ising Model - Simulation" /><published>2020-03-24T00:00:00-05:00</published><updated>2020-03-24T00:00:00-05:00</updated><id>https://www.lewiscoleblog.com/Spin-Glass-Models-4</id><content type="html" xml:base="https://www.lewiscoleblog.com/spin-glass-models-4">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-24-Spin-Glass-Models-4.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the third blog post in a series - you can find the previous blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models-3&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;Setup&quot;&gt;Setup&lt;a class=&quot;anchor-link&quot; href=&quot;#Setup&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this blog we will limit ourselves to trying to find minimum energy states of the Ising model - we could use these schemes in order to estimate other thermodynamic properties also. The models will be in 2-dimensions on a square lattice since the results of these will be easier to display, it should be fairly obvious how we could modify this code for other dimensions. We will also use Gaussian distributed interaction strengths since we do not require mathematical tractability when we are simulating.&lt;/p&gt;
&lt;h2 id=&quot;Interactions&quot;&gt;Interactions&lt;a class=&quot;anchor-link&quot; href=&quot;#Interactions&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Unlike the Sherrington-Kirkpatrick model we will have to be a bit &quot;clever&quot; in defining the interaction strengths. I have decided to do this using 4 (NxN) arrays representing the up, down, left and right interaction strengths. This is a bit wasteful in terms of memory use but I think it is worth the trade-off to improve readability of the code. We then have the following symmetries:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Where these indices exist, for the boundary coniditons we will take the following:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For all possible $i, j$. This is a fixed boundary condition, the edge cases will have only 3 neighbours and corner cases only 2. This can introduce some instability for small spin-glasses but this is fine for our purposes. Modifying this to allow for periodic boundary conditions (i.e. a toroidal geometry) would not be particularly difficult.&lt;/p&gt;
&lt;h2 id=&quot;Mixing,-Convergence,-etc.&quot;&gt;Mixing, Convergence, etc.&lt;a class=&quot;anchor-link&quot; href=&quot;#Mixing,-Convergence,-etc.&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The methods presented below are Markov-Chain Monte-Carlo (MCMC) methods. These methods are notoriously finicky and require parameter tuning, running multiple chains, etc. in order to ensure good performance. As to not get distracted in this blog post I will not mention these concerns but please keep them in mind when reading on. For now we will run a single chain and look at the results it produces, in practice one would not do this.&lt;/p&gt;
&lt;h1 id=&quot;Local-Update-Methods&quot;&gt;Local Update Methods&lt;a class=&quot;anchor-link&quot; href=&quot;#Local-Update-Methods&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We begin by looking at local update methods. In the Sherrington-Kirkpatrick blog post we looked at one such (very bad) method: the greedy gradient descent. Local update methods mean at each simulation step we update 1 site only.&lt;/p&gt;
&lt;h2 id=&quot;Metropolis-Hastings&quot;&gt;Metropolis-Hastings&lt;a class=&quot;anchor-link&quot; href=&quot;#Metropolis-Hastings&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;First we look at the &quot;classic&quot; approach to simulating the Ising model. In many texts and online references this will be the only method that is presented, it leads some to believe (incorrectly) that the simulation method is somehow part of the Ising model itself. This is the method I presented (without elaboration) in my Cython/Numba blog post.&lt;/p&gt;
&lt;p&gt;We present Metropolis-Hastings in it's most general form first (our application to the Ising model will appear below):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Initialize the system in state $x_t$&lt;/li&gt;
&lt;li&gt;Sample a new proposed state from some distribution $Q(x'_{t+1} | x_t)$&lt;/li&gt;
&lt;li&gt;Accept this new state with probability $min\left[\alpha, 1 \right]$, else $x_{t+1} = x_t$, where:

$$ \alpha = \frac{P(x'_{t+1})Q(x_t |x'_{t+1})} {P(x_t)Q(x'_{t+1} |x_{t})} $$
&lt;/li&gt;
&lt;li&gt;Repeat steps 2. and 3.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In this context $P(.)$ represents the probability distribution we wish to estimate. We notice that this does not need to be standardized (i.e. we can ignore any difficult partition functions) so this is a (relatively) easy algorithm to implement. We find that the sequence $x_t$ forms a Markov-Chain - hence the term Markov-Chain Monte Carlo (MCMC).&lt;/p&gt;
&lt;p&gt;We can see that that Metropolis-Hastings consists of 2 steps: a proposal step then an acceptance/rejection step. We see that there are essentially no constraints on $Q(.)$ so we can use something easy to sample from. We only need to be careful that it has a support that contains the support of $P(.)$ - otherwise we will not be able to sample all possible values as required. Selecting a suitable $Q(.)$ is at the heart of the algorithm however, the best performance will be where $Q$ and $P$ are very similar. Since $P$ is generally unknown in advance this often requires a bit of trial and error. There are many ways to test whether the algorithm is doing a &quot;good job&quot; but we will not cover them here (in a later set of blog posts I should probably go deeper into MCMC methods - here we're just concerned with the Ising model in particular).&lt;/p&gt;
&lt;p&gt;Moving back to the Ising model picture, we can apply the Metropolis-Hastings methodology via:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;First pick a random site&lt;/li&gt;
&lt;li&gt;Calculate the change in energy associated with &quot;flipping&quot; this sites spin (going from +1 to -1 or vice versa)&lt;/li&gt;
&lt;li&gt;If the energy decreases accept the flipped state and start again with a new site&lt;/li&gt;
&lt;li&gt;If energy increases accept the flipped state with some acceptance probability or keep the same state &lt;/li&gt;
&lt;li&gt;Begin again&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can see that in contrast to the &quot;greedy hill climber&quot; approach in the Sherrington-Kirkpatrick blog post we are not simply declining into a local minima, there is some probability that we can jump to a state of higher energy and escape a local minima to find a &quot;better&quot; one. In theory if we wait long enough we should find ourselves in a global minimum state. We now derive the acceptance probability as given by Metropolis-Hastings:&lt;/p&gt;
&lt;p&gt;Recall that the Gibbs distribution for the Ising model with a given configuration is:

$$ P(\sigma) = \frac{exp(-\beta H_{\sigma})}{Z_{\beta}} $$
&lt;/p&gt;
&lt;p&gt;Since we are uniformly selecting new states the $Q(.)$ terms in $\alpha$ cancel. If we denote the propsed state as: $\hat{\sigma}$ then the relative likelihood is:

$$ \alpha = \frac{P(\hat{\sigma})}{P(\sigma)} = \frac{exp(-\beta H_{\hat{\sigma}})}{exp(-\beta H_{\sigma})} = exp\left(-\beta \left(H_{\hat{\sigma}} - H_{\sigma}\right)\right) = exp(-\beta \Delta H)  $$
&lt;/p&gt;
&lt;p&gt;To summarise by Metropolis-Hastings we then accept the new configuration with probability:

$$ p_{flip} = min\left[1, exp(-\beta \Delta H) \right] $$
&lt;/p&gt;
&lt;p&gt;In this particular case we can calculate $\Delta H$ quite efficiently since we are changing the spin of only 1 site, the contributions of all other sites &quot;cancels out&quot;. We can write this down as:

$$ \Delta H = 2\sigma_{i,j} \sum_{(x,y) \in \langle i, j \rangle} J_{x,y} \sigma_{x,y} $$
&lt;/p&gt;
&lt;p&gt;This introduces some efficiency in a code implementation since we do not have to calculate the energy of the whole configuration each time we want to update a site's spin. If we are particularly concerned with utmost performance we can also note that $exp(- \beta \Delta H)$ can only take a finite list of values and so a lookup table can be used to avoid a call to an exponential function (we will not implement this however since it is unnecessary for the purposes of this blog post).&lt;/p&gt;
&lt;p&gt;An example implementation of this can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# An implementation of an Ising spin-glass of size NxN&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# With fixed boundary conditions using Metropolis-Hastings&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Connectivity is initialized as a Gaussian distribution N(0, s^2/N)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Updates occur at randomly selected sites&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set size of model N and initial spins&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of timesteps and some containers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize interaction arrays&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Have 4 arrays: up, down, left right&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# These represent the interaction strengths to the &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# up/down/left/right neighbours of a site&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# There is a symmetry between these matrices&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This is not the most memory efficient solution&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s_h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_v&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_h&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Avoid double count - each neighbour pair&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# counted twice in above since loop over each site&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix beta (inverse temerature) - from analysis we know that&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# system in glassy-phase for T&amp;lt;s so beta&amp;gt;1/s. Performance&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# of random updates isn&amp;#39;t good so don&amp;#39;t select temperature&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# too low&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define proposal step&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;proposal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;energy_change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;dE_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE_tmp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;acceptance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Define update step&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Proposal Step&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proposal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Calculate energy change&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy_change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Acceptance step&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;accept&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acceptance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accept&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#### Run Main Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot magnetism and energy evolving in time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time step&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetism&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;twinx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Gibbs-Sampling&quot;&gt;Gibbs Sampling&lt;a class=&quot;anchor-link&quot; href=&quot;#Gibbs-Sampling&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Many presentations of the Ising model only show the Metropolis-Hastings scheme, as such there is a misconception that the Metropolis-Hastings sampling is somehow part of the Ising model itself. This is not true, an alternative to Metropolis-Hastings is Gibbs-Sampling. We can describe Gibbs-Sampling in general terms as:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Pick an initial state $\pmb{x_t} = \left(x^1_t, x^2_t, ... , x^N_t\right)$&lt;/li&gt;
&lt;li&gt;For each $N$ dimension sample: $x^i_{t+1} \sim P\left(x^i_{t+1} | x^i_{t+1}, x^2_{t+1}, ... , x^{i-1}_{t+1}, x^{i+1}_t, ... x^N_i\right)$ and define next state as: $\pmb{x_{i+1}} = \left(x_1^{i+1}, x_2^{i+1}, ... , x_N^{i+1}\right)$&lt;/li&gt;
&lt;li&gt;Repeat sampling for each successive state&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can see this is just a special case of Metropolis-Hastings, if we denote $\pmb{x_t^{-j}} = \left(x_t^1, x_t^2, ... , x_t^{j-1}, x_t^{j+1}, ..., x_t^N\right)$ (all components apart from the jth). Then we can set: 

$$Q(x_{t+1}^j \pmb{x_t^{-j}} | \pmb{x_t} ) = P(x_{t+1}^j | \pmb{x_t^{-j}})$$

In the Metropolis-Hastings scheme, the acceptance probablilty then becomes:
\begin{align}
min\left[1 , \frac{Q(x_{t+1}^j \pmb{x_t^{-j}} | \pmb{x_t} ) P(\pmb{x_t})}{Q(\pmb{x_t} | x_{t+1}^j \pmb{x_t^{-j}} ) P(x_{t+1}^j \pmb{x_t^{-j}})} \right] &amp;amp; = min \left[1 , \frac{P(\pmb{x_t})P(x_{t+1}^j | \pmb{x_t^{-j}})}{P(x_{t+1}^j \pmb{x_t^{-j}})P(x_{t}^j | \pmb{x_t^{-j}})} \right] \\
&amp;amp;= min\left[1 , \frac{P(x_{t}^j | \pmb{x_t^{-j}})P(\pmb{x_t^{-j}})P(x_{t+1}^j | \pmb{x_t^{-j}})}{P(x_{t+1}^j | \pmb{x_t^{-j}})P(\pmb{x_t^{-j}})P(x_{t}^j | \pmb{x_t^{-j}})} \right] \\
&amp;amp;= min \left[1, 1 \right] = 1
\end{align}
Which results in the Gibbs procedure as described above.&lt;/p&gt;
&lt;p&gt;We can implement Gibbs sampling in the context of an Ising model as:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Pick a random site $(i,j)$&lt;/li&gt;
&lt;li&gt;Set spin to +1 with probability $p_{ij}$, or -1 with probability $(1-p_{ij})$&lt;/li&gt;
&lt;li&gt;Begin again&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The probability is defined as:

$$ p_{ij} = \frac{1}{1+ exp(- \beta \Delta H / \sigma_{i,j})} $$
&lt;/p&gt;
&lt;p&gt;At lower temperatures this should behave similarly to the Metropolis-Hastings. However the Metropolis-Hastings method has approximately twice the probability of accepting energetically unfavourable states, as such the Gibbs might be less efficient.&lt;/p&gt;
&lt;p&gt;Note: this is true for the Ising model with methods as descibed - it is note a general point on Gibbs/Metropolis-Hastings. When sampling from higher dimensional distributions Gibbs samplers sample each dimension independently whereas Metropolis-Hastings samples points from the high-dimensional space. In some situations the Gibbs sampler can perform significantly better.&lt;/p&gt;
&lt;p&gt;Since this is only a minor update to the Metropolis-Hastings code we will not present it here.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Glauber-Dynamics-(and-Heat-Bath)&quot;&gt;Glauber Dynamics (and Heat-Bath)&lt;a class=&quot;anchor-link&quot; href=&quot;#Glauber-Dynamics-(and-Heat-Bath)&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another confusion I have seen is that Metropolis-Hastings is the only acceptance-rejection scheme. This is not true, we can also define alternative acceptance probabilites. One such example is Glauber dynamics where we can express the acceptance probability as:

$$ p_{flip} = \frac{1}{2}\left( 1 - tanh\left( \beta \Delta H / 2\right) \right)\frac{exp(-\beta \Delta H/2)}{exp(\beta \Delta H/2) + exp(-\beta \Delta H/2)} $$

We will not derive this here nor simulate using Glauber dynamics (but we could modify 1 or 2 lines of the code above to ahcieve this), it is just to illustrate another option. For the Ising model Glauber dynamics has a lower acceptance probability for all possible states, as such its performance is likely to be slightly worse than Metropolis-Hastings.&lt;/p&gt;
&lt;p&gt;For the Ising model Glauber-Dynamics is identical to the Heat-Bath method.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Simulated-Annealing-and-Simulated-Tempering&quot;&gt;Simulated Annealing and Simulated Tempering&lt;a class=&quot;anchor-link&quot; href=&quot;#Simulated-Annealing-and-Simulated-Tempering&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now move onto our first &quot;improvement&quot; to the Metropolis-Hastings scheme: simulated annealing.&lt;/p&gt;
&lt;p&gt;The concept is very simple and takes inspiration from physical systems. Essentially we just start the system in a high temperature and gradually cool it down. This makes intuitive sense since at higher temperatures we have an increased chance of jumping out of local-minima and get closer to a better overall minima. However we will struggle to actually locate the minima at high temperature for the same reason. In contrast with a low temperature we will be able to locate a nearby local-minima very accurately but will not be able to jump out of it to find a better one. By starting off &quot;hot&quot; the samples will jump between many local minima, as we slowly cool down there should be fewer jumps between local minima and it should eventually get stuck in the domain of a &quot;good&quot; local minima (not far from the global minima ideally) as we cool the temperature further we should get closer and closer to that minima. This is similar to the process of annealing metals by heating them then cooling them to reorganize the crystalline structure.&lt;/p&gt;
&lt;p&gt;Simulated annealing has proved very useful in the field of combinatorial optimization in situations where we want to quickly generate &quot;good&quot; solutions (not necessarily &quot;best&quot;). Variations on the idea can be seen in many areas (e.g. variable learning rate algorithms in deep learning can be thought of as a form of simulated annealing). We can also note there is nothing in the method that is particular to Metropolis-Hastings (or the other variations presented) - it can be used with pretty much any simulation method.&lt;/p&gt;
&lt;p&gt;We have not descibed &quot;how&quot; we would want to decrease the temperature over time. This is part of the &quot;issue&quot; with simulated annealing (and many MCMC algorithms in general) - there is just as much art as their is science to implementing them. There are no real hard fast rules for getting good results, one in essense has to just try various options until something works (or on well studied problems borrow schemes from others).&lt;/p&gt;
&lt;p&gt;We will take a simple approach where we decrease temperature by 10% every 500 steps starting from a temperature of 4 (this was chosen arbitrarily - it is not a suggestion of what might work well in this situation!) We can make use of the code example above for Metropolis-Hastings to give a compact implementation of:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# An implementation of a Metropolis-Hastings algorithm&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# with simulated annealing applied to a 2d Ising spin glass&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set size of model N and initial spins&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up initial beta&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_main_loop_SA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt_initial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bt_live&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt_initial&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;bt_live&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt_live&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#### Run Main Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_main_loop_SA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot magnetism and energy evolving in time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time step&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetism&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;twinx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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I8Hs0EMtgN17rx37ULU4DRvCtGm2IvsVV1ib39FHw4gRyed1c865LPOgl6ZIdaf/O57EvvvCI4/A//yPHQ8aZG18vlSRcy4EHvRSNGECvPTSjueLimybStD7d1b6ItUSDz9s05eddZYdt2xpf5CSknDz5ZzLK96ml6YRI6zwMn++raAQkahNL4/+1MmpWg/PF1+MnisqgilTbFXeDh2qNhDSOZc13qbntqtMSc9hAe2FF2D1anjsMevduXkz7L+/je/705/CzqFzLod50EtTqm16jzyS/bzUKs2awSWX2Ji+996D//zH1um7917o3NlehxwCK1aEnVPnXA5Jf16uPBcp6X38sfXK/+ADm5UrXocO1Zqt2iV2baaxY227YoUtXPvkk75un3MuY7xNL01PPQUXX2z7qsmbo15/HU49NaNvnduWLrXVGwD69bMpcZo3DzdPzuWpXGrT85Jemho3Ti2d982opDZtYMwY+6Xw4ou2P3CgFZk7d4Zdd01+X1GRTZkTKYY751zAg16aIm16FfHpJ6vglFNs1P9ll8FHH1V+qfn994czz4Tbb89O/pxztY5Xb6Zp69boRNPJqjfPPhueey71AOmSKC21NZrmzUt8fcMGawucNQu+/96WtgCbHaZ7dwt+O+8MB2ZlmS7nclYuVW960MuASKDbvDlxjVr8GD5XTX76Ce6/36pH58yJnu/a1YLf7rvbLxJvbHWuXB70aqlsB70LL4Snn97x+vLlNgGJC8m2bfDVV7BwIQwbZus8TZkCGzfa9TPPtLWiCgqir4YN4fjjvfOMc3jQq7WyFfQ+/NAWD2jSxGbainjmGTjgAOt34WoYVZg7F3r0iAa/RPr337Feum5duO8++8KdywMe9GqpbAW9n36y2rJ4Y8ZYXwxXg5WWWjvg1q322rbNto89Zg2x8Y20339vaQD23tu2p54aXW7DuRzkQa+WylbQW73apo2Mt3gxtG2b8bdzYdq2zVYFnj3bjidPts41S5cm/uXjXA7IpaDn05BlQHznlbVrrfbMA14OqlMHbrvN6q6feQbOP9/Ot2kDd91lDbiRkqBzDhFpISLviMjcYLtDEUFEjhGRL2JeJSJyRlby4yW99JWWlm322brV/m10eWD9erjxRls6KaJePRs8X1oK111nawrus4+NbfH56FwtlE5JT0T+BqxU1aEichOwk6om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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that the system settled down to a lower energy state more quickly and smoothly than with the vanilla Metropolis-Hastings scheme.&lt;/p&gt;
&lt;p&gt;Although simulated annealing can improve on vanilla Metropolis-Hastings it can still struggle to find a global minima of the system. There are various &quot;hacks&quot; that can further improve this however - one such example being the concept of restarting. Again this is a very &quot;obvious&quot; thing to try - we store the &quot;best&quot; state we've visited so far in a simulation, if we &quot;get stuck&quot; somewhere above this energy level we &quot;jump back&quot; to this best state and try again.&lt;/p&gt;
&lt;p&gt;We can extend the simulated annealing idea further to the concept of &quot;simulated tempering&quot;. Here we treat the temperature of the system as a variable in itself, the teperature can go up as well as down during the simulation. This can further improve convergence properties since it allows the system to escape energy boundaries more easily by increasing temperature. This can remove the need to use restarting since a higher temperature is always available as an option at all times.&lt;/p&gt;
&lt;p&gt;One such simulated tempering scheme is &quot;parallel tempering&quot; - as the name suggests this involves running many Markov-Chains in parallel and &quot;jumping&quot; between chains as the algorithm progresses. In some instances the cost of running multiple chains is less than the improvement in performance. Again however there is an art to selecting the correct number of chains and temperatures to run in parallel, most times there is no substitute for just trying things and running tests on the results. For the interests of brevity we will not present a full code here - but we note that for 2 chains at temperatures $T_1$ and $T_2$ our proposed update is to switch the states between the two chains (or swap temperatures of the 2 chains) the acceptance probability is then:

$$p_{flip} = min\left[1, exp((H_1-H_2)(\beta_1 - \beta_2)) \right] $$

Where $H_1$ is the energy as defined by the Hamiltonian for chain with temperature $T_1 = 1/\beta_1$ and similar for $H_2$. This can be easily adapted to more chains and temperatures.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Cluster-Update-Methods&quot;&gt;Cluster Update Methods&lt;a class=&quot;anchor-link&quot; href=&quot;#Cluster-Update-Methods&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We now have a few options for simulating the Ising model, however they are by no means perfect. The issue still remains of falling into local optima instead of a global optima. From our previous mathematical study we know that energy minima for the Ising model are &quot;far away&quot; from each other, that is they have very little overlapping spins. By flipping individual spins 1 by 1 it is very hard to make the chains explore the energy landscape fully. The natural way to solve this is to flip multiple spins simultaneously at each step. From the general definition of the Metropolis-Hastings method there is nothing stopping us in following this line of reasoning.&lt;/p&gt;
&lt;p&gt;Unfortunately this makes things much harder, the complications arise in finding a valid scheme for flipping multiple spins at once. We have glossed over the mathematical foundations of MCMC here but the proposal/acceptance probabilities need to be selected in &quot;smart way&quot;  in order for the resulting Markov chain to have certain properties. When looking at more than 1 spin at a time in the Ising model this proved fairly difficult. This is evidenced by the original Metropolis-Hastings scheme being proposed in 1953 yet the first multi-spin method not being proposed and justified until the late 1980s.&lt;/p&gt;
&lt;h2 id=&quot;Wolff-Algorithm&quot;&gt;Wolff Algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#Wolff-Algorithm&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The main idea of the algorithm is to look for &quot;clusters&quot; of spin sites with the same spin. We then decide to flip the spin of all the sites within this cluster at once. We then pick a new cluster and repeat this process as necessary. The pseudocode for this algorithm as it applies to the Ising model is:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A site $x$ with spin $\sigma_x$ is selected at random and added to an empty cluster&lt;/li&gt;
&lt;li&gt;For each neighbour $y$ of $x$ such that $\sigma_y = \sigma_x$ we add $y$ to the cluster stack with probability $p_{xy} = 1 - exp(-2\beta J_{xy})$ else move onto next neighbour&lt;/li&gt;
&lt;li&gt;After all neighbours are exhausted select next site in the cluster stack and repeat the previous step until the cluster stack is exhausted&lt;/li&gt;
&lt;li&gt;Once the cluster is fully specified flip the spins of all sites in the cluster and begin again&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can see that like the Gibbs sampling algorithm, here the Wolff algorithm is &quot;rejection free&quot; - that is all proposed sites are flipped. We also note that there is nothing in this method that is incompatible with simulated annealing/tempering - these techniques are often used together.&lt;/p&gt;
&lt;p&gt;Some of the more computer-science focussed readers may be thinking: &quot;creating clusters is computationally expensive, will a brute force local update method not be better?&quot; Which is a valid concern; there a 2 things to consider here - firstly there are many efficient cluster generating algorithms from percolation theory which can help speed up this process (we presented a very simple method above for clarity.) And secondly the local update methods will take a very long time to make &quot;big jumps&quot; away from the current configuration - even though there is some probability to make unfavourable movements most of the time these will not be accepted, to jump to a different local energy minima we would need many such unfavourable moves which means we could be waiting for a very long time! This is why spin glass models form a good test bed for optimization algorithms as they are one of the simplest to define models with &quot;difficult&quot; energy landscapes.&lt;/p&gt;
&lt;p&gt;We should find this algorithm performs better in general, especially near the 2nd order phase transition whereby successive samples become increasingly correlated (whereas we would want more independent samples). We will try and produce plots of the 2nd order themodynamic variables: heat capacity and susceptibility. We should expect to see an approximate discontinuity at the critical temperature. To do this we will re-run the Wolff algorithm multiple times for each target temperature. For each target temperature we will run 1500 &quot;burn&quot; steps and then evaluate our variables over the next 2500 steps. This should be long enough to get some reasonable results.&lt;/p&gt;
&lt;p&gt;Note that the Wolff algorithm does not &quot;converge&quot; to a low energy state like the preceeding algorithms, instead it samples from the entire space in a &quot;smart way&quot; - even if it finds itself in the global energy minima there is still a relatively high probability of escaping. As such the graphs we produced before will look more &quot;wiggly&quot; - I've heard the term &quot;fat caterpillar&quot; used to describe the graph of a well mixed MCMC algorithm. If we were interested in finding a ground state we could keep track of the configuration corresponding to the lowest observed energy state so far (we will not do this in our code however).&lt;/p&gt;
&lt;p&gt;In the example below we'll run a constant $J=1$ to try and reproduce the heat capacity we found analytically in the previous blog post as a proof of concept. I will leave the functionality for general interaction strengths should you wish to experiment.&lt;/p&gt;
&lt;p&gt;An implementation of this method can be seen below (note: this is a very slow code since we're using Python lists! It would be a prime candidate for being sped up using Cython/Numba/etc.):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# An implementation of the Wolff algorithm&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# With simulated annealing applied to a &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2d Ising spin glass&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set size of model NxN and initial spins&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins_initial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix time-steps&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;burn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;evaluation&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;time_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;burn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluation&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize interaction arrays&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Have 4 arrays: up, down, left right&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# These represent the interaction strengths to the &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# up/down/left/right neighbours of a site&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# There is a symmetry between these matrices&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# This is not the most memory efficient solution&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s_h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s_v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Using J=1 constant so graphs are easier to generate&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Replace with comments to give an EA spin glass&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#np.random.rand(N-1,N) * s_v&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#np.random.rand(N,N-1) * s_h&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create function to find neigbour sites&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nbr_udlr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;down_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create function to return interactions strength&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;int_strength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;udlr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;udlr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;udlr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;udlr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;udlr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;energy_calc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
            &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;down_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left_neighbour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right_neighbour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;wolff_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;old_spin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
       
        &lt;span class=&quot;c1&quot;&gt;# Cycle neigbours&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nbr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr_udlr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nbr_spin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr_spin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old_spin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int_strength&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nbr_live&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cluster&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;###### Main Code&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create useful constants&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define temp ranges&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temp_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.75&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;temp_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.75&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;temp_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins_initial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;M1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;M2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;E1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;E2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wolff_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;burn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;mag_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;M1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag_tmp&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;M2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag_tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;energy_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy_calc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;E1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy_tmp&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;E2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy_tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;   

        &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;E1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;E1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create plots&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridspec_kw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetism&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetism&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Susceptibility&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Susceptibility&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Heat Capacity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Heat Capacity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The plots here are a bit noisy but they loosely match our previous theoretical findings.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Swendsen-Wang-Algorithm&quot;&gt;Swendsen-Wang Algorithm&lt;a class=&quot;anchor-link&quot; href=&quot;#Swendsen-Wang-Algorithm&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another cluster algorithm is the Swendsen-Wang. Unlike the Wolff algorithm Swendsen-Wang looks at multiple clusters concurrently and applies a spin-flip to all clusters. It was propsed 2 years prior to the Wolff method.&lt;/p&gt;
&lt;p&gt;In pseudo code it can be presented as:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;From an initialized spin configuration for each neighbour pair of sites $\langle x, y \rangle$ we specify a bond: $b_{x,y} \in \{0, 1 \}$ Where we sample according to:
\begin{align}
&amp;amp; \mathbb{P}(b_{x,y} = 0 | \sigma_x \neq \sigma_y) = 1 \\
&amp;amp; \mathbb{P}(b_{x,y} = 1 | \sigma_x \neq \sigma_y) = 0 \\
&amp;amp; \mathbb{P}(b_{x,y} = 0 | \sigma_x = \sigma_y) = exp(-2 \beta J_{xy})  \\
&amp;amp; \mathbb{P}(b_{x,y} = 1 | \sigma_x = \sigma_y) = 1 - exp(-2 \beta J_{xy}) 
\end{align}&lt;/li&gt;
&lt;li&gt;Generate clusters using bonds. If there exists a bond between sites $b_{x,y} = 1$ then the sites belong to same cluster&lt;/li&gt;
&lt;li&gt;For each cluster with probability 1/2 flip all spins within the cluster to get a new configuration&lt;/li&gt;
&lt;li&gt;Repeat process of generating bonds and clusters&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can see this is slightly different to the Wolff algorithm since it looks at multiple clusters within a given step. The performance of the Swendsen-Wang is slightly worse than that of the Wolff since it has a lower probability of flipping large clusters (in the case of Ising models). Both algorithms have been adpated and used to alternative spin glass models (as well as models outside of spin glasses).&lt;/p&gt;
&lt;p&gt;We won't present an implementation of this method here since we already looked at the Wolff algorithm for an example of a cluster algorithm.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this blog post we have looked at a variety of MCMC methods for simulating Ising models. We started by looking at various local update methods, which we now know do not behave optimally. We extended these ideas to cluster update methods which can show better performance for Ising models. We also looked at the very intuitive simulated annealing and simulated tempering methods, which have been used in optimization problems far outside the realms of spin glass models or even statsitical physics in general.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/hc_graph.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Spin Glass Models 3: Ising Model - Theory</title><link href="https://www.lewiscoleblog.com/spin-glass-models-3" rel="alternate" type="text/html" title="Spin Glass Models 3: Ising Model - Theory" /><published>2020-03-17T00:00:00-05:00</published><updated>2020-03-17T00:00:00-05:00</updated><id>https://www.lewiscoleblog.com/Spin-Glass-Models-3</id><content type="html" xml:base="https://www.lewiscoleblog.com/spin-glass-models-3">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-17-Spin-Glass-Models-3.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the third blog post in a series - you can find the previous blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models-2&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;In this blog post we are going to look at another spin-glass model. In the previous post we looked at the Sherrington-Kirkpatrick model which allowed us to study the spin-glass analytically. However there is a certain lack of &quot;realism&quot; in this model - the infinite interaction range means that the Sherrington-Kirkpatrick (in a sense) does not occupy any space, there is no concept of dimension nor geometry. While providing interesting mathematical results, some of which appear to be universal to spin-glass systems, we would like to look at a different model that captures more of the real world system and perhaps might uncover new behaviours.&lt;/p&gt;
&lt;h2 id=&quot;Introducing-the-Ising-Model&quot;&gt;Introducing the Ising Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Introducing-the-Ising-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;One model that we can look at is the Edwards-Anderson Ising model. We have actually looked at these models achronologically: Edwards-Anderson proposed the Ising model before Sherrington-Kirkpatrick proposed theirs. In fact Sherrington-Kirkpatrick developed their model partly due to the difficulty in deal with the Ising model. I have presented the models in this order in this series of blog posts because it feels more natural to look at models in increasing complexity order rather than presenting a historical account.&lt;/p&gt;
&lt;p&gt;The main difference between Ising and Sherrington-Kirkpatrick is the extent over which the interactions can occur, instead of an infinite range the Ising model only allows &quot;nearest-neighbour&quot; interactions. This relaxation means that there is a concept of dimension and geometry to an Ising spin-glass. For example we could think of spins oriented on a line segment (a finite 1d Ising model), a square lattice (a 2d Ising model) or something more exotic like spins oriented on the nodes of a 32 dimensional hexagonal lattice. Through careful use of limits we could also consider infinite-dimensional Ising models too. The Hamiltonian follows the form one would expect:

$$ H = - \sum_{\lt x,y \gt} J_{xy} \sigma_x \sigma_y  - h \sum_x \sigma_x $$

Where we use the notation $\lt x,y \gt$ to denote the sum occuring over neighbour pairs.&lt;/p&gt;
&lt;p&gt;As before the selection of $J_{xy}$ is somewhat arbitrary, however unlike the Sherrington-Kirkpatrick we do not have to scale this with lattice size to retain meaningful &quot;average energy&quot; or &quot;average magnetism&quot; measurements when we increase the size of the system. If we take $J_{xy} = J$ for some fixed $J$ we get the Ising model of Ferromagnetism, if we allow $J_{xy}$ to vary according to some distribution we get the Edwards-Anderson Ising Model. In this blog we will use the term &quot;Ising model&quot; to refer to either situation, the mathematics of moving from the fixed $J$ case usually involves integrating against the density function, this can lead to more complicated formulae so in this blog we will mainly focus on the ferromagnetic case unless otherwise stated.&lt;/p&gt;
&lt;p&gt;As before spins can only take values $\pm 1$ - in some literature this is referred to as &quot;Ising spins&quot; (e.g. you can read references to &quot;Sherrington-Kirkpatrick with Ising spins&quot; - this means an infinite interaction range with binary spins).&lt;/p&gt;
&lt;p&gt;A pictorial representation of a 3d square lattice Ising spin-glass can be seen below:
&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/Ising3d.png&quot; alt=&quot;&quot; title=&quot;Source: https://en.wikitolearn.org/Course:Statistical_Mechanics/Statistical_mechanics_of_phase_transitions/The_Ising_model_-_Introduction&quot; /&gt;&lt;/p&gt;
&lt;p&gt;For the rest of this article we will limit ourselves to talking about &quot;square&quot; lattices since this is where the majority of research is focussed. Using different lattice types won't change the story too much.&lt;/p&gt;
&lt;p&gt;In studying these models it is also worth noting what happens on the &quot;boundary&quot; of the lattice: for finite size systems this can become an issue. In this blog post we will skirt over the issue, where necessary we will assume periodic boundary conditions (i.e. there is a toroidal type geometry to the system) so each &quot;edge&quot; of the lattice is connected to an opposing one, so in a sense there are no boundary conditions to specify.&lt;/p&gt;
&lt;h2 id=&quot;1D-Ising-Model&quot;&gt;1D Ising Model&lt;a class=&quot;anchor-link&quot; href=&quot;#1D-Ising-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We will now consider a 1 dimensional Ising model where spins are located on a line segment. This simplication means that finding the ground state (minimal energy spin configuration) is trivial: we pick a site in the middle of the line segment (the origin) we will pick a spin ($\pm 1$) at random. We then propagate out from the origin in the left and right direction, we pick the spin for the next site according to the interaction strength for example: if $\sigma_0 = +1$ and $J_{0,1} &amp;gt; 0$ then $\sigma_1 = +1$ and so on. We can see that (as with all spin glass systems) there is a symmetry: if we flip all the spins direction we end up with an equivalent energy - we call these &quot;pairs&quot; of configurations. It doesn't take much convincing to realise that the pair of configurations we constructed is a unique minima for the system. To see this imagine we have only one pair of spins that opposes the direction indicated by the interaction strength. For a large enough system we can eventually find another interaction strength that is greater in magnitude (by definition having a spin pair as indicated by the sign of the interaction strength). By simply flipping the relative orientation of the pairs we will end up with a configuration of lower energy - which is a contradiction.&lt;/p&gt;
&lt;p&gt;We will now look to solve the 1d Ising model analytically. For simplicity we will assume no external magnetic field, this just makes the formulae look &quot;prettier&quot;. The crux of understanding any spin glass system is finding the Gibbs distribution, as before:

$$P(\sigma) = \frac{exp(-\beta H_{\sigma})}{Z_{\beta}}$$

Where:

$$H = - \sum_{\lt x,y \gt} J_{xy} \sigma_x \sigma_y$$

And $\beta$ is the inverse temperature. We can write an expression for the partition function as:

$$ Z_{\beta} = \sum_{\sigma} exp(-\beta H_{\sigma})  = \sum_{\sigma} exp(-\beta \sum_{\lt x,y \gt} J_{xy} \sigma_x \sigma_y)  $$

Suppose we look at a line segment with $N$ spins, we can then write this as:

$$ Z_{\beta} =\sum_{\sigma_1, ..., \sigma_N} exp(-\beta (J_{1,2}\sigma_1 \sigma_2 + J_{2,3}\sigma_2 \sigma_3 + ... + J_{N-1,N}\sigma_{N-1}\sigma_N))$$

We notice that we can factorise this summation as:

$$ Z_{\beta} =\sum_{\sigma_1, ..., \sigma_{N-1}} exp(-\beta (J_{1,2}\sigma_1 \sigma_2 + ... + J_{N-2,N-1}\sigma_{N-2}\sigma_{N-1}))\sum_{\sigma_N}exp(-\beta J_{N-1,N} \sigma_{N-1} \sigma_N)  $$

The internal sum can then be evaluated:

$$ \sum_{\sigma_N}exp(-\beta J_{N-1,N} \sigma_{N-1} \sigma_N) = exp(\beta J_{N-1,N} \sigma_{N-1} ) + exp(-\beta J_{N-1,N} \sigma_{N-1} ) = 2cosh(\beta J_{N-1,N} \sigma_{N-1}) = 2cosh(\beta J_{N-1,N}) $$

The last equality making use of the fact $\sigma_{N-1} = \pm 1$ and that $cosh(x) = cosh(-x)$. By repeating this process we can express the partition function as:

$$ Z_{\beta} = 2 \prod_{i=1}^{N-1} 2 cosh(\beta J_{i,i+1})  $$

We can evaluate this exactly. If we are sampling the interaction strengths according to some distribution we can find expected values (or other statistical properties) by integrating against the density function as usual, since this adds to notational complexity we will assume that the interaction strengths are fixed for now. We can then calculate thermal properties using the equations:&lt;/p&gt;
\begin{align}
F &amp;amp;= - \frac{1}{\beta} ln Z_{\beta} = - T ln 2 - T \sum_{i=1}^{N-1} ln (2 cosh(\beta J_{i,i+1})) \\
U &amp;amp;= - \frac{\partial}{\partial \beta} ln Z_{\beta} = - \sum_{i=1}^{N-1} J_{i,i+1} tanh(\beta J_{i,i+1}) \\
C &amp;amp;= \frac{\partial U}{\partial T} = \sum_{i=1}^{N-1} (\beta J_{i,i+1})^2 sech^2(\beta J_{i,i+1}) \\
S &amp;amp;= \frac{U - F}{T} = ln2 + \sum_{i=1}^{N-1} \left( -\beta J_{i,i+1} tanh(\beta J_{i,i+1}) + ln(2cosh(\beta J_{i,i+1}) \right)
\end{align}&lt;p&gt;Where: &lt;br /&gt;
F - is the Helmholtz-Free Energy &lt;br /&gt;
U - is the thermodynamic energy (ensemble average) &lt;br /&gt;
C - is the heat capacity &lt;br /&gt;
S - is the entropy&lt;/p&gt;
&lt;p&gt;We can find the expected value of a given instantiation of interactions through an integral such as:

$$ \mathbb{E}(U) = - \sum_{i=1}^{N-1} \int J_{i,i+1} tanh(\beta J_{i,i+1}) Q(J_{i,i+1}) dJ_{i,i+1} $$

With $Q(J)$ being the density function of the distribution and the integral occuring over its support. Similar formulae exist for the other thermodynamic variables and you can calculate other statistics (e.g. variance) in the usual way.&lt;/p&gt;
&lt;p&gt;We can plot the values of these variables for a given set of interaction weights:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code creates a 4 figure plot showing how&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Thermodynamic variables change with temperature&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# For a 1d Ising Model with Gaussian interactions&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of points&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Instantiate interaction strength&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set temperature ranges&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up holders for variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop over T_steps and calculate at each step&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Divide by number of points to give a scale invariant measure&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create plots&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridspec_kw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Free Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;F / N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Average Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;U / N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Heat Capacity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;C / N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Entropy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;S / N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmkAAAJcCAYAAACixjPMAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nOzdd3hUVf7H8fc3nZBCAiG00HsXQrOCgF3BAjYQC2BdXbuuu+uubV3r2gVRBMTeO80OKASkl9B7CTUESEg5vz9m2F9kk9CS3Jnk83qe+8zcuWdmPihev3PuueeYcw4RERERCSwhXgcQERERkf+lIk1EREQkAKlIExEREQlAKtJEREREApCKNBEREZEApCJNREREJACpSBMREREJQCrS5KiZ2Woz229mWYW2OuXwvf8ws9xDvndXWX+viAQvM/vBzHaaWaTXWUqD/8+Tfch58Auvc0nZUJEmx+p851xMoW3joQ3MLKwMvve9Q763Wml/QRnlFpFyZmYNgVMAB1xQRt/hxfnilkPOg+eX9hfoPBgYVKRJqTGzhmbmzOw6M1sLfOd/vbuZTTOzXWY218x6FnpPvJm9bmabzGyDmT1iZqHH+P3OzG4ws2X+X84vmZkVOn6tmS32H5tgZg0Oee/NZrYMWOZ/7QwzW2pmu83sZTP70cyGmlmkme0ws3aF3l/T37uYdCzZRaRMXAX8CrwJDDn4ov+ctLnwucbMLjSzef7nIWZ2n5mtMLPtZva+mSX6jxV3nvvA/5m7zewnM2tT6LOrm9kXZpZpZjP957lfCh1vaWaT/OeVpWY28Fj+sGbW08zWm9mdZrbVf169ptDxSDN7yszWmtkWM3vVzKoc8t57zWwzMNr/+j3+z9noP/85M2tqZl38nxFW6PMvNrM5x5JdiqYiTcrCaUAr4Ewzqwt8BTwCJAJ3AR8VKmbGAHlAU+AE4Axg6HF893lAF6ADMBA4E8DM+gN/AS4CkoCfgXcOeW9/oBvQ2sxqAB8C9wPVgaXAiQDOuRzgXWBQofdeDkx2zmUcR3YRKV1XAeP925lmlgzgnPsV2AucXqjtFcDb/ue34jsfnAbUAXYCLx3y2f89z/n3vwGaATWB2f7vPOgl//fVwlcsFi4YqwKT/N9dE9+55OXCRd5RqgXEA3WB64CXzCzBf+zfQHOgI75zbl3g74e8NxFoAAw3s7OAO4A+/vanHWzonJsJbAf6Fnr/IGDcMeaWojjntGk7qg1YDWQBu/zbp/7XG+K7rNC4UNt7gXGHvH8CvpNUMpADVCl07HLg+2K+9x/AgULfu6twW/93n1xo/33gPv/zb4DrCh0LAfYBDQq99/RCx68CphfaN2AdMNS/382/H+LfTwMGev3vRps2bb4NOBnIBWr495cAtxc6/gjwhv95LL4iqoF/fzHQu1Db2v7PCivqPFfEd1fzt4kHQv3vbXHId//if34p8PMh7x8BPFjMZ//gP3cVPg8+7D/WE9gPhBVqvxXo7j+H7QWaFDrWA1hV6L0HgKhCx98A/lVov6n/z9XUv38vMN7/PNGfq7bX/+4r0qZrznKs+jvnJhdzbF2h5w2AAWZWeMxEOPC9/1g4sKnQVcmQQ95/qPedc4NKOL650PN9QEyhHM+Z2dOFjhu+X5Jrishdp/C+c86Z2fpC+7+Z2V7gNDPbhO/k9XkJuUSkfA0BJjrntvn33/a/9myh/WlmdiO+HvbZzrmD54IGwCdmVlDo8/Lx/bA86L/nB/9l00eBAfh66g++rwZQBV9xt66o9/q/q5v98SaoMErukbrVOTeqmGPbnXN5hfYPngeTgGhgVuFRIPiKyIMynHPZhfbr4PsBWlRugLeAxWYWg+/Kxc/OuU0l5JajpCJNyoIr9Hwdvp60YYc2MrPa+HrSahxyUikL64BHnXPjS2hTOPcmoN7BHf/YtnqHtB+Dr3t/M/DhISc3EfGIf5zVQCDUP74KIBKoZmYdnHNznXOLzGwNcDZ/vNQJvvPFtc65qUV8dkP/08LniyuAfvguC67G14O2E18RlIFvSEc9IN3fPuWQ7/rROVf4smFZ2Iavl62Nc25DMW3cIft/OA/yx9w45zaY2XTgQmAw8EopZRU/jUmTsvYWcL6ZnWlmoWYW5R+gWs//i2si8LSZxfkH6zYxs9MO85nH4lXg/oPjPMx3w8KAEtp/BbQzs/7+gbE34xuvUdg4fCenQcDYMsgsIsemP76er9b4xl91xDd+7Gd8QxkOehvf+LNTgQ8Kvf4q8OjBm4vMLMnM+pXwfbH4fnBux9db9djBA865fOBj4B9mFm1mLQ/J8CXQ3MwGm1m4f+tiZq2O4c9dLOdcAfAa8KyZ1fT/ueqa2ZklvO194Boza2Vm0fxx/NpBY4F7gHbAJ6WZWVSkSRlzzq3D9wvzL/h+Ua4D7ub//+5dBUQAi/D98vwQ3/iP4lxqf5wfKOvgCecwOT7BN2j2XTPLBBbg+wVdXPtt+C5dPIHvxNsaX7d/TqE26/ENEHb4Tv4iEhiGAKOdc2udc5sPbsCLwJWF7kh8B99YrO8KXRYFeA7f8IWJZrYH3x2i3Ur4vrH4hk1swHcu+/WQ47fg613bjO/H3Tv4zyXOuT34bpi6DNjob/NvfD1/xXnxkHPgrBLaFnYvsBz41X8enAy0KK6xc+4b4Hl8w1OWA9P9h3IKNfsE/+Vh59zeI8whR8j8A/5EpARmFgKsB650zn1f6PU3gI3Oub96Fk5EgoqZ/Ruo5ZwbctjGAcTfu7cAiCw8RMXMVgDXlzBOWY6RetJEiuG/RFvNfDOV/wXf+JJfCx1viG/A8eueBBSRoOCfB629+XTFNzVGUFwaNN/8cRH+aTz+DXxxSIF2Mb6rCd95lbEiU5EmUrwewAp8A27Px3dH634AM3sY3y/KJ51zq7yLKCJBIBbfuLS9+MZ5PQ185mmiI3c9vqEqK/CN87vx4AEz+wHfzQI3+8e8SSnT5U4RERGRAKSeNBEREZEAVCHnSatRo4Zr2LCh1zFEpAzMmjVrm3Ou0q2RqvOaSMVV3HmtQhZpDRs2JC0t7fANRSTo+CcgrXR0XhOpuIo7r+lyp4iIiEgAUpEmIiIiEoBUpImIiIgEIBVpIiIiIgFIRZqIiIhIAFKRJiIiIhKAVKSJiIiIBCAVaSIiIiIBqEJOZnuknpqwlNyCAmIjw4iJDCOuSjjJcVHUio+idnwU0RGV+h+PiIiIHIXM7Fy+X7KV31bt4NH+bTGz4/q8Sl2FfL1gE+t37udAXkGRx2vERNA8OZbmybG0qBVLx5RqtEiOJSTk+P6hi4iISMWwY+8BJi7czLcLNzN1+TZy8x1JsZHcenozasVHHddnV+oi7bs7ewKQk5fP3px8du/PZUtmNpt3Z7Nx937WbNvH0i17eD9tHfsO5AMQFxVGasNEujVKpHermjRJijnuSllERESCx+59uUxYtJkv521i6vJt5Bc4UhKrcPWJDTmrbS1OSEkolQ4dT4o0MxsA/ANoBXR1zhW5IJ2ZnQU8B4QCo5xzj5dFnsiwUCLDQkmsGkGjGlX/53hBgWPdzn2krd7JzNU7mLF6B98t2cq/vllCw+rR9GmVzNntatOpfjUVbCIiIhVQZnYukxdt4ct5m/h5WQa5+b7CbPipjTm3XW3a1Ikr9RrAq560BcBFwIjiGphZKPAS0BdYD8w0s8+dc4vKJ+L/CwkxGlSvSoPqVbm4cz0ANu7az5QlW5m8aAtjp69h1C+raFSjKhedUJcLO9WlXkJ0eccUERGRUrQ3J4/Ji32F2Y/pGRzIK6ButSpcc1Ijzm1Xm/b14su0c8aTIs05txg43B+sK7DcObfS3/ZdoB9Q7kVaUepUq8Lg7g0Y3L0Be7Jz+WbBZj6atZ6nJ6XzzOR0eresyTUnNeLEJtXVuyYiIhIk8gsc01Zs45PZG/h24Wb2HcinVlwUg7o14Nz2tTkhpVq5jU0P5DFpdYF1hfbXA92Ka2xmw4HhAPXr1y/bZIeIjQpnYGoKA1NTWLdjHx+krWP8b2uZvPg3WiTHct3JjbiwU13CQzXjiYiISCBasjmTT2Zv4NM5G9iSmUNsVBj9Otahf8e6dGmY6MlNg2VWpJnZZKBWEYcecM59diQfUcRrrrjGzrmRwEiA1NTUYtuVtZTEaO44owU39WrKF3M38sbU1dzz0Tye/24Zfzq9KRd1qqdiTUREJABszczmszkb+fj3DSzelElYiNGzRRIPnl+P01vWJCo81NN8ZVakOef6HOdHrAdSCu3XAzYe52eWm6jwUAakpnBJ53r8sDSD/0xO596P5vPCd8u5rXczLu5UT1N5iIiIlLO8/AK+X5rBuzPW8v3SrRQ46FAvnn+c35rzO9Shekyk1xH/K5Avd84EmplZI2ADcBlwhbeRjp6Z0atlTXq2SOKHpRk8Ozmduz+cx5vTVvPXc1vTo0l1ryOKiIhUeGu27+X9tHV8kLaerXtySIqN5PrTmnBxp3o0rRnjdbwieTUFx4XAC0AS8JWZzXHOnWlmdfBNtXGOcy7PzG4BJuCbguMN59xCL/KWhsLF2udzN/LEt0u5/LVfOaN1Mvef06rIqT9ERETk2OXk5TNh4Rbem7mWqcu3E2LQs0VNLuuSQq+WNQN++JE559nwrTKTmprq0tKKnHotYGTn5vP6L6t4+fvl5OY7bu7VlBt6NiYyzNvr3yKBzsxmOedSvc5R3oLhvCYSKNZs38u46Wv4cPZ6du3LpW61KlzaJYUBqfWoHV/F63j/o7jzWiBf7qzQosJDublXUwZ0rsdDXy7i2cnpfDFvI49d2I6ujRK9jiciIhJUCgocPy7LYOy01fyQnkGoGWe0SeayLvU5uWmNoBwHriLNYzXjonjxik5c3Gkrf/10AQNHTOfyrin85ZxWxEaFex1PREQkoO3el8sHs9Yx7tc1rNm+77/rZl7RrT7Jcce3dqbXVKQFiF4tazLpjlP5z+RljPp5JT+lb+OpAR10Y4GIiEgRlm7ew5vTVvPp7xvYn5tPaoME7jyjBWe1qUVEWGCPNTtSKtICSHREGH85pxVnta3FHe/N4fLXfuW6kxtx95ktPJ+rRUQOz8wSgfeAhsBqYKBzbuchbRoAH+O7ISoceME592r5JhUJTs45pq3YzsifVvJjegZR4SH071iXwT0a0KZOvNfxSp2KtADUqX4CX992Cv/6egmv/7KKn9IzePbSjrStW/H+AopUMPcBU5xzj5vZff79ew9pswk40TmXY2YxwAL/usRBMw+kSHnLzS/gy3kbee2nVSzalEmNmEjuOqM5V3ZrQELVCK/jlRkVaQEqOiKMh/u3pU/rZO75cC4XvTyNv57XisHdG2gtUJHA1Q/o6X8+BviBQ4o059yBQruRQMW4LiNSBjKzc3l3xlpGT13Npt3ZNK0ZwxMXt+eCjnUqxRUmFWkB7rTmSXxz26nc+f4c/v7ZQqav2M7jF7cnvopuKhAJQMnOuU0AzrlNZlazqEZmlgJ8BTQF7i6uF83LNYlFvLQtK4fXf1nFW9PXsCcnjx6Nq/PYhe04rXlSUN6leaxUpAWBxKoRvD6kC6/9vJInJyxlwcafefHyTnRIqeZ1NJFKp6R1iY/0M5xz64D2/gm8PzWzD51zW4poFxBrEouUly2Z2Yz4cSVvz1hDTl4B57SrzY2nNam0w31UpAWJkBDj+tOakNowkVvf+Z1LXp3G389rzSBd/hQpVyWtS2xmW8ystr8XrTaw9TCftdHMFgKnAB+WclSRoLFuxz5e/XEFH6StJ985+nesy029mtAkKTCXayovKtKCTOcGCXx168nc/t4c/vbZQuZv2M1D/dpWimvzIkHgc2AI8Lj/8bNDG5hZPWC7c26/mSUAJwHPlGtKkQCxZvteXvhuOZ/+vgEzuKRzCjf1bEJKYrTX0QKCirQgVC3ad/nz2cnpvPDdcpZuyWLEoM7Uig/uSftEKoDHgffN7DpgLTAAwMxSgRucc0OBVsDTZuYAA55yzs33KrCIFzbu2s8L3y3j/bT1hIUYg7o34PrTGgfkkk1eUpEWpEJCjDvPaEGbOnHc+f5cznvhF14Z1IkuDbWklIhXnHPbgd5FvJ4GDPU/nwS0L+doIgEhY08OL/+wnPG/rcU5x5Xd6nNLr6bUDPKVAcqKirQgd1bb2jRJimH4uFlcPvJXHurXliu66S4wEREJHLv35TLipxWMnrqaA/kFXNypLrf2bka9BF3WLImKtAqgWXIsn958Ere+8zt/+WQ+q7Zlcd/ZrQitRLcpi4hI4MnOzWf01NW8/MNy9mTncX6HOtzepxmNK/kNAUdKRVoFEV8lnNeHpPLwl4t47edVrN6+j+cu60h0hP4Vi4hI+SoocHw+dyNPTljKhl376d2yJned2YJWteO8jhZU9H/wCiQsNIR/9mtLoxpVeejLRQx4dTqvD+miGwpERKTc/LpyO49+tZj5G3bTtm4cTw3oQI8m1b2OFZRUpFVAV5/UiPrVo/nT27/T/6WpjBqSWmknAhQRkfKxIiOLf329hMmLt1AnPopnL+1Avw51K9UKAaVNa8ZVUKe3TOaDG07EDAaOmM73S0ucU1NEROSYZGbn8vCXizjj2Z/4deV27jmrBd/d1ZMLT6inAu04qUirwFrXieOzm0+iYfWqDBuTxkez1nsdSUREKoiCAsdHs9Zz+lM/8sbUVQxMTeGHu3tyU8+mmmC9lOhyZwVXMy6K967vzg1vzeLOD+aSkZXD9ac21lJSIiJyzBZs2M2Dny9k1pqddEypxuiru9CunobVlDYVaZVAbFQ4b1zdhbs+mMfj3yxhS2Y2fzu3tbqhRUTkqOzad4CnJi5l/G9rSYyO4IlL2nNJJ13WLCsq0iqJyLBQnru0I0kxkbwxdRUZe3J4emAHIsPUJS0iIiVzzvHZnI089OUidu07wJAeDbm9b3Piq4R7Ha1CU5FWiYSEGH87rxXJcZH865sl7Nh7gBGDOxMbpf/IRESkaOt27OOBTxfwU3oGHVKq8dZ13WhdR/OdlQcVaZWMmXH9aU1Iio3kng/nMWjUb7x5TVcSqkZ4HU1ERAJIXn4Bo6eu5plJ6YQY/OP81gzu0VCr2ZQjFWmV1EWd6hEXFc5Nb8/mspG/Mu66rlrgVkREAN+NAfd9PI8FGzLp06omD/VrS51qVbyOVeloCo5KrE/rZEZf3YV1O/cxcMR01u/c53UkERHx0IG8Ap6euJR+L01lS2YOL1/ZideuSlWB5hEVaZXcSU1rMO66buzYe4ABr05nZUaW15FERMQDizdl0u+lqbzw3XL6d6zL5NtP45x2tTVlk4dUpAmdGyTwzvDuHMgrYOCI6SzamOl1JBERKSd5+QW89P1yLnjxFzL25PDaVak8PbAD8dG6qcxrKtIEgDZ14nn/hh6Eh4Zw2cjpzF670+tIIiJSxpZvzeLiV6fz5ISlnNmmFhNvP5W+rZO9jiV+KtLkv5okxfDBDT1IqBrBoFG/8dvK7V5HEhGRMuCcY+z01Zz7/M+s2b6XFy4/gRev6ESi7vQPKCrS5A/qJUTzwfU9qB0fxdWjZzJ9hQo1EZGKZMfeAwwbO4u/f7aQ7o2rM/H2Uzm/Qx2vY0kRVKTJ/6gZF8W7w3tQL6EK17w5g6nLt3kdSURESsG0Fds4+7mf+Ck9g7+d15rRV3ehZqymXwpUnhRpZjbAzBaaWYGZpZbQbrWZzTezOWaWVp4ZK7uk2EjeGd6dBolVufbNmfyUnuF1JBEROUa5+QU8OWEJV476jaqRYXx804lcd3IjrbkZ4LzqSVsAXAT8dARteznnOjrnii3mpGzUiPEVao1qVGXo2DR+WLrV60giInKUNuzaz8AR03np+xUM7JzCl386mbZ1472OJUfAkyLNObfYObfUi++Wo5NYNYJ3hnWnaVIMw8fO4vslKtRERILFj+kZnPf8zyzfksWLV5zAvy9pT3SEFhsKFoE+Js0BE81slpkNL6mhmQ03szQzS8vI0KW50pRQNYK3h3WjRa1Yrh83i8mLtngdSSQgmVmimU0ys2X+x4QS2saZ2QYze7E8M0rlUFDg+M/kdK4ePYPkuCg+/9PJnNdeNwcEmzIr0sxsspktKGLrdxQfc5JzrhNwNnCzmZ1aXEPn3EjnXKpzLjUpKem488sfVYuO4K3rutGqdiw3jp/FJBVqIkW5D5jinGsGTPHvF+dh4MdySSWVyo69B7j6zZn8Z/IyLjyhLp/cdBKNalT1OpYcgzIr0pxzfZxzbYvYPjuKz9jof9wKfAJ0Lau8cnjx0eGMva4brevEc9N4XfoUKUI/YIz/+Rigf1GNzKwzkAxMLKdcUknMXbeL81/4hV9XbOexC9vx9IAOVIkI9TqWHKOAvdxpZlXNLPbgc+AMfDcciIfiq4Qz9tquvkufb83i52W6tCxSSLJzbhOA/7HmoQ3MLAR4Grj7cB+mYRxyND75fT0DRkwH4MMbe3BFt/padzPIeTUFx4Vmth7oAXxlZhP8r9cxs6/9zZKBX8xsLjAD+Mo5960XeeWP4quEM+7abjSuUZWhY9I04a1UKqUwlOMm4Gvn3LrDNdQwDjkS+QWOf329mNvfm0un+tX48k8n075eNa9jSSnw5BYP59wn+C5fHvr6RuAc//OVQIdyjiZHKKFqBOOHduOykb9y3ZiZjLm2K10aJnodS6TMOef6FHfMzLaYWW3n3CYzqw0UNSagB3CKmd0ExAARZpblnCtp/JpIkTKzc7ntnd/5fmkGg7rX58Hz2xAeGrAXyeQo6d+kHLPqMZGMH9aNWnFRXDN6Jr9rUXaRz4Eh/udDgP8Zg+ucu9I5V9851xC4CxirAk2Oxepte7no5Wn8vGwbD/dvyyP926lAq2D0b1OOS83YKN4e1p3qMRFc9cYM5q/f7XUkES89DvQ1s2VAX/8+ZpZqZqM8TSYVyvQV2+n30lS2ZeUw9rquDO7ewOtIUgZUpMlxqxXvK9Tiq4Qz6PXfWLQx0+tIIp5wzm13zvV2zjXzP+7wv57mnBtaRPs3nXO3lH9SCWaf/r6Bq974jaTYSD6/+WRObFLD60hSRlSkSamoW60K7wzrTnREKINe/42lm/d4HUlEpEJxzvHS98v583tz6NwggY9uOJH61aO9jiVlSEWalJqUxGjeGdadsBDjylG/sWrbXq8jiYhUCHn5Bfzlk/k8OWEp/TrWYcy1XYmPDvc6lpQxFWlSqhrWqMrbw7pR4ByDRv3Ghl37vY4kIhLU9ubkMXRsGu/MWMfNvZrwn0s7EhmmCWorAxVpUuqa1oxl7LVdyczOZfCo38jYk+N1JBGRoLQ9K4fLRv7Kz8u28diF7bj7zJaaoLYSUZEmZaJt3XhGX92FTbuzGfz6b+zel+t1JBGRoLJx134GjphO+pY9jBzcmSu61fc6kpQzFWlSZlIbJjJicGdWZuzl6jdnsDcnz+tIIiJBYWVGFgNenc7WzBzGXdeN3q2SvY4kHlCRJmXq1OZJPH/5Ccxbv5vh49LIzs33OpKISEBbuHE3A0dMJzs3n3eGd6drI63mUlmpSJMyd1bbWjxxcXumLt/OLW//Tm5+gdeRREQC0szVO7hsxK9EhIbwwQ09aFs33utI4iEVaVIuLu5cj4f6tWHy4i3c9cFcCgqc15FERALKtOXbGPz6byTFRfLhjSfSOCnG60jiMU8WWJfK6aoeDdmTnceTE5YSExnGI/3b6i4lERHgl2XbuG7MTBpWr8r4Yd2oERPpdSQJACrSpFzd3KspWTl5vPLDCmIiw7jvbN1OLiKV20/pGQwbm0ajGlUZP7Qb1VWgiZ+KNCl395zZgqzsPEb8tJJq0RHc2LOJ15FERDzxw9KtDB83iyZJMYwf2o3EqhFeR5IAoiJNyp2Z8c8L2rB7fy7//nYJiVXDubSL5v8Rkcrl+yVbuX7cLJrW9BVoCSrQ5BAq0sQTISHGUwM6sGt/Lvd/PJ9q0RGc2aaW17FERMrFT+kZXD9uFs1rxfDWdd2oFq0CTf6X7u4Uz0SEhfDqoE60r1eNP73zO7+u3O51JBGRMjdj1Q6Gj0ujSc0Yxl/XXQWaFEtFmngqOiKM0Vd3oX5iNMPGpLFw426vI4mIlJl563dx7ZszqVutCuOu60p8dLjXkSSAqUgTzyVUjWDstV2JjQpjyBszWbN9r9eRRERK3dLNe7jqjRlUiw7nraGaZkMOT0WaBIQ61aow9rpu5BcUMPj1GWzNzPY6kohIqVm1bS9XjvqNyLAQ3h7andrxVbyOJEFARZoEjKY1Yxh9TVe2ZeUwZPRMdu/P9TqSiMhx27R7P4NG/UaBc4wf2o361aO9jiRBQkWaBJSOKdUYMbgzy7fuYdhYLcguIsFt9/5crn7D96Nz7LVdaVoz1utIEkRUpEnAOaVZEs8M7MjM1Tu45e3fydOC7CIShLJz8xk2No2V27IYObizFkuXo6YiTQLS+R3q8M8LfAuy3//xfJzTguwiEjzyCxy3vzeHGat28PTAjpzYtIbXkSQIaTJbCVhX9WjI9qwDPDdlGTViI7n3rJZeRxIplpklAu8BDYHVwEDn3M4i2uUD8/27a51zF5RXRikfzjke+mIh3yzYzF/PbcUFHep4HUmClHrSJKD9uU8zruxWn1d+WMGYaau9jiNSkvuAKc65ZsAU/35R9jvnOvo3FWgV0Cs/rmDM9DUMO6URQ09p7HUcCWIq0iSgmRkP9WtL39bJ/OOLhXwzf5PXkUSK0w8Y438+BujvYRbxyOdzN/LEt0u5oEMd7j+7lddxJMipSJOAFxpivHD5CXSqn8Bt/jEeIgEo2Tm3CcD/WLOYdlFmlmZmv5pZiYWcmQ33t03LyMgo7bxSyn5fu5O7PphLl4YJPDmgPSEh5nUkCXIq0iQoRIWHMuqqVFISqjB0zEzSt+zxOpJUQmY22cwWFLH1O4qPqe+cSwWuAP5jZk2Ka+icG+mcS3XOpSYlJR13fik7G3btZ9jYWdSKi2LE4FQiw0K9jiQVgIo0CRoJVSMYc21XosJDGfLGDDbt3u91JKlknHN9nHNti9g+A7aYWW0A/+PWYj5jo/9xJfADcEI5xZcykpWTx3VvziQnN5/Xh6SSWFULpkvpUJEmQaVeQjSjr+nCnka1BikAACAASURBVOy8/04QKRIgPgeG+J8PAT47tIGZJZhZpP95DeAkYFG5JZRSl1/guO2d31m2NYsXr+xEs2RNViulR0WaBJ02deIZMbgzK7dlMXxsGjl5WpVAAsLjQF8zWwb09e9jZqlmNsrfphWQZmZzge+Bx51zKtKC2L++XsyUJVv5x/mtOa25LklL6fKkSDOzJ81siZnNM7NPzKxaMe3OMrOlZrbczIq7nV0qoZOa1uCpAR34bdUO7nh/LgUFmuxWvOWc2+6c6+2ca+Z/3OF/Pc05N9T/fJpzrp1zroP/8XVvU8vx+Hj2ekb9soohPRowuEdDr+NIBeRVT9okoK1zrj2QDtx/aAMzCwVeAs4GWgOXm1nrck0pAa1fx7o8cE4rvpq3iYe/WqRVCUSk3CzYsJv7P55P98aJ/PU8/a9JyoYnKw445yYW2v0VuKSIZl2B5f7BtZjZu/jmIdKlAfmvoac0YtPubN6Yuora8VEMP7XYG+VERErFjr0HuH7cLBKrRvDiFZ0ID9XIISkbgfA361rgmyJerwusK7S/3v9akTSfUOVkZvz13Fac2742j329hM/mbPA6kohUYHn5Bdz6zu9kZOXw6qDO1IiJ9DqSVGBl1pNmZpOBWkUcesB/uzpm9gCQB4wv6iOKeK3Y61nOuZHASIDU1FRd96pEQkKMZwZ2YHtWDnd9MJcaMZGcpMWMRaQMPDlxKb8s38YTF7enQ0qRw6lFSk2Z9aQdZj4hzGwIcB5wpSt6MNF6IKXQfj1gY1nlleAWGRbKiMGpNEmK4fpxs1i0MdPrSCJSwXw5byMjflzJld3qM7BLyuHfIHKcvLq78yzgXuAC59y+YprNBJqZWSMziwAuwzcPkUiR4quE8+Y1XYmNCuPaN2dqslsRKTXLt2Zxz4fz6FS/Gg+e38brOFJJeDUm7UUgFphkZnPM7FUAM6tjZl8DOOfygFuACcBi4H3n3EKP8kqQqBUfxehrurA3J49rRs8kM1uT3YrI8cnOzeeWt2cTFR7Ky1d2JiIsEIZzS2Xgyd8051xT51yKc66jf7vB//pG59w5hdp97Zxr7pxr4px71IusEnxa1orjlUGdWb41i5vemk1ufoHXkUQkiP3zi4Us2byHZwZ2oFZ8lNdxpBLRzwGpkE5uVoPHL27PL8u3cf/H8zWHmogck8/mbOCdGeu4qWcTerao6XUcqWQ8mSdNpDxc0rke63bs47kpy0hJiOa2Ps28jiQiQWRFRhZ/+Xg+XRomcEff5l7HkUpIRZpUaH/u04z1O/fz7OR06iZU4ZLO9byOJCJBIDs3n5vHzyYiLITnLz+BME1YKx5QkSYVmpnxr4vasTlzP/d9NI/a8VGaQ01EDuvhLxexZPMeRl/ThdrxVbyOI5WUfhpIhRcRFsIrgzrTJCmGG8bNYunmPV5HEpEANnHhZsb/tpbrT21ML41DEw+pSJNKIS4qnNHXdCE6MpRrRs9gS2a215FEJABt3ZPNfR/Pp02dOO48o4XXcaSS0+VOqTTqVKvCG1d3YeCr07lm9Ezev6EHMZH6T6AyMbO/l3DYOeceLrcwEnCcc9z9wTz25uTx3GUdNR+aeK7Yv4FmtsrMVhbaCu+vKM+QIqWlTZ14XrqyE0u37OHm8ZpDrRLaW8TmgOvwrYIildiYaav5MT2Dv57biqY1Y72OI1Li5c5UoEuhrSvwNL6Fz+eUfTSRstGzRU0e7d+WH9Mz+NunCzSHWiXinHv64AaMBKoA1wLvAo09DSeeSt+yh8e+WUKvFkkM6t7A6zgiQAmXO51z2wHMLAQYDNyNrzg71zm3qHziiZSNy7rWZ93Ofbz0/QpSEqO5uVdTryNJOTGzROAO4EpgDNDJObfT21TipZy8fG5953diI8N44pIOmJnXkUSAEoo0MwvH9wvzduAXoJ9zTpc5pcK464wWrN+5nycnLKVeQhX6dazrdSQpY2b2JHARvl60ds65LI8jSQB4ZlI6Szbv4fUhqSTFRnodR+S/Sho1vQrIA/4DrAU6mFmHgwedcx+XcTaRMmVmPHFJe7ZkZnP3B/NIjouie+PqXseSsnUnkAP8FXigUI+J4btxIM6rYOKN2Wt38tpPK7msSwq9WyV7HUfkD0oakzYZ+B7oAJx/yHZe2UcTKXuRYaGMGJRK/erRDB+bxvKt6lipyJxzIc65Ks65WOdcXKEtVgVa5ZOdm8/dH8ylVlwUD5zbyus4Iv+jpDFpV5djDhHPxEeHM/rqLvR/aSrXvjmTT246keoxuuQhUtE9MymdFRl7GXttV2Kjwr2OI/I/NAmMCJCSGM1rQ1LZkpnN8HGzyM7N9zqSBBkzSzSzSWa2zP+YUEy7+mY20cwWm9kiM2tYvkkFYNaanbz280ou71qfU5sneR1HpEgq0kT8OtVP4JmBHZm1Zif3fDhPU3PI0boPmOKcawZM8e8XZSzwpHOuFb6pjbaWUz7xO3iZs058Ff5yTkuv44gUq6TJbGuXZxCRQHBu+9rcc1YLPp+7kWcnpXsdR0qZmU0ws9vNrCz+z9wP35Qe+B/7F/H9rYEw59wkAOdclnNuXxlkkRI8PXEpK7ft5d8Xt9dlTgloJfWkvWFmv5rZ42bW08y0fo5UCjee1oRLU1N4/rvlfDRrvddxpHQNAXYC/zCz2Wb2ipn1M7OYUvjsZOfcJgD/Y1ErczcHdpnZx2b2u5k9aWahxX2gmQ03szQzS8vIyCiFiDJ77U5G/bKKK7rV5+RmNbyOI1Kikm4cONvMooCewIXAU2a2FvgW+NY5t7Z8IoqULzPjkQvbsm7nPu77eB51qlWhRxNNzVEROOc2A28Cb/on6u4GnA3cY2b7gYnOuSeKe7+ZTQZqFXHogSOMEAacApyAb2qj94CrgdeLyTsS35xupKam6vr7ccrNL+D+j+ZTKy6K+8/WZU4JfCWOSXPOZTvnvnXO3eacS8U3x1AY8KKZzSiXhCIeCA8N4ZUrO1M/MZob3prFigxNzVHROOcKnHPTnXN/d86dBFwGbDjMe/o459oWsX0GbDk4TMT/WNRYs/XA7865lc65POBToFPp/smkOK/9vJKlW/bwUL+2uswpQeGobhxwzq1yzr3snLsAOLmMMokEBN/UHF0JCzGufXMmO/Ye8DqSlCHn3Dbn3Pjj+IjP8V1Oxf/4WRFtZgIJZnbwdsLTAS2zVw5Wb9vLc5OXcXbbWvRtrUlrJTgc892dzjn9H0sqvPrVoxl5VSqbdmdz/bg0cvI0NYcU63Ggr5ktA/r69zGzVDMbBeCcywfuAqaY2Xx8Kx285lHeSsM5xwOfziciNIR/XNDG6zgiR0xTcIgcRucGCTw9oAMzV2tqDimec267c663c66Z/3GH//U059zQQu0mOefaO+faOeeu1g/esvfx7A1MXb6de85uSXJclNdxRI5YSQus19fNASI+53eow5rte3lqYjoNq1fl9r7NvY4kx8DM7jjkJQdsA35xzq3yIJKUsR17D/DIV4vo3CCBK7vW9zqOyFEpqSft04NPzOyjcsgiEtBu7tWUizvV47kpy/jkd03NEaRiD9nigFTgGzO7zMtgUjYe+WoRWTl5/OuidoSEmNdxRI5KSXOfFf7b3Lisg4gEOjPjXxe1Y8Oufdz74XzqVouma6NEr2PJUXDO/bOo180sEZgMvFu+iaQsTVuxjY9nb+BPpzeleXKs13FEjlpJPWmumOcilVZEWAivDupMvYQqDB+Xxqpte72OJKXAP35M3SwVSG5+AX//bCEpiVW4uVdTr+OIHJOSirQOZpZpZnuA9v7nmWa2x8wyyyugSKCpFh3B6Gu6EGLGNaNnsFNTcwQ9Mzsd30oEUkGMnrqK5VuzePC8NkSFF7uog0hAK7ZIc86FOufinHOxzrkw//OD+3HlGVIk0DSoXpWRgzuzcVc214+bpak5goSZzTezeYds6/FNl3GT1/mkdGzJzOa5ycvo3bImfTQnmgQxrccpcoxSGyby5ID23PbuHO77aD7PDOyAma6YBbjzDtl3wHbnnK5bVyCPfrWY3ALHg+drTjQJbirSRI5Dv451WbN9H89MSqdRjarc2ruZ15GkBM65NV5nkLI1bcU2Pp+7kVt7N6N+9Wiv44gcFxVpIsfpT6c3ZfW2vTwzKZ3GSVU5r30dryOJVEq5+QU8+NlC6iVU4aaeTbyOI3LcPCnSzOxJ4HzgALACuMY5t6uIdquBPUA+kOdf5F0koJgZ/7q4HWt37OPO9+dSLyGajinVvI4lUum8OXU1y7Zm8dpVqbpZQCoEr5aFmgS0dc61B9KB+0to28s511EFmgSyyLBQRgzuTFJsJMPGprFx136vI4lUKlszs/nP5HR6tUiiT6uaXscRKRWeFGnOuYnOuTz/7q9APS9yiJSm6jGRvHF1F/YfyOe6MWnszck7/JtEpFQ8OWEpB/IL+Pv5bXQDj1QYgbDA+rXAN8Ucc8BEM5tlZsNL+hAzG25maWaWlpGRUeohRY5E8+RYXrziBJZuzuS2d+eQX6B5oEXK2oINu/lw9nquOakRjWpU9TqOSKkpsyLNzCab2YIitn6F2jwA5AHji/mYk5xznYCzgZvN7NTivs85N9I5l+qcS01KSirVP4vI0ejZoiZ/P681kxdv4Ylvl3gdR6RCc87x0JeLSIiO4JbTtbKAVCxlduOAc65PScfNbAi+OYt6O+eK7G5wzm30P241s0+ArsBPpZ1VpLQNObEhyzOyGPHTSpokxTCwS4rXkUQqpAkLNzNj1Q4e6d+WuKhwr+OIlCpPLnea2VnAvcAFzrl9xbSpamaxB58DZwALyi+lyLEzMx48vw2nNKvBXz6Zz68rt3sdSaTCycnL57Gvl9A8OYbL9ENIKiCvxqS9CMQCk8xsjpm9CmBmdczsa3+bZOAXM5sLzAC+cs59601ckaMXHhrCi1d0okH1aG54axartRi7SKl6c+pq1u7Yx9/Oa01YaCAMsRYpXV7d3dnUOZfin1qjo3PuBv/rG51z5/ifr3TOdfBvbZxzj3qRVeR4xFcJ542ru2DAtWNmsntfrteRRCqEbVk5vPDdcnq3rMkpzTQOWSom/fQQKWMNqlfl1UGdWbdjHze/PZvc/AKvI4kEvWcmpZOdm89fzm3ldRSRMqMiTaQcdGtcnccubMcvy7fx4OcLKeZeGRE5Aks2Z/LujLUM7tGAJkkxXscRKTNau1OknAxITWFFxl5e/XEFTZNiuPbkRl5HEglKj3+zhJjIMG7r3czrKCJlSj1pIuXonjNbcEbrZB75ahHfL9nqdRyRoDNtxTZ+WJrBzb2aUi06wus4ImVKRZpIOQoJMf5zWUda1Y7jT+/8ztLNe7yOJBI0nHM8/s0S6sRHMeTEhl7HESlzKtJEyll0RBijhqQSHRHKtW/OZFtWjteRpBSYWaKZTTKzZf7HhCLa9PJPO3Rwyzaz/l7kDUZfzd/EvPW7ueOMFkSFh3odR6TMqUgT8UDt+CqMGpLK9r05DB+bRnZuvteR5PjdB0xxzjUDpvj3/8A59/3BqYeA04F9wMTyjRmcDuQV8OSEpbSsFcuFJ9T1Oo5IuVCRJuKR9vWq8czAjsxeu4v7PpqnOz6DXz9gjP/5GOBwPWSXAN8Ut+qK/NE7M9ayZvs+7j2rJaEh5nUckXKhIk3EQ+e0q81dZzTn0zkbefG75V7HkeOT7JzbBOB/rHmY9pcB75TUwMyGm1mamaVlZGSUUszgsyc7l+enLKN740R6ttDEtVJ5aAoOEY/d3KspKzL28vSkdBonxXBu+9peR5JimNlkoFYRhx44ys+pDbQDJpTUzjk3EhgJkJqaWmm7Wl/7eRXb9x7gjbNbYaZeNKk8VKSJeMzMePzidqzdsY873p9DvYQqdEip5nUsKYJzrk9xx8xsi5nVds5t8hdhJc2xMhD4xDmndcIOY+uebEb9vJJz29XWfxdS6ehyp0gAiAwLZcTgziTFRjJsbBqbd2d7HUmO3ufAEP/zIcBnJbS9nMNc6hSf5yYv40BeAXef2cLrKCLlTkWaSICoERPJqCGp7M3JY/i4NPYf0B2fQeZxoK+ZLQP6+vcxs1QzG3WwkZk1BFKAHz3IGFRWb9vLuzPXcXnX+jSsUdXrOCLlTkWaSABpWSuO5y47gfkbdnP3h3N1x2cQcc5td871ds418z/u8L+e5pwbWqjdaudcXedcgXdpg8PzU5YRHmr86fSmXkcR8YSKNJEA06d1Mvee1ZIv523iBd3xKZXU8q17+HTOBq7q0ZCacVFexxHxhG4cEAlA15/amPQte3hmUjrNasZwdjvd8SmVy7OTlxEVHsr1pzb2OoqIZ9STJhKAzIzHLmxHp/rVuP39OSzYsNvrSCLlZvGmTL6at4lrT2pE9ZhIr+OIeEZFmkiAigoPZcTgVBKjIxg2No2tmbrjUyqHZyelExsVxrBT1IsmlZuKNJEAlhQbyWtDUtm1L5fh42ZpjU+p8Oat38XERVsYenJj4qPDvY4j4ikVaSIBrk2deJ69tANz1mmNT6n4npmUTrXocK49uaHXUUQ8pyJNJAic1fb/1/h85ccVXscRKROz1uzgh6UZXH9qE2Kj1Ismors7RYLEzb2akr4liycnLKVpUgxntClqCUmR4PX0xHRqxEQw5MQGXkcRCQjqSRMJEmbGE5e0p33deP783hwWb8r0OpJIqZm+YjvTVmznxp5NiY5Q/4EIqEgTCSpR4aGMvCqVuKhwho5JY1tWjteRRI6bc45nJi0lOS6SK7vV9zqOSMBQkSYSZJLjonjtqlS2783hhnGzyMnTHZ8S3H5ato2Zq3dyS6+mRIWHeh1HJGCoSBMJQu3qxfPUgA6krdnJA58s0B2fErScczwzcSl1q1VhYJcUr+OIBBQVaSJB6rz2dbitdzM+nLWeUT+v8jqOyDGZsngrc9fv5tbeTYkMUy+aSGEanSkSxG7r3YxlW/fw2DeLaVKzKqe3TPY6ksgRKyhwPD0pnYbVo7moUz2v44gEHPWkiQSxkBDj6QEdaVMnjlvfmUP6lj1eRxI5Yt8u3MziTZnc1qcZ4aH635HIofRfhUiQqxIRymtXpVIlIpTrxsxkx94DXkcSOaz8Asezk9JpWjOGCzrU9TqOSEBSkSZSAdSOr8LIwZ3ZkpnDjW/N4kBegdeRREr0xdyNLNuaxe19mhMaYl7HEQlIKtJEKogT6ifw5CXt+W3VDh78XHd8SuDKyy/guSnLaFkrlrPbauUMkeKoSBOpQPp1rMvNvZrwzox1vDlttddxRIr08e8bWLVtL3f0bU6IetFEiuVZkWZmD5vZPDObY2YTzaxOMe2GmNky/zakvHOKBJs7+7bgjNbJPPzlIn5Mz/A6jsgfHMgr4LnJy2hfL56+rXU3skhJvOxJe9I519451xH4Evj7oQ3MLBF4EOgGdAUeNLOE8o0pElxCQoxnL+1I8+RYbnl7Nsu3ZnkdSeS/3k9bx4Zd+7mjb3PM1IsmUhLPijTnXOHVoasCRQ2gOROY5Jzb4ZzbCUwCziqPfCLBrGpkGKOGpBIZFsLQMTPZtU93fIr3snPzefG75XRukMBpzZO8jiMS8Dwdk2Zmj5rZOuBKiuhJA+oC6wrtr/e/VtRnDTezNDNLy8jQJR6RegnRjBjcmY27srlp/Gxy83XHZ1kzs0Qzm+QfnjGpuJ5/M3vCzBaa2WIze94qSZfS27+tZXNmNneeoV40kSNRpkWamU02swVFbP0AnHMPOOdSgPHALUV9RBGvFXnLmnNupHMu1TmXmpSkX2giAJ0bJPLohW2ZtmI7j3612Os4lcF9wBTnXDNgin//D8zsROAkoD3QFugCnFaeIb2w/0A+L/+wgh6Nq3NikxpexxEJCmW6LJRzrs8RNn0b+Arf+LPC1gM9C+3XA3447mAilciA1BSWbt7DqF9W0aJWLJd3re91pIqsH/9/zhqD73x17yFtHBAFROD7IRoObCmfeN4ZO30127JyeHVQJ6+jiAQNL+/ubFZo9wJgSRHNJgBnmFmC/7LBGf7XROQo3Hd2S05tnsTfP1vAjFU7vI5TkSU75zYB+B9rHtrAOTcd+B7Y5N8mOOeK7OasKMM4snLyePXHFZzWPInUholexxEJGl6OSXvcf+lzHr7i6zYAM0s1s1EAzrkdwMPATP/2kP81ETkKYaEhvHD5CaQkRHPjW7NYv3Of15GC1uGGcRzB+5sCrfBdGagLnG5mpxbVtqIM4xj9yyp27svljr7NvY4iElTK9HJnSZxzFxfzehowtND+G8Ab5ZVLpKKKrxLOa0NS6f/iVIaNncVHN/YgOsKzU0DQKmkYh5ltMbPazrlNZlYb2FpEswuBX51zWf73fAN0B34qk8Ae270vl5E/r6Rv62Q6pFTzOo5IUNGKAyKVSJOkGJ6/4gSWbM7krg/maumo0vc5cHDS7SHAZ0W0WQucZmZhZhaO76aBCntXx8ifV5CVk6deNJFjoCJNpJLp1aIm95/dkq/nb+aF75Z7HaeieRzoa2bLgL7+/T8M4wA+BFYA84G5wFzn3BdehC1r27JyGD11Nee1r0Or2nFexxEJOrrWIVIJDTulMUs27eGZSek0T47lLC1yXSqcc9uB3kW8/t9hHM65fOD6co7miVd+WEF2bj5/7tPs8I1F5H+oJ02kEjIzHruoHR1SqnHH+3NYvCnz8G8SOQqbd2cz7tc1XNSpHk2SYryOIxKUVKSJVFJR4aGMHNyZ2Kgwho5JY3tWjteRpAJ58ftlOOe4rbd60USOlYo0kUosOS6KkYNTycjK4cbxszmQp6Wj5Pit27GPd2es49IuKaQkRnsdRyRoqUgTqeQ6pFTjiYvbM2PVDv75xUKv40gF8NyUZYSEGLf0Ui+ayPHQjQMiQv8T6rJk8x5e/XEFLWvHMbh7A68jSZBakZHFx7PXc81JjagVH+V1HJGgpp40EQHg7jNbcHrLmvzz84VMW7HN6zgSpJ6dlE5UeCg39mzidRSRoKciTUQACA0xnrusIw1rVOXm8bNZu11LR8nRmb9+N1/O28Q1JzWkRkyk13FEgp6KNBH5r9iocEZdlUqBg2Fj08jKyfM6kgQJ5xyPf7uYhOhwrj9NvWgipUFFmoj8QcMaVXnpik4sz8ji9vfmUFCgpaPk8H5ato2py7fzp9ObERcV7nUckQpBRZqI/I+Tm9Xgr+e2YtKiLTw7Od3rOBLgCgocj3+zhJTEKlzZvb7XcUQqDBVpIlKkq09syKWpKbzw3XK+mLvR6zgSwD6ds4HFmzK564wWRIaFeh1HpMJQkSYiRTIzHurfhtQGCdz94VwWbNjtdSQJQNm5+Tw9MZ12deM5v30dr+OIVCgq0kSkWJFhobwyqDOJ0REMG5tGxh4tHSV/NG76Gjbs2s99Z7ckJMS8jiNSoahIE5ESJcVGMvKqVHbuO8ANb80iJy/f60gSILZl5fD8d8s4rXkSJzWt4XUckQpHRZqIHFbbuvE8PaAjs9bs5K+fLMA53fEp8PTEdPYfyOdv57X2OopIhaQiTUSOyLnta3Pr6U35YNZ6Rk9d7XUc8diCDbt5d+ZahpzYkKY1Y7yOI1IhqUgTkSP25z7NOaN1Mo98tYif0jO8jiMecc7x0BeLSIyO4NbeWkRdpKyoSBORIxYSYjx7aUeaJ8dyy9uzWbVtr9eRxANfzd/EjNU7uOvMFsRX0cS1ImVFRZqIHJWqkWG8dlUqoSHG0DEzyczO9TqSlKOsnDwe/WoxrWvHMTA1xes4IhWaijQROWopidG8fGVn1mzfx23v/E6+lo6qNJ6euJTNmdk8cmFbQjXlhkiZUpEmIsekR5Pq/OOCNny/NIMnJizxOo6Ug7nrdvHmtNUM6taATvUTvI4jUuGFeR1ARILXoO4NWLI5kxE/rqRlrVguPKGe15GkjOTmF3Dfx/NJionk7rNaeB1HpFJQT5qIHJcHz29D98aJ3PvRfOau2+V1HCkjo35exeJNmfzzgjbERelmAZHyoCJNRI5LeGgIL13RiaSYSIaPS2NrZrbXkTxhZolmNsnMlvkfi7weaGb/NrMF/u3S8s55LBZvyuTZSemc2SaZs9rW8jqOSKWhIk1Ejlv1mEheuyqVzP15lXnpqPuAKc65ZsAU//4fmNm5QCegI9ANuNvM4so15VHKycvn9vfmEFclnMcubIeZbhYQKS8q0kSkVLSuE8fTAzswe+2uyrp0VD9gjP/5GKB/EW1aAz865/Kcc3uBucBZ5ZTvmDwzKZ0lm/fwxCXtqB4T6XUckUpFRZqIlJpz2v3/0lFvTlvtdZzyluyc2wTgf6xZRJu5wNlmFm1mNYBeQLGTjZnZcDNLM7O0jIzyX+Hhx/QMRv60ksu7pnB6y+Ry/36Ryk53d4pIqfpzn+Ys2rSHR75aTPPkWE5qWsPrSKXGzCYDRQ3KeuBI3u+cm2hmXYBpQAYwHcgrof1IYCRAampquXZNrt+5j9ve/Z0WybH8/bw25fnVIuKnnjQRKVW+paM60Pj/2Lvv+Crr8//jrysbCCOQsPeUITPiwFVFhbpbF+79betoq9/a9mdrrW2/tVq3tnXU1lG1jrpx74UCsmRvEsIIJJCQPa7fH+dgYwwkwMm5z0nez8fjPHLOfe77Pu8g3F7nc39GZjuueOJL1m0tDTpSxLj7ZHcf1cDjRWCTmfUACP/cvItz/MHdx7r7MYABy6P3GzRNRXUNV/zrS2pqnL+eO4E2KYlBRxJplVSkiUjEtU9L5qELsnGHyx6dxY6KXTYWtSQvAReEn18AvFh/BzNLNLMu4eejgdHAm1FL2AS1tc7PnpnPvNzt3Hr6GAZktgs6kkirFUiRZma/M7P5ZjbXzN40s5672K8mvM9cM3sp2jlFZO/169KOe88ex/LNxVz79FxqW/7SUTcDx5jZcuCY8GvMLNvMHgrvkwx8ZGaLCN3GPNfdY6qCveWNpbw0L4/rpgzTdBsiAQuqSgc/PAAAIABJREFUJe1Wdx/t7mOBV4AbdrFfWfi2wFh3PymK+UQkAg4bksX1x4/gjYWbuPvdmLurF1HuvtXdj3b3IeGfBeHts9z90vDzcncfEX4c5O5zg039TQ9/vJq/fbCScw/qyw+PGBR0HJFWL5CBA+5eVOdlO6DFf8UWaa0untSfRXlF3Pn2cvbr3p4po3oEHUka8NBHq/j9q4uZMrI7N544UvOhicSAwPqkmdkfzCwHOIddt6SlhYefzzCzhuYcqnu+QIeqi0jDzIw/nDqKsX06cc3T81iysajxgyRq3J17313O719dzNRR3bnn7HEkJaq7skgsaLZ/iWb2dp2lT+o+TgZw9+vdvQ/wL+DKXZymr7tnA2cDd5rZLtvf3f0Bd8929+ysrKyI/z4isvfSkhO5/7wJpKcmcdmjsygsqQw6khAaxXntM/P485vLOGVsT+6eNo5kFWgiMaPZ/jU2MlS9rieA7+/iHHnhn6uA94FxzZVXRJpXtw5p3H/eBDYVVXDFE19SVVMbdKRWbVX+Dk7/22f858v1XHPMUO44c6wKNJEYE9ToziF1Xp4ELGlgnwwzSw0/zwQmAYuik1BEmsO4vhn88dT9+XTlVv7w6uKg47RKVTW1PPzxao6/+2PWFZTyt3MncPXRQ9QHTSQGBbXiwM1mNgyoBdYCP4DQUHXgB+GRUMOB+82sllAxebO7q0gTiXPfn9CbRRuK+PvHqxnRowNnHLDLVZEkgiqra5m+YAN3v7ucVfklHDE0i1tOG023DmlBRxORXQhqdOeubm/OAnYOVf8U2D+auUQkOn45dT+WbSrmVy98xaCu6UzolxF0pBbF3SmrqiFvWznLNxXzycotvLFwE/nFFQzums7fL8jmqP26qvVMJMZp7U4RibqkxATumTaOk+/7hP95bDavXn2oWnQi5Kjb3ienoJSqmv/ObNQmOZHDhmRy9oF9OXxIFgkJKs5E4oGKNBEJRKe2KTx4fjaPfraGjm2Sg47TYnx3VA9q3OnYJpms9FSGdEtnaLf2pCVr/U2ReKMiTUQCM7Rbe35/ino1RNL/Hjcs6AgiEiEaby0iIiISg1SkiYiIiMQgFWkiIiIiMUhFmoiIiEgMUpEmIiIiEoNUpImIiIjEIBVpIiIiIjFIRZqIiIhIDFKRJiIiIhKDzN0b3yvOmFk+sLaJu2cCW5oxTnNQ5uhQ5ujZk9z93D2rOcPEIl3XYpIyR0c8ZoYIXNdaZJG2J8xslrtnB51jTyhzdChz9MRr7lgVj3+eyhwdyhw9kcit250iIiIiMUhFmoiIiEgMUpEGDwQdYC8oc3Qoc/TEa+5YFY9/nsocHcocPfucu9X3SRMRERGJRWpJExEREYlBKtJEREREYlCrLdLMbIqZLTWzFWb2i6DzNIWZPWxmm83sq6CzNJWZ9TGz98xssZktNLMfB52pMWaWZmZfmNm8cObfBp2pqcws0czmmNkrQWdpCjNbY2YLzGyumc0KOk+803UtOnRdi67WfF1rlX3SzCwRWAYcA+QCM4Fp7r4o0GCNMLPDgR3Ao+4+Kug8TWFmPYAe7v6lmbUHZgOnxPKftZkZ0M7dd5hZMvAx8GN3nxFwtEaZ2TVANtDB3U8IOk9jzGwNkO3u8ThRZUzRdS16dF2LrtZ8XWutLWkTgRXuvsrdK4GngJMDztQod/8QKAg6x55w9w3u/mX4eTGwGOgVbKrd85Ad4ZfJ4UfMf5sxs97A8cBDQWeRQOi6FiW6rkVPa7+utdYirReQU+d1LjH+D6wlMLP+wDjg82CTNC7cvD4X2Ay85e4xnxm4E7gOqA06yB5w4E0zm21mlwcdJs7puhYAXdeaXau+rrXWIs0a2Bbz3yjimZmlA88BP3H3oqDzNMbda9x9LNAbmGhmMX0bxsxOADa7++ygs+yhSe4+HpgKXBG+9SV7R9e1KNN1rXnputZ6i7RcoE+d172BvICytHjh/g/PAf9y9/8EnWdPuPs24H1gSsBRGjMJOCncF+Ip4CgzezzYSI1z97zwz83A84Ru2cne0XUtinRdi4pWf11rrUXaTGCImQ0wsxTgLOClgDO1SOHOqn8HFrv77UHnaQozyzKzTuHnbYDJwJJgU+2eu//S3Xu7e39Cf5/fdfdzA461W2bWLtzpGjNrBxwLxM0Ivxik61qU6LoWHbqutdIizd2rgSuBNwh1+Hza3RcGm6pxZvYk8BkwzMxyzeySoDM1wSTgPELfgOaGH98NOlQjegDvmdl8Qv/je8vd42Lod5zpBnxsZvOAL4BX3f31gDPFLV3XokrXNdmViF7XWuUUHCIiIiKxrlW2pImIiIjEOhVpIiIiIjFIRZqIiIhIDFKRJiIiIhKDVKSJiIiIxKCkoAOI7Ckz6wK8E37ZHagB8sOvJ4bXLRQRiRu6rklDNAWHxDUzuxHY4e5/DjqLiEgk6LomO+l2p4iIiEgMUpEmIiIiEoNUpImIiIjEIBVpIiIiIjFIRZqIiIhIDFKRJiIiIhKDNAWHiIiISAxSS5qIiIhIDFKRJiIiIhKDVKSJiIiIxCAVaSIiIiIxSEWaiIiISAxSkSYiIiISg1SkiYiIiMQgFWkiIiIiMUhFmoiIiEgMUpEmIiIiEoNUpImIiIjEIBVpIiIiIjFIRZqIiIhIDFKRJiIiIhKDVKSJ7CEzW2hmRwadQ0REWjYVabJLZrbGzCbX23ahmX0cofO7mQ1uZJ8eZvZ3M9tgZsVmtsTMfmtm7SKRYW+4+0h3fz+c70YzezyoLCISnPA1sszMdtR53NuE4943s0ujkVHim4o0iVlm1hn4DGgDHOzu7YFjgE7AoCCziYiEneju6XUeV+7rCc0sKRLBJP6pSJN9YmY9zew5M8s3s9VmdnWd9yaa2Wdmti3cEnavmaWE3/swvNu88LfPMxs4/TVAMXCuu68BcPccd/+xu88Pn+cuM8sxsyIzm21mh9X5/BvN7Fkz+3e4Fe5LMxtT5/1fmNnK8HuLzOzUer/bZWa2uM7748Pb15jZZDObAvw/4Mzw7zDPzE43s9n1znOtmb2w13/IIhJXdt5xMLM/m1lh+No4NfzeH4DDgHvrtryF7yxcYWbLgeXhbYeY2Uwz2x7+eUidz3jfzP5oZl+E338x/MUWM3vVzK6ql2m+mZ0SpT8CiRAVabLXzCwBeBmYB/QCjgZ+YmbHhXepAX4KZAIHh9//EYC7Hx7eZ0z42+e/G/iIycB/3L12NzFmAmOBzsATwDNmllbn/ZOBZ+q8/4KZJYffW0noYtkR+C3wuJn1CP9upwM3AucDHYCTgK11P9jdXwf+D/h3+HcYA7wEDDCz4XV2PRd4bDe/g4i0PAcCSwld/24B/m5m5u7XAx8BVzbQ8nZK+LgR4YLrVeBuoAtwO/CqmXWps//5wMVAT6A6vC/AI4SuOwCEv5z2AqZH/LeUZqUiTRrzQrglbJuZbQP+Uue9A4Asd7/J3SvdfRXwIHAWgLvPdvcZ7l4dbgm7HzhiDz67C7Bhdzu4++PuvjX8GbcBqcCwOrvMdvdn3b2K0EUuDTgofOwz7p7n7rXhInE5MDF83KXALe4+00NWuPvaxgK7ewXwb8IXSDMbCfQHXmn6ry0iceQb10gzuyy8fa27P+juNYSKph5At0bO9Ud3L3D3MuB4YLm7Pxa+vj0JLAFOrLP/Y+7+lbuXAL8GzjCzROBFYIiZDQnvdx6hL5OVkfmVJVpUpEljTnH3TjsfhFvCwvoBPesVcf+P8IXIzIaa2StmttHMigi1OmXuwWdvJXRh26XwrcTF4eb+bYRaxep+Rs7OJ+EWuVxC3zoxs/PNbG6d7KPqHNuHUEvb3ngEONvMjNDF8elw8SYiLc83rpHu/mB4+8adO7h7afhpeiPnyqnzvCdQ/4vhWkItYg3tvxZIBjLD15ungXPDdzymodb8uKQiTfZFDrC63gWqvbt/N/z+Xwl98xvi7h0IFXC2B+d/Gzg1fJH5lnD/s58DZwAZ4SJye73P6FNn/wSgN5BnZv0ItfpdCXQJH/tVnWNzaNrgBP/WBvcZQCWhW6lno4ujiHzTt64bDWzPI/RFuK6+wPo6r/vUe68K2BJ+/QhwDqFuJqXu/tlep5XAqEiTffEFUGRmPzezNmaWaGajzOyA8PvtgSJgh5ntB/yw3vGbgIG7Of/thPqDPRIuqjCzXmZ2u5mNDp+/GsgHkszshvD+dU0ws+9ZaLTUT4AKYAbQjtAFMT983osItaTt9BDwv2Y2wUIG78zQwO/Qv4FC8lHgXqDa3SMyZYmItBiNXfsg1H9sqJmdbWZJFhpcNYJvdp0418xGmFlb4Cbg2fDtVcJFWS1wG/qiGLdUpMleC18MTiTUcX81oW9wDxG65Qjwv4RakooJtVrVHxxwI6ECbJuZndHA+QuAQwh9O/zczIqBdwi1lq0A3gBeA5YRauov55vN/xDqm3EmUEjo1uP33L3K3RcRunh9RuiCuT/wSZ3Pfgb4A6HBBsXAC4QGH9T3TPjnVjP7ss72xwgVfbo4irRsL9s350l7vgnH3AWcFh75eXdDO7j7VuAE4FpCXT+uA05w9y11dnsM+CehW6tpwNX1TvMooWub5nKMU+a+q1ZXkfhmZjcCg9393Mb2bYbPbgNsBsa7+/Jof76ItGxm9j7wuLs/tJt9zgcud/dDoxZMIkotaSLN44fATBVoIhKE8C3QHwEPBJ1F9p5mNRaJMDNbQ2gAgiaOFJGoC89V+R9Cg6+eCDiO7APd7hQRiaDwShR3AYnAQ+5+c7337wC+E37ZFugaHl0sIvINKtJERCIkPJHoMkJrzOYSWhFjWnigSkP7XwWMc/eLo5dSROJFi7zdmZmZ6f379w86hog0g9mzZ29x96ygc+zCRGBFePUNzOwpQkuTNVikEZpk9DdNObGuayIt166uay2ySOvfvz+zZs0KOoaINAMza3R5rgD14pvTwOQSWovxW8Lz7g0A3t3VyczscuBygL59++q6JtJC7eq6ptGdIiKR09CKGrvqU3IWdSYfbYi7P+Du2e6enZUVq42HItJcVKSJiEROLt9cqqc3oeV9GnIW8GSzJxKRuKUiTUQkcmYCQ8xsgJmlECrEXqq/k5kNAzIIrXghItIgFWkiIhHi7tXAlYSWLFsMPO3uC83sJjM7qc6u04CnXMPrRWQ3WuTAARGRoLj7dEKLY9fddkO91zdGM5OIxCe1pImIiIjEIBVpIiIiIjFIRZqIiIhIDFKftBi1MG87Hy3fQkFJJVnpqRw8qAujenUMOpaIiEirV1PrbC+rYltpJYWl3/y5rbSKwtJKbjp5FIkJDU2d2HQq0mLMxu3l/PI/83lvaT4AKUkJVFbXApDdL4MbTxqpYk1ERCSCyqtqKCipZOuOSraUVLB1RyVbd1SwtaSSLcUVFNQrworKq9jV2OwEg05tU7juuP3o2DZ5n3KpSIshizcUcf7DX1BaUc0vpu7HaRN6k5meSn5xBa/Oz+Pe91Zy0r0f87/HDeOHRwzCbN8qdBERkZaqptbZsqOCTUXlbCqqYGNROflF5WwpCRdgOyrZEv5ZXFHd4DlSkxLITE+lc7sUOrVNpl/ntmS0TaZj2xQy2iaT0TaFjuGfGW2T6dQmhfZpSSTsYwvaTirSYsT6bWVc8PAXJJrx/BWTGNqt/dfvZbVP5cJJAzh1fG+uf34Bt7y+lFX5Jfzp+6P3uSlVREQk3pRWVrO+sIy87eWhImx7OZuKQ8VYqCgrJ7+4gtp6rV0JBp3bpdClXSpd0lPYv3cnurRLITM9hS7pqaHn7VPJDL/fNiUx0AYRFWkxoKbW+clTcyitrOG5Hx7yjQKtro5tkrln2jgGZaVz1zvLqXXn1tPGqFATEZEWwz3U3yu3sIz128pYX1gWfl769evC0qpvHZfRNpluHdLo1iGN/bq3//p56JFK9w5pdElPjav/Z6pIiwH/+GQ1M9cUctvpYxjWveECbScz46fHDCUxwbj9rWVkpafyy+8Oj1JSERGRfefubC6uYPWWEtZuLWH1llLWbClhzdYScgpKKams+cb+bZIT6ZXRhl6d2jCmd6evn/fs1IbuHdLIap9KWnJiQL9N81GRFrDCkkruemc5Rw7L4nvjezX5uKuOGszm4nLu/3AVg7qmc0Z2n8YPEhERiaIdFdWs2LyD5ZuKWZlf8nUhtnZrKWVV/y3EkhONPp3b0r9LOw4a2IXe4SKsd0ZbemW0IaNtcqvsh60iLWD3vbeCkopqfjl1+B79BTQzfnPiSNZsKeX65xcwokcHjfoUEZFAFJdXsXzzDlZs2sGyTcWh55t3sH5b2df71C3EDhmUSf/M0PMBme3o0TGNpERN3VqfirQAbd1RwaMz1vK98b0bvc3ZkOTEBO6ZNo6pd33EVU/O4eWrDiU9Vf9JRUSkebg7G4vKWbi+iIV5RSzM287CvKJvFGOpSQkMykonu38GZ3fry+Cu6Qzpmk7fzm1ViO0h/R89QE98vo7K6lp+cMSgvT5HRrsU7jxrLNMenMENL37F7WeMjWBCERFprdyd9dvKmJuzjQXrt7MoL1SYFZRUAmAGA7q0Y1zfTpx9YF+GdmvPkK7p9OncNq4658cyFWkBqayu5dEZazl8aBaDu6bv07kOGtiFq74zmLvfXcGUkd05dmT3CKUUEZHWorSymgW525mTs4056wqZs24bm4srgNCtyqHd2jN5eFdG9uzIyJ4dGN6jA+1096ZZ6U83IG8u2kh+cQW3nNY/Iue78qghvLloE79+8SsOHNiFjm32bZZjERFp2bbuqOCL1QXMWLWVWWsLWbKxmJrwxGL9u7Rl0uBMxvftxNg+GQzr3p6UJN2qjDYVaQF5Yc56undI4/AhWRE5X0pSArecNppT7vuEm19bzB+/Nzoi5xURkZahblE2Y1UBSzcVA6HpLcb368SPjhzEuHBR1rldSsBpBVSkBaKgpJL3l+Zz8aEDInrffnTvTlx22EDu/3AVJ4/txUEDu0Ts3CIiEl+qamqZvbaQD5bl8/7SfBZvKAJCRVl2/wxOGtuTgwZ2YXTvjiSrQ39MUpEWgFcXbKC61jllbNPnRWuqn0weyqsLNvCbFxfy6tWHaiSNiEgrkretLFyUbeaTFVvZUVFNUoIxoV8GPztumIqyOKMiLQCvzs9jSNd0hvfY82k3GtMmJZFfHT+CHzw+m8dmrOWiSQMi/hkiIhI7Vmwu5vWvNvL6wo18tT7UWtajYxonjunBEUO7MmlwF9qnqZ9yPFKRFmXbS6uYuaaQHxwxsNlmTz5uZDcOG5LJ7W8t48QxPclMT22WzxERkehzd75aX8TrCzfw+lcbWZlfAsC4vp34xdT9OGq/rgzpmt4qZ+hvaVSkRdn7yzZTU+scPbxbs33GztUIptz5Ibe+vpQ/naZBBCIi8W7NlhJemLueF+fmsXpLCYkJxoEDOnPBIf05dkR3undMCzqiRJiKtCh7a9EmMtNTGNu7U7N+zuCu6Vx86AAe+HAV5x3cT0tGiYjEoYKSSl6Zn8fzc9YzZ902zOCgAV34wREDOWZEd43CbOFUpEVRdU0tHyzLZ+qo7iREYTbmK48azDOzcrj5tSU8dslENX2LiMQBd+ezlVv51xfreHPhRqpqnP26t+eXU/fjpLE96dGxTdARJUpUpEXR/PXbKS6v5vChkZkbrTEd0pK56qgh3PTKIj5Yls+Rw7pG5XNFRGTPFZRU8uzsHJ78IofVW0ro2CaZ8w7qz+nZvRneo0PQ8SQAKtKi6LOVWwE4OIrzl517UD/++ekabn5tCYcNydJ6aiLNzMymAHcBicBD7n5zA/ucAdwIODDP3c+OakiJKYs3FPHQR6t5eV4elTW1HNA/g6uPHszUUT1IS04MOp4ESEVaFH22civ7dW9PlyiOtkxJSuC6KcO48ok5PPdlLmdk94naZ4u0NmaWCNwHHAPkAjPN7CV3X1RnnyHAL4FJ7l5oZmriboXcnfeX5fP3j1bz8YottE1J5KyJfTj3oH4M7Rb56ZkkPqlIi5KK6hpmrS3grAP6Rv2zj9+/Bw/2Wc3tby7jxNE9aZOib2YizWQisMLdVwGY2VPAycCiOvtcBtzn7oUA7r456iklMNU1tbw0L4+/vr+S5Zt30K1DKtdNGcY5E/vRsa3mMpNv0pTDUTJ33TbKq2o5ZFD0l2oyM67/7nA2FpXzj09XR/3zRVqRXkBOnde54W11DQWGmtknZjYjfHu0QWZ2uZnNMrNZ+fn5zRBXoqW6ppZnZ+cy+fYPuObpeSQmGLefMYaPrjuKHx05WAWaNCgqLWmN9dEws2uAS4FqIB+42N3Xht+rARaEd13n7idFI3OkfbZqK2Zw4IBg1tOcOKAz3xmWxf0frOLcg/rRQbNPizSHhjp9er3XScAQ4EigN/CRmY1y923fOtD9AeABgOzs7PrnkThQU+v858tc7n1vBWu3ljKiRwf+du4Ejh3RLSqj/CW+NXtLWp0+GlOBEcA0MxtRb7c5QLa7jwaeBW6p816Zu48NP+KyQAOYvbaQ/bp3CPTb0rXHDmN7WRUPfaTWNJFmkgvU7fjZG8hrYJ8X3b3K3VcDSwkVbdKCuDvvLdnM1Ls+5GfPzic9NYkHzpvAq1cfypQoTcMk8S8atzu/7qPh7pXAzj4aX3P399y9NPxyBqELW4tRW+vMXbeN8X2bdwLbxozq1ZGpo7rz949WUVBSGWgWkRZqJjDEzAaYWQpwFvBSvX1eAL4DYGaZhG5/ropqSmlWX63fzjkPfc5F/5xJRXUtfzlnPK9cdSjHjuyu+Splj0SjSGtKH426LgFeq/M6LdwnY4aZnbKrg2K578aK/B0UV1Qzrm9G0FG45pihlFbV8LcPVgYdRaTFcfdq4ErgDWAx8LS7LzSzm8xs552AN4CtZrYIeA/4mbtvDSaxRNKWHRVc+/Q8TrjnYxZvKOI3J47grZ8ewXf376HiTPZKNPqkNaWPRmhHs3OBbOCIOpv7unuemQ0E3jWzBe7+rQojlvtuzFlXCIQWvw3akG7tOXVsLx75dA2XHjqArh201ptIJLn7dGB6vW031HnuwDXhh7QANbXOE5+v5dY3llJWVcP/HDGQK74zWH1/ZZ9FoyWtKX00MLPJwPXASe5esXO7u+eFf64C3gfGNWfY5jBn3TY6tklmYGa7oKMA8JPJQ6mpde59b0XQUURE4tq8nG2cct8n/PrFhYzq1ZHXfnw4v5w6XAWaREQ0irRG+2iY2TjgfkIF2uY62zPMLDX8PBOYxDfnG4oLc9ZtY1zfTjHT3N23S1vOOKAPT36xjpyC0sYPEBGRbyivquGPry3m1L98wsaicu6eNo5/XXogg7umBx1NWpBmL9Ka2EfjViAdeMbM5prZziJuODDLzOYR6rtxc92Zu+NBcXkVyzYXM65P8P3R6rrqqMGYGfe8uzzoKCIicWXOukKOv/sj7v9gFWdk9+Gda4/gpDE9Y+aLuLQcUZknrQl9NCbv4rhPgf2bN13z+mp9Ee4wpk/HoKN8Q4+ObTj3wH7889PV/OCIQQzM0rc/EZHdqayu5fa3lvHAhyvp1iGNRy6eyBFDs4KOJS2YVhxoZgvztgMwsmdsFWkAP/rOIFKTErnrHbWmiYjszrqtpZz+t0/52wcrOW1Cb9746eEq0KTZqUhrZos2FNG1fSpZ7aO3qHpTZaancsEh/XlpXh7LNhUHHUdEJCa9PC+P4+/+iNVbSvjrOeO55bQxGhggUaEirZktyitiRM8OQcfYpf85fCDtUpK4461lQUcREYkp5VU1/PI/87nqyTkM6ZbOq1cfxtT9ewQdS1oRFWnNqLyqhhWbdzAyhou0jHYpXHzoAF77auPXt2ZFRFq7jdvLOfOBGTz5RQ4/PHIQ//6fg+nTuW3QsaSVUZHWjJZv2kF1rTOiR+z1R6vrkkMH0CFNrWkiIgCz1xZw4r0fs2JTMfefN4GfT9mP5ET971KiT3/rmtGiDTsHDcRuSxpAxzbJ/M8Rg3h78eavV0cQEWmN/j1zHWc9MIO2KYk8f8UkjhvZPehI0oqpSGtGC/OKSE9Nom8cNJFfeEh/OrdL4Xa1polIK+Tu3PrGEn7+3AIOGtiFF6+YxNBu7YOOJa2cirRmtCiviOE92pOQEPsTHLZLTeIHRwzko+VbmLmmIOg4IiJRU1ldy7XPzOO+91Zy1gF9+MeFB9CpbUrQsURUpDWX2lpn8YYiRvSI7VuddZ13UH+y2qfy5zeWEloDWkSkZSsur+KSR2byny/Xc80xQ/nj9/YnSf3PJEbob2IzWb+tjJLKGoZ1j58irU1KIlccOYjPVxfw6cqtQccREWlW20orOeehz/l05VZuOW00Vx89REs7SUxRkdZMVmzeAcCQbvG13NJZE/vSo2Mat72p1jQRabm27qhg2oOfs2RDMfefO4EzsvsEHUnkW1SkNZOdM/gP6RpfRVpaciJXHjWYL9dt4/1l+UHHERGJuM3F5Zz1wAxW5e/gwQuymTyiW9CRRBqkIq2ZLN+8g6z2qXHZ+fT0CX3ondGG299cptY0EWlRNheVc9b9M1i/rYx/XqQF0iW2qUhrJss3FTM0zm517pSSlMCPjx7CgvXbeXPRpqDjiIhERGFJJef+/XM2FpXz6MUTOXhQl6AjieyWirRm4O4s37yDIV3jd46dU8f1YmBmO+54axm1tWpNE5H4VlxexQX/+II1W0t56Pxssvt3DjqSSKNUpDWD9dvKKK2sibtBA3UlJSbw48lDWLKxmFcXbAg6jojIXiurrOGSR2axKK+Iv54znkMGZwYdSaRJVKQ1g+U7R3bGcUsawAmjezK0Wzp3vr2MGrWmiUgcqql1rnryS2auKeCOM8dy9HANEpD4oSKtGSyP05Gd9SUmGD+dPJSV+SW8OHd90HFERPaIu3PTywt5e/FmfnvSSE4c0zPoSCJ7REVaM1i+aQeZ6alktIu/kZ31HTcCvuFEAAAgAElEQVSyOyN6dOCud5ZTVVMbdBwRkSZ7+JM1PPLZWi47bADnH9w/6Dgie0xFWjMIDRqI71a0nRISjGuOGcraraU8Nzs36DgiIk3y+lcb+P2ri5gysju/nDo86Dgie0VFWoS5O6vydzCoa7ugo0TM0cO7MqZPJ+55dwUV1TVBxxER2a1FeUX85N9zGdO7E3ecOZaEBC31JPFJRVqEFZZWUVReTf8uLadIMzOuPWYo67eV8fTMnKDjiMQ0M5tiZkvNbIWZ/aKB9y80s3wzmxt+XBpEzpZqW2kl//P4LDq2SeaB8yfQJiUx6Egie01FWoSt3hIa2Tkwq+UUaQCHDcnkgP4Z3PPuCsqr1Jom0hAzSwTuA6YCI4BpZjaigV3/7e5jw4+HohqyBQuN5JzDxu3l/PXcCXRtnxZ0JJF9oiItwlbllwAwILNl9Enbycy45phhbC6u4PEZa4OOIxKrJgIr3H2Vu1cCTwEnB5yp1bjtzaV8tHwLN508ivF9M4KOI7LPVKRF2JqtJSQlGL0z2gQdJeIOHtSFSYO78LcPVlJaWR10HJFY1Auo2ycgN7ytvu+b2Xwze9bM+uzqZGZ2uZnNMrNZ+fn5kc7aory1aBN/eX8l0yb2ZdrEvkHHEYkIFWkRtnpLCX07tyU5sWX+0V5zzDC27KjkkU/VmibSgIZ6qNefCfploL+7jwbeBh7Z1cnc/QF3z3b37KwsLQS+Kxu2l/GzZ+cxqlcHbjypobvLIvGpZVYSAVqVX0L/zJbVH62uCf0yOHJYFvd/uJLi8qqg44jEmlygbstYbyCv7g7uvtXdK8IvHwQmRClbi1RT6/z4qblUVddyz7TxpCZpoIC0HCrSIqi21lmztYQBLbhIA7j2mGFsK63i4Y/XBB1FJNbMBIaY2QAzSwHOAl6qu4OZ9ajz8iRgcRTztTj3vLucL1YX8LtTRrX4a6+0PirSImhjUTnlVbUt/kKxf++OHDuiGw99tIptpZVBxxGJGe5eDVwJvEGo+Hra3Rea2U1mdlJ4t6vNbKGZzQOuBi4MJm38m7mmgLvfWc6p43rxvfG9g44jEnFRKdKaMG/QNWa2KNyR9h0z61fnvQvMbHn4cUE08u6tNVtCIzsHtvAiDeCnxwyluKKaBz9aFXQUkZji7tPdfai7D3L3P4S33eDuL4Wf/9LdR7r7GHf/jrsvCTZxfCqpqObap+fRO6MtvztlVNBxRJpFsxdpTZw3aA6QHe5I+yxwS/jYzsBvgAMJDW3/jZnF7LjqVeEibUALmyOtIcN7dODEMT15+OM1bCoqDzqOiLQyf3p9CTmFpfz59DGkpyYFHUekWUSjJa3ReYPc/T13Lw2/nEGosy3AccBb7l7g7oXAW8CUKGTeK6u3lJCWnEC3VjKB4s+OHUZ1bS13vLUs6Cgi0op8unILj362losOGcDEAZ2DjiPSbKJRpDV13qCdLgFe29NjY2E+odVbSujfpV2rWSeub5e2nHdQf56elcOyTcVBxxGRVmBHRTXXPTufAZnt+Nlxw4KOI9KsolGkNWXeoNCOZucC2cCte3psLMwntGZLSYtbDqoxVx01mHapSfzpNXWrEZHm96fXlrB+Wxl/Pn201uWUFi8aRVqj8wYBmNlk4HrgpDpzCDXp2FhQXVPLuoLSFrWwelNktEvhR0cO5p0lm/ls5dag44hICzZnXSGPf76WCw/pz4R+us0pLV80irSmzBs0DrifUIG2uc5bbwDHmllGeMDAseFtMSdvWznVtd6iJ7LdlYsm9adHxzT++NpiamsbbOgUEdkn1TW1XP/8V3Rrn8a1x+o2p7QOzV6kNXHeoFuBdOAZM5trZjuHqhcAvyNU6M0EbgpviznrCkLjHvp2bhtwkuhLS07k2mOHMT93O68u2BB0HBFpgf756RoWbSjiNyeO0GhOaTWi8jfd3acD0+ttu6HO88m7OfZh4OHmSxcZrblIAzh1XC8e+mgVt7yxhGNHdtPSLCISMXnbyrj9rWV8Z1gWU0Z1DzqOSNRoxYEIWVdQSkpiAt06tI7pN+pLTDB++d3h5BSU8a8Z64KOIyItyO9eWURNrXPTyaMwax2j50VARVrE5BSU0jujDYmtZPqNhhw+JJNDB2dy97vLtVyUiETEpyu38NpXG7nyO4Pp00rvVEjrpSItQtYVlLb6C4iZcf3xwykqq+LOt5cHHUdE4lxNrfP7VxbTq1MbLjt8YNBxRKJORVqErCsobbX90eoa3qMD0yb25bEZa1muCW5FZB88OzuHRRuK+PnU/UhLVj9XaX1UpEXA9tIqtpdVqUgLu+aYobRLSeSmVxbhrik5RGTP7aio5tY3ljG+bydOHN0j6DgigVCRFgE5haGRna39dudOXdJT+fHkoXy0fAvvLtnc+AEiIvX89f0VbNlRwQ0njtRgAWm1VKRFQGuffqMh5x/cj0FZ7fj9q4uprK4NOo6IxJEN28t48KPVnDK2J2P7dAo6jkhgVKRFwM4irU/nNgEniR3JiQn8+oQRrN5SwiOfrgk6jojEkXveXYG7a2UBafVUpEXAuoJSOrdLoX1actBRYsqRw7py1H5dufud5eQXVzR+gIi0emu2lPD0zBzOnthXXUik1VORFgE5mn5jl64/fjhlVTX8+Y2lQUcRkThw59vLSEo0rjhqcNBRRAKnIi0CNP3Grg3KSueiSf15enYOc9YVBh1HRGLY0o3FvDgvjwsPGUDX9q1z9RaRulSk7aPqmlrWF5bRV/3RdunHk4fStX0qv3rhK6prNIhARBp225tLSU9J4gdHaOJaEVCRts82bC+nutbVkrYb6alJ3HDCSBbmFfH4jLVBxxGRGPTV+u28uWgTlx0+kE5tU4KOIxITVKTto/+O7FSRtjvf3b87hw3J5LY3l7G5qDzoOCISY+59dwUd0pK4aFL/oKOIxAwVaftIc6Q1jZlx08mjqKiu5Q/TFwcdR0RiyLJNxby+cCMXHtJfo+RF6lCRto/WFZSSlGD06Kg+aY0ZkNmOHxw5iBfn5vHJii1BxxGRGPGX91bQNiWRiyYNCDqKSExRkbaP1hWU0jujDYkJWrakKX505CD6dWnLr1/8iorqmqDjiEScmU0xs6VmtsLMfrGb/U4zMzez7GjmizVrtpTw0rw8zj2oHxnt1BdNpC4VaftIc6TtmbTkRG48aSSr8kt44INVQccRiSgzSwTuA6YCI4BpZjaigf3aA1cDn0c3Yez52wcrSUpM4NJD1YomUp+KtH2kOdL23HeGdeX4/Xtwz3srWLF5R9BxRCJpIrDC3Ve5eyXwFHByA/v9DrgFaNWjaPK2lfHcl7mcdUAfunbQvGgi9alI2wfby6rYVlqlIm0v3HjSSNokJ/KL5+ZTW+tBxxGJlF5ATp3XueFtXzOzcUAfd3+lsZOZ2eVmNsvMZuXn50c2aQz456drqHW4/HDNiybSEBVp+yBH02/staz2qfz6hBHMWlvI459r7jRpMRrqnPr1txAzSwDuAK5tysnc/QF3z3b37KysrAhFjA07Kqp58vN1TB3Vnd4ZuoaKNERF2j7ILdT0G/vi++N7cdiQTP702hLWbysLOo5IJOQCfeq87g3k1XndHhgFvG9ma4CDgJda4+CBp2fmUFxRzaWHqRVNZFdUpO2DnIJQYdFH3wL3ipnxf6fujwPXP78Ad932lLg3ExhiZgPMLAU4C3hp55vuvt3dM929v7v3B2YAJ7n7rGDiBqOm1nn4k9Vk98tgbJ9OQccRiVkq0vZBTmEp7dOS6NhWky/urT6d23LdccN4f2k+L8xdH3QckX3i7tXAlcAbwGLgaXdfaGY3mdlJwaaLHW8u3EhuYRmXHqYRnSK7kxR0gHiWU1CqVrQIOO/g/rw8fwO/fXkRkwZn0rW9RnlJ/HL36cD0ettu2MW+R0YjU6z5+8er6dO5DceM6B50FJGYppa0fZBTWEafzlppYF8lJhh/+v5oyipr+H//0W1PkZZszrpCZq0t5OJJAzQJuEgjVKTtJXdXS1oEDe6aznVT9uPtxZt5ZlZu0HFEpJk88uka2qcmcXp2n8Z3FmnlVKTtpfziCiqqazX9RgRddEh/DhrYmd++vPDr6U1EpOXYuqOC6Qs28r3xvUhPVW8bkcaoSNtLOYU750jT7c5ISUgw/nz6GMyMa5+Zp0luRVqYZ2bnUllTyzkH9Qs6ikhcUJG2lzT9RvPondGW35w4gi9WF/DwJ6uDjiMiEVJb6zzx+TomDujM0G7tg44jEhcabW82s2L+O2P2zl6eHj42xd2bco4pwF1AIvCQu99c7/3DgTuB0cBZ7v5snfdqgAXhl+vcPSaGse+8HaeZsiPvtAm9eXPRJm55YymHD83SBV2iyszO39377v5otLK0JB8uz2ddQSk/O25Y0FFE4kajLWnu3t7dO4Qf7YGewB+AjYQKr90ys0TgPmAqMAKYZmYj6u22DrgQeKKBU5S5+9jwIyYKNAjd7sxMT6VNSmLQUVocM+OP39uf9qlJXP3kHMqraoKOJK3LAQ08JhJaFP3hAHPFtcdnrCUzPZXjRmraDZGmavLtTjPrZGY3AvMILW1ygLs3Zf25icAKd1/l7pXAU8DJdXdw9zXuPh+obXLygOUUaPqN5pSZnsqtp49mycZi/jh9cdBxpBVx96t2PoCrgc+BIwitDjA+0HBxav22Mt5dspkzD+hNSpJ62Yg0VaP/Wsws08z+CHwJVAPj3P1X7r61iZ/RC8ip8zo3vK2p0sxslpnNMLNTdpPz8vB+s/Lz8/fg9Hsnp1DTbzS3o/brxsWTBvDIZ2t5c+HGoONIK2JmSWZ2KbAImAyc5u5nhr9Myh566ot1ODBtYt+go4jElaaMgV4L5AP/AEqBS8z+OwGhu9/eyPENzVa4J8P2+rp7npkNBN41swXuvvJbJ3R/AHgAIDs7u1mHBVbX1LJhe7la0qLg51OH8fnqrVz33HxG9epIz076M5fmZWZXAD8G3gGmuPvagCPFtZpa55lZuRwxNEt9eEX2UFPanW8lVKBB6DZn/UdjcoG6sxb2BvKaGtDd88I/VwHvA+Oaemxz2bC9nJpaV0taFKQmJXLPtHFUVtfyk6fmUl0TN3fEJX7dA3QADgVeNrP54ccCM1NL2h76aHk+G4vKOVOT14rssUZb0tz9xn38jJnAEDMbAKwHzgLObsqBZpYBlLp7hZllApOAW/Yxzz7bObJTE9lGx8CsdH538iiufWYe97y7gp8eMzToSNKyadXvCHpmVi4ZbZM5eni3oKOIxJ1mn/LZ3avN7ErgDUJTcDzs7gvN7CZglru/ZGYHAM8DGcCJZvZbdx8JDAfuN7NaQq1+N7v7oubO3JivJ7JVS1rUfH9Cbz5ZsYV73l3OxAGdmTQ4M+hI0kLp9mbkFJZU8taiTZxzUF8NGBDZC1FZl8PdpwPT6227oc7zmYRug9Y/7lNg/2YPuIdyCspITDB6dEoLOkqr8rtTRjF//XaufnIOL191qPqnicS4F+eup7KmltMn6FanyN5oyujOg63uSAEhp7CUHh3TSE7UN8NoapeaxN/OnUB5VQ0/+teXVFRr/jSRWPbM7FxG9erAiJ4dgo4iEpeaUmVcAMw2s6fM7EIza/UzEeYUaPqNoAzums6tp49hbs42fv+K5k+TyDOzB8zsVDPTUhf7YGHedhbmFXGGBgyI7LWmrDjwA3cfD9xIqM/YP83sMzP7PzM7PLyiQKuSU6iJbIP03f17cPnhA3lsxlr+82Vu0HGk5XkYGANMN7N3zOznZjYm6FDx5plZuaQkJnDSmJ5BRxGJW02+X+fuS9z9DnefAhwFfAycTmg27lajvKqG/OIKtaQF7LrjhnHggM78v+cXsCivKOg40oK4+wx3v9HdDwPOILRs3bVmNsfMHjazMwKOGPMqq2t5Ye56jh3ZjU5tU4KOIxK39qpTlbuXufv08NIp2ZEOFctyCzX9RixISkzg3rPH07FNMpc/NoutOyqCjiQtkLtvdfcn3f18dx9HaB3iIUHninUfLMtnW2kV3x//rfFgIrIH1PN9D+UUlAHodmcMyGqfyv3nZZNfXMEPH/+SympNdCvNy91nu/sfgs4R616Yu57O7VI4dIimyhHZFyrS9pDmSIstY/t04pbTRvPFmgJ+9cIC3Jt1RTARaURxeRVvL9rECaN7aAS8yD5qyhQcg81sUgPbDzOzQc0TK3blFJSSmpRAVvvUoKNI2Mlje3HVUYN5elYuf/94ddBxRFq1NxZuoqK6lpPH9go6ikjca8rXnDuB4ga2l4Xfa1VyCsrondEGTR0XW346eShTR3Xn/6Yv5r2lm4OOI3HMzA6oO9WQmZ1vZi+a2d1m1jnIbPHgxbnr6dO5DeP7dgo6ikjca0qR1t/dv7WosLvPAvpHPFGMyyks1aCBGJSQYNx2xhiG9+jAVU/MYclGjfiUvXY/UAlgZocDNwOPAtuBBwLMFfM2F5fzyYotnDyml77IikRAU4q03a191Op6z2si29jVNiWJhy7IJj01iQsfnknetrKgI0l8SnT3gvDzM4EH3P05d/81MDjAXDHvlXkbqHU4ZZzmRhOJhKYUaTPN7LL6G83sEmB25CPFru1lVRSVV2tkZwzr0bEN/7joAEoqqrnwH1+wvawq6EgSfxLNbOe6xkcD79Z5r9H1js1sipktNbMVZvaLBt7/gZktMLO5ZvaxmY2IUO7AvTh3PSN7dmBwVy3WIBIJTSnSfgJcZGbvm9lt4ccHwKXAj5s3XmzJKdDIzngwvEcH7j9vAqu3lHD5o7O0xqfsqSeBD8zsRUJ9bz+C0CAqQrc8dym8Ast9wFRgBDCtgSLsCXff393HArcAt0c4fyBWbylhXu52Th6rVjSRSGnKslCb3P0Q4LfAmvDjt+5+sLtvbN54sUUT2caPQwZn8ufTx/D56gKueXoetbWamkOaJjwP2rXAP4FD/b/zuiQAVzVy+ERghbuvcvdK4Cng5Hrnr9thsh3QIv5yvjwvDzM4UctAiURMo033O7n7e8B7zZgl5n09ka1a0uLCyWN7sXF7OX98bQld26dywwkj1JlZmsTdZzSwbVkTDu0F5NR5nQscWH8nM7sCuAZIIbTMXoPM7HLgcoC+ffs24eODM33BBrL7ZdCjo7qDiESKZhrcAzmFpbRPS6Jj2+Sgo0gTXX74QC6a1J9/fLKGO99eHnQcafka+hbwrZYyd7/P3QcBPwd+tauTufsD7p7t7tlZWVkRjBlZK/N3sGRjMd/dv0fQUURalCa3pIlGdsYjM+PXx49gR3k1d72znPTUJC47fGDQsaTlygX61HndG8jbzf5PAX9t1kRRMH3+BgCmjlKRJhJJKtL2QE5hGYOy2gUdQ/ZQQoJx8/dHU1pVwx+mL6ZdahJnHxjbt44kbs0EhpjZAGA9cBZwdt0dzGyIu+9s1j0eiPsm3lcXbGBCvwy6d9zdjE0isqdUpDWRu5NTUMqRQ2P3loPsWmKCcccZYymrrOH6FxbQNiWRU8Zp2RqJLHevNrMrgTeAROBhd19oZjcBs9z9JeBKM5sMVAGFwAXBJd53q8K3On99QouZSUQkZqhIa6L84goqqms1sjOOpSQl8JdzxnPRP2Zy7TPzSE5M4PjRuj0jkeXu04Hp9bbdUOd5i5q6aPqC0K3O7+7fvZE9RWRPaeBAE+V8Pf2GRi7Fs7TkRB66IJsJfTO4+qk5vDRvd92FRKQxry7YyPi+nTSqU6QZqEhrIk2/0XK0S03iHxcdQHa/DH7y1BxemLM+6EgicWn1lhIWbyjSqE6RZqIirYl2rjbQW0Vai7CzUDtwQBd++vRcnpudG3Qkkbjz31udKtJEmoOKtCbKKSwlMz2VNimJQUeRCGmbksTDFx7ApEGZ/O+z83h6Zk7jB4nI116dv4FxfTvRs5NudYo0BxVpTZRTUKb+aC1Qm5RQH7XDhmRx3XPz+fvHq4OOJBIX1mwpYdGGIo5XK5pIs1GR1kQ5hZrItqVKS07kwfMnMGVkd373yiL+/MZS/rtco4g05K1FmwA4bqRGdYo0FxVpTVBdU8uG7eVqSWvBUpMSue+c8Uyb2Id731vB9S98RY0WZRfZpbcWb2K/7u01LZFIM9I8aU2wYXs5NbWulrQWLjHB+L9T9yejbQp/eX8l20uruP3MMaQmqR+iSF2FJZXMWlPAFd8ZHHQUkRZNRVoT7BzZqW+MLZ+Zcd2U/chom8Ifpi+msLSSv547gY5tkoOOJhIz3lu6mVqHY0Z0CzqKSIum251NsHMi274q0lqNyw4fyO1njGHmmgK+/9dPvy7URQTeXryJbh1SGdWzY9BRRFq0qBRpZjbFzJaa2Qoz+0UD7x9uZl+aWbWZnVbvvQvMbHn4EcgadzkFZSQmGD20eHCr8r3xvXnskgPJL67glPs+4ct1hUFHEglcRXUNHyzN5+jh3UhIsKDjiLRozV6kmVkicB8wFRgBTDOz+ivxrgMuBJ6od2xn4DfAgcBE4DdmltHcmevLKSylR8c0khLV8NjaHDSwC//50SGkpyUx7YEZvDp/Q9CRRAL12cqtlFTWcMxw3eoUaW7RqDomAivcfZW7VwJPASfX3cHd17j7fKC23rHHAW+5e4G7FwJvAVOikPkbcgo0/UZrNigrned/NIn9e3Xkiie+5N53l2uKDmm13l68iTbJiRw8qEvQUURavGgUab2AulO554a3RfRYM7vczGaZ2az8/Py9CrorOYWayLa169wuhccvPZCTx/bkz28u40f/+pIdFdVBxxKJKnfn7UWbOXxoJmnJGvUs0tyiUaQ11Gmhqc0QTT7W3R9w92x3z87KympyuMaUV9WQX1yhNTuFtORE7jxzLL86fjhvLNzIqfd9wuotJUHHEomahXlFbCwqZ7JudYpERTSKtFygT53XvYG8KBwbEbmFZQBqSRMgNEXHpYcN5LFLDmTLjgpOuvdj3lu6OehYIlHx1qJNJBgctV/XoKOItArRKNJmAkPMbICZpQBnAS818dg3gGPNLCM8YODY8LaoyQ1Pv6E+aVLXpMGZvHTlofTJaMvF/5zJXW8v1woF0uK9vXgTE/pl0CU9NegoIq1Csxdp7l4NXEmouFoMPO3uC83sJjM7CcDMDjCzXOB04H4zWxg+tgD4HaFCbyZwU3hb1OSEW9J0u1Pq69O5Lc/98BBOHduLO95exvkPf87m4vKgY4k0i7xtZSzMK9KtTpEoisqKA+4+HZheb9sNdZ7PJHQrs6FjHwYebtaAu5FbWEpKYgJd2+ubo3xbm5REbjtjDAcN6sINL37Fd+/6mDvPHMuhQzKDjiYSUW8vDi2oPlmrDIhEjSb+akRuQRm9Mtpo0kbZJTPjjOw+vHTloWS0Tea8hz/ntjeXUl1Tf0YZkfj11qJNDMxsx6Cs9KCjiLQaKtIakVtYSu8MDRqQxg3t1p4Xr5zEaeN7c8+7K5j24AwtJyUtQnF5FTNWbVUrmkiUqUhrRG5hmfqjSZO1TUni1tPHcOeZY1myoZgpd37Iv2eu0+S3Etc+XLaFqhpXfzSRKFORthslFdVsLalUS5rssVPG9eL1nx7O6N6d+PlzC7js0VnkF1cEHUtkr7y9eBMZbZMZ37dT0FFEWhUVabuxftvOOdLUkiZ7rlenNvzr0gP59Qkj+HD5Fo6780Ne/0prf0p8qa6p5d0lm/nOfl21frFIlOlf3G7s7E+kljTZWwkJxiWHDuDVqw6lZ6c0fvD4l1zxry81VUcLZmZTzGypma0ws1808P41ZrbIzOab2Ttm1i+InE01a20h28uqOFb90USiTkXabny92oD6pMk+GtKtPc//aBL/e+xQ3lq0icm3fcDTM3PUV62FMbNE4D5gKjACmGZmI+rtNgfIdvfRwLPALdFNuWfeXrSJlMQEDhsSueX2RKRpVKTtRm5hKWnJCWSmpwQdRVqA5MQErjxqCNN/fBj7de/Adc/N55yHPmftVq3/2YJMBFa4+yp3rwSeAk6uu4O7v+fuO4f9zmAXc0TGAnfnrcWbOGRwF9qlRmVaTRGpQ0XabuQUhEZ2mmmONImcwV3Teeryg/j9KaOYn7ud4+78kPveW0FFdU3Q0WTf9QJy6rzODW/blUuA13b1ppldbmazzGxWfn5+hCI23YrNO1i7tVSjOkUCoiJtN3K3aY40aR4JCca5B/Xj7WuO4IihWdz6xlKOu+NDLdYe/xr6RtfgPW0zOxfIBm7d1cnc/QF3z3b37Kys6N9ufCu8ysDRw7WgukgQVKTtRqglTUWaNJ/uHdO4/7xsHrl4IglmXPSPmVz6yCzWbdUkuHEqF+hT53VvIK/+TmY2GbgeOMndY3ZulrcXbWL/Xh3p0VHXQZEgqEjbhaLyKraXVWnQgETFEUOzeP0nh/OLqfvx6cotTL7jA25/axmlldVBR5M9MxMYYmYDzCwFOAt4qe4OZjYO/n97dx7cdX3ncfz5zi8XEA4lByGcYjhlRaVYL0AOBdsFu2NXbbdjd+1Yu7V1t06tzOz2cNfddtrZ3u3WsW5b62LdarupMnWDgEVb5EYhAUHOkJCEIyFAQkjy3j9+P2qMiYTkl9/3+8vv9Zhh+B3f3y+vCeST9+9z8hOiBVpou05rG86y5VCdhjpFAqQirQsVx6MrO3XagCRKZnoa98+ZwKqH5nLrtBF87+XdzPnmGpavP6hzQJOEu7cADwAvAeXAs+6+w8weNbMlscu+CeQA/2NmW82spIu3C9TqnTW4w4KpGuoUCYqW63Sh4kR0uGn0perml8QaMTSb7999FZ+8fiyPvVjOsuff5L9e28eyxVOYOylPC1lCzt1XACs6PPbldrcXJDxUD5SWV1M0bABTC4cEHUUkZaknrQvn90hTT5oE5Zqxl/LcZ67nxx+/muaWNv72Zxv4+BOv82ZFfdDRpJ9rOtfK2t21LJiSrw8FIgFSkdaFyrpGsjPSuGRgRtBRJIWZGbA9LX0AABHdSURBVIunF1L6hTl8bck0dh5p4C9/8Cqffmoj5VUng44n/dRre47SdK6NBTplQCRQKtK6UHWyiZFDB+hTpIRCRiSNe64fx5ovzuUfF0zkj3uOsfi7a/ns05t5q7oh6HjSz5SWVZOTlc6144cHHUUkpalI60JVXSMjhmYHHUPkXYZkZ/DggmJe/dI8PjfvctbsquHW7/yBzy/fwp6aU0HHk36grc1ZWV7DnEl5ZKbrV4RIkPQT2IWq+ibtDSShNXRgBg/dMom1X5rH/XMmUFpWzcJvv8LfP71Jc9akV7ZV1HH01FkWausNkcBpdWcnWlrbqD7ZxMhh6kmTcLt0UCZfWjSZe28cz5Ov7uOpPx1gxZtHuKk4l8/MmcB1E4ZryF4uysryaiJpxtxJOlBdJGjqSetE7amztDka7pSkkZuTxcOLJvPasnk8sngyO4808LEnXuf2H77G77dX0drW6clEIu+xsqyGD4y7hGEDM4OOIpLyVKR1orKuCYCRGu6UJDMkO4P750xg7cM3828fmU5d4znu/+Vm5n5rNU+s3Ut947mgI0qIHTx2hl3VDSycOiLoKCKCirROVdVH90gr1HCnJKnsjAgfu3YMqx6ay48+fjWFQwbwry+Wc92/v8w//3a7FhlIp1bGDlRfoAPVRUJBc9I6caQ+2pNWOEQ9aZLcImnGbdMLuW16IdsP1/OzP+7nVxsO8dS6A8yemMc9141l7qR8ImmatybRIm1iQQ5jhw8KOoqIoJ60TlXWNTEwM8KQAaphpf+4omgo3/rolfxx2TweWjiRnVUnuffnG7npG6v4dulbHK5rDDqiBKj+zDle33dcB6qLhIiqkE5U1TdSODRbq+KkX8rNyeJz84v59JwJvFxezfINh/jeqt18f9Vu5kzM4+5ZY5g3OZ/0iD7DpZI1b9XQ2uY6ZUAkRFSkdaKyvomRwzTUKf1bZnoai6cXsnh6IYeOn+HZjYf41YZD3PfUJvIHZ3HHNaP4q6uLuDx/cNBRJQFKy6rJzclkxqhhQUcRkRgVaZ04Ut/IxHztESSpY/SlA3nolkk8OL+Y1btqWb7+IP/5ytv8aM3bTC8aykeuKmLJjJHk5mQFHVX6QHNLG6/squW26YWkaX6iSGioSOvgXGsbNQ1nKVRPmqSg9EgaC6cWsHBqATUNTZRsreQ3Ww7z6AtlPLainNnFuXzk6lHcMrWA7IxI0HElTtbvO07D2RYNdYqETEKKNDNbBHwXiABPuPvXOzyfBfwCuAY4Btzp7vvNbBxQDuyKXbrO3e/vy6zVJ5twh5HayFZSXP7gbD5102V86qbLeKu6gec3H+Z/tx7m88u3MCgzwvwpBdw2vZC5k/JUsCW5leXVZGekcePluUFHEZF2+rxIM7MI8ENgIVABbDCzEncva3fZvcAJd7/czO4CvgHcGXvubXef0dc5z6uKbb+h0wZE3jGxYDCPLJ7Mw7dOYt2+Y5RsreSlHUco2VbJoMwI86YU8KHpI5g7KV8FW5Jxd0rLqrnx8jwGZOrfTiRMEtGTNgvY4+57AczsGWAp0L5IWwp8NXb718APLKClleeLNC0cEHmvtDTj+gm5XD8hl3+5/QrW7T3GijereGlHNb/bVsnAzAjzJuez+IpCZk/MZXB2RtCR5QJ2HmngcF0jn59/edBRRKSDRBRpRcChdvcrgGu7usbdW8ysHhgee268mW0BTgL/5O5rO/siZnYfcB/AmDFjehy2KrZXVKF60kTeV0YkjZuK87ipOI9/WdrGur3HWbG9ipe2H+GFN6rIiBgfvGw4C6YUMH9KPqMuGRh0ZOnEyrJqzGDeZM1HEwmbRBRpnfWIdTztuatrqoAx7n7MzK4Bfmtm09z95Hsudn8ceBxg5syZPT5Nuqq+iZysdPUAiFyE9EgaNxbncmNxLo8umcbmg3W8XF5NaXk1XynZwVdKdjB5xOA/F2xXjhqmVYQhUVpezYzRw8gbrJW7ImGTiCKtAhjd7v4ooLKLayrMLB0YChx3dwfOArj7JjN7G5gIbOyrsOc3shWRnkmPpDFr/KXMGn8py26bwr6jp6MFW1k1P37lbX6weg+5OZnMnpjHnIl5zC7O45JBmUHHTklH6pt4o6KeL946KegoItKJRBRpG4BiMxsPHAbuAj7W4ZoS4B7gT8AdwCp3dzPLI1qstZrZZUAxsLcvw1bVN2n7DZE4Gp876M+rROvONLNmVy2rd9WwemcNz28+jBmsWzafgiH6cJRoL++MHqi+UFtviIRSnxdpsTlmDwAvEd2C40l332FmjwIb3b0E+CnwlJntAY4TLeQAZgOPmlkL0Arc7+7H+zJvZV0TU0YM6csvIZKyhg3M5Parirj9qiJa25w3D9ez+cAJFWgBWVlWzdjhAynOzwk6ioh0IiH7pLn7CmBFh8e+3O52E/DRTl73HPBcnweMOdvSytFTZykcpl8YIn0tkmbMGD2MGaN1DFEQTp9t4bW3j/GJD47VOcUiIaUTlNupOXkWgJFDNdwpIv3b2t1HaW5pY8EUDXWKhJWKtHYqz2+/oZ40EekhM1tkZrvMbI+ZPdLJ87PNbLOZtZjZHUFkhOgpA0MHZDBz3CVBRRCRC1CR1s75jWy1ulNEeqLdCSuLganA3WY2tcNlB4FPAv+d2HTvaG1zVu2s4eZJeWRE9GtAJKx0wHo77xRpGu4UkR654Akr7r4/9lxbEAEBthw8wfHTzTpQXSTk9BGqnar6RgZnpzMoS7WriPRIZyesFPX0zczsPjPbaGYba2trex3uvNKyajIixuyJeXF7TxGJPxVp7VTWNVGkPdJEpOe6c8JKt7n74+4+091n5uXFr6AqLa/mg5cNZ4hOVhEJNRVp7ei0ARHppe6csBKot2tPsbf2tDawFUkCKtLaqaxr1GkDItIbfz5hxcwyiW7MXRJwpncpLYueMjBfW2+IhJ6KtJjG5lZOnDnHSPWkiUgPuXsLcP6ElXLg2fMnrJjZEgAz+4CZVRDdwPsnZrYjkRlLy6qZNnKIpnaIJAHNkI+pqo/ukTZSDZeI9EI3TljZQHQYNOFqG86y+eAJHpxfHMSXF5GLpJ60GG2/ISL93aqd1bjrQHWRZKEiLeZw3fmeNA13ikj/VFpWTdGwAUwtHBJ0FBHpBhVpMVV10Z60EZqTJiL90JnmFtbuPsrCqQU6UF0kSahIi6mqbyQ3J4us9EjQUURE4m7t7qOcbWnTUKdIElGRFlNZ36ShThHpt1aWVTM4O51Z4y8NOoqIdJOKtJjKOm1kKyL90zsHqufrQHWRJKKfVsDdqapr1MpOEemXNh04wbHTzRrqFEkyKtKAo6eaOd3cytjhA4OOIiISdy++UUlWeho3T84POoqIXAQVacD+Y6cBGJ87KOAkIiLx1drmrNh+hJsn5ZOTpf3LRZKJijRgX62KNBHpnzbsP05tw1k+9BeFQUcRkYukIg3Yd+w06Wmms+xEpN954Y1KsjPSmD9FQ50iyUZFGrC7+hRjhw8kXaueRKQfaWlt4/fbjzB/cgEDMzXUKZJsUr4qcXe2HjrBjNGXBB1FRCSu1uyq5eipZpbMGBl0FBHpgZQv0sqrGjh6qplrxqpIE5H+Zfn6g+QNzmKeVnWKJKWUL9Ke3XiIzEgat00fEXQUEZG4qapvZPWuGv565ihtYCuSpFL6J7etzfndtkoWTM1n2MDMoOOIiMTN8vWHcODOmWOCjiIiPZTSRdqB42c4drqZ2cV5QUcREYmbpnOtPL3uAPMn5zNGm3SLJK2ULtLKq04CMG3k0ICTiIjET8nWSo6dbubvbhgfdBQR6YWULtLKKk8SSTOKC3KCjiIiEjdPv36AySMGc92E4UFHEZFeSOkibXdNA+OGDyQ7IxJ0FBGRuDhc18i2inqWzijCzIKOIyK9kJAizcwWmdkuM9tjZo908nyWmf0q9vzrZjau3XPLYo/vMrNb45nrxJlzDM/JiudbiogEalV5NQC3TisIOImI9FafF2lmFgF+CCwGpgJ3m9nUDpfdC5xw98uBbwPfiL12KnAXMA1YBPwo9n5xcbLxHEMHZMTr7UREArfpwAkKhmRxWZ6mcYgku0T0pM0C9rj7XndvBp4Blna4Zinw89jtXwPzLdpPvxR4xt3Puvs+YE/s/eKiXkWaiPQzWw/VceWoYUHHEJE4SMRhbkXAoXb3K4Bru7rG3VvMrB4YHnt8XYfXFnX2RczsPuA+gDFjurcv0B3XjGJiweBuXSsiEnZtbc6SK0cycYTaNZH+IBFFWmczV72b13TntdEH3R8HHgeYOXNmp9d09NAtk7pzmYhIt5nZIuC7QAR4wt2/3uH5LOAXwDXAMeBOd98fj6+dlmZ8Qe2aSL+RiOHOCmB0u/ujgMqurjGzdGAocLybrxURCYXezMEVEekoEUXaBqDYzMabWSbRhQAlHa4pAe6J3b4DWOXuHnv8rtjqz/FAMbA+AZlFRHqiN3NwRUTepc+HO2NzzB4AXiLa/f+ku+8ws0eBje5eAvwUeMrM9hDtQbsr9todZvYsUAa0AJ9199a+ziwi0kO9mYN7tOOb9WSurYj0H4mYk4a7rwBWdHjsy+1uNwEf7eK1jwGP9WlAEZH46M0c3Pc+2IO5tiLSf6T0iQMiInHWmzm4IiLvoiJNRCR+ejMHV0TkXRIy3Ckikgp6MwdXRKQjFWkiInHUmzm4IiLtabhTREREJISsP06FMLNa4EA3L8+lk6XvIafMiaHMiXMxuce6e15fhgkjtWuhpMyJkYyZIQ7tWr8s0i6GmW1095lB57gYypwYypw4yZo7rJLx+6nMiaHMiROP3BruFBEREQkhFWkiIiIiIaQiLbabd5JR5sRQ5sRJ1txhlYzfT2VODGVOnF7nTvk5aSIiIiJhpJ40ERERkRBSkSYiIiISQilbpJnZIjPbZWZ7zOyRoPN0h5k9aWY1ZrY96CzdZWajzWy1mZWb2Q4zezDoTBdiZtlmtt7MtsUyfy3oTN1lZhEz22JmLwSdpTvMbL+ZvWlmW81sY9B5kp3atcRQu5ZYqdyupeScNDOLAG8BC4EKooci3+3uZYEGuwAzmw2cAn7h7lcEnac7zKwQKHT3zWY2GNgE3B7m77WZGTDI3U+ZWQbwKvCgu68LONoFmdkXgJnAEHf/cNB5LsTM9gMz3T0ZN6oMFbVriaN2LbFSuV1L1Z60WcAed9/r7s3AM8DSgDNdkLv/geiBzEnD3avcfXPsdgNQDhQFm+r9edSp2N2M2J/Qf5oxs1HAh4Angs4igVC7liBq1xIn1du1VC3SioBD7e5XEPIfsP7AzMYBVwGvB5vkwmLd61uBGqDU3UOfGfgO8DDQFnSQi+DA/5nZJjO7L+gwSU7tWgDUrvW5lG7XUrVIs04eC/0nimRmZjnAc8A/uPvJoPNciLu3uvsMYBQwy8xCPQxjZh8Gatx9U9BZLtIN7n41sBj4bGzoS3pG7VqCqV3rW2rXUrdIqwBGt7s/CqgMKEu/F5v/8BzwtLs/H3Sei+HudcAaYFHAUS7kBmBJbC7EM8A8M/tlsJEuzN0rY3/XAL8hOmQnPaN2LYHUriVEyrdrqVqkbQCKzWy8mWUCdwElAWfql2KTVX8KlLv7fwSdpzvMLM/MhsVuDwAWADuDTfX+3H2Zu49y93FE/z+vcve/CTjW+zKzQbFJ15jZIOAWIGlW+IWQ2rUEUbuWGGrXUrRIc/cW4AHgJaITPp919x3BprowM1sO/AmYZGYVZnZv0Jm64QbgE0Q/AW2N/bkt6FAXUAisNrM3iP7iK3X3pFj6nWQKgFfNbBuwHnjR3X8fcKakpXYtodSuSVfi2q6l5BYcIiIiImGXkj1pIiIiImGnIk1EREQkhFSkiYiIiISQijQRERGREFKRJiIiIhJC6UEHELlYZjYceDl2dwTQCtTG7s+KnVsoIpI01K5JZ7QFhyQ1M/sqcMrdvxV0FhGReFC7JudpuFNEREQkhFSkiYiIiISQijQRERGREFKRJiIiIhJCKtJEREREQkhFmoiIiEgIaQsOERERkRBST5qIiIhICKlIExEREQkhFWkiIiIiIaQiTURERCSEVKSJiIiIhJCKNBEREZEQUpEmIiIiEkL/DwEqEa14S2XUAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;From these plots we can see there is no phase transition taking place - this is true for all 1d Ising models.&lt;/p&gt;
&lt;p&gt;We can also calculate the correlation function for the system. By following a similar line of logic as before we find:

$$ \langle \sigma_n \sigma_{n+r} \rangle = \prod_{i=0}^{r} tanh(\beta J_{n+i, n+i+1})$$
&lt;/p&gt;
&lt;p&gt;We can plot this as a function of $r$ starting at the first position:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code creates a plot displaying&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# The correlation function&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# For a 1d Ising Model with Gaussian interactions&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of points&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Instantiate interaction strength&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create holders for variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;corr_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix beta&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate correlations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tanh_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;corr_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tanh_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corr_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Correlation Function&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$\langle \sigma_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{1}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; \sigma_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{r}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; \rangle$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAEWCAYAAABfdFHAAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3deXxV9Z3/8dcnCTchCVtuQJBFtCIiLiAUd+u+tBa07TjadkqdWjqd2l2rjvOr1m62M1PbqbaVca1ataW2UqVV6lJtXUFZBFkiokBAwo4sWT+/P84JXMPNcsM9954k7+fD+8jZz+cm1/vh+z3f8znm7oiIiESlIN8BiIhI96ZEIyIikVKiERGRSCnRiIhIpJRoREQkUko0IiISKSUakQ4ys5VmdlYn9z3FzJZmO6a4MLNFZnZavuOQeFKikS7DzD5pZnPM7D0zW2tmfzazk/MdVzpm5mZ2aPO8uz/n7qMjOM/I8FzvpbzmZ/s8Lc55t5l9L3WZu49192eiPK90XUX5DkCkI8zsG8A1wL8BjwN1wHnAFODvGR6ryN0b2lvWxfTv4vFLN6YWjcSemfUDbgS+5O4Pu/sOd6939z+5+1XhNsVm9lMzqw5fPzWz4nDdaWa22syuNrN1wF3ploXbXmBm88xsi5k9b2ZHtxLTJDN7IdxurZndYmaJcN2z4WbzwxbGPzefL2X/MWb2TLj/IjObnLLubjO71cweM7PtZvaSmX2gE7+3G8zsvpT55tZPUTj/jJl918z+EZ7nCTOrTNn+5PB3sMXMVpnZZ81sGvAp4Fvhe/tTuO2ebsUO/i2+aWbrw9/dZZm+N+lalGikKzgBKAH+0MY21wHHA+OAY4BJwH+mrB8MVAAHAdPSLTOzY4E7gS8ASeA2YGbzl2QLjcDXgcowvjOBfwdw91PDbY5x93J3fyh1RzPrBfwJeAIYBHwZuN/MUrvWLgW+AwwAqoDvt/He98cngcvCOBLAlWGMI4A/Az8HBhL8Xue5+3TgfuDH4Xv7aJpjduRv0Q8YCnwOuNXMBmT/rUlcKNFIV5AENrTTNfQp4EZ3X+/uNQRf0v+Ssr4JuN7da919VyvLPg/c5u4vuXuju98D1BJ8ab6Pu8919xfdvcHdVxIkpQ918P0cD5QDN7l7nbs/BTxKkFyaPezuL4fv+X6CL+22bAhbHlvM7MoOxgFwl7svC9//b1PO8yngr+7+QNh63Oju8zp4zPb+FvXh+np3nwW8B2T9+pXEh67RSFewEahs5zrKgcDbKfNvh8ua1bj77hb7tFx2EDDVzL6csizR4jgAmNlhwE+AiUApwf9LczvyZsLjrXL3phbxDk2ZX5cyvZMgMbWlspPXaFo7z3DgzU4cD9r/W2xsEWtH3p90YWrRSFfwArAbuLCNbaoJEkWzEeGyZunKlLdctgr4vrv3T3mVuvsDafb9JbAEGOXufYH/AKyd95Ea63AzS/3/bwSwpoP7d9QOgiTYbHAG+64CWrsu1F7J9/b+FtLDKNFI7Ln7VuDbBH35F5pZqZn1MrPzzezH4WYPAP9pZgPDC9rfBu5r7Zit+D/g38zsOAuUmdlHzKxPmm37ANuA98zscOCLLda/CxzSynleIkgC3wrfx2nAR4EHM4y3PfOAU81sRDig4toM9r0fOMvMLjazIjNLmllzt1pb7w2y87eQbkSJRroEd/8J8A2Ci8o1BP/ivgL4Y7jJ94A5wAJgIfBquCyTc8whuE5zC7CZ4CL8Z1vZ/EqCC+nbCRLUQy3W3wDcE14zubjFeeqAycD5wAbgF8Bn3H1JJvG2x91nh3EtIOjWezSDfd8BPgx8E9hEkLSOCVffARwRvrc/ptl9v/8W0r2YHnwmIiJRUotGREQiFatEY2Z3hjdxvd7KejOz/zWzKjNbEN730LxuqpktD19Tcxe1iIi0JVaJBriboKxIa84HRoWvaQQjfzCzCuB64DiCm8Ou1w1gIiLxEKtE4+7PElx4bM0U4NceeBHob2ZDgHOB2e6+yd03A7NpO2GJiEiOdLUbNocSjDZqtjpc1tryfYS1mqYBlJSWTxg7Rjcki4h01Ny5cze4+8BM9ulqiSbdDXHexvJ9Fwa1mqYDjBh9lM+ZMyd70YmIdHNm9nb7W71frLrOOmA1QWmMZsMI7jhubXmbGps0tFtEJGpdLdHMBD4Tjj47Htjq7msJnk9yjpkNCAcBnBMua1NDY1N7m4iIyH6KVdeZmT0AnEZQQHE1wUiyXgDu/itgFsHdylUEhfguC9dtMrPvAq+Eh7rR3dsaVABAg1o0IiKR69GVAfoNP9y3rspq1Q8RkW7NzOa6+8RM9ulqXWdZ1dCkrjMRkaj18ETjNKn7TEQkUj060QBs3VWf7xBERLq1Hp9oNu6ozXcIIiLdWo9PNBveq8t3CCIi3VqPTzQblWhERCKlRKOuMxGRSPX4RKOuMxGRaPXoRFNYYGx8Ty0aEZEo9ehEU1RgukYjIhKxHp5oCnSNRkQkYj070RSqRSMiErWenWgKjA26RiMiEqmenWgKC9i2u4G6BhXXFBGJSs9ONAXBE6A37VD3mYhIVJRoQN1nIiIR6tmJpjBINBvVohERiUyPTjSFBcHb36QhziIikYlVojGz88xsqZlVmdk1adbfbGbzwtcyM9uSsq4xZd3MjpxvT4tGQ5xFRCJTlO8AmplZIXArcDawGnjFzGa6++Lmbdz96ynbfxkYn3KIXe4+LpNzFpqRKCxQvTMRkQjFqUUzCahy9xXuXgc8CExpY/tLgQf296TJ8oTqnYmIRChOiWYosCplfnW4bB9mdhBwMPBUyuISM5tjZi+a2YUdPWmyPKHBACIiEYpN1xlgaZZ5K9teAsxw98aUZSPcvdrMDgGeMrOF7v7mPicxmwZMAxgxYgRjy4rVohERiVCcWjSrgeEp88OA6la2vYQW3WbuXh3+XAE8w/uv36RuN93dJ7r7xIEDB5IsT+gajYhIhOKUaF4BRpnZwWaWIEgm+4weM7PRwADghZRlA8ysOJyuBE4CFrfcN53K8mI27qjFvbXGk4iI7I/YdJ25e4OZXQE8DhQCd7r7IjO7EZjj7s1J51LgQX9/ZhgD3GZmTQTJ86bU0WptSZYl2F3fxM66RsqKY/PrEBHpNmL1zerus4BZLZZ9u8X8DWn2ex44qjPnrChLAMG9NEo0IiLZF6eus7yoLC8GYIOqA4iIRKLHJ5pk+d4WjYiIZJ8STdii0RBnEZFoKNE0X6PRTZsiIpHo8YmmpFch5cVFeiaNiEhEenyigeZ6Z2rRiIhEQYmGoPtso0adiYhEQomGYECAWjQiItFQogEqVe9MRCQySjRAsqyYTTtqaWpSvTMRkWxToiEYDNDksGVXfb5DERHpdpRo0E2bIiJRUqIBKnXTpohIZJRoSG3RKNGIiGSbEg0phTV1L42ISNYp0QADShOYoSHOIiIRUKIBCguMitKEBgOIiERAiSakemciItFQogkly4p1jUZEJAKxSjRmdp6ZLTWzKjO7Js36z5pZjZnNC1+Xp6ybambLw9fUTM+tFo2ISDSK8h1AMzMrBG4FzgZWA6+Y2Ux3X9xi04fc/YoW+1YA1wMTAQfmhvtu7uj5K8uL9UwaEZEIxKlFMwmocvcV7l4HPAhM6eC+5wKz3X1TmFxmA+dlcvKKsgTbdjdQ19CUUdAiItK2OCWaocCqlPnV4bKWPm5mC8xshpkNz3BfzGyamc0xszk1NTV7ljffS7NJ1QFERLIqTonG0ixrWU75T8BIdz8a+CtwTwb7Bgvdp7v7RHefOHDgwD3Lk2VBdQB1n4mIZFecEs1qYHjK/DCgOnUDd9/o7s2Z4P+ACR3dtz2V5ap3JiIShTglmleAUWZ2sJklgEuAmakbmNmQlNnJwBvh9OPAOWY2wMwGAOeEyzpMFZxFRKIRm1Fn7t5gZlcQJIhC4E53X2RmNwJz3H0m8BUzmww0AJuAz4b7bjKz7xIkK4Ab3X1TJuffU+9MQ5xFRLIqNokGwN1nAbNaLPt2yvS1wLWt7HsncGdnz92nuIhEYQEbdNOmiEhWxanrLK/MTDdtiohEQIkmRZBo1KIREckmJZoUQb0ztWhERLJJiSaFus5ERLJPiSZFc70z97T3eoqISCco0aRIliWobWhiR11jvkMREek2lGhS6KZNEZHsU6JJkVQZGhGRrFOiSVFZ1tyiUaIREckWJZoUe8vQqOtMRCRblGhSVJSp60xEJNuUaFKU9CqkT3GRnkkjIpJFSjQt6KZNEZHsUqJpIVlezEZVcBYRyRolmhaSZWrRiIhkkxJNC8nyBBuUaEREskaJpoVkWTGbdtTS1KR6ZyIi2aBE00KyPEGTw5Zd9fkORUSkW4hVojGz88xsqZlVmdk1adZ/w8wWm9kCM3vSzA5KWddoZvPC18zOxqB6ZyIi2RWbRGNmhcCtwPnAEcClZnZEi81eAya6+9HADODHKet2ufu48DW5s3FUhjdt6jqNiEh2xCbRAJOAKndf4e51wIPAlNQN3P1pd98Zzr4IDMt2EHtaNBriLCKSFXFKNEOBVSnzq8Nlrfkc8OeU+RIzm2NmL5rZha3tZGbTwu3m1NTU7LN+b70ztWhERLKhKN8BpLA0y9IO/TKzTwMTgQ+lLB7h7tVmdgjwlJktdPc39zmg+3RgOsDEiRP3Of6A0gRmukYjIpItcWrRrAaGp8wPA6pbbmRmZwHXAZPdfU82cPfq8OcK4BlgfGeCKCwwKkoTbFBhTRGRrIhTonkFGGVmB5tZArgEeN/oMTMbD9xGkGTWpywfYGbF4XQlcBKwuLOBBPXO1KIREcmG2HSduXuDmV0BPA4UAne6+yIzuxGY4+4zgf8CyoHfmRnAO+EIszHAbWbWRJA8b3L3zieasmJdoxERyZLYJBoAd58FzGqx7Nsp02e1st/zwFHZiiNZnmBR9bZsHU5EpEeLU9dZbFSWF+uZNCIiWaJEk0ayLMH23Q3UNjTmOxQRkS5PiSaN5ps2N+9QvTMRkf2lRJNG802bPaX7rKGxKd8hiEg3pkSTRmVzdYAecC/NknXbOPa7s/n93NX5DkVEuiklmjSSZT2ngvPPn6pi2+4Gbpi5iOotu/Idjoh0Q0o0afSUemdV699j1sK1XDjuQBrdufr3C3DXA99EJLuUaNIoLy4iUVTAhm5ewfkXz1RRXFTA/7vgCK798BieW76BB19Z1f6OIiIZUKJJw8yoLEt06xbNOxt38si8aj513EEky4v51KQRnPiBJN9/7A1Wb97Z/gFERDpIiaYVyfLibn2N5pd/e5NCM6adeggABQXGjz5+NO7ONb9fqC40EcmaDiWasGjlZ8zsD2a2yMweNbPPm9kBUQeYL8nyRLcddbZ26y5mzF3FxR8cxgF9S/YsH15Ryn98ZAx/r9rAb15+J48Rikh30m6iMbOHgYeBQcDV7j4W+HegBLjXzJ6JNMI8qejGXWe3/W0F7vCFUz+wz7pPThrByYdW8oPH3mDVJnWhicj+60iL5l/d/XR3/293XxYuq3X3n7v7OUCrT7PsyprrnXW3LqSa7bU88PI7XDR+KMMrSvdZb2bc9PGjMDOu/v0Cmpq6xvt3d/742hoWrN6S71BEpIV2E427p/s/d2o767u8ZFmC2oYmdtR1r3pnt/99BfWNTXzxtH1bM82GDSjluo+M4fk3N3J/F+hCa2pybnx0MV97aB4X3voPfjDrDXbXd6+/m0hX1tnBAFPM7AozG53VaGKkud5ZdxoQsHlHHfe98DYXHH0ghwwsb3PbSz44nFNGVfLDWfHuQmtsCu7/uesfK/nsiSP55w+OYPqzKzj/Z8/xyspN+Q5PROh8ovkYUAVcZGa3ZzGe2Nhb76z7XKe56/mV7Khr5EunH9rutmbBKLRCM66aMT+WXWh1DU185YHX+N3c1Xz1zFFc/9Ej+OHHjuL+y4+jvrGJi297gRtmLmJHbUO+QxXp0TqcaMzs+uZpd3/X3f/i7je5++XRhJZfld2sDM223fXc/Y+3OHfsAYwe3KdD+xzYvzf/ecEYXlyxiXtffDviCDOzq66RaffO4bGFa7nuw2P4+tmHET51lZMOreTxr53K1BNGcvfzKznvZ8/yfNWGPEcs0nNl0qK53sx+ZGb/Z2ZfNLMBkUUVA8luVljz3hfeZtvuBq44fVRG+108cTgfOmwgN/15CW9v3BFRdJnZvrueqXe9zN+W1fDDjx3F58N7gVKVFRdxw+Sx/PYLJ1BUUMAnb3+Jax9eyLbdevSDSK5lkmgc2A08DgwHnjezY7IZjJmdZ2ZLzazKzK5Js77YzB4K179kZiNT1l0bLl9qZufubywVZc31zrp+i2ZnXQN3/P0tThs9kKOG9cto3+ZRaEWFxlUz8j8KbfOOOj51+0u8+vZmfnbJeC6dNKLN7ScdXMGsr5zCtFMP4aFX3uHcm5/l6aXrcxRtZtydpeu2c/tzK/jfJ5fz+KJ1vLNxZ95/5yL7qyiDbZe4e3P32Qwzuxv4FXBGNgIxs0LgVuBsYDXwipnNdPfFKZt9Dtjs7oea2SXAj4B/NrMjgEuAscCBwF/N7DB37/TQo5JehfQpLuoW12h+89I7bNpRx5fPaP/aTDpD+vXm2xccwVUzFnDPCyu57KSDsxtgB63ftptP3/ESKzfu5LZ/mcCZYzp2v3DvRCH/8eExnH/kYL41YwGX3fUKHz92GP/vgjH0L01EHHXbNrxXyz+qNvDssg08t7yG9dv3/YdNWaKQ0YP7cPiQvowZ0pcxg/tw2OA+9C3plYeIRTKXSaLZYGYT3H0ugLsvM7OBWYxlElDl7isAzOxBYAqQmmimADeE0zOAWyzomJ8CPOjutcBbZlYVHu+F/QmoO1QH2F3fyPRnV3DCIUkmHFTR6eN8YsIw/vz6On70lyWcNnoQB1eWZTHK9q3atJNP3/ESNdtrufuyD3LiByozPsb4EQN49Csn8/Mnq/jl397k2eU1fO/CIzl37OAIIk6vtqGRuW9v5rnlQWJ5fc02APqX9uLkQys5ddRATh5VSb/evVj27naWrNvOkrXbeGPddh6dX81vXto73HzYgN4cPrgvY4b04fDBfTl8SB9GJssoLLBWz+/u7KhrZPOOOrbsrGfLrjo276xny85gfnPKz2276mmtLZXuDM3XyFpuV2CGGRQW2D7TBRbsV2hGQUEwXWBGoTXvFxzTccL/cPfwZzDf5M3rPFiWMt2yMdgcoqVdZu+fb7E87ZvOpSw1bD8xYRinHz4oOwfroEwSzVeAB81sLrAQOBp4K4uxDAVSSwevBo5rbRt3bzCzrUAyXP5ii32HpjuJmU0DpgGMGNF2t0t3qHf2u7mrWb+9lp9eMm6/jmNm/OCiozjn5r/xrRnzeWjaCRS08YWWTVXr3+PTt7/ErvpG7r/8OMaP6PzlweKiQq48dzTnHTmYq2Ys4Av3zuWjxxzIDR89Ys+Q9mxyd96s2cFzy2t4bvkGXlyxkZ11jRQVGMeOGMCV5xzGKaMGcuTQfvskiPEjBrzvvbo7a7fuZsm6bbyxdm8SenrpehrDb9TiogIOO6APowf3ocBg8856toaJY/POerbuqqO+sfVvrPLiIvqX9mJAaYK+vYsoSJM80r/P9MubPPjCb3SnvrGJJg+GpLs7TR6sD+aD6aaU5U3uNKU8/NUsfGHhzyAZEU6bWfgzZRvbkyb2fE+nuwm7eZGHW+2db32ffEiXzDO1eWfu//Hc4UTj7vPNbBxwFnAk8DTwQBZjSfcbbPnXbW2bjuwbLHSfDkwHmDhxYpufnmRZgrc3xvcekvbUNzbxq2feZMJBAzjhkOR+H29wvxKu/+hYvvm7+dz1/Eo+d3L0XWivr9nK1Dtfxsx4cNrxjBnSNyvHPXJoP2ZecRK/fOZNfv7Ucv5RtYHvTB7LBUcP2e//mbfsrOMfVRv3JJc14QPlRiZL+cSEYZwyaiDHH1JBnwy7vsyMA/v35sD+vTnj8L3dhrvrG6la/x5L1m1n6bptLFm3nWeX1WAGA0oT9Ovdiw8MLGdAWS/6lybo3ztIJP1Lg/kB4c/+pb3oVag6u5J9mbRoCLumHgtfAJjZ1e7+oyzEsppgkEGzYUB1K9usNrMioB+wqYP7ZixZXsyr72ze38PkzR9eW8OaLbv43kVHZuVfQgAfO3Yof359LT/+yxJOHz2w3Rs/98eclZu47O5X6FNcxH2XH5f1c/UqLOArZ47i3LGD+daM+Xz5gdf442trGHVAH+oamqhrbKS2vom6xqZgviGYrm3YO1/b0Pj+9Q1N7KxvxB36FBdx4qFJ/v30D3DKoQMZkdy35E82lPQq5Mih/ThyaGYDPURyJaNEA2Bmv02dBcYRXJTfX68Ao8zsYGANwcX9T7bYZiZB+ZsXgE8AT7m7m9lM4Ddm9hOCwQCjgJf3N6DK8gSbdtTR1OQ56ybKlsYm5xdPV3Hk0L6cdlj2LqU1d6GdffOzXDVjAb/9wgltXhPorOeW1zDt13MZ3K+E+y4/jqH9e2f9HM1GD+7D7794Inf8/S3+98nlPLd8A4miguBVGPwsbp4Pl/UpKaK4qIDiosL3bZcoKqB/716ceGiSY4b1p0gtBJHMEw2wLfUmTTP7ZTYCCa+5XEEwfLoQuNPdF5nZjcAcd58J3EFQMbqKoCVzSbjvojABLgYagC/tz4izZsmyBE0OW3bV7xnu3FU8uqCalRt38qtPT8haa6bZoL4l3DD5CL7+0Hzu/Ptbae9j2R+PL1rHl3/zGocMLOPezx3HwD7Zv3bSUlFhAV/40Af4wodarwEnIp3TmUTz/Rbz12UjEAB3nwXMarHs2ynTu4F/amXf76eJbb+k1jvrSommqcm59ekqDjugnHOOiOaRQReOG8qshev47yeWcvrhgzh0UHa6tf7w2mqu/N0Cjhraj3sum0S/Ug3hFenqMi5B4+7vG2nm7t22cmFXrXf2xOJ3Wfbue3zp9EMj6/IzM75/0ZH0ThRy1Yz5e0Y97Y97X3ybrz80n0kjK7jv8uOUZES6iUxaNNebWSlQAbxKcN9K171S3gGVzS2aHV1niLO7c8vTyzm4sowLjj4w0nMN6lPCdyaP5asPzuPWp6u44Ogh7K5vYld9I7X1jexuaGRXXRO7w+nd9eF0+NpVv3fZtt0NPLushrPGDOKWTx5LSa/CSGMXkdzJJNGklqA5lqAEzSXuPj+SyGIguacMTddp0TyzLLgJ8MefODqSi/QtTT7mQGYtXMtPZi/jJ7OXtb8DwX0OJUWF9E4UUlJUQEmvQkp6FfLZE0dy3UfGaIitSDcTmxI0cdS/NEGBdZ16Z+7Oz59cztD+vblofNr7VbPOzPjJxeN4YvE6DKOkVwHFvQrpHSaPkl4Fe6eLCilJBCO0sj1AQUTiK04laGKnsMCoKEuwoYuUoXlhxUZefWcL373wyJy2CsqKi7ho/LCcnU9Eupb9KUFzDNktQRNLybKuU4bmlqeqGNSnmH+aoC99EYmPdv/Za2YFEJSgIbg5s7nszFPAJc3ru6uKskSXuEYz9+1NPP/mRqadeogupItIrHQkScwOnwFzKVDs7o8BPwc2A7cBc6MMMN+6SgXnW56qoqIswSePa7tQqIhIrrXbdebuZ4bPe5kCPGZmvQhGoD0O3Ozur0YcY15VlhezIeZdZ6+v2crTS2u46tzRlCY6cw+uiEh0OvStFD58bDHwQzMrCe/Q7xGSZQm2726gtqGR4qJ4dknd8lQVfUuK+MwJB+U7FBGRfWR8faUnJRnYW4ZmU0y7z5a9u52/LFrHZ086OOOy8yIiudCtL+RnQ3MZmrgOCLj16SrKEoVcduLIfIciIpKWEk07KvfUO4vfdZpNO+p4bMFaLpk0ggFdqOiniPQsSjTtSJY1V3COX4tm1sK1NDQ5Hz9W982ISHwp0bRjT9dZDAtrzpxXzahB5YwZ0iffoYiItEqJph3lxUUkigpi16JZs2UXL6/cxJRxB6pumIjEmhJNO8yMyrJE7J5J86f51QBMPiY3xTNFRDpLiaYDkuXFses6e2ReNeNH9GdEsjTfoYiItCkWicbMKsxstpktD38OSLPNODN7wcwWmdkCM/vnlHV3m9lbZjYvfI3LZnzJ8njVO1v27nbeWLuNKcdE+2AzEZFsiEWiAa4BnnT3UcCT4XxLO4HPuPtY4Dzgp2bWP2X9Ve4+LnzNy2ZwcavgPHNeNQUGH4n4CZoiItkQl0QzBbgnnL4HuLDlBu6+zN2Xh9PVwHogJ8/DqQwLa7p7Lk7XJnfnkflrOOnQSgb2Kc53OCIi7YpLojnA3dcChD8HtbWxmU0CEsCbKYu/H3ap3WxmrX4Dm9k0M5tjZnNqamo6FFyyPEFtQxM76ho7tH2UXlu1hVWbdjFlnAYBiEjXkLNEY2Z/NbPX07ymZHicIcC9wGXu3hQuvhY4HPggUAFc3dr+7j7d3Se6+8SBAzvWINp702b+u89mzqsmUVTAuWMPyHcoIiIdkrOa8u5+VmvrzOxdMxvi7mvDRLK+le36Ao8B/+nuL6Yce204WWtmdwFXZjH0PTdtbnivjoOSZdk8dEYaGpt4dEE1Z40ZpAKaItJlxKXrbCYwNZyeCjzScgMzSwB/AH7t7r9rsW5I+NMIru+8ns3gKsvj0aJ5/s2NbHivTvfOiEiXEpdEcxNwtpktB84O5zGziWZ2e7jNxcCpwGfTDGO+38wWAguBSuB72Qxubxma/A5xfmReNX1KijhtdE7GQIiIZEUsHsfo7huBM9MsnwNcHk7fB9zXyv5nRBlfRVnzowLy16LZXd/I44vW8eGjBlPSK54PYBMRSScuLZpYKy4qpE9JUV7L0Dy1ZD3v1TZotJmIdDlKNB2ULEvktevskXlrGNinmOMPSeYtBhGRzlCi6aBkef6qA2zdVc/TS2r46NEHUligSs0i0rUo0XRQsix/9c4ef30ddY1NTBmnkjMi0vUo0XRQPis4PzJ/DSOTpRw9rF9ezi8isj+UaDqosjzBph11NDbltt7Z+m27ef7NjUweN1QPOBORLkmJpoOSZQmaHLbszG332Z8WrMUdJuuRACLSRSnRdFCyuTpAjkeezZy3hiOH9uXQQeU5Pa+ISLYo0XTQ3npnubtO865bLJwAAA6ASURBVNaGHcxfvVWtGRHp0pRoOmhvvbPctWhmzqvGDD6qRCMiXZgSTQclc1yGpvkBZ5NGVjCkX++cnFNEJApKNB3UvzRBgeXuGs2i6m2sqNmhkjMi0uUp0XRQYYFRUZbIWb2zR+atoVehcf6Rg3NyPhGRqCjRZCBZlpsyNI1Nzsz51XzosIEMCLvsRES6KiWaDCTLc1NY8+W3NvHutlomq9tMRLoBJZoMJMuL2ZSDRDNz/hpKE4WcNWZQ5OcSEYmaEk0GkmWJyO+jqWtoYtbCdZxzxAGUJmLxXDoRkf2iRJOByvIE23c3UNvQGNk5nl1Ww9Zd9RptJiLdRiwSjZlVmNlsM1se/hzQynaNZjYvfM1MWX6wmb0U7v+QmUVyBb25DE2U3WePzK9mQGkvTh5VGdk5RERyKRaJBrgGeNLdRwFPhvPp7HL3ceFrcsryHwE3h/tvBj4XRZB7b9qMJtHsqG1g9uJ1fOToIfQqjMufRkRk/8Tl22wKcE84fQ9wYUd3tKB2/hnAjM7sn4nmFk1U12lmL36X3fVN6jYTkW4lLonmAHdfCxD+bG24VYmZzTGzF82sOZkkgS3u3hDOrwZa/aY2s2nhMebU1NRkFGRlebQtmkfmrWFo/95MGJG251BEpEvK2bAmM/srkO429+syOMwId682s0OAp8xsIbAtzXatPp3M3acD0wEmTpyY0VPM9j4qIPstmo3v1fLs8g18/pRDKCjQA85EpPvIWaJx97NaW2dm75rZEHdfa2ZDgPWtHKM6/LnCzJ4BxgO/B/qbWVHYqhkGVGf9DQBliUKKiwoiadHMen0djU3OlHGq1Cwi3Utcus5mAlPD6anAIy03MLMBZlYcTlcCJwGL3d2Bp4FPtLV/NphZeC9N9hPNzHlrOOyAcg4f3CfrxxYRyae4JJqbgLPNbDlwdjiPmU00s9vDbcYAc8xsPkFiucndF4frrga+YWZVBNds7ogq0GR5cda7zlZv3skrKzczZdxQgrENIiLdRyxuPXf3jcCZaZbPAS4Pp58Hjmpl/xXApChjbJYsT2S96+xP89cC6EmaItItxaVF02VEUcH5kXlrOHZEf4ZXlGb1uCIicaBEk6HK8gQbdtQRXBraf0vXbWfJuu26d0ZEui0lmgwlyxPUNTTxXm1D+xt3wMz5aygsMD581JCsHE9EJG6UaDKULAvvpcnCdRp355F51Zx0aCUD+xTv9/FEROJIiSZDyebqAFkYefbqO1tYvXkXUzQIQES6MSWaDFXuqXe2/y2ae19YSXFRAeeMPWC/jyUiEldKNBlKZqne2f0vvc0f51Vz+SkH06ekVzZCExGJJSWaDFXseVRA57vOXlm5iesfWcRpowfyjbNHZys0EZFYUqLJUHFRIX1KitjYyYefVW/ZxRfvm8vwilJ+dsl4ClVAU0S6uVhUBuhqKsuLO/VMmt31jXzh3rnsrm/iwWkT6NdbXWYi0v0p0XRCsiyR8eOc3Z1rH17IwjVb+b/PTOTQQSqeKSI9g7rOOqEz9c7u+Ptb/OG1NXzj7MM4+wiNMhORnkOJphMyreD83PIafjDrDc4bO5grTj80wshEROJHiaYTKsOus8am9uudvb1xB1f85jVGDerD/1x8jJ6eKSI9jhJNJyTLi2ly2LKz7e6zHbUNTPv1XACmf2YCZcW6JCYiPY8STSfsLUPTeqJxd7752/ksX7+dWz45noOSZbkKT0QkVpRoOqG5sGZbQ5xveaqKvyxax7Xnj+GUUQNzFZqISOwo0XRCZTtlaP66+F3+Z/YyLho/lMtPOTiXoYmIxE4sEo2ZVZjZbDNbHv4ckGab081sXsprt5ldGK6728zeSlk3Lsp4k+XNjwrYt0VTtX47X3toHkcN7ccPP3YUZrr4LyI9WywSDXAN8KS7jwKeDOffx92fdvdx7j4OOAPYCTyRsslVzevdfV6Uwfbv3YsC2/cazdZd9Xz+13Mp6VXAbf8ygZJehVGGISLSJcQl0UwB7gmn7wEubGf7TwB/dvedkUbVioICo6Is8b5HBTQ2OV998DVWbdrJLz41gQP7985HaCIisROXRHOAu68FCH8Oamf7S4AHWiz7vpktMLObzSzyx1Umy4rf13X2308s5ZmlNdwweSyTDq6I+vQiIl1Gzm7sMLO/AoPTrLouw+MMAY4CHk9ZfC2wDkgA04GrgRtb2X8aMA1gxIgRmZz6fZLliT1dZ3+aX80vn3mTSyeN4NPHH9TpY4qIdEc5SzTuflZr68zsXTMb4u5rw0Syvo1DXQz8wd3rU469NpysNbO7gCvbiGM6QTJi4sSJ7d/a34pkeTELV29hUfVWrpoxn4kHDeA7k8d29nAiIt1WXLrOZgJTw+mpwCNtbHspLbrNwuSEBUO8LgRejyDG90mWJXh3Wy3Tfj2X/r0T/OLTx5IoisuvU0QkPuLyzXgTcLaZLQfODucxs4lmdnvzRmY2EhgO/K3F/veb2UJgIVAJfC/qgCvLE+yqb6TmvVpu+5cJDOpTEvUpRUS6pFgU33L3jcCZaZbPAS5PmV8JDE2z3RlRxpfO0AHBqLIfXnQUxwzvn+vTi4h0GbFINF3RBUcfyJghfTl8cN98hyIiEmtx6TrrcnoVFijJiIh0gBKNiIhESolGREQipUQjIiKRUqIREZFIKdGIiEiklGhERCRSSjQiIhIpJRoREYmUEo2IiERKiUZERCKlRCMiIpFSohERkUgp0YiISKSUaEREJFJKNCIiEiklGhERiZQSjYiIRCoWicbM/snMFplZk5lNbGO788xsqZlVmdk1KcsPNrOXzGy5mT1kZoncRC4iIu2JRaIBXgc+Bjzb2gZmVgjcCpwPHAFcamZHhKt/BNzs7qOAzcDnog1XREQ6KhaJxt3fcPel7Ww2Cahy9xXuXgc8CEwxMwPOAGaE290DXBhdtCIikomifAeQgaHAqpT51cBxQBLY4u4NKcuHtnYQM5sGTAtna83s9QhizUQlsCHPMUA84ohDDBCPOOIQA8QjDsWwVxziGJ3pDjlLNGb2V2BwmlXXufsjHTlEmmXexvK03H06MD2MaY67t3pNKBfiEENc4ohDDHGJIw4xxCUOxRCvOMxsTqb75CzRuPtZ+3mI1cDwlPlhQDVBdu9vZkVhq6Z5uYiIxEAsrtF00CvAqHCEWQK4BJjp7g48DXwi3G4q0JEWkoiI5EAsEo2ZXWRmq4ETgMfM7PFw+YFmNgsgbK1cATwOvAH81t0XhYe4GviGmVURXLO5o4Onnp7Ft9FZcYgB4hFHHGKAeMQRhxggHnEohr3iEEfGMVjQIBAREYlGLFo0IiLSfSnRiIhIpHpkommtlE2OYxhuZk+b2Rth+Z2v5iOOMJZCM3vNzB7NYwz9zWyGmS0Jfycn5CGGr4d/i9fN7AEzK8nRee80s/Wp93SZWYWZzQ7LKs02swF5iOG/wr/HAjP7g5n1jzKG1uJIWXelmbmZVeYjBjP7cvi9scjMfhxlDK3FYWbjzOxFM5tnZnPMbFLEMaT9nsr089njEk07pWxyqQH4pruPAY4HvpSnOAC+SjDAIp9+BvzF3Q8Hjsl1PGY2FPgKMNHdjwQKCUY25sLdwHktll0DPBmWVXoynM91DLOBI939aGAZcG3EMbQWB2Y2HDgbeCcfMZjZ6cAU4Gh3Hwv8dz7iAH4MfMfdxwHfDuej1Nr3VEafzx6XaGillE2ug3D3te7+aji9neCLtdWKBlExs2HAR4Dbc33ulBj6AqcSjhZ09zp335KHUIqA3mZWBJSSo/ux3P1ZYFOLxVMIyilBDsoqpYvB3Z9IqbjxIsE9apFq5XcBcDPwLdq4GTviGL4I3OTuteE26/MUhwN9w+l+RPwZbeN7KqPPZ09MNOlK2eT8Cz6VmY0ExgMv5eH0PyX4H7gpD+dudghQA9wVduHdbmZluQzA3dcQ/Cv1HWAtsNXdn8hlDC0c4O5rw9jWAoPyGAvAvwJ/zseJzWwysMbd5+fj/KHDgFPCKvF/M7MP5imOrwH/ZWarCD6vuWhlAvt8T2X0+eyJiSajkjVRM7Ny4PfA19x9W47PfQGw3t3n5vK8aRQBxwK/dPfxwA6i7yp6n7CPeQpwMHAgUGZmn85lDHFlZtcRdKHcn4dzlwLXEXQT5VMRMICg++gq4LdhQd9c+yLwdXcfDnydjt8zuF/293uqJyaa1krZ5JyZ9SL4493v7g/nIYSTgMlmtpKgC/EMM7svD3GsBla7e3OLbgZB4smls4C33L3G3euBh4ETcxxDqnfNbAhA+DPyrpp0zGwqcAHwKc/PTXcfIEj+88PP6TDgVTNLVzcxSquBhz3wMkEPQKSDEloxleCzCfA7gksBkWrleyqjz2dPTDRpS9nkOojwX0N3AG+4+09yfX4Ad7/W3Ye5+0iC38NT7p7zf8W7+zpglZk1V4U9E1ic4zDeAY43s9Lwb3Mm+R0gMZPgSwXyVFbJzM4jqLox2d135vr8AO6+0N0HufvI8HO6Gjg2/Mzk0h8JHkeCmR0GJMhPFeVq4EPh9BnA8ihP1sb3VGafT3fvcS/gwwSjaN4kqB6djxhOJuiyWwDMC18fzuPv5DTg0TyefxwwJ/x9/BEYkIcYvgMsIXgQ371AcY7O+wDBdaF6gi/SzxGUUnqS4IvkSaAiDzFUEVzPbP58/iofv4sW61cClXn4XSSA+8LPxqvAGXn6XJwMzAXmE1wrmRBxDGm/pzL9fKoEjYiIRKondp2JiEgOKdGIiEiklGhERCRSSjQiIhIpJRoREYmUEo2IiERKiUYkxiyg/0+lS9MHWCRmzGxk+PyPXxDcHDi8vX1E4kw3bIrETFgldwVworu/mN9oRPafWjQi8fS2kox0F0o0IvG0I98BiGSLEo2IiERKiUZERCKlwQAiIhIptWhERCRSSjQiIhIpJRoREYmUEo2IiERKiUZERCKlRCMiIpFSohERkUj9f/0lbHUgW+6RAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see there is a specific &quot;structure&quot; to the correlation function given an instantiation - this is not particularly surprising. If we picked an alternate starting state (e.g. the 2nd site) this graph can look totally different, the decay in absolute value will be similar however. We also notice that the correlation decays to zero fairly rapidly suggesting there isn't a long range structure to the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;2d-Ising-Model&quot;&gt;2d Ising Model&lt;a class=&quot;anchor-link&quot; href=&quot;#2d-Ising-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now turn our attention to the 2d Ising model. The mathematics here will, understandably, get more complicated. We will require a bit more sophistication to solve this system. The solution was originally published by Lars Onsager in 1944, with alternative proofs and derivations published later. The derivation itself is fairly involved and would take a blog post (at least) by itself to cover - I may come back to this at a later date. For now I will simply present the result for the free energy (F) in absence of a magnetic field ($h=0$):

$$ - \frac{\beta}{N} F = ln2 + \frac{1}{8\pi^2} \int^{2\pi}_{0} \int^{2\pi}_{0} ln \left[ cosh(2 \beta J_H) cosh(2 \beta J_V) - sinh(2 \beta J_H)cos(\theta_1) - sinh(2 \beta J_V)cos(\theta_2) \right]d\theta_1 d\theta_2 $$

Where instead of $J_{xy}$ being sampled from a gaussian distribution we assume fixed interaction strengths $J_H$ and $J_V$ in the horizontal and vertical directions.&lt;/p&gt;
&lt;p&gt;For simplicity we will take: $J_H = J_V = J$ and we can derive the thermodynamic properties (per site - e.g. $f=\frac{F}{N}$) of this system as:
\begin{align}
f &amp;amp;= \frac{-ln2}{2\beta} - \frac{1}{2\pi\beta} I_0(\beta, J)  \\
u &amp;amp;= -J coth(2\beta J) \left[ 1 + \frac{2}{\pi} \left( 2tanh^2(2\beta J) -1 \right) I_1(\beta, J) \right]      \\
c &amp;amp;= 2J\beta^2 \left[U csch(2\beta J)sech(2\beta J) + \frac{8J}{\pi} sech^2(2\beta J) I_1(\beta, J) - \frac{2 \beta J}{\pi}(cosh(4\beta J)-3)^2 sech^6(2\beta J) I_2(\beta, J) \right]     \\
s &amp;amp;= \frac{U - F}{T}
\end{align}&lt;/p&gt;
&lt;p&gt;For convenience I created 3 new functions $I_0(\beta,J), I_1(\beta, J)$ and $I_2(\beta, J)$ to make the equations a little shorter. These functions are defined as:
\begin{align}
I_0(\beta, J) &amp;amp;= \int^\pi_0 ln \left[ cosh^2(2 \beta J) + sinh^2(2 \beta J) \sqrt{1 + csch^4(2 \beta J) - 2 csch^2(2 \beta J) cos(2\theta)} \right] d\theta \\
I_1(\beta, J) &amp;amp;= \int^{\frac{\pi}{2}}_0 \left[1 - 4csch^2(2\beta J)( 1 + csch^2(2\beta J))^{-2} sin^2(\theta) \right]^{-\frac{1}{2}} d\theta \\
I_2(\beta, J) &amp;amp;= \int^{\frac{\pi}{2}}_0 sin^2(\theta)\left[1 - 4csch^2(2\beta J)( 1 + csch^2(2\beta J))^{-2} sin^2(\theta) \right]^{-\frac{3}{2}} d\theta
\end{align}&lt;/p&gt;
&lt;p&gt;As before we can produce plots of these:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code creates a 4 figure plot showing how&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Thermodynamic variables change with temperature&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# For a 2d Ferromagnetic Ising Model with fixed interaction&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.integrate&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Instantiate interaction strength&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set temperature ranges&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up holders for variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;u&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up integrands for I0, I1, I2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrand0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrand1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrand2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrand1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop over T_steps and calculate at each step&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;I0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integrand0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;I1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integrand1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;I2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integrand2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create plots&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gridspec_kw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wspace&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Free Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;f&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;u&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Average Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;u&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Heat Capacity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Entropy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;axs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnAAAAJcCAYAAAB5fZnuAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nOzdd5gV5fn/8fe9nbqUXXqHhaUICCuIxg6CFUvU2BNjjCYmJjGJGvNVY2JijSbRxB419kbUiFLsDWVBeu+71AXpZdly//44g7/jenZpuzvn7H5e1zXXOTPzzJzPERzuM/PMM+buiIiIiEjiSAo7gIiIiIjsHxVwIiIiIglGBZyIiIhIglEBJyIiIpJgVMCJiIiIJBgVcCIiIiIJRgWciIiISIJRASfVysyWmdlOM9sWNbWrhc+9xcxKKnzuppr+XBFJXGb2vpltNLP0sLNUh+D77KpwHHwj7FxSM1TASU04zd0bR02rKjYws5Qa+NwXKnxus+r+gBrKLSK1zMy6AEcBDpxeQ58RxvHi6grHwdOq+wN0HIwPKuCkVphZFzNzM/uhma0A3g2WH25mn5rZJjObbmbHRm2TaWaPmdlqM1tpZn8ys+QD/Hw3syvNbGHwi/sBM7Oo9ZeZ2dxg3Tgz61xh25+a2UJgYbDsRDObb2abzeyfZvaBmV1uZulm9pWZHRK1favgrGT2gWQXkRpxCTAJeAK4dM/C4Ji0JvpYY2ZnmtmM4H2SmV1vZovNbIOZvWhmLYJ1lR3nXgr2udnMPjSzvlH7bmlmb5jZFjObHBznPo5an2tmE4LjynwzO/dAvqyZHWtmhWZ2rZmtC46rP4han25md5vZCjNba2YPmlmDCtteZ2ZrgH8Hy38b7GdVcPxzM+thZocF+0iJ2v/ZZjbtQLJLbCrgpLYdA/QGRppZe+BN4E9AC+DXwCtRhc6TQCnQAzgUOBG4/CA++1TgMGAAcC4wEsDMzgB+B5wFZAMfAc9V2PYMYCjQx8yygJeBG4CWwHzgCAB3LwaeBy6K2vZ8YKK7Fx1EdhGpXpcAzwTTSDNrDeDuk4DtwPFRbS8Ang3e/5zI8eAYoB2wEXigwr6/Ps4F828BOUArYGrwmXs8EHxeGyKFZHQx2QiYEHx2KyLHkn9GF4D7qQ2QCbQHfgg8YGbNg3V3AD2BgUSOue2Bmyps2wLoDFxhZqOAXwHDg/bH7Gno7pOBDcCIqO0vAv5zgLklFnfXpKnaJmAZsA3YFEz/DZZ3IXKpoltU2+uA/1TYfhyRA1hroBhoELXufOC9Sj73FmB31Oduim4bfPZ3ouZfBK4P3r8F/DBqXRKwA+gcte3xUesvAT6LmjegALg8mB8azCcF8/nAuWH/2WjSpCkyAd8BSoCsYH4e8Muo9X8CHg/eNyFSYHUO5ucCJ0S1bRvsKyXWcS7GZzcL2mQCycG2vSp89sfB+/OAjyps/xBwcyX7fj84dkUfB/8YrDsW2AmkRLVfBxweHMO2A92j1g0DlkZtuxvIiFr/OPCXqPkewffqEcxfBzwTvG8R5Gob9p99XZp0HVtqwhnuPrGSdQVR7zsD55hZdB+NVOC9YF0qsDrqSmdShe0retHdL6pi/Zqo9zuAxlE5/mZm90StNyK/QJfHyN0uet7d3cwKo+Y/N7PtwDFmtprIge31KnKJSO26FBjv7uuD+WeDZfdGzX9qZlcROTM/1d33HAs6A2PMrDxqf2VEfnTu8fXxIbgUextwDpEz/Hu2ywIaECn8CmJtG3zWUPvmDVkpVH0m6+fu/mgl6za4e2nU/J7jYDbQEJgS3bOESIG5R5G774qab0fkx2ms3ABPA3PNrDGRKx4fufvqKnLLflIBJ7XNo94XEDkD96OKjcysLZEzcFkVDjg1oQC4zd2fqaJNdO7VQIc9M0Ffug4V2j9J5JLBGuDlCgc+EQlJ0K/rXCA56M8FkA40M7MB7j7d3eeY2XLgJL55+RQix4vL3P2TGPvuEryNPl5cAIwmcqlxGZEzbxuJFEhFRLqJdAAWBO07VvisD9w9+lJkTVhP5OxcX3dfWUkbrzD/jeMg38yNu680s8+AM4GLgX9VU1YJqA+chOlp4DQzG2lmyWaWEXSW7RD8UhsP3GNmTYOOw93N7Ji97PNAPAjcsKdfiUVunjinivZvAoeY2RlBJ92fEukfEu0/RA5cFwFP1UBmETkwZxA5Y9aHSH+vgUT6q31EpHvEHs8S6e92NPBS1PIHgdv23OhkZtlmNrqKz2tC5MfoBiJnuf68Z4W7lwGvAreYWUMzy62Q4X9ATzO72MxSg+kwM+t9AN+7Uu5eDjwC3GtmrYLv1d7MRlax2YvAD8yst5k15Jv95fZ4CvgtcAgwpjoziwo4CZG7FxD5Zfo7Ir9EC4Df8P//Xl4CpAFziPxifZlIf5PKnGffHP9o256D0V5yjCHSgfd5M9sCzCLyy7uy9uuJXA65k8hBuQ+RSwnFUW0KiXRWdiL/MIhIfLgU+Le7r3D3NXsm4H7gwqg7J58j0vfr3ahLrQB/I9IlYryZbSVyJ+vQKj7vKSJdMVYSOZZNqrD+aiJn5dYQ+eH3HMGxxN23Erl563vAqqDNHUTOGFbm/grHwClVtI12HbAImBQcBycCvSpr7O5vAX8n0uVlEfBZsKo4qtkYgkvO7r59H3PIPrKgg6GIHCAzSwIKgQvd/b2o5Y8Dq9z996GFE5GEYmZ3AG3c/dK9No4jwVnBWUB6dLcXM1sM/LiKftFygHQGTuQABJd9m1lkBPffEenPMilqfRcinZ8fCyWgiCSEYJy3/hYxhMjwHglxudEi4+OlBUOR3AG8UaF4O5vIVYh3w8pYl6mAEzkww4DFRDr/nkbkztudAGb2RyK/RO9y96XhRRSRBNCESD+47UT6ld0DvBZqon33YyLdXxYT6Vd41Z4VZvY+kRsXfhr0sZNqpkuoIiIiIglGZ+BEREREEky9GgcuKyvLu3TpEnYMEakBU6ZMWe/u9e55szquidRdVR3X6lUB16VLF/Lz8/feUEQSTjDwar2j45pI3VXVcU2XUEVEREQSjAo4ERERkQSjAk5EpIaZWQszm2BmC4PX5lW0bWpmK83s/trMKCKJRQWciEjNux54x91zgHeC+cr8EfigVlKJSMJSASciUvNGA08G758k8kD1bzGzwUBrYHwt5RKRBKUCTkSk5rV299UAwWurig2CZ+reA/xmbzszsyvMLN/M8ouKiqo9rIjEv9AKODO7y8zmmdkMMxtjZs0qaTfKzOab2SIzuz5qeVcz+zzoU/KCmaXVXnoRkW8ys4lmNivGNHofd/ETYKy7F+ytobs/7O557p6XnV3vhr4TEcI9AzcB6Ofu/YEFwA0VG5hZMvAAcBLQBzjfzPoEq+8A7g36lGwk8gBgEZFQuPtwd+8XY3oNWGtmbQGC13UxdjEMuNrMlgF3A5eY2e219gVEJKGENpCvu0f38ZgEfDdGsyHAIndfAmBmzwOjzWwucDxwQdDuSeAWIg/OPWgT56zl40Xrv543C16xCvNR74M39vVGsdvvmY+5rsI+oj831j6iP7eynKnJSWSkJpGekkx6ShLpKUlkpAbvU5NpmJZMZoNUMhukkpGavG//gURkf70OXArcHrx+62Hl7n7hnvdm9n0gz92rutlBRBJEWbmTv+wrJsxZyyn923Jop0pvRN9n8fIkhsuAF2Isbw9EX04oBIYCLYFN7l4atbx9rB2b2RXAFQCdOnXapzCzV21hzJcrcXd8z0L/xss31vnX6/zr+W9v9+11HmzoUfsIU1pK0tfFXLMGqbRumkGbzAzaNM2gdWYGbTMz6NyyIdmN079ROIrIXt0OvGhmPwRWAOcAmFkecKW7Xx5mOBGpfsWlZXy6eAPjZq1hwpy1bNi+m7TkJLpmN4r/As7MJgJtYqy6MbisgJndCJQCz8TaRYxlXsXyby90fxh4GCAvL2+fyqRrhudwzfCcfWlaY74u7iop+P7/uv/f7pvbR9aVlDrFpWUUl5ZTXFrGrpLIa3FJOcWl5WzfXcrmnSVfT1uC143bS5i7egvvzV/Hjt1l39h3k/QUurVqTPesRnRv1Zh+7TMZ0CGTZg3VDVEkFnffAJwQY3k+8K3izd2fAJ6o8WAiUq22F5fywYIi3p61hvfmrWNrcSmN0pI5LrcVo/q14dherWicXj2lV40WcO4+vKr1ZnYpcCpwgnvMc1CFQMeo+Q7AKmA90MzMUoKzcHuW1xlfX5L9Rql6AGe90gBSDziHu7NlVylrt+xi1aadLFu/ncVF21myfhufLdnAq1+u/LptpxYN6d8hk6FdW3BEjyy6ZTXSmToREanTdu4u4515a3l92ireX1DE7tJyWjRK4+RD2jKyX2uO6J5VI12UQruEamajgOuAY9x9RyXNJgM5ZtYVWAl8D7jA3d3M3iPSb+55KulTIgfPzL6+rNqzdRPo9c31m3eWMHvlZqYXbmZG4SamLN/I/2asBqBtZgZHdM9iRJ/WHNsrW33sRESkTigpK+fjhet5bdpKJsxZy/bdZWQ3SeeCIZ0Y1a8NeZ2bk5Jcs/eJhtkH7n4gHZgQnKWZ5O5Xmlk74FF3P9ndS83samAckAw87u6zg+2vA543sz8BXwKP1f5XkMwGqRzRI4sjemQBkTN2yzfs4JPF6/l00QYmzl3LK1MLaZCazPG5rTilf1uG925NWoqGIBQRkcRRXu58sewrXp++irdmrmbjjhIyG6Ry2oB2nD6gHUO7tSQ5qfauOoV5F2qPSpavAk6Omh8LjI3RbgmRu1QljpgZXbIa0SWrERcO7UxJWTmfL/mKt2atZtzsNbw5czUtGqVx9qD2nHdYJ3q0ahx2ZBERkUoVfLWDV6YW8vKUQgo37qRBajIj+rTm9AHtOLpndmgnJOLlLlSpo1KTk/hOThbfycni1tH9+GhhEc9/UcC/P1nGIx8t5bhe2Vx5THeGdG2h/nIiIhIXdu4uY9zsNbyYX8CnizdgBkd2z+I3I3sxok9rGqaFXz6Fn0DqjeQk49herTi2VyuKthbz/BcreOLTZZz38CQO7dSMX43oyVE5GlVeRETCMbNwM89NXsEb01axtbiUji0a8MvhPTl7cHs6NG8YdrxvUAEnochuks7PTsjhR0d346X8Ah78YAkXP/YFR+VkccNJvenTrmnYEUVEpB7YVVLG/2as5j+TljO9YBMZqUmc3K8t5+R1ZGjXFiTVYr+2/aECTkKVkZrMxcO6cO5hHfnPZ8v5x7uLOOUfH3HBkE5cd1IuTTMOfAgUERGRyizfsJ1nPl/Bi/kFbNpRQvfsRtxyWh/OGtwhIf7tUQEncSE9JZnLj+rGOYM7ct87C3jy02VMmLOWW0f3Y1S/WGNBi4iI7B9358OF63n846V8sKCI5CRjZN/WXHR4Z4Z1a5lQfbFVwElcyWyYys2n9eWMge25/tWZXPn0FM7N68Atp/eNi06jIiKSeIpLy3h92ioe/Wgp89duJbtJOr8YnsP3DutEm8yMsOMdEP2LKHFpQMdmvH71kdw3cQH/fH8xU1ds4p8XDooMJiwiIrIPNu8o4enPl/Pkp8tYt7WYXq2bcPc5Azh9QLuEH49UBZzErdTkJH4zMpdh3bL4xQvTOPufn3L/hYM4pqfuVBURkcqt27KLhz5cwnNfrGDH7jKOysni7nMGcFROVkJdJq2KCjiJe9/JyeKNnx3JZU/kc9kTk/nzmf0477BOYccSEZE4s2rTTh76YDHPTS6grNwZPaAdPzq6G73b1r2RDVTASUJom9mAl64cxk+fmcp1r8yktNy5cGjnsGOJiEgcKPhqB//6YDEv5RfgDt8d3IGfHNuDTi3ja+y26qQCThJG4/QUHr5kMFc9PZUbx8wCUBEnIlKPrd2yi7+9s5AXJxeQZMZ5h3XkymO6x92guzVBBZwklPSUZP510aCvi7iGacmceWiHsGOJiEgt2ryjhH99sJgnPl1KWblzwdBOXHVsd9pmNgg7Wq1RAScJZ08R9/3HJ/Obl2bQvGEax/ZqFXYsERGpYTt3l/HEp8v41/uL2FpcyugB7fjViF51+lJpZVTASUJKT0nmoUsGc95Dk/jJM1N59keHM7Bjs7BjiYhIDSgvd/47bSV3vD2PtVuKOT63Fb8+sVe9fuxiYg+CIvVa04xUnvzBYbRolMZlT0xmxYYdYUcSEZFqNq1gE2c/+Cm/enE6bZpm8OKPh/H49w+r18UbqICTBNeqaQZPXTaEsnLn8qcms3VXSdiRRL7FzFqY2QQzWxi8Nq+kXSczG29mc81sjpl1qd2kIvFj3ZZdXPvidM544BMKN+7k7nMGMOYnRzKka4uwo8UFFXCS8LplN+aBCwaxuGg71zw/jbJyDzuSSEXXA++4ew7wTjAfy1PAXe7eGxgCrKulfCJxo7SsnEc+XMJxd7/PG9NXcdWx3Xnv18fy3cEdSEqqG4PwVgcVcFInfCcni1tO68O789Zx59vzwo4jUtFo4Mng/ZPAGRUbmFkfIMXdJwC4+zZ3V78AqVdmFG5i9AOfcNvYuRzerSXjf3k0143KpXG6uuxXpP8iUmdcPKwLC9Zu46EPl5DTugnfHazhRSRutHb31QDuvtrMYt023RPYZGavAl2BicD17l5WsaGZXQFcAdCpk55KIolvW3Ep94yfz5OfLiO7SToPXjSIkX3b1JnHXtUEFXBSp9x0Wh8WF23jxjEz6d22CX3bZYYdSeoJM5sItImx6sZ93EUKcBRwKLACeAH4PvBYxYbu/jDwMEBeXp76DEhCe2/eOn43ZiZrtuzi4sM78+uRvWiakRp2rLinS6hSp6QmJ/H38w+lecM0rnp6Kpt36qYGqR3uPtzd+8WYXgPWmllbgOA1Vt+2QuBLd1/i7qXAf4FBtfcNRGrX1l0lXP/KDH7wxGSaZqTyylVHcOvofire9pEKOKlzshqn88CFg1i1aSfXvjiNct3UIOF7Hbg0eH8p8FqMNpOB5maWHcwfD8yphWwite6zxRsYdd9HvJhfwFXHduf1nx3JoE4xb86WSqiAkzppcOfm3HhKbybOXceDHy4OO47I7cAIM1sIjAjmMbM8M3sUIOjr9mvgHTObCRjwSEh5RWrErpIy/vDGbM5/ZBKpycZLVw7julG5pKckhx0t4agPnNRZ3z+iC1OWb+TucfMZ2LEZR3TPCjuS1FPuvgE4IcbyfODyqPkJQP9ajCZSaxat28bVz05l3pqtXDKsM9eflEvDNJUhByqUM3BmdpeZzTOzGWY2xsy+9QwkM+toZu8FA1rONrNrotbdYmYrzWxaMJ1cu99AEoGZccfZ/emW3Zhrnp/G+m3FYUcSEamXXplSyOn3f8zaLbv49/cP49bR/VS8HaSwLqFOAPq5e39gAXBDjDalwLXBgJaHAz8Nxkna4153HxhMY2s+siSiRukp3H/BoWzeWcKvX5qu/nAiIrVoe3Epv3pxGte+NJ1D2mfy1jVHc1xurFF0ZH+FUsC5+/jgLiuAScC3Buxy99XuPjV4vxWYC7SvvZRSV+S2acr/ndKb9+cX8fgnS8OOIyJSLywp2sboBz5hzJcrueaEHJ790eG0ycwIO1adEQ83MVwGvFVVg+B5gIcCn0ctvjq4BPt4Zc8VDLa9wszyzSy/qKioOvJKArro8M6M6NOaO96ex6yVm8OOIyJSp707by2jH/iEr7bv5pkfDuWXI3qSrMdgVasaK+DMbKKZzYoxjY5qcyORS6XPVLGfxsArwC/cfUuw+F9Ad2AgsBq4p7Lt3f1hd89z97zs7OzKmkkdZ2bceXZ/WjZK52fPfcn24tK9byQiIvulvNz5xzsL+eGT+XRq0ZDXrz6SI3roBrKaUGM9CN19eFXrzexS4FTgBHeP2THJzFKJFG/PuPurUfteG9XmEeB/1RJa6rTmjdK473sDOf+RSdz8+mzuPmdA2JFEROqMHbtLufbF6bw1aw1nDGzHX87qT4M0DQ9SU8K6C3UUcB1wemUPa7bIA9AeA+a6+18rrGsbNXsmMKumskrdcni3lvzsuB68PKWQ16atDDuOiEidULS1mPMfnsTbs9dw48m9ufe8gSrealhYfeDuB5oAE4JhQB4EMLN2ZrbnjtIjgYuB42MMF3Knmc00sxnAccAva/sLSOL6+Qk5DOrUjP/77yxWb94ZdhwRkYS2aN1WzvznJ8xfu5WHLhrMj47upofQ14JQBmFx9x6VLF8FnBy8/5jISOSx2l1cc+mkrktJTuKv5w7kpL99xG9fnsFTlw3RwUZE5ABMWrKBK57KJy0liReuGMaAjt8a1lVqSDzchSpS67pkNeLGU3rz0cL1/GfS8rDjiIgknLdnreGSx76gVdMMxvzkSBVvtUwFnNRbFw7txDE9s/nz2LksKdoWdhwRkYTxypRCfvrsVPq2b8orVx5BxxYNw45U76iAk3rLzLjzu/3JSE3mly9Op7SsPOxIIiJx76nPlnHtS9M5vFsLnv7hUDIbpoYdqV5SASf1WuumGfzpjH5ML9jEv95fHHYcEZG49sB7i7jptdmM6NOaxy49jEbpep5pWFTASb13av92nD6gHX97ZyEzC/WUBhGRWB54bxF3jZvPGQPb8c8LB5GRqmFCwqQCTgT44+h+ZDVO59qXplFcWhZ2HBGRuPLIh0u+Lt7uOXcgqckqH8KmPwERILNhKn856xAWrN3G/e8uCjuOiEjceOKTpdw2di6n9G/L3ecM0DNN44QKOJHAcbmtOGtQe/75/mI98F5EBHj28xXc8sYcRvZtzX3nDSRFZ97ihv4kRKLcdGofWjRK47cvz6BEd6WKSD02duZqbvzvTI7PbcU/zh+ky6ZxRn8aIlGaNUzjtjP6MWf1Ft2VKiL11udLNvCLF6YxqFNzHrhgEGkpKhfijf5ERCo4sW8bThvQjn+8u5D5a7aGHUfqADNrYWYTzGxh8Nq8knZ3mtlsM5trZn83PeNNQjBvzRYufyqfTi0a8tileXoofZxSAScSwx9O70vTjFR+87IG+JVqcT3wjrvnAO8E899gZkcARwL9gX7AYcAxtRlSZNWmnXz/8ck0TEvmycuG0KxhWtiRpBIq4ERiaNEojVtH92NG4WYe+Whp2HEk8Y0GngzePwmcEaONAxlAGpAOpAJrayWdCLBjdymXP5nP9uJSnrxsCO2bNQg7klRBBZxIJU7p35aT+rXh3okLWLROz0qVg9La3VcDBK+tKjZw98+A94DVwTTO3efG2pmZXWFm+WaWX1RUVIOxpb4oL3d+/dJ05q3Zwt8vOJTcNk3DjiR7oQJOpAq3ju5Hw7Rkrn9lBuXlHnYciWNmNtHMZsWYRu/j9j2A3kAHoD1wvJkdHautuz/s7nnunpednV19X0Lqrb+/u5CxM9dww0m9Oa7Xt35fSBxSASdShewm6fz+lD7kL9/Ic5NXhB1H4pi7D3f3fjGm14C1ZtYWIHhdF2MXZwKT3H2bu28D3gIOr71vIPXVWzNXc9/EhXx3cAcuP6pr2HFkH6mAE9mLswe154juLbl97DzWbtkVdhxJTK8DlwbvLwVei9FmBXCMmaWYWSqRGxhiXkIVqS6L1m3j2pemM6hTM247sx+68TlxqIAT2Qsz489nHsLusnJueX122HEkMd0OjDCzhcCIYB4zyzOzR4M2LwOLgZnAdGC6u78RRlipH3buLuMnz0whIzWZf144mPQUDReSSFLCDiCSCLpkNeLnJ+Rw17j5jJ+9hhP7tgk7kiQQd98AnBBjeT5wefC+DPhxLUeTeuz/XpvFwnXbePIHQ2iTmRF2HNlPOgMnso+uOLobuW2acNNrs9m6qyTsOCIiB+zFyQW8PKWQnx2fw9E9dSNMIlIBJ7KPUpOT+MtZh7B26y7uGb8g7DgiIgdk0bpt3PT6LI7o3pJrTsgJO44cIBVwIvvh0E7NuXRYF578bBlTV2wMO46IyH4pKSvnVy9OIyM1mfvOG0hykm5aSFQq4ET2069H9qJN0wxueGUmJXrMlogkkH+8s5AZhZv5y5mH0Kqp+r0lMhVwIvupcXoKt47ux/y1W3n4wyVhxxER2SdTV2zk/vcWcfagDpx0SNuw48hBCqWAM7O7zGyemc0wszFm1qySdsvMbKaZTTOz/KjlLcxsgpktDF6b1156ERjRpzUn9WvD395ZyNL128OOIyJSpR27S/nVC9Nom9mAm0/vE3YcqQZhnYGbAPRz9/7AAuCGKtoe5+4D3T0vatn1wDvungO8E8yL1Ko/nN6X9OQkbnptFu56zJaIxK/7Ji5k2YYd3HPuAJpmpIYdR6pBKAWcu49399JgdhKRZ//tj9HAk8H7J4EzqiubyL5q1TSDa0/syUcL1/PmzNVhxxERiWlm4WYe/WgJ5w/pxOHdWoYdR6pJPPSBu4zIM/9icWC8mU0xsyuilrd299UAwWulT941syvMLN/M8ouKiqottAjAxcO60LddU259Y47GhhORuFNaVs71r84gq3E615+UG3YcqUY1VsCZ2UQzmxVjGh3V5kagFHimkt0c6e6DgJOAn5rZ0fubw90fdvc8d8/LztZghVK9kpOM2848hKJtxdw7YWHYcUREvuGxj5cye9UW/nB6XzIb6NJpXVJjj9Jy9+FVrTezS4FTgRO8kg5E7r4qeF1nZmOAIcCHwFoza+vuq82sLbCuetOL7LuBHZtxwZBOPPHpUs4e3J6+7TLDjiQiQuHGHdw7cQEj+rRmVD89/q+uCesu1FHAdcDp7r6jkjaNzKzJnvfAicCsYPXrwKXB+0uB12o2sUjVfjsyl+YN0/j9f2dRXq4bGkQkfH8ZOw+AW07vi5kG7K1rwuoDdz/QBJgQDBHyIICZtTOzsUGb1sDHZjYd+AJ4093fDtbdDowws4XAiGBeJDSZDVP53cm9+XLFJl7ILwg7jojUc58t3sCbM1dz1TE9aN+sQdhxpAbU2CXUqrh7j0qWrwJODt4vAQZU0m4DcEKNBRQ5AGcNas+L+QXc/tY8TuzTmpaN08OOJCL1UGlZOX94YzbtmzXgx8d0CzuO1JB4uAtVpE4wM/50Rj+2F5dy+1vzwo4jIvXUc5MLmLdmKzee0puM1OSw40gNUQEnUo1yWjfh8qO68azVnwMAACAASURBVNKUQiYv+yrsOCJSz2zZVcJfx89naNcWnKQbF+o0FXAi1eznJ0T6nPx+zCw97F5EatWjHy5h444Sfn9KH924UMepgBOpZg3TUrj5tD7MX7uVf3+yNOw4IlJPrN9WzKMfL+WUQ9pySAcNZ1TXqYATqQEn9m3D8N6tuG/iQlZv3hl2HBGpB+5/dxHFpeX86sSeYUeRWqACTqSG3HxaX8rKnT+P1Q0N9Z2ZnWNms82s3Mzyqmg3yszmm9kiM7u+NjNKYivcuINnP1/BOYM70D27cdhxpBaogBOpIR1bNOSqY7vzxvRVfLZ4Q9hxJFyzgLOIPEkmJjNLBh4g8ujAPsD5ZtanduJJovv7OwvB4JrhOWFHkVqiAk6kBl15THc6NG/ALa/P1g0N9Zi7z3X3+XtpNgRY5O5L3H038Dwwei/biFC4cQevTl3JBUM60TZTg/bWFyrgRGpQRmoyN50auaHhP58tDzuOxLf2QPRjPAqDZd9iZleYWb6Z5RcVFdVKOIlfD32wBDM0aG89owJOpIaN6NOaY3pmc++EBRRtLQ47jtQQM5toZrNiTPt6Fi3WmA8xH6zr7g+7e56752VnZx94aEl467bs4oX8As4e1EFn3+oZFXAiNczMuPm0PuwqLeOOt3VDQ13l7sPdvV+M6bV93EUh0DFqvgOwqvqTSl3y6MdLKS0r58pjuocdRWqZCjiRWtAtuzE//E43Xp5SyJTlG8OOI/FpMpBjZl3NLA34HvB6yJkkjm3asZunJy3ntAHt6JLVKOw4UstUwInUkp8d34PWTdO5+fVZlJXHvDImdZSZnWlmhcAw4E0zGxcsb2dmYwHcvRS4GhgHzAVedPfZYWWW+PfsFyvYsbuMq47V2bf6SAWcSC1plJ7Cjaf0YdbKLbwwuWDvG0id4e5j3L2Du6e7e2t3HxksX+XuJ0e1G+vuPd29u7vfFl5iiXclZeX857PlHNmjJbltmoYdR0KgAk6kFp3Wvy1Du7bgznHz2Lh9d9hxRCRBjZu9htWbd/GDI7qGHUVCogJOpBaZGX8Y3Zetu0q5Z8LehgUTEYnt358so3PLhhyf2yrsKBISFXAitSy3TVMuGdaZZz5fwayVm8OOIyIJZnrBJqYs38ilw7qQlBRr9BmpD1TAiYTgF8N70rJRGje9Noty3dAgIvvhyU+X0Tg9hXPyOoQdRUKkAk4kBJkNUrluVC5TV2zi1S9Xhh1HRBLE5h0lvDlzNWcc2o4mGalhx5EQqYATCcnZgzpwaKdm3PH2PLYVl4YdR0QSwGvTV1JcWs73DusUdhQJmQo4kZAkJRk3n9aXoq3FPPDeorDjiEicc3ee+6KAfu2b0q99ZthxJGQq4ERCNLBjM84e1IHHPlrK8g3bw44jInFs5srNzF29hfN09k1QAScSuutG9SI12bjtzblhRxGROPb85AIyUpMYPbBd2FEkDqiAEwlZq6YZ/PT4Hoyfs5aPF64PO46IxKFdJWW8MW0VJx/Slqa6eUEIqYAzs7vMbJ6ZzTCzMWbWLEabXmY2LWraYma/CNbdYmYro9ad/O1PEUkclx3ZlU4tGnLr/2ZTWlYedhwRiTPvzVvH1uJSzjpUQ4dIRFhn4CYA/dy9P7AAuKFiA3ef7+4D3X0gMBjYAYyJanLvnvXuPrZWUovUkIzUZG48pTcL1m7j2S9WhB1HROLMa9NWkdU4nWHdW4YdReJEKAWcu4939z3jJkwC9vaT4gRgsbsvr9lkIuE5sU9rjujeknvGL9BzUkXka5t3lvDu/HWc2r8tyXryggTioQ/cZcBbe2nzPeC5CsuuDi7BPm5mzSvb0MyuMLN8M8svKio62KwiNcbMuOm0PmzdVcJ9ExeEHUdE4sS42WvYXVqumxfkG2qsgDOziWY2K8Y0OqrNjUAp8EwV+0kDTgdeilr8L6A7MBBYDdxT2fbu/rC757l7XnZ29kF+K5GaldumKRcO7czTn69g/pqtYccRkTjw+rRVdGrRkIEdv9VdXOqxGivg3H24u/eLMb0GYGaXAqcCF7p7VQ+DPAmY6u5ro/a91t3L3L0ceAQYUlPfQ6S2/WpETxqnp3Dr/2ZT9f8aIlLXfbV9N58uXs9pA9pipsun8v+FdRfqKOA64HR337GX5udT4fKpmbWNmj0TmFW9CUXC07xRGr8cnsMnizYwYc7avW8gInXWu/PWUe4wqm/bvTeWeiWsPnD3A02ACcEwIA8CmFk7M/v6jlIzawiMAF6tsP2dZjbTzGYAxwG/rKXcIrXiwsM7k9OqMX96cy7FpWVhxxGRkIyfvYa2mRn0a9807CgSZ1LC+FB371HJ8lXAyVHzO4Bv3TPt7hfXXDqR8KUmJ3HTaX24+LEvePzjZVx1bPewI4lILdu5u4wPFxZxbl5HXT6Vb4mHu1BFJIajcrIZ3rs197+7kHVbdoUdRw6CmZ1jZrPNrNzM8ipp09HM3jOzuUHba2o7p8SXjxYWsauknBP7tAk7isQhFXAicez3p/Rmd1k5d46bH3YUOTizgLOAD6toUwpc6+69gcOBn5pZn9oIJ/Fp/Jy1NMlIYWi3FmFHkTikAk4kjnXJasRl3+nKy1MKmV6wKew4coDcfa67V1mFu/tqd58avN8KzAXa10Y+iT9l5c47c9dyfG4rUpP1T7V8m/5WiMS5q4/rQVbjdP7whoYVqS/MrAtwKPB5Jes1QHkdN2vlZjbuKOH43FZhR5E4FcpNDCKy75pkpPLrE3ty/aszeXPmak7tr9HYa5KZ3RRrubvfupftJgKxOivduGf8y338/MbAK8Av3H1LJVkeBh4GyMvLU1VfB320MFKYH9kjK+QkEq8qPQNnZv8JXtWRViRk5+R1JLdNE25/ax67SjSsSA3bHjWVERlMvMveNtrb4OX7wsxSiRRvz7h7xeGTpB75cOF6+rZrSlbj9LCjSJyq6hLqYDPrDFxmZs3NrEX0VFsBRQSSk4z/O7UPhRt38u9PloUdp05z93uiptuAY6mFvmgWGSfiMWCuu/+1pj9P4te24lKmLt/IUTl6/KNUrqoC7kHgbSAXmFJhyq/5aCIS7cgeWQzv3YoH3ltE0dbisOPUJw2BbgezAzM708wKgWHAm2Y2LlgePXj5kcDFwPHBAOfTzOzkSnYpddjnSzZQWu4cnaPLp1K5Sgs4d/97cDv74+7ezd27Rk0HdTATkQNzw8m92VVSxr0TF4Qdpc7a85SXYJoNzAf+djD7dPcx7t7B3dPdvbW7jwyWr3L3k4P3H7u7uXt/dx8YTGOr3rPURR8tXE9GahKDuzQPO4rEsb3exODuV9VGEBHZu+7Zjbno8M489dkyLhnWmdw2erxODTg16n0psNbdS8MKI/XPJ4vWM7RrS9JTksOOInFMw4iIJJhrTsihSUYqt705V8OK1AB3Xx41rVTxJrVp4/bdLFy3jSFd1dVcqqYCTiTBNG+Uxs9PyOGjhet5f77GABOpS/KXbwTgsC4q4KRqKuBEEtDFh3ema1Yj/vTmHErKysOOIyLVJH/ZV6QlJ9G/Q2bYUSTOqYATSUBpKUnccFIui4u289wXK8KOIyLVZPKyr+jfIZOMVPV/k6qpgBNJUCP6tGZYt5bcO2EBm3eWhB1HRA7SrpIyZq7cTJ4un8o+UAEnkqDMjN+f2ptNO0u4/92FYccRkYM0rWATJWXOYRo+RPaBCjiRBNa3XSbnDO7AE58uY/mG7WHHEZGDMK1gEwCDOqmAk71TASeS4H59Yi9Sk5P4y9h5YUcRkYMwa+VmOjRvQPNGaWFHkQSgAk4kwbVqmsFVx3Tn7dlr+HzJhrDjiMgBmrVyM/3a6e5T2Tcq4ETqgMuP6kbbzAz+9OZcyss1uK9Iotmyq4RlG3bQr72eriL7RgWcSB3QIC2Z60blMnPlZsZ8uTLsOCKyn2av3AJAv/Y6Ayf7RgWcSB1x+oB2DOiQyZ3j5rFjt57+JJJIZq/aDKiAk32nAk6kjkhKMv7v1D6s3VLMwx8uCTuOiOyHWSs30zYzg6zG6WFHkQShAk6kDsnr0oJT+rfloQ+WsHbLrrDjiMg+mr92G7ltmoQdQxJIaAWcmf3RzGaY2TQzG29m7Sppd6mZLQymS6OWDzazmWa2yMz+bmZWe+lF4td1I3MpLS/nr+MXhB1FRPZBWbmzpGgbPVo1DjuKJJAwz8Dd5e793X0g8D/gpooNzKwFcDMwFBgC3Gxme0Y4/BdwBZATTKNqJbVInOvUsiGXDuvCi1MKmLdmS9hxRGQvVm7cSXFpuQo42S+hFXDuHv0vSyMg1tgHI4EJ7v6Vu28EJgCjzKwt0NTdP3N3B54Czqjx0CIJ4urje9AkPUWD+4okgMVF2wDonq0CTvZdqH3gzOw2MysALiTGGTigPVAQNV8YLGsfvK+4PNZnXGFm+WaWX1RUVD3BReJcs4Zp/PyEHD5YUMSHC/T3XiSeLVoXKeB0Bk72R40WcGY20cxmxZhGA7j7je7eEXgGuDrWLmIs8yqWf3uh+8PunufuednZ2Qf6VUQSzsXDOtOxRQP+PHYuZRrcN1Rmdo6ZzTazcjPL20vbZDP70sz+V1v5JFxL1m+jZaM0mjXUI7Rk39VoAefuw929X4zptQpNnwXOjrGLQqBj1HwHYFWwvEOM5SISSE9J5rcjc5m3ZiuvTi3c+wZSk2YBZwEf7kPba4C5NRtH4smqTbvo0LxB2DEkwYR5F2pO1OzpQKzOOuOAE82seXDzwonAOHdfDWw1s8ODu08vASoWhSL13qn92zKwYzPuHj+fnbvLwo5Tb7n7XHefv7d2ZtYBOAV4tOZTSbxYs3kXbTIzwo4hCSbMPnC3B5dTZxApzK4BMLM8M3sUwN2/Av4ITA6mW4NlAFcROcgtAhYDb9VyfpG4Z2bceEpv1m4p5rGPNbhvArgP+C1QXlUj9e2tW1Zv3knbTJ2Bk/2TEtYHu3usS6a4ez5wedT848DjlbTrV2MBReqIw7q0YGTf1vzr/cWcd1gnsptopPeaYGYTgTYxVt0Yo9tIrO1PBda5+xQzO7aqtu7+MPAwQF5enjo4JrDtxaVs2VVK66Y6Ayf7R09iEKkHrhuVS3FpOfdN1OC+NWU/+vxW5kjgdDNbBjwPHG9mT9dYYIkLa4InprTVJVTZTyrgROqBbtmNuXBoJ56fXMCidVvDjiMxuPsN7t7B3bsA3wPedfeLQo4lNWz1pkgBpzNwsr9UwInUEz8/IYeGqcnc/pYG961tZnammRUCw4A3zWxcsLydmY0NN52EqWDjDgA6tlAfONk/KuBE6omWjdO56rjuTJy7js8Wbwg7Tr3i7mOCs2vp7t7a3UcGy1e5+8kx2r/v7qfWflKpbcs37CA12XQTg+w3FXAi9chlR3alXWYGfx47l3IN7isSuuUbttOxRUOSk2KNTy9SORVwIvVIRmoyvxnVi5krN/P6dI19LRK25Rt20LlFw7BjSAJSASdSz4we0J5+7Zty17j57CrR4L4iYXF3Vny1g84tG4UdRRKQCjiReiYpyfjdSb1ZuWknT3y6LOw4IvXWqs272FZcqofYywFRASdSDx3RI4vjc1vxwLuL+Gr77rDjiNRL81ZvASC3TZOQk0giUgEnUk/dcFIu23eX8vd3FoYdRaRemrcmMiZjTxVwcgBUwInUUzmtm/C9IZ14etJylq7fHnYckXpn3pqttG/WgKYZqWFHkQSkAk6kHvvF8BzSUpK4Q4P7itS6+Wu20Lutzr7JgVEBJ1KPtWqSwZXHdOft2WuYvOyrsOOI1BvFpWUsLtpOL10+lQOkAk6knrv8qK60apLObW/OxV2D+4rUhvlrtlJW7vRpmxl2FElQKuBE6rmGaSlce2JPphVs4u1Za8KOI1IvfLliEwADOzULOYkkKhVwIsLZgzqQ06oxd46bT0lZedhxROq8aQWbyG6STrvMjLCjSIJSAScipCQncd2oXJau387zkwvCjiNS500r2MTAjs0w0zNQ5cCogBMRAE7o3YohXVrwt4kL2FZcGnYckTpr047dLF2/nYEddflUDpwKOBEBwMy4/uRc1m/bzSMfLgk7jkidNa0g0v/tUBVwchBUwInI1wZ1as5J/drwyEdLWLd1V9hxROqkqcs3kmRwSAfdgSoHTgWciHzDb0b2YndpuR6xJVJDPluygUPaZ9JET2CQg6ACTkS+oVt2Y84f0onnvihgSdG2sOOI1Ck7d5cxrWATh3dvGXYUSXAq4ETkW35+Qg4ZKUncNW5+2FFE6pT85V9RUuYc3k0FnBwcFXAi8i3ZTdL50dHdeGvWGqau2Bh2nIRnZueY2WwzKzezvCraNTOzl81snpnNNbNhtZlTat6kJRtITjIO69Ii7CiS4EIp4Mzsj2Y2w8ymmdl4M2sXo81AM/ssOOjNMLPzotY9YWZLg+2nmdnA2v0GInXfj47qRlbjdG4fO0+P2Dp4s4CzgA/30u5vwNvungsMAObWdDCpXZ8t3kD/Dpk0Tk8JO4okuLDOwN3l7v3dfSDwP+CmGG12AJe4e19gFHCfmUXfc/0bdx8YTNNqIbNIvdIoPYVrhufwxbKveGfuurDjJDR3n+vuVV6PNrOmwNHAY8E2u919U23kk9qxrbiUGYWbGabLp1INQing3H1L1Gwj4Fs/7919gbsvDN6vAtYB2bWTUEQAvndYR7plNeKOt+dRqkds1bRuQBHwbzP70sweNbNGsRqa2RVmlm9m+UVFRbWbUg7YxwuLKC13ju6pf8rk4IXWB87MbjOzAuBCYp+Bi247BEgDFkctvi24tHqvmaVXsa0OdCIHKDU5id+M7MXCddt4eUph2HHimplNNLNZMabR+7iLFGAQ8C93PxTYDlwfq6G7P+zuee6el52tYiBRvDeviCYZKQzu3DzsKFIH1FgBt7eDmbvf6O4dgWeAq6vYT1vgP8AP3H3PKYAbgFzgMKAFcF1l2+tAJ3JwRvVrw6GdmnHvxAXs3F0Wdpy45e7D3b1fjOm1fdxFIVDo7p8H8y8TKeikDnB33pu/jqNzsklN1v2DcvBq7G/RfhzMngXOjrWPoE/Im8Dv3X1S1L5Xe0Qx8G9gSE19D5H6zsz43cm9WbulmMc/WRp2nDrL3dcABWbWK1h0AjAnxEhSjeas3sK6rcUcl9sq7ChSR4R1F2pO1OzpwLwYbdKAMcBT7v5ShXVtg1cDziByh5eI1JDDurRgeO/WPPj+Yr7avjvsOAnHzM40s0JgGPCmmY0Llrczs7FRTX8GPGNmM4CBwJ9rP63UhPfmRW4EOkb936SahHUe9/bgcuoM4ETgGgAzyzOzR4M25xK5I+v7MYYLecbMZgIzgSzgT7WcX6TeuW5UL7bvLuUf7+oRW/vL3ce4ewd3T3f31u4+Mli+yt1Pjmo3Lejy0d/dz3B3DcJXR4yfs5aBHZuR3aTSLtsi+yWUgWjcPeYlU3fPBy4P3j8NPF1Ju+NrLp2IxJLTugnn5nXk6UnL+cERXenUsmHYkUQSQsFXO5hRuJnfnZwbdhSpQ9STUkT22S9H9CQ5ybh7vB6xJbKv3pq1GoCT+rUNOYnUJSrgRGSftW6awQ+/05XXp69iZuHmsOOIJIQ3Z66hf4dMOrbQWWupPirgRGS//PiY7rRolMZf3pqrR2yJ7EXhxh1ML9iks29S7VTAich+aZqRys+O78GnizfwwQINji1SlbEz91w+bRNyEqlrVMCJyH67cGhnOrVoyO1vzaOsXGfhRGJxd16ZspJDOzWjS1bMp6KJHDAVcCKy39JSkvj1yF7MW7OV/365Muw4InFp1sotzF+7lbMHdQg7itRBKuBE5ICcekhbDmmfyV8nLGBXiR6xJVLRK1MLSUtJ4rT+7cKOInWQCjgROSBJScYNJ+WyctNOnvpsWdhxROLK7tJyXpu2khF9WpPZMDXsOFIHqYATkQN2RI8sju6ZzQPvLWbzzpKw44jEjQlz1rJxRwnfHazLp1IzVMCJyEH57chebN5ZwkMfLA47ikjceOqzZXRs0YCjc/TsU6kZKuBE5KD0a5/J6IHtePyTpazdsivsOCKhm7dmC58v/YqLhnYmOcnCjiN1lAo4ETlo147oRVm587d39KB7kf98tpz0lCTOzesYdhSpw1TAichB69SyIRcM6cQLkwtYUrQt7Dgiodmyq4QxX67ktAHtaN4oLew4UoepgBORanH18TmkpyRxz/gFYUcRCc1zn69gx+4yLh3WJewoUsepgBORapHdJJ3Lj+rGmzNXM6NwU9hxRGrdrpIyHv14Kd/pkcUhHTLDjiN1nAo4Eak2PzqqKy0apXHH2/PCjiJS616ZWkjR1mJ+cmz3sKNIPaACTkSqTZOMVK4+rgefLNrARwv1oHupP0rLynnogyUM6JDJsO4tw44j9YAKOBGpVhce3okOzRtwx9vzKNeD7qWeeH36KlZ8tYOrju2BmYYOkZqnAk5EqlV6SjK/GtGTWSu38ObM1WHHiQtmdo6ZzTazcjPLq6LdL4N2s8zsOTPLqM2ccmB2l5bz1wkL6NuuKSf2aR12HKknVMCJSLUbPbA9uW2acM/4+ZSUlYcdJx7MAs4CPqysgZm1B34O5Ll7PyAZ+F7txJOD8dwXKyjcuJPfjsolSQP3Si1RASci1S45yfjtqF4s27CD5ycXhB0ndO4+193n70PTFKCBmaUADYFVNZtMDtb24lL+8e4ihnZtwdE5WWHHkXpEBZyI1IjjerViSJcW/P2dhezYXRp2nLjn7iuBu4EVwGpgs7uPj9XWzK4ws3wzyy8q0s0iYXrwg8Ws31bMb0flqu+b1CoVcCJSI8yM607KpWhrMY9/vDTsODXOzCYGfdcqTqP3cfvmwGigK9AOaGRmF8Vq6+4Pu3ueu+dlZ+th6WFZtn47D32whDMGtmNw5+Zhx5F6JiXsACJSdw3u3JwRfVrz0AdLuHBo5zr9aCF3H36QuxgOLHX3IgAzexU4Anj6YLNJzbj1f3NITTZuOLl32FGkHgrtDJyZ/dHMZpjZNDMbb2btKmlXFrSZZmavRy3vamafm9lCM3vBzOruvwwiCey3I3uxfXcpD7y3KOwo8W4FcLiZNbTItbgTgLkhZ5JKTJyzlnfnreMXw3vSuqluFpbaF+Yl1Lvcvb+7DwT+B9xUSbud7j4wmE6PWn4HcK+75wAbgR/WcF4ROQA5rZtw9qAOPPXZclZu2hl2nFCY2ZlmVggMA940s3HB8nZmNhbA3T8HXgamAjOJHJ8fDimyVGHzzhJ+/99Z9GzdmO8f2SXsOFJPhVbAufuWqNlGwD6P+Bn8Oj2eyMEO4EngjOpLJyLV6ZcjeoLBvRPq54Pu3X2Mu3dw93R3b+3uI4Plq9z95Kh2N7t7rrv3c/eL3b04vNRSmVvfmEPRtmLuPmcAqcnqSi7hCPVvnpndZmYFwIVUfgYuI7jbapKZ7SnSWgKb3H3PrW2FQPtKPkN3a4mErF2zBlw6rDOvTi1kwdqtYccROWAT56zllamF/OTY7vTv0CzsOFKP1WgBt7e7stz9RnfvCDwDXF3Jbjq5ex5wAXCfmXUHYt2rHfMMnu7WEokPPzm2B43SUrjz7X0ZDk0k/qzdsovrX51Bbpsm/Oz4nLDjSD1XowWcuw8PLgVUnF6r0PRZ4OxK9rEqeF0CvA8cCqwHmgWDXQJ0QANeisS15o3SuPLY7kycu5b8ZV+FHUdkv5SWlfOzZ79ke3EZ/zj/UNJSdOlUwhXmXajRP19OB+bFaNPczNKD91nAkcAcd3fgPeC7QdNLgYpFoYjEmR8c2YXsJunc8fY8Iv8biySGu8bP54tlX/GXsw4hp3WTsOOIhNoH7vbgcuoM4ETgGgAzyzOzR4M2vYF8M5tOpGC73d3nBOuuA35lZouI9Il7rHbji8j+apiWwjUn5DB52Ubenbcu7Dgi++S1aSt56IMlXDC0E2ccGrO7tUitC20gX3ev7JJpPnB58P5T4JBK2i0BhtRYQBGpEecd1pHHPl7KnW/P59herUjWw78ljn2x9Ct+89IMhnRtwc2n9Qk7jsjXdBFfRGpVanIS157Yk/lrtzLmy5VhxxGp1KJ1W7niP/l0aNGAhy8eTHpKctiRRL6mAk5Eat3J/dpySPtM7p2wgF0lZWHHEfmWJUXbOP+Rz0lJSuKJ7w+hWUM97Efiiwo4Eal1SUnGdaNyWblpJ09PWh52HJFvWL5hOxc88jnl5c6zPxpKp5YNw44k8i0q4EQkFN/JyeI7PbJ44L1FbNlVEnYcEQBmrdzM2f/6jF2lZTx9+VB66o5TiVMq4EQkNNeNymXjjhIe+XBJ2FFE+HBBEec99BnpKUm8fOUwerdtGnYk+X/s3Xl8XHW9//HXJ3ubtumSdN/SFdrSBUqBArIIUhQBFRBwQ0FE4YrXHe+V68V7f4r7AldFUAGRVcQqm4iUzRaarpSuabok3ZKmzdZmz+f3x0zqNKRt2iZzzknez8cjdGbOd2Y+KenJe77bkUNSgBORwJw0Mof3TR/Gva9uorS6LuhypIdyd36xYCPX/fZNRg3szZOfm8uEwep5k3BTgBORQH35PZNpbG7h5y8WBl2K9ECV+xv5zINLuPO5tVw8bRhPfHYuQ/plBV2WyBEpwIlIoPJzs/nwqaN4+M2tbC3fH3Q50oP8ffUuLvzxy/xjbSnfvGQKd107iz6ZgW2PKnJUFOBEJHCff/dE0lKNH72gC91L19tWUcu/PbyMGx4oYGB2Bk/dfCbXn5WPmTaVlujQRw0RCdyQfll88sx8fvnyRj5zznhNHpcuUVnbyL2vFnHPK0U4cOu7J3LzeRN0YXqJJAU4EQmFm941nocWbeEHz6/jvutODboc6UZ2VdXxm9c28dAbW6mpb+KymcP5ykWTGTlA+7tJdCnAiUgo5PRO57PnTuDO59ayePMeTh07MOiSJMIam1tYsK6MxwqKeWltKS3uXDJ9OJ85ZxxTh+cEc+DEnwAAIABJREFUXZ7IcVOAE5HQuG7uWH77+ibufHYtj990huYkyVGprG3klfVlvLS2lJfWlbJ3fyO5fTL51Fn5fOS00YwZlB10iSKdRgFOREKjV0Yqt14wkf/40ypeWlfK+ScMCbqkTmFm3wfeDzQAG4FPuntFO+3mAT8FUoF73f27SS00Qmrqmygqq2HtzmqWba1g2da9rNtVjTsM6J3OuZMH896ThnHu5DzSUzXHTbofBTgRCZWrZo/i168U8b3n1nHupMGkpHSLXrgXgNvcvcnM7gRuA76W2MDMUoG7gQuBEmCxmc1399VJr/YYuTvu4In3D9wGJ3acNo8BNLU4tQ3N7KtvYn/Cn5W1jZRV11NWU09pVR07q+ooKttHaXX9gdfpl5XGzNEDuGjqUN41KZeZowaQ2j1+bkQOSQFOREIlPTWFL75nMp9/eBnzV2zn8lkjgi7puLn73xLuLgKuaKfZHKDQ3YsAzOwR4DKgUwLcT/6+nvte2xQvKBayPJ6mYrdbDx0cwmgTvA71vK6WmZZCXt9MBvfN5OyJeYzLy2Z8XjYTBvdlXG52dwn6Ih2mACcioXPJScNYuHE3Y3O75ZylTwGPtvP4CKA44X4JcFp7L2BmNwI3AowePbpDbzpteA4fOnkkrdMKDcMMWmOPGQfmHFr8PxY/2tqu7XP/1dYOfp02xw/ctn+9XtsaUlOM3hlpZGem0jsjjd4ZqfTOSKVvVjqD+2XSNzNNcyJFEijAiUjopKQY3/ng9KDLOCpm9ndgaDuH/sPd/xxv8x9AE/BQey/RzmPt9m+5+z3APQCzZ8/uUB/YBVOGcMGU7jGnUEQU4EREOoW7X3C442b2CeAS4N3u7Q48lgCjEu6PBLZ3XoUi0p1oaY6ISBeLry79GnCpux/qgq+LgYlmlm9mGcDVwPxk1Sgi0aIAJyLS9e4C+gIvmNlyM/slgJkNN7NnANy9CbgFeB5YAzzm7m8HVbCIhJuGUEVEupi7TzjE49uB9ybcfwZ4Jll1iUh0qQdOREREJGICCXBm9m0zWxkfSvibmQ1vp8158eOtX3Vmdnn82O/MbFPCsZnJ/y5EREREghFUD9z33X26u88E/grc3raBu7/k7jPjbc4H9gOJm2F+pfW4uy9PTtkiIiIiwQskwLl7VcLdbA6x11GCK4BnD7N6S0RERKTHCGwOnJn9r5kVAx+hnR64Nq4GHm7z2P/Gh2F/bGaZh3mfG82swMwKysrKjrNqERERkeBZ+/tJdsILd2BX8ni724Asd/+vQ7zOMGAlMNzdGxMe2wlkENuNfKO739GBmsqALR38FnKB3R1sGxaqOTmiWDNEs+6jqXmMu+d1ZTFhpPNaKEWxZohm3d295kOe17oswHWUmY0Bnnb3aYc4fisw1d1vPMTxc4Evu/slnVxXgbvP7szX7GqqOTmiWDNEs+4o1hxmUfz7VM3JE8W6e3LNQa1CnZhw91Jg7WGaX0Ob4dN4DxwWu7Lx5cCqzq5RREREJKyC2sj3u2Y2GWgh1vV/E4CZzQZucvcb4vfHErs24Mttnv+QmeURu/jz8tbni4iIiPQEgQQ4d//QIR4vAG5IuL8ZGNFOu/O7rLh/uScJ79HZVHNyRLFmiGbdUaw5zKL496makyeKdffYmgOfAyciIiIiR0eX0hIRERGJGAU4ERERkYhRgGvDzOaZ2TozKzSzrwddT0eY2W/MrNTMIrMa18xGmdlLZrbGzN6ObxcTamaWZWZvmtmKeM3/HXRNHWVmqWa2zMz+GnQtHWVmm83srfj1jguCrifqonZu03ktOXReS67OPK9pDlwCM0sF1gMXAiXAYuAad18daGFHYGbvAmqABw61n17YxLeCGebuS82sL7AEuDzMf9fxbWuy3b3GzNKB14Bb3X1RwKUdkZl9EZgN9OvsPRO7ipltBma7e9Q26QydKJ7bdF5LDp3Xkqszz2vqgTvYHKDQ3YvcvQF4BLgs4JqOyN1fAfYEXcfRcPcd7r40frsaWEM7K47DxGNq4nfT41+h/wRkZiOB9wH3Bl2LBCZy5zad15JD57XoUoA72AigOOF+CSH/x9cdxPf7mwW8EWwlRxbvsl8OlAIvuHvoawZ+AnyV2L6LUeLA38xsiZm1eyUW6TCd25JM57Uu1+PPawpwB7N2Hgv9J5EoM7M+wB+BL7h7VdD1HIm7N7v7TGAkMMfMQj20Y2aXAKXuviToWo7Bme5+MnAxcHN8SE2Ojc5tSaTzWtfSeS1GAe5gJcSu/NBqJLA9oFq6vfh8iz8CD7n7k0HXczTcvQJYAMwLuJQjORO4ND7v4hHgfDP7fbAldYy7b4//WQr8idgwoBwbnduSROe1pNB5DQW4thYDE80s38wygKuB+QHX1C3FJ87eB6xx9x8FXU9HmFmemfWP3+4FXMDhr+MbOHe/zd1HuvtYYj/P/3D3jwZc1hGZWXZ8Ejhmlg28B13z+Hjo3JYEOq8lh85rMQpwCdy9CbgFeJ7Y5NPH3P3tYKs6MjN7GFgITDazEjO7PuiaOuBM4GPEPjktj3+9N+iijmAY8JKZrST2C/EFd4/M8vWIGQK8ZmYrgDeBp939uYBriqwontt0XksandeSp1PPa9pGRERERCRi1AMnIiIiEjEKcCIiIiIRowAnIiIiEjEKcCIiIiIRowAnIiIiEjFpQRcg0pnMbBDwYvzuUKAZKIvfnxO/DqSISGTovCbt0TYi0m2Z2beAGnf/QdC1iIh0Bp3XpJWGUEVEREQiRgFOREREJGIU4EREREQiRgFOREREJGIU4EREREQiRgFOREREJGK0jYiIiIhIxKgHTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTkRERCRiFOBEREREIkYBTqSTmNnbZnZu0HWIiEj3pwAnR83MNpvZBW0eu87MXuuk13czm3CENsPM7D4z22Fm1Wa21sz+28yyO6OGY+HuU919Qby+b5nZ74OqRUSCFT9P1ppZTcLXXR143gIzuyEZNUq0KcBJ5JjZQGAh0As4w937AhcC/YHxQdYmIpLg/e7eJ+HrluN9QTNL64zCJPoU4KRLmNlwM/ujmZWZ2SYz+3zCsTlmttDMKuI9aHeZWUb82CvxZivin1g/3M7LfxGoBj7q7psB3L3Y3W9195Xx1/mpmRWbWZWZLTGzsxPe/1tm9oSZPRrvvVtqZjMSjn/dzDbGj602sw+0+d4+bWZrEo6fHH98s5ldYGbzgG8AH45/DyvM7EozW9Lmdb5kZk8d81+yiERO62iFmf3AzPbGz48Xx4/9L3A2cFdij118VOJmM9sAbIg/NtfMFptZZfzPuQnvscDMvmNmb8aP/zn+wRcze9rM/q1NTSvN7PIk/RVIJ1GAk05nZinAX4AVwAjg3cAXzOyieJNm4N+BXOCM+PHPAbj7u+JtZsQ/sT7azltcADzp7i2HKWMxMBMYCPwBeNzMshKOXwY8nnD8KTNLjx/bSOwkmgP8N/B7MxsW/96uBL4FfBzoB1wKlCe+sbs/B/w/4NH49zADmA/km9mJCU0/Cjx4mO9BRLqn04B1xM6B3wPuMzNz9/8AXgVuaafH7vL486bEw9jTwM+AQcCPgKfNbFBC+48DnwKGA03xtgD3Ezv3ABD/8DoCeKbTv0vpUgpwcqyeivegVZhZBfB/CcdOBfLc/Q53b3D3IuDXwNUA7r7E3Re5e1O8B+1XwDlH8d6DgB2Ha+Duv3f38vh7/BDIBCYnNFni7k+4eyOxk18WcHr8uY+7+3Z3b4kHyA3AnPjzbgC+5+6LPabQ3bccqWB3rwceJX7iNLOpwFjgrx3/tkUkYg46T5rZp+OPb3H3X7t7M7FANQwYcoTX+o6773H3WuB9wAZ3fzB+jnsYWAu8P6H9g+6+yt33Ad8ErjKzVODPwEQzmxhv9zFiHzYbOudblmRRgJNjdbm792/9It6DFjcGGN4m4H2D+AnKzCaZ2V/NbKeZVRHrrco9ivcuJ3bCO6T48OSa+PBBBbHetMT3KG69Ee/JKyH2SRUz+7iZLU+ofVrCc0cR66E7FvcD15qZETtpPhYPdiLSPR10nnT3X8cf39nawN33x2/2OcJrFSfcHg60/eC4hVhPWnvttwDpQG78nPMY8NH4aMk1aCQgkhTgpCsUA5vanLj6uvt748d/QezT4kR370cs3NlRvP7fgQ/ETz7vEJ/v9jXgKmBAPGBWtnmPUQntU4CRwHYzG0Ost/AWYFD8uasSnltMxxZK+DsecF8ENBAbnr0WnTRF5J3ece5o5/HtxD4oJxoNbEu4P6rNsUZgd/z+/cBHiE1f2e/uC4+5WgmMApx0hTeBKjP7mpn1MrNUM5tmZqfGj/cFqoAaMzsB+Gyb5+8Cxh3m9X9EbP7Z/fHAhZmNMLMfmdn0+Os3AWVAmpndHm+f6BQz+6DFVnR9AagHFgHZxE6UZfHX/SSxHrhW9wJfNrNTLGZCaw3tfA9j2wmZDwB3AU3u3inbrohIt3Kk8x/E5qtNMrNrzSzNYou9pnDwlIyPmtkUM+sN3AE8ER+yJR7YWoAfog+SkaUAJ50ufpJ4P7FFBJuIfeq7l9gwJsCXifVAVRPr7Wq7UOFbxMJZhZld1c7r7wHmEvtE+YaZVQMvEutlKwSeB54F1hMbOqjj4OEEiM0D+TCwl9hw5gfdvdHdVxM7qS0kdiI9CXg94b0fB/6X2MKHauApYgsh2no8/me5mS1NePxBYoFQJ02R7u8vdvA+cH/qwHN+ClwRX6H6s/YauHs5cAnwJWJTSr4KXOLuuxOaPQj8jthwbRbw+TYv8wCx85v2q4wocz9Ub61I92Rm3wImuPtHj9S2C967F1AKnOzuG5L9/iLS/ZnZAuD37n7vYdp8HLjR3c9KWmHSqdQDJ5JcnwUWK7yJSFDiw6qfA+4JuhY5dtrRWSRJzGwzscUQ2jBTRAIR34/zSWKLwf4QcDlyHDSEKiIiIhIxGkIVERERiZhQD6HGd40uALa5+yVtjmUSW0VzCrFVOB9uvS7moeTm5vrYsWO7plgRCdSSJUt2u3te0HUkm85rIt3X4c5roQ5wwK3AGt65hxfA9cBed59gZlcDdxLbFuKQxo4dS0FBQedXKSKBM7MjXtKsO9J5TaT7Otx5LbRDqGY2ktj13g61DPoyYrtJAzwBvDt+iSIRERGRbi20AQ74CbHNCVsOcXwE8c1Z3b2J2Caug9o2MrMbzazAzArKysq6qlYRERGRpAllgDOzS4BSd19yuGbtPNbe9SfvcffZ7j47L6/HTY8RERGRbiiUAQ44E7g0vm/WI8D5Ztb2ch8lxC/WG7+eZQ6wJ5lFioiIiAQhlAHO3W9z95HuPha4GvhHO5c9mg98In77ingbbWonIiIi3V7YV6EexMzuAArcfT5wH/CgmRUS63m7OtDiRERERJIk9AHO3RcAC+K3b094vA64MpiqRERERIITyiFUERERETm00PfAibQqra7jpbWlfPjU0UGXIiIi0iHlNfVsLNtHYWkNRWU1XDRtKKeOHXjcr6sAJ5Hx6fsLWFFSyTmTBjM0JyvockRERABoaXG2VdRSWFbDxtIaCktr2FgW+3Pv/sYD7bLSU8jPy1aAk56lrLoegGYtNhYRkYDU1DexdkcVa3ZUsXpHNWt2VLFuZzW1jc0H2gzKzmB8Xh/mTRvGhMF9GJ+XzYTBfRie04uUlM65aJQCnESOdosREZFkKKuuZ2VJBW9tq2TNjirW7Khm6579B47n9ErnxGF9uXrOKCYN6cuEwX2YkNeHAdkZXV6bApyIiIj0ePvqm3hrWyUrSypYUVzJ8uIKtlXUAmAG+YOyOWlEDlfNHsmJw/px4rB+DMvJIqjLsCvASeQE9Y9FRES6j+0Vtby5aQ9vbt7Dks172VBaTUt8gGfUwF7MHN2f6+aOZcao/kwd3o/szHBFpnBVIyIiItLJ3J1Nu/fFAls8tJXsjfWu9c1MY9aYAcybNpSZo/ozfWQOg/pkBlzxkSnASWRo5puIiHRUeU09rxXu5pX1u3l1Qxml8YVwg7IzmJM/kE+dmc+c/IGcOKwfqZ20sCCZFOAkcqL3z0xERLpaY3MLizfv4dUNscC2alsVAP17p3PmhFzOHJ/LnPyBjM/L7hZTcRTgREREJJKq6xp5eX0ZL6zexUtrS6mqayItxTh5zAC+/J5JnD0xj2kjciLZw3YkCnASGdo9REREyqrref7tnbywehcLN5bT0NzCwOwMLpo6lAumDOHMCbn0CdmCg67Q/b9D6Xa6Qc+3iIgchaq6Rp5ftZP5K7bzeuFuWhzGDOrNJ+aO4cIpQzllzIBu2ct2OApwIiIiEjoNTS38Y+0unlq2nX+sK6WhqYVRA3vx2XPH8/4Zw5k8pG+3mMt2rBTgJDI8vg5VQ6kiIt1XYWkNjxUU88clJZTvayC3TybXzhnNpTOHM2tU/x4d2hIpwEnktCjBiYh0K3WNzTy9cgePLN7K4s17SUsxLjhxCB+eM4p3TczrccOjHaEAJ5Fh8Q1ElN8kqsxsHvBTIBW4192/206bq4BvEdv6cIW7X5vUIkWSqLS6jt8v2spDi7ZQvq+B/Nxsvn7xCXzo5JHk9Q3/ZrpBUoCTyHBt5SsRZmapwN3AhUAJsNjM5rv76oQ2E4HbgDPdfa+ZDQ6mWpGutXp7Ffe9tom/rNhOY0sL7z5hMJ88M5+54wdpiLSDFOAkctQDJxE1Byh09yIAM3sEuAxYndDm08Dd7r4XwN1Lk16lSBdasmUvP//HBhasK6N3RirXzBnFdWfmk5+bHXRpkRPKAGdmWcArQCaxGp9w9/9q0+Y64PvAtvhDd7n7vcmsU4KhnjiJqBFAccL9EuC0Nm0mAZjZ68SGWb/l7s+1fSEzuxG4EWD06NFdUqxIZ3qjqJyf/6OQ1wp3MzA7g69cNJmPnjaGnN7pQZcWWaEMcEA9cL6715hZOvCamT3r7ovatHvU3W8JoD4JQGvPm3rgJKLaGxdq+9OcBkwEzgVGAq+a2TR3rzjoSe73APcAzJ49W/8iJLRWllTw3WfX8s+N5eT2yeAb7z2Bj5w2huwesNFuVwvl36C7O1ATv5se/9JJSgD9IEhklQCjEu6PBLa302aRuzcCm8xsHbFAtzg5JYp0juI9+/n+8+uYv2I7A7Mz+OYlU7h2zmh6ZaQGXVq3EcoABwcm/C4BJhCbE/JGO80+ZGbvAtYD/+7uxW0baKih+3F1wUk0LQYmmlk+sakfVwNtV5g+BVwD/M7McokNqRYltUqR41BV18jPX9zA/f/cQkoK3HLeBD5zzjj6ZmmotLOFNsC5ezMw08z6A3+KDyOsSmjyF+Bhd683s5uA+4Hz23kdDTV0E97mT5EocfcmM7sFeJ7Y/LbfuPvbZnYHUODu8+PH3mNmq4Fm4CvuXh5c1SId4+7MX7Gd/3l6Dbtr6rnylJF88cLJDM3JCrq0biu0Aa6Vu1eY2QJgHrAq4fHEk9qvgTuTXJoERB1wElXu/gzwTJvHbk+47cAX418ikVBYWs03n3qbhUXlzBiZw32fmM30kf2DLqvbC2WAM7M8oDEe3noBF9AmoJnZMHffEb97KbAmyWVKYJTgRESC1tTcwi9f3shPX9xAr/RU/ufyaVwzZ7SumpAkoQxwwDDg/vg8uBTgMXf/a5uhhs+b2aVAE7AHuC6waiWpWpTfREQCVVhazZceW8GKkkreN30Y/33pVHL76MoJyRTKAOfuK4FZ7TyeONRwG7Edy6WH0RCqiEgwWlqc37y+ie89v47sjFTuunYWl0wfHnRZPVIoA5zI4WgjXxGR5Nuzr4EvPbacl9aVccGJQ/jOB0/S9UoDpAAnkaGNfEVEglGweQ//9vAyymsa+PZlU/no6WN0zdKAKcBJ5CjAiYgkh7tz32ub+M6zaxnRvxdPfm4u00bkBF2WoAAnEaQhVBGRrtfQ1MJ//OktHl9SwkVTh/D9K2fQTxvyhoYCnERILLipB05EpGuV19Tz2d8v5c3Ne/j8+RP4wgWTSNH2IKGiACciIiIHbNq9j4//5g1Kq+r52TWzuHSGVpmGkQKcRI564EREusaqbZVc99s3aXF49DNnMHOUrqgQVgpwEhkHVqFqDpyISKdbuLGcTz9QQE6vdB64fg7j8/oEXZIchgKcRI564EREOtfL68v49AMFjBnYmweun8OwnF5BlyRHoAAnkdG65VCLEpyISKd5bcNuPv1AARPy+vDQDacxIDsj6JKkA1KCLkCko/41hCoiIp3hnxt3c/39ixmXm63wFjEKcBI56oATETl+S7bs4frfFTBmUG+FtwhSgJMIUoITETkehaU1XH9/AUNzsnjohtMZ1EfXNI0aBTiJjNbYph44EZFjV1pVxyd+8yZpKcb9n5yjC9JHlBYxSOQov4mIHJua+iY++bvF7N3fwCM3ns7oQb2DLkmOkQKcRI564EREjl5Li/Olx5azdmc1935iNtNHapPeKNMQqkSGux/0p4iIdNzdLxXy/Nu7uO3iEzhv8uCgy5HjpAAnkaP4JiJydF5cs4sf/X09l88czvVn5QddjnQCBTiJjJbWfeCU4EREOqx4z36+8Ohypgzrx3c+OB1r3RVdIk0BTiLjwBCq+uBERDqksbmFzz+yDBx++dFT6JWRGnRJ0klCGeDMLMvM3jSzFWb2tpn9dzttMs3sUTMrNLM3zGxs8iuVZNI2IiIiR+enf9/Asq0V/L8PnsSogVpx2p2EMsAB9cD57j4DmAnMM7PT27S5Htjr7hOAHwN3JrlGSTLXEKqISIf9c+Nu7l5QyFWzR/L+GcODLkc6WSgDnMfUxO+mx7/a/tq+DLg/fvsJ4N2mgf1uTUOoEnVmNs/M1sVHDr7ezvHrzKzMzJbHv24Iok6Jvpr6Jr7y+EryB2XzrUunBl2OdIFQBjgAM0s1s+VAKfCCu7/RpskIoBjA3ZuASmBQO69zo5kVmFlBWVlZV5ctXUiLGCTKzCwVuBu4GJgCXGNmU9pp+qi7z4x/3ZvUIqXbuPPZtWyvrOX7V86gd4a2fO2OQhvg3L3Z3WcCI4E5ZjatTZP2etve8avd3e9x99nuPjsvL68rSpUkaTnQAycSSXOAQncvcvcG4BFiIwkinWpRUTkPLtrCJ+fmc8qYAUGXI10ktAGulbtXAAuAeW0OlQCjAMwsDcgB9iS1OEmqfy1iUISTSDowahBXEn+srQ+Z2Uoze8LMRrX3QhpZkEOpbWjma39cyeiBvfnyRZOCLke6UCgDnJnlmVn/+O1ewAXA2jbN5gOfiN++AviH6zd7t+bqgZNo68iowV+Ase4+Hfg7/5rne/CTNLIgh/CLlzeypXw/3/3gSRo67eZCGeCAYcBLZrYSWExsDtxfzewOM7s03uY+YJCZFQJfBN4xIVi6J+V0iagDowZxI4HtiQ3cvdzd6+N3fw2ckqTapBso3rOfX768kffPGM7cCblBlyNdLJTx3N1XArPaefz2hNt1wJXJrEuCZRjgNDUrwEkkLQYmmlk+sA24Grg2sYGZDXP3HfG7lwJrkluiRNm3/7qaVDO+8d4Tgi5FkiCUAU6kPa2bxDS3KMBJ9Lh7k5ndAjwPpAK/cfe3zewOoMDd5wOfj48yNBGb03tdYAVLpLyyvoy/rd7FVy6azLCcXkGXI0mgACeR0RrgmhTgJKLc/RngmTaPJY4s3Abcluy6JNqaW5z/eXo1Ywb15oazdaH6niKsc+BE3sHic8DVAyci8i9PLdvG+l01fPWiE8hM07VOewoFOImMFPXAiYgcpL6pmR+9sJ6TRuRw8bShQZcjSaQAJ5GREh9DbWpuCbgSEZFw+MMbW9lWUctX500mJUVXk+xJFOAkMjQHTkTkX2obmrn7pULOGDeIs7RtSI+jACeRYaY5cCIirR5dvJXdNQ38+4WTDpwfpedQgJPIUA+ciEhMQ1ML97xSxKljBzAnf2DQ5UgAFOAkMlIO9MBpDpyI9Gx/Xr6N7ZV1fO68CUGXIgFRgJPI0CpUEZHYNJJfvLyRKcP6ce4kXQu3p1KAkwhpXYWqACciPdeLa3ZRVLaPz503XnPfejAFOImQWHBTD5yI9GT3L9zM8Jws5k3Vvm89mQKcREZjvOdNc+BEpKfasKua1wvL+cjpY0hL1a/wnkz/9yUyWjfwVQ+ciPRU9y/cTEZaCtfMGR10KRIwBTiJjMZ4cGvWHDgR6YEqaxv545JtXDpjOAOzM4IuRwKmACeR0bqBr3rgRKQnmr9iO7WNzXz8jDFBlyIhoAAnkeDuCQFOc+BEpOd5vKCYE4b25aQROUGXIiGgACeR0JgwbKpLaYlIT7NuZzUrSyq5cvYobR0igAKcRERir5v2gRORnubxgmLSUozLZw4PuhQJiVAGODMbZWYvmdkaM3vbzG5tp825ZlZpZsvjX7cHUaskR+K8N/XAiUhP0tjcwlPLt/HuEwczqE9m0OVISKQFXcAhNAFfcvelZtYXWGJmL7j76jbtXnX3SwKoT5IssddNixhEpCd5ZX0Zu2sauPKUUUGXIiESyh44d9/h7kvjt6uBNcCIYKuSILXuAQfqgRORnuWvK3eQ0yudd+m6p5IglAEukZmNBWYBb7Rz+AwzW2Fmz5rZ1EM8/0YzKzCzgrKysi6sVLpSY0tiD5xWoYpIz1DX2MwLq3dx0dQhZKSF/le2JFGofxrMrA/wR+AL7l7V5vBSYIy7zwB+DjzV3mu4+z3uPtvdZ+fl6dNLVDU2aRGDiPQ8r6wvo6a+ifdN1+IFOVhoA5yZpRMLbw+5+5Ntj7t7lbvXxG8/A6SbWW6Sy5QkqU8McBpCFZEe4um3djCgdzpzxw8KuhQJmVAGOIttcnMfsMbdf3SINkPj7TCzOcS+l/LkVSnJVN9yprWaAAAgAElEQVTUfOC2hlBFpCeoa2zm76t3MW/aUNJ14XppI6w/EWcCHwPOT9gm5L1mdpOZ3RRvcwWwysxWAD8DrnZ3dc10U4k9cI1N+t8s0WRm88xsnZkVmtnXD9PuCjNzM5udzPokXBYWlbOvoZn3TB0adCkSQqHcRsTdXwMOu9W0u98F3JWciiRoDfEA1yczjbqE3jiRqDCzVOBu4EKgBFhsZvPbbo8U3zrp87S/cEt6kJfWltIrPZUzxmn4VN4prD1wIgdpHULtl5VGfaOGUCWS5gCF7l7k7g3AI8Bl7bT7NvA9oC6ZxUm4uDsvrinlzAm5ZKWnBl2OhJACnERCa2jr1ytdPXASVSOA4oT7JbTZ39LMZgGj3P2vh3shbY/U/W0orWFbRS3vPnFw0KVISCnASSS0zoHrl5WuHjiJqvamhRyY0GlmKcCPgS8d6YW0PVL39+KaUgDOm6wAJ+1TgJNIODCEqh44ia4SIPFaSCOB7Qn3+wLTgAVmthk4HZivhQw900trS5k6vB9Dc7KCLkVCSgFOIqF1EUNOr3TqGhXgJJIWAxPNLN/MMoCrgfmtB9290t1z3X2su48FFgGXuntBMOVKUGrqm1i6dS/n6NJZchgKcBIJB4ZQe6VR39SCdoyRqHH3JuAW4Hli13d+zN3fNrM7zOzSYKuTMFm8eQ9NLc6ZE7Q3vRxaKLcREWkrcQ6cOzQ0t5CZppVZEi3xq8Y80+ax2w/R9txk1CThs3BjORmpKZwyZkDQpUiIqQdOIqE+PmzaNyv2mSNxY18Rke5k4cZyZo3ur+1D5LAU4CQS6ptbyExLOXBC0zw4EemOKvc3smp7JWfo2qdyBApwEgn1jS1kpKWQmZZy4L6ISHfzxqZy3GHueM1/k8NTgJNIqG1oJjsj7UAPXL22EhGRbujNTXvITEthxqicoEuRkFOAk0jY19BE78zUAwGutkE9cCLS/SwrruCkETlapCVHpAAnkbC/oZneGan0yYwtYqipbwq4IhGRztXQ1MJb2yo5WatPpQMU4CQS9tU30TsjTQFORLqt1TuqaGhqYdao/kGXIhGgACeRsL+hmeyMVPrEtxHZpwAnIt3Msq17AZg1Wj1wcmQKcBIJsTlw/+qBq1aAE5FuZunWCobnZOn6p9IhCnASCfvrYz1wrRv51tQpwIlI97KiuIIZGj6VDlKAk0jY1xCbA5eZlkJqilFT3xh0SSIinaa6rpGte/YzbYS2D5GOUYCT0HP32By4zFTMjD6ZaeqBE5FuZe3OagBOHNY34EokKkIZ4MxslJm9ZGZrzOxtM7u1nTZmZj8zs0IzW2lmJwdRq3S9+qYWmluc3hmx4dM+mWnU1GsjXxHpPlZvrwJgyjD1wEnHpAVdwCE0AV9y96Vm1hdYYmYvuPvqhDYXAxPjX6cBv4j/Kd1MZW1suDSnVzoQu6C9hlBFpDtZvb2KgdkZDOmXGXQpEhGh7IFz9x3uvjR+uxpYA4xo0+wy4AGPWQT0N7NhSS5VkqBtgMvOTNM+cCLSrazZWcWJw/piZkGXIhERygCXyMzGArOAN9ocGgEUJ9wv4Z0hDzO70cwKzKygrKysq8qULtQ2wGkOnIh0J80tzrqd1ZwwtF/QpUiEhDrAmVkf4I/AF9y9qu3hdp7i73jA/R53n+3us/Py8rqiTOlilfvbBLisNO0DJyLdxvaKWuqbWpgwuE/QpUiEhDbAmVk6sfD2kLs/2U6TEmBUwv2RwPZk1CbJ1bYHrl9WOlW1mgMnIt3Dpt37AMjPzQ64EomSUAY4i00CuA9Y4+4/OkSz+cDH46tRTwcq3X1H0oqUpGkb4AZmp7N3fyMtLe/ocBURiZyishoAxuUpwEnHhXUV6pnAx4C3zGx5/LFvAKMB3P2XwDPAe4FCYD/wyQDqlCRoDXD9DgS4TJpbnOq6JnJ6pwdZmojIcdu0ex99MtPI66MVqNJxXRrgzOx+4FZ3r4jfHwD80N0/dbjnuftrtD/HLbGNAzd3Vq0SXpW1jfTNTCM1JfYjMTA7Ftr27G9QgJNAmNmVwHPuXm1m/wmcDPxP6+p5kaNRtHsf4/KytQJVjkpXD6FObw1vAO6+l9iKUpEOq6ptPND7BjCgdwYAe/Y1BFWSyDfj4e0s4CLgfmJ7UYoctS3l+xk7SMOncnS6OsClxHvdADCzgYR32FZCqrK28cD8N4CB2bEAt1cBToLTeimQ9wG/cPc/AxkB1iMR5e7srKpjWP+soEuRiOnqMPVD4J9m9gSxLT6uAv63i99Tupnd+xoY1OdfvxvVAychsM3MfgVcANxpZpmEdFGYhFvF/kYamloY0lcBTo5Ol55w3P0B4EPALqAM+KC7P9iV7yndz+7q+oMm97aGuT37FeAkMFcBzwPz4tNEBgJfCbYkiaJd1XUADOmnACdHp8uHM+PXL119xIYi7XB3ymrqye37rwDXKz2VzLQU9cBJYNx9P/Bkwv0dwBG3MTKzecBPgVTgXnf/bpvjNxFbnNUM1AA3trkGtHQzu6rqAXQNVDlq6vKXUKuub6KhqeWgHjgzY0i/LHZV1QVYmcjRMbNU4G7gYmAKcI2ZTWnT7A/ufpK7zwS+BxxqH0zpJnZVqgdOjo0CnITa7urYp9PcvgfPDx/aL4sdlQpwEilzgEJ3L3L3BuAR4LLEBm0uGZhNO5cHlO6l9YPoYPXAyVFSgJNQ210TGybNbbPB5dAc9cBJ5IwAihPul8QfO4iZ3WxmG4n1wH2+vRcysxvNrMDMCsrKyrqkWEmO7ZV1DMrOIDMtNehSJGIU4CTUylp74NoEuGE5sR642H7OIpHQ3i6t7/gBdve73X088DXgP9t7IXe/x91nu/vsvLy8Ti5Tkqlk735GDOgVdBkSQQpwEmql8RVag/seHOCG9MuioamFvft1UXuJjBJgVML9kcD2w7R/BLi8SyuSwG2rqGWkApwcAwU4CbVte2vJSk85sHlvq2E5sQm/OzUPTqJjMTDRzPLNLAO4Gpif2MDMJibcfR+wIYn1SZK1tDjb9tYyor8CnBw9XRVBQm17ZS3D+/d6xzUCh7YGuKpapgzvF0RpIkfF3ZvM7BZi+8elAr9x97fN7A6gwN3nA7eY2QVAI7AX+ERwFUtX21FVR31TC2NzdRktOXoKcBJq2yrq2v102hrgtleoB06iw92fAZ5p89jtCbdvTXpREpiNpTUAjMvtE3AlEkUaQpVQ215Ry/Ccdwa4wX2zSE81SvbWBlCViMjxKyqLBbjxeeqBk6OnACehVd/UTFl1PcPb6YFLTTFGDezNlvJ9AVQmInL8inbvo29mGnl9tQecHD0FOAmt1gUKw/u3v0P52EHZbNqtACci0VRUto9xednvmOMr0hEKcBJa2+LDo+31wEEswG0p36+94EQkkjaW1TAuT/Pf5NgowElobdmzH4Axg3q3e3xsbm9qG5spjW/2KyISFRX7G9hRWccJQ/sGXYpElAKchNam3fvISEtpdxEDxHrgADZrGFVEImb1jthlb7UNkhyrUAY4M/uNmZWa2apDHD/XzCrNbHn86/b22km0FZXtI39QNikp7c8PyY/vnbSxTAFORKJl9fZYgDtxmAKcHJuw7gP3O+Au4IHDtHnV3S9JTjkShKLdNUwafOjhhRH9e9EnM421O6uSWJWIyPFbs6OawX0z33GdZ5GOCmUPnLu/AuwJug4JTlNzC1vL95N/mP2RUlKMyUP7snZHdRIrExE5fqt3VKn3TY5LKANcB51hZivM7Fkzm3qoRmZ2o5kVmFlBWVlZMuuT41Cyt5amFj8wTHooJw7ry5qdVVqJKiKR0dDUQmFptea/yXGJaoBbCoxx9xnAz4GnDtXQ3e9x99nuPjsvLy9pBcrxWbcr1qs2cfDhl9ifMLQf1XVNbKvQFRlEJBoKS2tobHb1wMlxiWSAc/cqd6+J334GSDez3IDLkk60ZkcVZjD5CEvsTxzWN95ew6giEg0rSioAOGlETsCVSJRFMsCZ2VCLb11tZnOIfR/lwVYlnWnNjiryB2XTO+Pw62wmD+2H2b9WdImIhN2yrXsZ0DudsYfY41KkI0K5CtXMHgbOBXLNrAT4LyAdwN1/CVwBfNbMmoBa4GrXJKhuZe3OaqZ2YH5In8w0Jg7uw7LivUmoSkTk+C3bWsGs0QN0CS05LqEMcO5+zRGO30VsmxHphmrqm9hSvp8rTh7ZofYnjx7As6t20tLih9wzTkQkDCprG9lQWsOlM4YHXYpEXCSHUKV7W7fz6Da4PHnMACprGynaXdOVZYmIHLeV8flvs0YPCLgSiToFOAmdt0oqAZg6omMB7pQxsRPh0i0VXVaTiEhnWLa1AjOYPkoLGOT4KMBJ6CzdWsGwnCyGHeIaqG2Ny81mQO90Fm/W3s8iEm7Ltu5l4uA+9MtKD7oUiTgFOAmdZcV7mTW6f4fbmxlnjB/Ea4W7taGviIRWc4uzZMveA6MGIsdDAU5Cpay6nuI9tcwadXQnuLMn5rGjso6NZZoHJyLhtGZHFVV1TZw+blDQpUg3oAAnobJsa2w7kJPHdLwHDuCsCbF9nF9Zv7vTaxIR6QyLimLblZ6WrwAnx08BTkJl8eY9ZKSmMHX40U3wHTWwN+Nys3llg653KyLhtKionPzcbIbmZAVdinQDCnASKq8XlnPKmAFkpace9XPPnpjLoqJyahuau6AyEZFj19zivLFpj4ZPpdMowElo7N3XwOodVcwdf2wnuPdMHUpdYwsvry/t5MpERI7P6u1VVNc1cfq4gUGXIt2EApyExsL4/JC58flsR+u0/IEMzM7gmbd2dmZZIiLHrXX+m3rgpLMowElovF64mz6ZacwYeWwbXKalpnDR1CG8uGYXdY0aRpXwMbN5ZrbOzArN7OvtHP+ima02s5Vm9qKZjQmiTul8rxXuZlxuNkP6af6bdA4FOAkFd+fVDbs5LX8gaanH/mN58bRh7GtoZsE6LWaQcDGzVOBu4GJgCnCNmU1p02wZMNvdpwNPAN9LbpXSFeoam1lUVM67JuUFXYp0IwpwEgobSmvYumc/5584+LheZ+74QQzum8kTS4o7qTKRTjMHKHT3IndvAB4BLkts4O4vufv++N1FwMgk1yhdYGFROfVNLZw7WQFOOo8CnITCC6t3AXDBiUOO63XSUlO44pSR/GNtKTsr6zqjNJHOMgJI/GRREn/sUK4Hnm3vgJndaGYFZlZQVqbe5rB7eV0ZmWkpmv8mnUoBTkLhhdW7mDEyp1Pmh1w1exQtDn9cWtIJlYl0GmvnsXav/WZmHwVmA99v77i73+Pus919dl6eenXC7uX1ZZwxftAxbY8kcigKcBK40uo6lhdXcOGU4+t9azU2N5vTxw3kkcVbaW7RtVElNEqAUQn3RwLb2zYyswuA/wAudff6JNUmXWRL+T427d7HeZOPb3qISFsKcBK4A8OnnRTgAD5+xliK99Tyt7e1pYiExmJgopnlm1kGcDUwP7GBmc0CfkUsvGlDw26gdUGV5r9JZ1OAk8D9efl2xudlM3lI3057zYumDmX0wN786pUi3NULJ8Fz9ybgFuB5YA3wmLu/bWZ3mNml8WbfB/oAj5vZcjObf4iXk4j4x9pS8nOzGTMoO+hSpJtJC7oA6dm2VdTy5qY9fOnCSZi1N0Xo2KSmGDecnc/tf36bgi17OXWsdj+X4Ln7M8AzbR67PeH2BUkvSrpMZW0j/9y4m0+dmR90KdINhbIHzsx+Y2alZrbqEMfNzH4W3wxzpZmdnOwapXPMXx6bAnTZzMMtxjs2V54yioHZGfz07xs6/bVFRI7kpbWlNDY7F00bGnQp0g2FMsABvwPmHeb4xcDE+NeNwC+SUJN0Mnfnz8u3cfLo/owe1LvTX79XRio3nzeB1wp383rh7k5/fRGRw3lu1U6G9Mtk5sj+QZci3VAoA5y7vwLsOUyTy4AHPGYR0N/MhiWnOuksK0sqWbuzmg+c3HV7lX7ktNEMz8nie8+t1Vw4EUma2oZmFqwv5aKpQ0lJ6bzpISKtQhngOqDDG2Jqw8vweuiNLfTOSOXymcO77D2y0lP5woWTWFFSyV9X7uiy9xERSfTy+jLqGluYN1XDp9I1ohrgOrwhpja8DKfK2kbmr9jOZTNH0DcrvUvf60Mnj2Tq8H78z9Orqalv6tL3EhEBeG7VDvr3TmdOvhZQSdeIaoDr0IaYEl5/WlpCXWMLHzltdJe/V2qK8T+XT6O0up6fvLC+y99PRHq22oZmXli9i3lTh5KWGtVfsxJ2Uf3Jmg98PL4a9XSg0t01PhYRLS3Og4u2MH1kDtNG5CTlPWeNHsDVp47mt//czIriiqS8p4j0TC+s2cW+huYuWV0v0iqUAc7MHgYWApPNrMTMrjezm8zspniTZ4AioBD4NfC5gEqVY/Di2lI2lu3j+rOSuzfS1y8+gcF9M/n3x5ZT29Cc1PcWkZ7jqWXbGJaTxWkaPpUuFMqNfN39miMcd+DmJJUjneyeVzYyon8v3ndSchcO5/RK5wdXzuAj977Bd59dw39fNi2p7y8i3d+efQ28sr6M68/K1+pT6VKh7IGT7mvJlr0s3ryXG87OD2RuyJkTcvnUmfncv3ALz63SdVJFpHM9vXI7TS3O5bM0fCpdSwFOkupXL28kp1c6V80edeTGXeSr8yYzY2QOX358BYWl1YHVISLdz1PLtzN5SF9OHNYv6FKkm1OAk6RZta2Sv63exXVzx5KdGdzofVZ6Kr/46Clkpadw44NLqKprDKwWEek+ispqWLJlr3rfJCkU4CRpfvC3deT0Suf6s4O/sPPw/r24+9qT2Vq+n8/+fgn1TVrUICLH55HFxaSlGB86RQFOup4CnCRFweY9LFhXxk3njKdfF2/c21GnjRvEnR+azuuF5XzxsRU0t+hSWyJybOqbmnliSQkXnDiEwX2zgi5HeoBQrkKV7sXd+cHf1pHbJ5NPzB0TdDkH+dApIynfV8//e2YtA3tncMdlUzHTyjEROTovrN7Fnn0NXD0nuPm90rMowEmXe2ldKYuK9vCt90+hd0b4fuRufNd4ymsa+NUrRTjOHZdO0/J/ETkqD7+5lRH9e3H2RF2yUZIjfL9NpVtpaGrh239dw/i8bD5yerh63xJ9/eITwOBXLxfR0NTCdz44nVSFOBHpgC3l+2JTMS6cpPOGJI0CnHSp3/1zE5t27+N3nzyV9BBfE9DM+Pq8E8hMS+VnL26gsraRn3x4Fr0yUoMuTURC7nf/3ExaivHhUzV8KskT3t+oEnll1fX87MVCzj9hMOdOHhx0OUdkZnzxwkncfskU/rZ6F1ffs5DS6rqgyxKREKuua+TxghIumT6MIf20eEGSRwFOusx3nl1DXWMz//m+E4Mu5ah86qx87vnYbNbvquEDd/+TlSUVQZckIiH1WEEJNfVNfCrJ13YWUYCTLvHqhjKeXLqNz5wzjnF5fYIu56hdOGUIj33mDNydK36xkAcXbiZ2CV4RkZjmFud3/9zE7DEDmD6yf9DlSA+jACedbn9DE9/401uMy83m386fGHQ5x+ykkTk8/fmzmTthEN/889v828PLqNyvqzaISMwLq3dRvKeW69X7JgFQgJNO9+MX1lO8p5bvfPAkstKjvQhgQHYGv/nEqXzlosk8u2on7/nJyyxYVxp0WSISMHfnFy9vZNTAXlw4ZUjQ5UgPpAAnnWp5cQX3vbaJa08bzWnjBgVdTqdISTFuPm8Cf/rcXPplpXPdbxdz25MrqaxVb5xIT/Va4W5WFFfw2XMmkBbiFfbSfemnTjrNvvomvvDIMobl9Irtq9bNTB/Zn7/821l85pxxPLq4mHf/cAFPLCmhRZfgEulxfv5iIUP7Zem6pxIYBTjpNN/+62q27NnPD6+aEZrrnXa2rPRUbrv4RObfchajB/bmy4+v4MpfLWTVtsqgS5MIMLN5ZrbOzArN7OvtHH+XmS01syYzuyKIGuXI3igq583Ne/jMOePITIv2NBGJLgU46RTPrdrJI4uLuemc8ZzeTYZOD2faiByeuGku37tiOpt37+P9d73GrY8sY0v5vqBLk5Ays1TgbuBiYApwjZlNadNsK3Ad8IfkVidH466XCsntk8E1c0YHXYr0YApwctx2VdVx25MrmTaiH/9+waSgy0malBTjqtmj+MeXz+Wz54zn+bd38u4fvsx/PvUWu6q0AbC8wxyg0N2L3L0BeAS4LLGBu29295VASxAFypEt3FjOqxt28+mzx0V+kZZEW2gDXAeGGq4zszIzWx7/uiGIOnu6xuYWbn5oKfVNLfzkw7PISAvtj1SXyemVzlfnncArXzmPa+aM5pE3izn7zpe47cm32LxbPXJywAigOOF+Sfyxo2ZmN5pZgZkVlJWVdUpxcmTuznefW8vQfll8Yu7YoMuRHi6Uv207ONQA8Ki7z4x/3ZvUIgWA7z67loIte/nuh6YzYXD0NuztTIP7ZfHty6fxjy+dy5WzR/LHpSWc/8MF3PyHpbxVojlyQntXOT+mFTDufo+7z3b32Xl5ecdZlnTUc6t2sqK4gi9eOEm9bxK4sF7M/sBQA4CZtQ41rA60KjnIM2/t4L7XNnHd3LFcOmN40OWExuhBvfnfD5zErRdM5Levb+b3C7fw9ModzBrdn4+dPob3njRMJ/+eqQRIvNr5SGB7QLXIUWpsbuH7z69j4uA+fPBkrTyV4IWyB46ODzV8yMxWmtkTZjaqneMaaugiG8tq+OoTK5k1uj/feG+0rnWaLIP7ZvG1eSfw+m3nc/slU6jc38gXH1vBGd95ke88u4ZNGl7taRYDE80s38wygKuB+QHXJB30yOJiinbv46vzTtC+bxIKYf0p7MhQw1+Ase4+Hfg7cH97L6Shhs5Xsb+BG+4vIDMthbuvPblHzns7Gv2y0vnUWfm8+KVzeOiG0zgtfxD3vrqJ836wgA/83+s8uGgLFfsbgi5Tupi7NwG3AM8Da4DH3P1tM7vDzC4FMLNTzawEuBL4lZm9HVzF0mrPvgZ+8Pw6Th83kAtOHBx0OSJAeIdQjzjU4O7lCXd/DdyZhLp6vMbmFj77+6Vs21vLHz59GsP79wq6pMgwM86ckMuZE3LZVVXHU8u28eTSbXzzqVXc8Ze3Of+EwVw6YwTnTs4jOzOs/zTleLj7M8AzbR67PeH2YmLnOwmR7z23ln31Tdxx2TTM2utfEEm+sP6WODDUAGwjNtRwbWIDMxvm7jvidy8l9olWupC7c/ufV7GwqJwff3gGs8cODLqkyBrSL4vPnDOeG981jtU7qnhy6Tb+vHw7z7+9i8y0FN41KY+Lpw3l3ScMIad399wUWSQKlm3dy6MFxdxwVj6ThvQNuhyRA0IZ4Ny9ycxahxpSgd+0DjUABe4+H/h8fNihCdhDbPNL6UL3vbaJh98s5ubzxvOBWeok6AxmxtThOUwdnsM33nsiizfv4blVO3lu1U5eWL2LtBTjjPGDOHfyYM6ZlMf4vGz1AIgkSVNzC7f/+W3y+mRyaw/a41Kiwdx7znUcZ8+e7QUFBUGXEUnPvLWDm/+wlIumDOX/PnIyKSkKEV2ppcVZUVIRC3JrdlFUFlvwMHJAL86dnMc5kwYzd/wgDbUmMLMl7j476DqSTee1rvOLBRu587m13HXtLC6ZrpX2knyHO6/p7C9H9Hrhbr7wyHJOGT2AH394psJbEqSkGLNGD2DW6AHc9t4TKd6znwXry3h5XRlPLt3G7xdtJS3FmDGqP6flD+T0cYM4ZcwABTqRTrJhVzU/fmE9F08byvtOGhZ0OSLvoLO9HNZbJZXc+EAB+bnZ3PeJU+mVof3LgjBqYG8+dvoYPnb6GOqbminYvJdXN+zmjU3l/OqVIv5vwUbSUoyTRuZw+rhBzMkfyMyR/RmQnRF06SKR09TcwpcfX0GfrDS+fbkWLkg4KcDJIW3avY/rfvsm/Xtn8MD1czSZPiQy01IPrGYFqKlvYsmWvbxRVM6ionJ+/UoRv1iwEYCxg3oza/QAZo7qz8xR/TlxWD9t+yJyBP+3YCMrSiq569pZ5PbJDLockXYpwEm7ivfs56P3voEDD14/hyH9soIuSQ6hT2Ya50zK45xJsX0O9zc0saK4kuXFFSzbupfXC3fzp2XbAMhIS2Ha8H5MG5HDlGH9mDK8H5OG9NWVIUTiFhWV85O/r+fymcM1703+f3v3HmRlfd9x/P3dPXu/usvCXmBZkLvYiKG7Kol/ZKCDmoRoL0FrqxY009ZJqk7TprUdmuk0ZtJm0ol1GhXHAVS00TqkoSotmsSqLCIXYUFY7steYe/3y/n1j3NYdjfALmQ5z3nO+bxmzux5nn0O+5kzh+/5Ps/ze35PVFMDJ7/mTGsP9z73ER29A7z88C3MLojve5z6TXpygFuvz+fW6/OB0PQvdW29ww3d3tNtvPHJGTb0nQQgMcG4viBjuKFbVJTDvMJMCjJTdOpI4srZzj6++cpuyvIz+Me7b/Q6jshlqYGTUWpbe7j32Y9o6xngpbUVLC7J8TqS/IbMjOLcNIpz07gzPBg7GHScbummqradqrp2qmrb2XG8mTf3XJgvOyctiblTM5kz4jF3WhbFOalq7CTmDAUdj726h9aeAV58qJxMXRAkUU6fUBlW39bLvc99REtXPxvXVvBb03O9jiTXSEKCMTM/g5n5Gdwx4gq75q5+Dta1c6ShgyONnRxp7GRbVQObd164NXF6ciJzpmYya0ro9WX56czMT2dmfgb5Gclq7sSX/mnrQX515CxP3XMji4qzvY4jMi41cAKEx7yt38G5zn42rinnphlq3uJRXkbyqAskzmvu6qe6sZMjjR1UN3ZS3djJrpMt/GxvLcERU0lmpgQozUunbEqooZuZl05pXjrFuWkU5aaSEtBYO4k+r1SeYv37x3nwtjJWl5d6HUdkQtTACYcbOrj/+R30DQbZuKacJaXXeR1JokxeRjLls/Ion0CddroAAAuRSURBVDX69mn9g0FqWro5ea6bE+e6OHmum5PnujhU18G2qgYGhkZPFD41K4Xi3DRKrkujJPfC4/y67NSAjuBJRP1f9Vn+7s393D6vgCfvWuh1HJEJUwMX53afauGhF3eSnJjAa9+4lfmFutefTFxyIIHZBZkXvdBlcChIXVsvp1u6OdPSQ21rL2dau6lt7aWqtp1tVQ30DwZHvSYzJcC07BQKc1IpzE7jnptLfu1ooMhk+eRUCw9v+JjZBRk8fd8SAomaYkf8Qw1cHPvVkSa+sXEXUzJT2LSmgtL8dK8jSQwJJCYwIy+dGXkX/1w55zjb2U9taw9nWnuobe2hpqWHhvZe6tt7+eDoWSpm5130tSK/qYN17Tz4QiUFWaH6l52qeS7FX9TAxanNlad48s39XF+QycY15UzVPG8SYWZGQVYKBVkpfE5jLiWC9p9p44EXKslICbBpTYXqn/iSGrg4Eww6vv/2IX7yi2PcPq+Ap+9boj1PEYkblcebWfPiTrJSA2xaW3HJI8Qi0U4NXBzp6hvkidf28taBeu6/pZR1X7lBYz5EJG68c6Ceb27eTXFuGpvWVFCcm+Z1JJGrpgYuTlQ3dvKnm3ZxtKmTJ+9ayJovzNLVfiISF5xz/Hh7NT/cdpjPTc9h/YO/rXuciu+pgYsDWz+t4y//Yy8pSYls+JMKvjBXV/WJSHxo6x7gr17fx1sH6rl7SQnfu+dG3ftXYoIauBjWOzDEU/99iBc/OMGS0lye+cObKcrRKQMRiQ8fHD3LE6/tpamjj7+9cyFrv6gzDxI71MDFqH01rTz26h6ONnXx0LIyvnPHQpIDGu8mIrGvrXuAH7xziJd2nGJWfgZv/NltujWgxBw1cDGmd2CIZ96t5pn3jg7Pb6RTpiISDwaHgvx0Vw0/ePszWrr7eeDWMr69cj7pyfqqk9gTtZ9qM1sJ/CuQCDzvnHtqzO9TgA3A54FzwNedcycinTOabD/UwLotVZxq7ubuJSWs++oN5KRpihARiW2DQ0He3FPLj7cf4eS5bj4/8zo2rqrQTeklpkVlA2dmicC/ASuAGmCnmW1xzlWN2GwN0OKcm2Nmq4HvA1+PfFrvfVrTxr9s+4z3PmtiztRMXl5bwW26/ZCIxLjGjl5erTzNy5WnqGvrZVFRNs/98VKWL5yqsW4S86KygQPKgWrn3DEAM9sMrAJGNnCrgHXh5z8FnjYzc86Nvnv2Vag83sze062YQYIZCQYJCYaFslxYZ4bZ+XXhbROM3LQkCrJSmJqVQl5G8jUpJM45dp1s4Se/PMa2qgZy05P4mzsX8OBtszTWTURi1rnOPt6pamDrp3V8ePQcg0HHF+dO4burFqtxk7gSrQ1cCXB6xHINUHGpbZxzg2bWBuQDZ0duZGaPAI8AlJaWTuiPbz/UyL//4uhVBR8rOzXA/MIs5k3LYkFRNouKsllQmEVGytW99Q3tvby1v55XKk9xqL6D7NQAj6+Yx0PLysjSHRVEopqGhlyZoaDjdHM3B2rb2XmimR3HmzlU345zUJafzsO3z+YPls5g1pQMr6OKRFy0NnAX24Uae2RtItvgnHsWeBZg6dKlEzo699iKuTz6pTkEncMFIehc+BE68uVgeDkYdDgXWnbAUDBIS/cATR191Lf1crSpk8MNHfxsby0v7TgVCm4wKz+DhcXZ3FAcaurmTssiPyN51PxEnX2DnGnp4VhTJ7tPt1J5vJk9p1sBWFSUzffuuZFVNxVrgK6ID8Tq0BDnQjUQQgX4fI28sG7E78M/+4eCdPUN0tU3SGffIF19Q7R099PQ3kt9Wy/17b0cP9vF0aZOegeCAKQlJbK07DoeXz6P5YumsaAwS0fbJK5F6zd/DTBjxPJ0oPYS29SYWQDIAZon44+nBBK5ygNkl+Sco7atl6ra9tCjro19Na38fF/dqO2SAwkkGAwOOQaDF/rN5MQEFpdk88SKeaxcXMicqZkqXiL+4unQkB/9z2HWv398eDf3cs2WO7/BmHXnY4x8zWRLTUqgMDuVGXnp3DJ7JvOnZTG/MItFxdkk6dZ/IsOitYHbCcw1s1nAGWA1cN+YbbYADwAfAr8HbJ+MInetmBkluWmU5KaxYtG04fVtPQMcqmvnaFMXrT39tHUP4IBAgpGdlkRJbhqleeksKMoiJaDZw0V8zNOhIYuLc/jdm6eHxu2GT2CEnjM8lhfCpzbC25zfRxzeZsw6zIZ/F1pnF/03GfP6QIKRmRIgIyUw/DM3PYlp2alkpwa0cyoyAVHZwIUL16PA24TGirzgnDtgZt8FPnbObQHWAxvNrJrQkbfV3iW+ejlpSVTMzqdidr7XUUTk2vJ0aMjyRdNYPmLnUUT8LSobOADn3FZg65h1fz/ieS/w+5HOJSJylTwdGiIisUUDCkREImN4aIiZJRM6a7BlzDbnh4aAD4aGiIh3ovYInIhILImnoSEicu2pgRMRiRANDRGRyaJTqCIiIiI+owZORERExGfUwImIiIj4jBo4EREREZ9RAyciIiLiMxZPUwyZWRNwcoKbT2HM7Wt8QJkjw4+ZwZ+5ryTzTOdcwbUME41U16KSMkeOH3NPSl2LqwbuSpjZx865pV7nuBLKHBl+zAz+zO3HzNHMj++nMkeGHzODP3NPVmadQhURERHxGTVwIiIiIj6jBu7SnvU6wFVQ5sjwY2bwZ24/Zo5mfnw/lTky/JgZ/Jl7UjJrDJyIiIiIz+gInIiIiIjPqIETERER8Rk1cGOY2Uoz+8zMqs3sr73OMxFm9oKZNZrZfq+zTJSZzTCzd83soJkdMLNveZ1pPGaWamaVZrY3nPkfvM40UWaWaGa7zey/vM4yUWZ2wsw+NbM9Zvax13n8THUtMlTXIive65rGwI1gZonAYWAFUAPsBO51zlV5GmwcZnY70AlscM4t9jrPRJhZEVDknPvEzLKAXcDXovm9NjMDMpxznWaWBLwPfMs595HH0cZlZo8DS4Fs59yXvc4zEWZ2AljqnPPbJJ1RRXUtclTXIive65qOwI1WDlQ754455/qBzcAqjzONyzn3S6DZ6xxXwjlX55z7JPy8AzgIlHib6vJcSGd4MSn8iPo9IDObDtwFPO91FvGE6lqEqK5FjuqaGrixSoDTI5ZriPL/fLHAzMqAJcAOb5OML3zIfg/QCGxzzkV9ZuBHwLeBoNdBrpAD3jGzXWb2iNdhfEx1zQOqa9dc3Nc1NXCj2UXWRf2eiJ+ZWSbwOvAXzrl2r/OMxzk35Jy7CZgOlJtZVJ/aMbMvA43OuV1eZ7kKy5xzNwN3AH8ePqUmV051LcJU164t1bUQNXCj1QAzRixPB2o9yhLzwuMtXgdecs694XWeK+GcawXeA1Z6HGU8y4CvhsddbAa+ZGabvI00Mc652vDPRuA/CZ0KlCunuhZBqmsRobqGGrixdgJzzWyWmSUDq4EtHmeKSeGBs+uBg865H3qdZyLMrMDMcsPP04DlwCFvU12ec+47zrnpzrkyQp/n7c65+z2ONS4zywgPAsfMMoDfAXxzNWKUUV2LENW1yFBdC1EDN4JzbhB4FHib0ODT15xzB7xNNT4zewX4EJhvZjVmtsbrTBOwDPgjQntOe8KPO70ONY4i4F0z20foS3Gbc843l6/7zDTgfTPbC1QCP3fOveVxJl9SXYso1TW5nEmta5pGRERERMRndARORERExGfUwImIiIj4jBo4EREREZ9RAyciIiLiM2rgRERERHwm4HUAkclkZvnA/4YXC4EhoCm8XB6+F6SIiG+orsnFaBoRiVlmtg7odM79s9dZREQmg+qanKdTqCIiIiI+owZORERExGfUwImIiIj4jBo4EREREZ9RAyciIiLiM2rgRERERHxG04iIiIiI+IyOwImIiIj4jBo4EREREZ9RAyciIiLiM2rgRERERHxGDZyIiIiIz6iBExEREfEZNXAiIiIiPvP/jopfjPLWOKwAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We find there is a critical temperature $T_c$ where the specific heat equation diverges. We can compute the value of this as satisfying:

$$ sinh\left(\frac{2J_H}{T_c}\right)sinh\left(\frac{2J_V}{T_c}\right) = 1 $$

In the case where $J_H = J_V = J$ we have:

$$T_c = \frac{2 J}{ln\left(1+\sqrt{2}\right)} $$

This is an example of a second order phase transition since the discontinuity only arises under a second derivative.&lt;/p&gt;
&lt;p&gt;For temperatres under this critical temperature we have that the spontaneous magnetization can be calculated as:

$$ m = \left[ 1 -  csch^2\left(\frac{2J_H}{T}\right)csch^2\left(\frac{2J_V}{T}\right)   \right]^{\frac{1}{8}} $$
&lt;/p&gt;
&lt;p&gt;We can plot this (for $J_H = J_V = J = 1$) as:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code plots the spotaneous magnetization of &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# a 2d Ising model on a square-lattice&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set up temperature array&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1e-4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_min&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix interaction strength constant&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;T&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetization&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;2d Ising Model Spontaneous Magnetization&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Critical Temp (Tc):&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Critical Temp (Tc): 2.269185314213022
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The correlation function is harder to compute, here we just present the correlation function between elements on the diagonal of the lattice:&lt;/p&gt;
&lt;p&gt;
$$ \langle \sigma_{0,0} \sigma_{N,N} \rangle = det \left[ A_N \right]$$

Where $A_N = (a_{n,m})_{n,m=1}^N$ is an $NxN$ matrix with entries:

$$ a_{n,m} = \frac{1}{2 \pi} \int_0^{2\pi} e^{i(n-m)\theta} \sqrt{\frac{sinh^2(2\beta J) - e^{-i\theta}}{sinh^2(2\beta J) - e^{i\theta}} } d\theta $$
&lt;/p&gt;
&lt;p&gt;We can plot this as so:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# This code plots the diagnoal correlation function&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# For the 2d square-lattice Ising model&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Lattice size = NxN&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# At the critical temperature&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.integrate&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set up integrand function&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;complex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sinh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up constants&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Set up arrays&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;correl_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;A_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integrand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;J&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;A_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;correl_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;det&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot correlations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$\langle \sigma_{0,0} \sigma_{N,N} \rangle$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Correlation Function&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that even though we have short range interactions (nearest neighbour) this gives rise to longer-range structure within the model. In fact we find for temperatures below the critical temperature there is an infinite correlation length, whereas for temperatures above the critical temperature the correlation length is finite.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Infinte-Dimension-Ising-Model&quot;&gt;Infinte Dimension Ising Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Infinte-Dimension-Ising-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Next we consider the situation where the Ising model exists in infinite dimensions. In this case each site has infinitely many neighbours, as such a mean-field approximation is valid and we have a model that is somewhat similar to the Sherrington-Kirkpatrick fully connected geometry. (Please excuse the lack of rigour here; one has to be careful in how limits are defined and it is a non-trivial exercise. For this blog post I don't want to go down into that sort of detail.)&lt;/p&gt;
&lt;p&gt;If each site has infinitely many neighbours we only need to concern ourselves with the ratio of positive and negative spin neighbours. By mean field if we take the probability of a positive spin as $p$ then via the Gibbs distribution we have:

$$ \frac{p}{1-p} = exp(2\beta H)$$

The average magnetization can then be calculated:

$$ \mathbb{E}\left[M\right] = (1)p + (-1)(1-p) = 2p - 1 = \frac{1 - exp(2\beta H)}{1 + exp(2\beta H)} = tanh(2 \beta H)$$
&lt;/p&gt;
&lt;p&gt;By investigating this function we can gain insight into spontaenous magnetization. Other similar arguments can be invoked for the other themodynamic properties. It is possible to show, as with the Sherrington-Kirkpatrick, that a phase transition occurs.&lt;/p&gt;
&lt;h2 id=&quot;n-d-Ising-Model-($n\geq3$)&quot;&gt;n-d Ising Model ($n\geq3$)&lt;a class=&quot;anchor-link&quot; href=&quot;#n-d-Ising-Model-($n\geq3$)&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Finally we look at the case where the dimension of the model is finite but strictly greater than 2. In this situation things get much trickier, in fact there are not many defined mathematical results in these systems and this is the subject of current research. As such I will just briefly outline some of the approaches that have been suggested to study these systems and their properties (presented in chronological order from when they were proposed):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Replica-Symmetry Breaking&lt;/strong&gt; - From our previous post on Sherrington-Kirkpatrick models we briefly looked at this sort of method. They were an obvious first choice in trying to deal with short range interactions. It has been shown that the &quot;standard&quot; techniques are insufficient but there have been extensions proposed that have shown some promise. Like in the infinite range model it suggests states have an ultrametric structure and uncountably many pure states.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Droplet Scaling&lt;/strong&gt; - The first such argument being presented by Rudolf Peierls. The main idea is to consider the arisal of &quot;loops&quot; or &quot;islands&quot; of spins (clusters of atoms all with the same spin being enclosed by some boundary). We then aim to count the number of such loops, often in high or low temperature ranges via approximation. This leads to only 2 pure states.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Chaotic Pairs&lt;/strong&gt; - Has properties somewhat similar to a combination of the preceeding 2 methods, like replica symmetry breaking there are infinitely many thermodynamic states however the relationship between them is much simpler and has simple scaling behaviour - much like droplet scaling.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;TNT&lt;/strong&gt; - This interpretation does not itself specify the number of pure states, however it has been argued that it most naturally exists with 2 pure states - much like droplet scaling. However it has scaling properties more similar to that of replica symmetry breaking.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For completeness: a pure state of a system is a a state that cannot be expressed as a convex combination of other states.&lt;/p&gt;
&lt;p&gt;As far as I am aware there is currently no conesensus on which (if any) of the options presented is the correct interpretation.&lt;/p&gt;
&lt;p&gt;One of the main questions that we would like to answer is whether there is a phase transition (first order). This is unresolved currently. Another question we might ask is whether there exists multiple ground state pairs (i.e. we can find 2 different configurations that have minimal energy that are not merely negative images of each other) - again this is unresolved. In infinite dimensions we can see this would be true, in 1d we know this cannot be true - for other dimensions it is unclear (although it is believed it is probably not true for d=2).&lt;/p&gt;
&lt;p&gt;In addition to this there are many other unanswered questions that are the subject of current research into Ising type models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this blog post we have investigated some of the properties of square-lattice Ising models in various dimensions. In particular we have seen that there is no phase transition in 1d, a second order phase tranisition in 2d, a phase transition in infinite dimension and currently other dimensions are unresolved. We can see that the short-range interactions cause a lot of headaches when trying to analyse these systems. In the next blog post in this series we will begin to look at ways of simulating Ising models (and other spin glass models generally).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the first blog post in a series - you can find the next blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models-4&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/Ising3d.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/Ising3d.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Spin Glass Models 2: Sherrington-Kirkpatrick</title><link href="https://www.lewiscoleblog.com/spin-glass-models-2" rel="alternate" type="text/html" title="Spin Glass Models 2: Sherrington-Kirkpatrick" /><published>2020-03-10T00:00:00-05:00</published><updated>2020-03-10T00:00:00-05:00</updated><id>https://www.lewiscoleblog.com/Spin-Glass-Models-2</id><content type="html" xml:base="https://www.lewiscoleblog.com/spin-glass-models-2">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-10-Spin-Glass-Models-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the second blog post in a series - you can find the previous blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;From a previous blog post we now have a reasonable understanding of what a spin glass is, some of the (frankly) bizarre behaviours they exhibit and some motivation behind why we might want to wish to study them. In this blog post we will embark on studying our first spin glass model due to Sherrington-Kirkpatrick. (Note: this model is sometimes also called the fully-connected Ising model.)&lt;/p&gt;
&lt;p&gt;For our purposes we will just consider finding the properties and behaviours of interest rather than trying to capture exact behaviour of specific materials. As such we will assume measurement units are such that any constants &quot;disappear&quot; this should help with clarity. It is worth keeping this in mind if you look at any research on the topic (particularly in Physics journals) where extra terms may appear, these are typically to correct for units (e.g. to get energy measurements in Joules, distances in metres, etc.)&lt;/p&gt;
&lt;p&gt;It is also worth noting that this model was not the first spin glass model and some other models appeared before this one. I have chosen to start with this as it is in some ways the &quot;simplest&quot; model.&lt;/p&gt;
&lt;h2 id=&quot;Simplification&quot;&gt;Simplification&lt;a class=&quot;anchor-link&quot; href=&quot;#Simplification&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As with any good model we want to simplify the real world to a set of minimal requirements to capture the behaviour of interest. Recall the Hamiltonian for a general spin glass as:

$$ H = - \sum_{x,y} J_{xy} \sigma_x \sigma_y  - h \sum_x \sigma_x $$

In a real world spin glass $\sigma$ represent spins in the form of vectors denoting the direction the magnetic moment faces. It turns out that allowing for all range of orientation of spins is unnecessary to observe interesting behaviour. For modelling purposes $\sigma_x = \pm 1$ is usually sufficient.&lt;/p&gt;
&lt;p&gt;Turning our attention to interacting pairs now, we can simplify significantly here by assuming a fully connected model. That is each atom interacts with every other. This is particularly useful since it allows us to use a range of mathematical &quot;tricks&quot; through mean field type approaches. This is the key to the Sherrington-Kirkpatrick model and what differentiates it from other models (which we will review in a later blog post).
&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/fully-connected.png&quot; alt=&quot;&quot; title=&quot;Source: https://en.wikipedia.org/wiki/Complete_graph&quot; /&gt;&lt;/p&gt;
&lt;p&gt;This leaves us with one final assumption to make (excluding the external magnetic field): what values should $J_{xy}$ take. There are two options that we could use here to make our lives easier: the first is $J_{xy} = \pm \frac{J}{\sqrt{N}}$ - that is we select each interaction to be positive (ferromagnetic) or negative (antiferromagnetic) at random. Another option is to take values via a continuous probability distribution, typically a normal distribution owing to its &quot;nice&quot; mathematical properties. Typically we will want a mean of zero since we do not want the material to exhibit any magnetism in a ground state. We want to scale the standard deviation by $\frac{1}{\sqrt{N}}$ as in the bernoulli case. If we are using simulation we could try more &quot;exotic&quot; distributions (such as double fat-tail, assymetric distributions, etc) The scalings applied to the interaction weights is merely a convenience to allow us to scale the size of the spin glass in such a way as to allow population averages to remain comparable between glass size.&lt;/p&gt;
&lt;p&gt;We will thus define the Sherrington-Kirkpatrick Hamiltonian as:

$$ H_N = - \sum_{x,y} J_{xy} \sigma_x \sigma_y $$

With $J_{xy} \sim N(0,\frac{s^2}{N})$ iid (value of $s$ is somewhat irrelevant as long as it's not too large/small). We have removed the external magnetic field as it isn't crucial for the story we are telling here.&lt;/p&gt;
&lt;h2 id=&quot;An-Alternate-Interpretation&quot;&gt;An Alternate Interpretation&lt;a class=&quot;anchor-link&quot; href=&quot;#An-Alternate-Interpretation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;For those that are finding spin glasses and magnet terminology a little confusing or alien for this particular model we can introduce another interpretation in the form of the &quot;Dean Problem&quot;. Imagine you are the dean of a college hall, you have a number of students ($x, y$) who can like or dislike each other ($J_{xy}$). Your job is to place students in one of two groups ($\sigma = \pm 1$) so as to maximise the overall happiness of the students ($\sum J_{xy} \sigma_x \sigma_y$). We can note that this maximization problem is equivalent to the energy minimization problem presented by the spin glass (i.e. the minimization of a negative quantity is equivalent to the maximization of its modulus)&lt;/p&gt;
&lt;h2 id=&quot;Mathematical-Analysis&quot;&gt;Mathematical Analysis&lt;a class=&quot;anchor-link&quot; href=&quot;#Mathematical-Analysis&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The nice thing about the assumptions made by Sherrington-Kirkpatrick is that it allows for (comparatively) easy mathematical analysis. This is largely due its regularity (every atom looks like every other), by assuming arbitrarily large spin glasses we can also take limits and look at asymptotic behaviour. In other models this is not always possible and if it is it becomes increasingly more difficult.&lt;/p&gt;
&lt;p&gt;First question we will ask is what is the minimum value attained by the Hamiltonian? This is equivalent to:

$$M_N = max_{\sigma} \sum J_{xy} \sigma_x \sigma_y = max_{\sigma} \left[ - H_N \right]  $$

Where we are considering $N$ atoms in the system. We are using a slighlty sloppy notation for $max_{\sigma}$ to represent the maximum over all possible configurations.&lt;/p&gt;
&lt;p&gt;Studying maximum quantities mathematically is often difficult. To overcome this difficulty we instead look at the Helmholtz free energy function ($F_N$) instead:

$$F_N(\beta) = \frac{1}{N\beta} \mathbb{E}\left[ log \sum_{\sigma} exp(- \beta H_N) \right] $$
&lt;/p&gt;
&lt;p&gt;We have done this since we can write the following inequality:

$$ \frac{1}{N} \mathbb{E} \left[ M_N \right] \leq F_N(\beta) \leq  \frac{1}{N} \mathbb{E} \left[ M_N \right] + \frac{log(2)}{\beta} $$
&lt;/p&gt;
&lt;p&gt;This is a deceptively simple inequality, to see why it holds for the lower bound we replace the summation in $F_N$ by the maximum value in the sum (1 term). For the upper bound we replace every term in the sum with this attained maximum ($2^N$ values). The logs/exponents/beta/etc. all cancel leaving the result. This is useful to us because it means in the limit $\beta \to \infty$ we get the relation: $F_N(\beta) \to  \frac{1}{N} \mathbb{E} \left[ M_N \right] $ which is what we are interested in studying.&lt;/p&gt;
&lt;p&gt;This is closely related to the Gibbs distribution of the system. This gives  us a probability distribution of states of the spin glass:

$$G_N(\sigma) = \frac{exp(-\beta H_N(\sigma))}{Z_N(\beta)} $$

Where $Z_N(\beta)$ is the partition function, it is a normalizing constant (i.e. it is a sum over all possible terms of the numerator of $G_N$). We can think of the Gibbs distribution as weighting the configurations according to their free energy. We can see that finding the partition function is the crux of understanding the Gibbs distribution (and through comparison to the free energy the ground states).&lt;/p&gt;
&lt;p&gt;One of the first ways this was investigated mathematically was to use a &quot;replica trick&quot;, this is just a result of using the identity:

$$ln(Z) = lim_{n \to 0} \frac{Z^n - 1}{n} $$
&lt;/p&gt;
&lt;p&gt;On the partition function. Essentially one takes $n$ independent copies (replicas) of the system and computes an average over all of them. Approximations are then used to take the limit $n$ to zero. For certain system behaviours this method works well but for others it can be inaccurate. In particular looking at very low temperatures (small beta near ground state) the approximations do not perform well. This method assumes certain symmetries between atoms which are not true in practice (due to taking independent replicas and averaging), these methods have been extended to &quot;replica symmetry breaking&quot; (RSB) methods. These methods were further superceded by the work of Parisi using variational principles. The mathematical details would take too long to put in a blog like this. Please see the references for links to papers on the topic.&lt;/p&gt;
&lt;p&gt;What we are really interested in with spin glass systems is when a phase transition occurs. To do this physicists look at an order parameter which captures all behaviours of the system. Edwards and Anderson suggested the following order parameter:

$$ q = \frac{1}{N} \sum_x  \hat{\sigma}_x^2 $$

Where $\hat{\sigma}_x$ represents the average over time of spin $x$. This order parameter is such that for $q=0$ the configuration is non-magnetic. For $q&amp;gt;0$ then it is in a spin glass phase. Using the replica method (and some work!) we can show that under full symmetry we have that $q$ satisfying the self-consistency formula:

$$ q = 1 - \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty} exp(-z^2/2) sech^2(\beta s \sqrt{q} z) dz $$

Using this we can find a phase transition occurs at $T=s$ - temperatures below this the system exhibits glassy behaviour and above this the system is not magnetic (in equilibrium).&lt;/p&gt;
&lt;p&gt;Unfortunately assuming this sort of symmetry this $q$ does not behave well at lower temperatures, it does not display all the characteristics of the system.&lt;/p&gt;
&lt;p&gt;If we introduce symmetry breaking we re-write the order parameter of the form:

$$ q_{\alpha \beta} = \frac{1}{N} \sum_x  \hat{\sigma}^{\alpha}_x \hat{\sigma}^{\beta}_x$$

For two states $\alpha$ and $\beta$ - This is also sometimes called the &quot;spin overlap function&quot;. If we consider the likelihood of observing a system state $\alpha$ as $W_{\alpha}$ (so that $\sum_{\alpha} W_{\alpha} = 1$) we can define the overlap density:

$$P_\tilde{J}(q) = \sum_{\alpha \beta} W_{\alpha}W_\beta \delta(q - q_{\alpha \beta})$$

Where $\delta(.)$ is the Dirac delta function and the density is defined for some fixed realisation of interaction strengths $\tilde{J}$. Finally we can use this to define the Parisi order parameter function as:

$$P(q) = \int \prod_{xy} Q(J_{xy}) P_\tilde{J}(q) dJ_{xy}$$

With $Q(J_{xy})$ representing the density by which the interaction strength is chosen (e.g. Gaussian). This order parameter does not suffer from the issues of symmetry like the order parameter function above.&lt;/p&gt;
&lt;p&gt;In addition to uncovering a phase transition, the new Parisi order parameter uncovers some other interesting properties:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The broken symmetry of the spin glass requires an infinite number of order parameters to characterize&lt;/li&gt;
&lt;li&gt;In the limit of large-N there is no self-averaging in the spin glass state. That is there exists distinct samples even as N approaches infinity. This is unlike most other systems where there is no concept of a &quot;sample&quot; when N increases.&lt;/li&gt;
&lt;li&gt;Given 2 states of the spin glass, there is no &quot;inbetween&quot; spin glass state - this is called &lt;a href=&quot;https://en.wikipedia.org/wiki/Ultrametric_space&quot;&gt;ultrametric structure&lt;/a&gt;. This gives the space of spin glass states a very interesting structure. In some sense the states are clustered. More than that it is clustered at any scale you look at - if you look at states within a distance of $d$ of each other you get a number of clusters, if you look at a larger scale $d' &amp;gt; d$ then these small clusters will merge into larger ones. (Distance here is defined using overlap of states).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Simulation&quot;&gt;Simulation&lt;a class=&quot;anchor-link&quot; href=&quot;#Simulation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;After all the text we will now look at a simple simulation of this model. For now we will do this in a nave way. In practice you wouldn't want to use this method, it will be very very inefficient and will be highly likely to get stuck in local minima and will struggle to find a global minima from all starting points (particularly at lower temperatures). In a future post we will look at some better methods for simulation that will improve performance.&lt;/p&gt;
&lt;p&gt;Given a configuration of spins we will perform an update step by picking a site at random, we will compute the probability of flipping the spin and then accept/reject this change based on a random draw. This process will be repeated for a set number of steps - we could enforce a stopping criteria (e.g. stop if the energy remains constant for some number of updates) however given the inefficiency of this method we will not bother. We will keep track of the energy of the system (the Hamiltonian) and the overall magnetism ($\sum_x \sigma_x$).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# An implementation of a Sherrington-Kirkpatrick spin-glass of size N&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Connectivity is initialized as a Gaussian distribution N(0, s^2/N)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Updates occur at randomly selected sites&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Fix random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set size of model N and initial spins&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of timesteps and some containers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize interaction array&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate initial values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix beta (inverse temerature) - from analysis we know that&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# system in glassy-phase for T&amp;lt;s so beta&amp;gt;1/s. Performance&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# of random updates isn&amp;#39;t good so don&amp;#39;t select temperature&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# too low&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define update step&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    update function performs 1 update step to the model&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    inputs:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    s_array - an array of N spins (+-1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    i_array - an array of interaction strengths NxN&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;global&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;old_s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Select a spin to update&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Get interaction vector&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;i_vector&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Calculate energy change associated with flipping site spin&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i_vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Calculate gibbs probability of flip&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Sample random number and update site&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;   
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s_temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_step&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dM&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#### Run Main Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# plot magnetism and energy evolving in time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time step&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Magnetism&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;twinx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Energy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this code we can see in the beginning the magnetism of the system fluctating and the energy decreasing. This stablises to some sort of &quot;quasi-equilibrium&quot; but even after 100k time steps the system has still not converged to an energy minima.&lt;/p&gt;
&lt;p&gt;Eventually the magnetism is fixed as the system has found an energy minimum. Since the energy always decreases it suggests the system is slowly finding its way to a local energy minimum rather than exploring to find a better energy minima. This is to be expected with such a basic implementation. To observe this better we will re-run the code for a second time from a different starting spot, we will compare the resulting spin array - we should notice that there is quite a large discrepency between the 2 runs - this shows that the system is settling down to a different local energy minima.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;old_energy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;old_mag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#### Run Main Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate a distance metric&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;old_spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Proportion of sites with the same spin is:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Resting energies of the 2 systems are:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old_energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;and:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;energy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Resting magnetism of the 2 systems are:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;old_mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;and:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;mag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timesteps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Proportion of sites with the same spin is: 0.508
Resting energies of the 2 systems are: -608.7546315240614 and: -589.7510068842638
Resting magnetism of the 2 systems are: -84.0 and: 56.0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The proportion of sites having the same spin is high (around 50%!) and the energy attained is different, suggesting the system has converged to 2 different local minima that are &quot;far apart&quot; from each other. If we want to find the global minima (or at least a &quot;better&quot; minima) we will have to adopt a better strategy. We will introduce some options when we look at the next spin glass model. The code above should act as a warning about blindly simulating and relying on computational power/time to solve complex problems: it doesn't always work!&lt;/p&gt;
&lt;p&gt;We'll finish this blog post by looking at the Edwards-Anderson order parameter. We will use a basic numerical technique to solve the self consistency integral equation.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.integrate&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;integrand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_approx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_approx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_approx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_min&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;q_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_approx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_approx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;beta_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q_old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresh&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q_old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_tmp&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;integrand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_tmp&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;beta_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$\beta$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;q&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Edwards-Anderson Order Parameter (s=1)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEaCAYAAAAcz1CnAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3dd5wV9b3/8ddnG2VpUkW6CAJWdAU0uVZM0ETRq0kQomLDEqLG3CQm5nq9enNj+o0/NbHXKBrUiFFjBU1UUBDpIAvSey/Lsu3z+2Nm5Xg8u+yyOztn97yfj8d57Mx8vzPzOXNm5zPfqebuiIhI5sqKOwAREYmXEoGISIZTIhARyXBKBCIiGU6JQEQkwykRiIhkOCWCmJlZbzNzM8vJhPlWEcsyMxsedxwNwczGmtm/4o6jqTKzQWY2vQHn96GZHdFQ84uKEkEEwg3bHjPblfC5O+646pMFlprZ/LhjaQjh9/2RmS0Of9sVZnanmTWLOa4pZlYcrmObzOx5M+saZ0w1YWa3mdmTEUz6DuC39TUxMzvSzF4Ll22qm65+C9xeX/OLixJBdM5x91YJn/FxBRLRXv/JQGfgUDM7IYLp71cDt2buAsYBlwCtgbOA04FnqxrBzLLrM4Bqpjfe3VsB/YF2wB8OYNqxtwxrI1W8YQI8DfhbPc6qlOA3vqKK8knAaY0h+VZHiaCBmVm2mf023MNYCnwjoew0M5uT0P+mmX2Y0P8vMzsv7L7ZzJaY2U4zm29m5yfUG2tm75nZH8xsC3BbdfNNGGdpOL3PzGzMfr7KpcCLwCthd+K0ppjZHWEMO83sdTPrmFB+sZktN7PNZnZL0rhZCd9ts5k9a2btw7LKw1lXmNkK4G0za25mT4Z1t5nZR2bWJax/iJlNMrMtZlZoZlclzOe2cNqPhzHOM7OCKn6zfsB1wBh3/8Ddy9x9HnABMMLMTg/rPWpmfzKzV8xsN8EGokMYw47wt+ybNO0BZvZGGOMiM/t2QtmXplfdD+LuW4DngCPD8b9hZjPDea80s9sSpv2lZRkO/6uZrTOz7Wb2riUc9gjjudfMXg1bIO+Z2cFm9n9mttXMFprZ4IT6h5jZc2a2MVynrg+HjwB+BnwnnM6scHhbM3vIzNaa2Woz+x8Lk1+qdTrFIjgT+NjdixNi+Ek4rZ3h8j2jumWYYpkucveHgHlVlBcDM4Cv1Wa6acfd9annD7AMGF5F2TXAQqAH0B6YDDiQAzQH9gAdw/51wBqCPdAWYVmHcDrfAg4hSObfAXYDXcOysUAZ8P1wOi32M998YAdweDh+V+CIar5fy7D+2QQbw01AXkL5FGAJwR5qi7D/zrBsELCLoEXRDPh9GOvwsPxGYCrQPSy/D3g6LOsdxvx4GHML4GrgpTCmbOB4oE1Y/x3g3nC5HgtsBM4Iy24DisPvkA38EphazW+2vIqyd4Bfht2PAtuBr4S/S3NgAsEeZT7BBno18K+wfj6wErgs/B2OC5flEVVNL8X8pwBXht0dCTboT4T9pwJHheMeDawHzqtqWYbDLydY35oB/wd8kjCvR8P4jg+/29vAZwStpGzgf4DJYd0sgg3krUAecCiwFPh6wvJ/Mum7/C38vfMJWpsfAldXtU6nWBa/Ae5J6D88XL6HJHznvmH3aGBbNZ+eSdM+DPAq1oG7gN/Hvd2p0zYr7gCa4ocgEexKWrGuCsveBq5JqPu18B8yJ+z/J/DvwDDgdYKNyAiCvcHZ1czzE2Bk2D0WWJFUXuV8w3+8bQQb9S/9g6WY13cJNqo54QZjG3B+QvkU4OcJ/dcB/wi7bwUmJJTlAyXsSwQLCDfWYX9XguZ5Dvs2XocmlF8OvA8cnRRjD6AcaJ0w7JfAo2H3bcCbCWWDgD1VfN+fU3WSmAA8EHY/CjyeUJYdxj4gYdj/si8RfAf4Z9L07gP+K9X0qpj/FKAo/A1WA38BOlVR9/+AP4TdX1qWKeq3C+u0TYjngYTy7wMLEvqPAraF3UNTrIM/BR5JWP5PJpR1AfYmrn/ARexLLGOTp5ci3gcIdzjC/sOADcBwILeO/9PVJYJfAA/XZfpxfxrVccFG5jx3fzPF8EMI9lIqLU8qf4dgT25V2L0VOIXgn+SdykpmdglwE8E/NEArgj3CSonzqHa+7r7bzL4D/AfwkJm9B/zQ3Rea2TygV1j1LHf/J8GhoGfdvQwoM7Pnw2EvJEx/XUJ3URjfl+II5705oW4v4AUzq0gYVk6woUj13Z4g2OhPMLN2wJPALeF8trj7zqTvnHj4JznG5maWE36vRJsIElIqXQn2ilPF1okggVX1e/cChprZtoRhOeF3SjW9qlzv7g8mDzSzocCdBC2RPIKk/dekaisT6mcTbNS+FcZe+Rt0JGiZQNCqqLQnRX/l79wLOCTpu2UT7Oik0gvIBdaaWeWwLL74/fe3LLYStGYAcPdCM7uRIOkcYWavATe5+5r9TKe2WhMk4kZL5wga3lqCDVelnknllYng5LD7HYJEcErYjZn1Itj7GU9wqKgdMBewhOkkX+FQ7Xzd/TV3P5Ngw7YwnD7ufoTvO+H9TzPrTnCS9LvhseR1wIXA2YnnAWr6/c2sJdAhoXwlQcJpl/Bp7u6rU303dy919/9290HAScA3CQ5VrAHam1nrhPF6Euw119bbQA8zG5I40Mx6ELTc3koVG0GrqYyql/tK4J2k79rK3a+tYnq19RTBycwe7t4W+DNfXEeSpz8aGEmwB92WfTsZyePUxErgs6Tv1trdz04x38r6e4GOCfXbuHvipZn7WxazCQ5H7hvB/Sl3/ypBonHgVwBmNsa+eFVf8if5/7I6A4FZtaifdpQIGt6zwPVm1t3MDgJuTip/n+DY5hDgQw9OSvYiaGq/G9bJJ1ipNwKY2WWEJwgPZL5m1sXMzjWzfIJ/xl0Ee+GpXAx8GsZ4bPjpT9CCuWg/MQBMBL5pZl81szyCS+8S18M/A78Ikx1m1snMRlY1MQtOsB8V7s3uIDgUU+7uKwmW5S8tOKF8NMGVH3+pQYxf4O6fhnH9xcyGWXDi/QiCE7NvVtHyw93LgecJTta3NLNBfPHE+t+B/hacPM8NPyeY2cDaxliF1gStouIwiY2uQf29wGaCcy7/W4d5fwjsCE/WtgiX2ZG27wqz9UBvM8sCcPe1BIdCf2dmbSy4aKCvmZ1Si3m+ARxnZs0BzOxwMzvdgkt8iwlaLOXh/P7iX7yqL/mzIpyGhdPLC/ubW8Ilw2H38eG8Gy0lgui8lLSHUXnY5AHgNYI9iI8JNhSfc/fd4fB57l4SDv6A4GTlhrDOfOB34fD1BMdm39tPPNXNNwv4IcFe9BaC1sd1VUznUuBed1+X+CHYUF5axTiJ328e8D2CvdW1BM35VQlV/kiwF/u6me0kOHE8tJpJHkyQXHYQnF94h+DwEASJqXf4vV4gOPZ+oP+w44EHw2nvAv5BcHz+ghqM14rgMNSjwCOVBeFhq68Bo8IY1xHssdbXvQnXAbeHy/FWqrnUNfQ4waGr1cB8gmV/QMIkeA7BjsJnBIfXHiRoacC+Q1SbzezjsPsSgg3ufIL1YiJVH5JLNc/1BK23yh2HZgSHxjYRLNvOBFcr1UYvggRSedXQHmBRQvm5wJQIDjc1KAtPdoiINHphq+sxYIg3wMbNzKYBV7j73KjnFSUlAhGRDKdDQyIiGU6JQEQkwykRiIhkuEZ3Q1nHjh29d+/ecYchItKozJgxY5O7d0pV1ugSQe/evZk+vcEeNy4i0iSYWfJTDD6nQ0MiIhlOiUBEJMMpEYiIZDglAhGRDKdEICKS4ZQIREQynBKBiEiGUyIQEUlzRSVl/PLVBazaWhTJ9BvdDWUiIpnkX4s38dMXZrNyyx66H9SSi4f12v9ItaREICKShrYXlfI/L8/nrzNW0adjPhPGDWPYoR32P+IBUCIQEUkzb8xfzy0vzGHz7hKuPbUvN5zRj+a52ZHNT4lARCRNbN1dwn9NmsekWWsYcHBrHrr0BI7q3nb/I9aREoGISBp4Y/56fvr8HLYVlXDj8H5cd+ph5OU0zPU8SgQiIjHavqeU/35pHs9/vJqBXdvw+OVDGHRImwaNQYlARCQm/1q8iR9NnMWGnXu5/vTDGH96vwZrBSRSIhARaWDFpeXc+epCHn1/GX075fPCdSdxdPd2scWjRCAi0oAKN+xi/FMfs3DdTi7/Sh9+POLwSK8IqolI2yBmNsLMFplZoZndnKJ8rJltNLNPws+VUcYjIhKn5z9exbl3/4sNO/fy2OVDuPWcQbEnAYiwRWBm2cA9wJnAKuAjM5vk7vOTqj7j7uOjikNEJG679pbxXy/O47mPVzGkT3vuGjWYg9s2jzusz0V5aGgIUOjuSwHMbAIwEkhOBCIiTdasldu4YcJMVmwp4voz+nH96YeRk51ej3mLMppuwMqE/lXhsGQXmNlsM5toZj1STcjMxpnZdDObvnHjxihiFRGpVxUVzn3vLOGCP71PSVkFE8adyE1n9k+7JADRJgJLMcyT+l8Cerv70cCbwGOpJuTu97t7gbsXdOrUqZ7DFBGpX5t27eWyRz/il68u5MxBXXj1hpMZ0qd93GFVKcpDQ6uAxD387sCaxAruvjmh9wHgVxHGIyISuQ+WbOaGCTPZtqeUO847ku8O7YlZqv3i9BFlIvgI6GdmfYDVwChgdGIFM+vq7mvD3nOBBRHGIyISmYoK557JhfzhzU/p3TGfRy9r+DuED1RkicDdy8xsPPAakA087O7zzOx2YLq7TwKuN7NzgTJgCzA2qnhERKKyeddebnzmE/65eBMjjz2EX5x/FK2aNZ7btMw9+bB9eisoKPDp06fHHYaICAAzlm/le3/5mC1FJdx2zhFcNKRHWh4KMrMZ7l6QqqzxpCwRkTTi7jz6/jJ+8fICurZrzvPXnsSR3aJ/ZHQUlAhERGqpqKSMm5+bw6RZaxg+sDO/+9axtG2ZG3dYB0yJQESkFpZv3s3VT8xg0fqd/MfX+nPdqYeRlZV+h4JqQ4lARKSGJi/awA1PzyQry3j0siGc0r9p3NekRCAish/uzp/eWcJvXlvEwIPbcN/Fx9Ojfcu4w6o3SgQiItUoKinjRxNn8/LstZxzzCH8+oKjaZEX/xND65MSgYhIFVZv28NVj01nwbod3HzWAK4++dC0vDS0rpQIRERSmLF8C1c/MYO9pRU8PPYETju8c9whRUaJQEQkycQZq/jZ83M4pF1zJowr4LDOreMOKVJKBCIioYoK5zevL+JPU5ZwUt8O3DvmONq1zIs7rMgpEYiIAHtKyvnBM5/wj3nruGhIT24feQS5afjugCgoEYhIxtuws5irHpvO7NXb+fk3BnLFV/s0yZPCVVEiEJGMtnj9TsY+8hFbdpdw/8UFnDmoS9whNTglAhHJWO8XbuLqJ2fQPDebZ68+kaO6N86HxtWVEoGIZKS/zVzNjybOok/HfB4eewLdD2o6dwrXlhKBiGQUd+fP7yzlV/9YyLBD23PfxQW0bdF4nxxaH5QIRCRjlFc4t780j8c+WM45xxzCb791NM1ymtbjIg6EEoGIZIS9ZeXc9OwsXp69lqv+rQ8/PWtgo398dH1RIhCRJm9ncSlXPzGD95ds5mdnD2DcyX3jDimtKBGISJO2raiESx7+kPlrdvD7bx/Dvx/XPe6Q0o4SgYg0WVt3lzDmwWkUbtzF/Zccz+kDMu8egZpQIhCRJmnzrr2MeXAan23azQOXFDSZt4lFQYlARJqcDTuK+e5D01ixpYiHLj2Br/brGHdIaU2JQESalNXb9jDmgals2LmXR8YO4cS+HeIOKe0pEYhIk7Fs027GPDiNHcWlPHnlUI7reVDcITUKSgQi0iQUbtjF6AemUlpewdNXDePIbpn53KADoUQgIo3ep+t3MvqBaQA8c/WJ9O/StN8oVt8y460LItJkLVi7g4vun0qWwYRxw5QEDkCkicDMRpjZIjMrNLObq6l3oZm5mRVEGY+INC0L1u5g9ANTyc3O4pmrT+Swzq3iDqlRiiwRmFk2cA9wFjAIuMjMBqWo1xq4HpgWVSwi0vQsXLeDMQ9Oo1lONhPGDaNPx/y4Q2q0omwRDAEK3X2pu5cAE4CRKerdAfwaKI4wFhFpQhau28HoB6aRl53FhHHD6K0kUCdRJoJuwMqE/lXhsM+Z2WCgh7v/vboJmdk4M5tuZtM3btxY/5GKSKOxeP1Oxjwwjdxs42klgXoRZSJI9XxX/7zQLAv4A/DD/U3I3e939wJ3L+jUSbeJi2SqpRt3MfrBaWRlGU9fpcNB9SXKRLAK6JHQ3x1Yk9DfGjgSmGJmy4BhwCSdMBaRVFZsLmL0A9OoqHCeunIoh3bSieH6EmUi+AjoZ2Z9zCwPGAVMqix09+3u3tHde7t7b2AqcK67T48wJhFphNZu38PoB6dSXFbOk1cOpZ8uEa1XkSUCdy8DxgOvAQuAZ919npndbmbnRjVfEWlaNoVPEd1eVMrjlw9hYNc2cYfU5ER6Z7G7vwK8kjTs1irqnhplLCLS+GwvKuXihz5kzbY9PHHFUI7u3i7ukJok3VksImmpqKSMsY9+yJINu7j/4gJO6N0+7pCaLCUCEUk7e8vKufqJGcxauY27LjqWk/VSmUjpoXMiklbKK5ybnpnFPxdv4tcXHs2II7vGHVKTpxaBiKQNd+c/X5zLy3PW8rOzB/Dtgh77H0nqTIlARNLGH95czFPTVnDNKX0Zd3LfuMPJGEoEIpIWnpy6nLveWsy3C7rzkxGHxx1ORlEiEJHY/WPuOm59cS6nD+jM/55/FGapnlAjUVEiEJFYzVyxlesnzOSYHu24Z/Rx5GRrs9TQtMRFJDZrtu3hqsdncHCb5jx06Qm0yMuOO6SMpMtHRSQWRSVlXPnYdPaWlvP0VUNpn58Xd0gZS4lARBpcRYXzw2dnsXDdDh4ae4IeIhczHRoSkQb3uzcW8ercdfzs7IGcdnjnuMPJeEoEItKgJs5YxT2Tl3DRkB5c8dU+cYcjKBGISAOaunQzP31+Nl85rAO3jzxSl4mmCSUCEWkQyzbt5ponZ9CzfUvuHXM8ubpMNG3olxCRyG3fU8rlj32EAY+MHULbFrlxhyQJdNWQiESqrLyC7z89kxWbi3jyyqH07NAy7pAkiRKBiETqf19ZyLufbuTOfz+KYYd2iDscSUGHhkQkMs9OX8nD733GZV/pzaghPeMOR6qgRCAikfh4xVZ+/sJcvnpYR245e2Dc4Ug1lAhEpN6t31HMNU/M4OC2zbl79GA9SC7N6dcRkXq1t6yca56cwa69Zdx/yfG0a6lnCKU7nSwWkXp126R5zFyxjT+NOY4BB7eJOxypAbUIRKTeTPhwBU9/uJLrTu3LWUfppfONhRKBiNSLT1Zu49YX5/Fv/Tryw6/pVZONiRKBiNTZ5l17ue7JGXRq3Yy7Rg0mO0vPEGpMdI5AROqkosL5j7/OYtPuEp6/9iQO0gtmGh21CESkTh55fxmTF23k598YyJHd2sYdjhyASBOBmY0ws0VmVmhmN6cov8bM5pjZJ2b2LzMbFGU8IlK/5q7ezp2vLmD4wC5cPKxX3OHIAYosEZhZNnAPcBYwCLgoxYb+KXc/yt2PBX4N/D6qeESkfu3eW8b3n55Jh/xm/ObCo/VugUYsyhbBEKDQ3Ze6ewkwARiZWMHddyT05gMeYTwiUk/cnf/821yWbd7NH75zrM4LNHJRnizuBqxM6F8FDE2uZGbfA24C8oDTU03IzMYB4wB69tSDq0TiNnHGKp6fuZobzujHiX31RNHGLsoWQap24pf2+N39HnfvC/wE+HmqCbn7/e5e4O4FnTp1qucwRaQ2Fq/fya0vzmPYoe25/ox+cYcj9SDKRLAK6JHQ3x1YU039CcB5EcYjInW0p6Sc8U/NpGVeNn/U/QJNRpSJ4COgn5n1MbM8YBQwKbGCmSXuTnwDWBxhPCJSR3e8PJ9F63fy++8cS5c2zeMOR+pJZOcI3L3MzMYDrwHZwMPuPs/Mbgemu/skYLyZDQdKga3ApVHFIyJ184+5a3lq2gquPuVQTumvQ7RNSaR3Frv7K8ArScNuTei+Icr5i0j9WLNtDz95bg5Hd2/LD8/Uc4SaGt1ZLCLVKq9wbpzwCWXlFdw1ajB5OdpsNDV61pCIVOueyYV8uGwLv/vWMfTumB93OBIBpXYRqdInK7fxx7cWc+4xh/Dvx3WLOxyJiBKBiKS0e28ZN06YycFtmnPHeUfqERJNmA4NiUhKd/x9Psu3FPH0VcNo2yI37nAkQmoRiMiXvD5vHRM+Wsk1p/Rl2KF6hERTV6MWgZndVF25u+upoSJNxPaiUm7521wGdW3DD4b3jzscaQA1PTRUAJzAvjuDzwHe5YsPlRORJuCOl+ezZXcJj4w9QZeKZoiaJoKOwHHuvhPAzG4D/uruV0YVmIg0vCmLNjBxxiq+d1pfvW0sg9Q03fcEShL6S4De9R6NiMRm194ybnlhLn075fP90/VU0UxS0xbBE8CHZvYCwaOkzwceiywqEWlwv3p1IWu272HiNSfRPDc77nCkAdUoEbj7L8zsVeDfwkGXufvM6MISkYb0fuEmnpi6nMu/0ofjex0UdzjSwGp8H4G7fwx8HGEsIhKD3XvL+PFzs+nTMZ8ffV0PlMtEuqFMJMPd+epCVm/bw7NXn0iLPB0SykS6Nkwkg72/JDgkdNlJfTihd/u4w5GYKBGIZKiikjJufm4OvTu01CGhDKdDQyIZ6vevf8qKLUVMGDdMh4QynFoEIhlo5oqtPPzeZ4wZ2lPPEhIlApFMs7esnB9PnE2XNs25+awBcYcjaUCHhkQyzJ+mLGHxhl08MvYEWjfX46VFLQKRjLJs027unbKEc485hNMGdI47HEkTSgQiGcLdue2leeRlZ3HLNwbGHY6kESUCkQzxxvz1TFm0kRuH96NLm+ZxhyNpRIlAJAPsKSnnv1+az+FdWnPpSb3jDkfSjE4Wi2SAeyYXsnrbHp4ZN4zcbO3/yRdpjRBp4go37OK+d5dw/uBuDNU9A5KCEoFIE+bu/Off5tIiN5ufna0TxJKaEoFIE/biJ2v4YOlmfjxiAJ1aN4s7HElTkSYCMxthZovMrNDMbk5RfpOZzTez2Wb2lpn1ijIekUyyvaiU/3l5Psf0aMfoIT3jDkfSWGSJwMyygXuAs4BBwEVmNiip2kygwN2PBiYCv44qHpFM89vXF7Fldwm/OO9IsrIs7nAkjUXZIhgCFLr7UncvASYAIxMruPtkdy8Ke6cC3SOMRyRjLFy3g79MW87Fw3pxZLe2cYcjaS7KRNANWJnQvyocVpUrgFdTFZjZODObbmbTN27cWI8hijQ97s4df59P6+a53Di8f9zhSCMQZSJI1Rb1lBXNvgsUAL9JVe7u97t7gbsXdOrUqR5DFGl63lywgfcKN/OD4f04KD8v7nCkEYjyhrJVQI+E/u7AmuRKZjYcuAU4xd33RhiPSJNXUlbBL16eT99O+YwZpmsvpGaibBF8BPQzsz5mlgeMAiYlVjCzwcB9wLnuviHCWEQywuMfLGPZ5iJ+/s1BuoNYaiyyNcXdy4DxwGvAAuBZd59nZreb2blhtd8ArYC/mtknZjapismJyH5s2rWXP765mFP6d+K0w/WIaam5SJ815O6vAK8kDbs1oXt4lPMXySS/fW0Re0rL+c9vJl+lLVI9tR1FmoA5q7bzzPSVjD2pN4d1bhV3ONLIKBGINHKVL5zpkJ/H9cP7xR2ONEJKBCKN3IufrGHG8q38+OsDaKN3EMsBUCIQacSKS8u589WFHN29LRcerxvz5cAoEYg0Yg+/9xnrdhRzy9kD9TwhOWBKBCKN1NbdJfxpyhLOGNBZL5yROlEiEGmk7p5cyO69ZfzkrAFxhyKNnBKBSCO0cksRT3ywnAuP707/Lq3jDkcaOSUCkUbod68vwgx+cKaeLip1p0Qg0sjMX7ODF2et4bKv9KFr2xZxhyNNgBKBSCPz29cX0bpZDtee0jfuUKSJUCIQaUQ+/GwLby/cwLWnHkbblrp5TOqHEoFII+Hu/PofC+ncuhljT+oddzjShCgRiDQSby/cwPTlW7lheD9a5GXHHY40IUoEIo1AeYXzm9cW0btDS75d0GP/I4jUghKBSCPwwszVLFy3kx9+7XC9eUzqndYokTRXXFrO715fxDHd2/KNo7rGHY40QUoEImnu0feXsXZ7MTefpQfLSTSUCETS2NbdJdwzuZDTB3TmxL56sJxEQ4lAJI3dU/lguRF6sJxER4lAJE2t2baHxz9YzgXHdefwg/VgOYmOEoFImrp7ciGOc4PeQywRUyIQSUMrtxTx7EcrGXVCT7of1DLucKSJUyIQSUP/7+3FZGUZ3zvtsLhDkQygRCCSZpZt2s1zH69mzNCeHNy2edzhSAZQIhBJM398azG52ca1p+ox09IwlAhE0kjhhl28+MlqLjmxN51bqzUgDUOJQCSN3PXWYprnZnP1yYfGHYpkECUCkTSxeP1OXpq9hktO7E2HVs3iDkcySKSJwMxGmNkiMys0s5tTlJ9sZh+bWZmZXRhlLCLp7o9vLaZlbjbj1BqQBhZZIjCzbOAe4CxgEHCRmQ1KqrYCGAs8FVUcIo3Bp+t38vKctVx6Um/a5+fFHY5kmJwIpz0EKHT3pQBmNgEYCcyvrODuy8KyigjjEEl7f3xzMfl5OVz1b2oNSMOL8tBQN2BlQv+qcFitmdk4M5tuZtM3btxYL8GJpIvFYWtg7Em9OUitAYlBlIkg1YPT/UAm5O73u3uBuxd06tSpjmGJpJd7pyyhZV42V3y1T9yhSIaKMhGsAhJfrtodWBPh/EQanRWbi5g0aw2jh/RUa0BiE2Ui+AjoZ2Z9zCwPGAVMinB+Io3Ofe8uIduMK3VuQGIUWSJw9zJgPPAasAB41t3nmdntZnYugJmdYGargG8B95nZvKjiEUk3G3YU89fpq7jg+O56ppDEKsqrhnD3V4BXkobdmtD9EcEhI5GM8+C/PqOsooJrT9EzhSReurNYJAZbd5fw5NTlnHvMIfTsoPcNSLyUCERicP8/l7KntJzr9L4BSQNKBCINbNOuvTz2/jLOOfoQ+nfRu/V48aIAAAxBSURBVIglfkoEIg3s/neXUlxazvVn6F3Ekh6UCEQa0IadxTz+wTLOO7Ybh3VuFXc4IoASgUiD+vOUpZSWO99Xa0DSiBKBSAPZsKOYv0xbzvmDu9GnY37c4Yh8TolApIH86Z0llFU43z9dVwpJelEiEGkAG3YU89S0FZw/uBu9Oqg1IOlFiUCkAdz37lLKKpzxum9A0pASgUjENuws5smpyznv2G701rkBSUNKBCIRu/+dpZSWVzBe5wYkTSkRiERow85inpwWtAZ0pZCkKyUCkQj9/vVPKa/QfQOS3pQIRCIyb812npm+kktO7K3WgKQ1JQKRCLg7d/x9Pu1a5HL96WoNSHpTIhCJwOvz1zN16RZ+cGZ/2rbMjTsckWopEYjUs5KyCn75ygL6dW7F6CE94w5HZL+UCETq2d2TC1m2uYiff3MQOdn6F5P0p7VUpB7NXb2deycXcv7gbpzSv1Pc4YjUiBKBSD0pKavgRxNnc1B+Hv91zqC4wxGpsZy4AxBpKu6dUsiCtTt44JIC2rXMizsckRpTi0CkHnywZDN3v13IeccewpmDusQdjkitKBGI1NHkhRsY+8iH9OmYz23nHhF3OCK1pkQgUgd/n72Gqx6fTv8urXnm6hN1SEgaJZ0jEDkAxaXl3PXWYv78zhIKerXnobEFtG6uG8ekcVIiEKml95ds4mfPz2HZ5iIuPL47d4w8khZ52XGHJXLAlAhE9qOiwlm4bidvzF/PGwvWMXf1Dnp1aMlTVw7lpMM6xh2eSJ1FmgjMbATwRyAbeNDd70wqbwY8DhwPbAa+4+7LooxJJFlJWQVrt+9h9dY9rNtRzJbdJWwtKmHt9mIWr9/F4g07KS6twAwG92jHLWcP5OITe9E8V60AaRoiSwRmlg3cA5wJrAI+MrNJ7j4/odoVwFZ3P8zMRgG/Ar4TVUzSsCoqnNKKCsrKnewso1lOFmYGQHmFU1JWQUlZBcVl5ewNN7TNcrLIy8mitNwpLi1nT2k57pCTbeRmZVFSXsGuvWXsKi6jrKKCLDOyswxLmG9RSTmbdu1l8+4SdhaXUVJWQWl5BcWl5RSVlLO7pIydxWVsDTf42/aU4v7F2LOzjE6tmtGvSyvGDO3FwK5tOKV/Jzq1btZwC1CkgUTZIhgCFLr7UgAzmwCMBBITwUjgtrB7InC3mZl78r9l3T370Uoe+OfSWo1TkyASQ62qvsHnG8D9juv7ut0dB9zBw6GGkWWQZcYXtn7VjFdRsW94hUNFWJ6TFWxEs7MMrxzu+8avcKe8Iugvd6e8PPhb4U5uVhY52UZOdlZQXrHvUxZ+yiu+vERys43yiiCOhpCXHSSWvJwsmuVk0TIvm/xmObRqlsPArm04KD+XDvnN6HZQC7q3a0HXdi1on59Hm+Y5KX8zkaYoykTQDViZ0L8KGFpVHXcvM7PtQAdgU2IlMxsHjAPo2fPAnubYrmUu/bq0qvV4X9zXrLJSqk4g3DhXt9FLMa6ZJXTvSyQWTqoiYYOeOL8qx7Pge5hBthlZ4UXD5Qkb7KzKccMkkxWOk5VlZGfx+Z53TpZhZpSVO6XlFZRVVGBmZNu+pJKTHfTn5WSRm51FTpZRVtkCKK/4vCwn22iek02z3Cya5WRT4ftaCbnZRvPcbFrkZWMYZRUVlJY7udlG6+Y55OflkJuTRUWKhNM8N5uOrZvRIT9Ph29EaiDKRJBqC5q8SaxJHdz9fuB+gIKCggPal/zaEQfztSMOPpBRRUSatChvKFsF9Ejo7w6sqaqOmeUAbYEtEcYkIiJJokwEHwH9zKyPmeUBo4BJSXUmAZeG3RcCb0dxfkBERKoW2aGh8Jj/eOA1gstHH3b3eWZ2OzDd3ScBDwFPmFkhQUtgVFTxiIhIapHeR+DurwCvJA27NaG7GPhWlDGIiEj19NA5EZEMp0QgIpLhlAhERDKcEoGISIazxna1ppltBJYf4OgdSbprOU0ortpRXLWXrrEprtqpS1y93L1TqoJGlwjqwsymu3tB3HEkU1y1o7hqL11jU1y1E1VcOjQkIpLhlAhERDJcpiWC++MOoAqKq3YUV+2la2yKq3YiiSujzhGIiMiXZVqLQEREkigRiIhkuCaTCMxshJktMrNCM7s5RXkzM3smLJ9mZr0Tyn4aDl9kZl9v4LhuMrP5ZjbbzN4ys14JZeVm9kn4SX6Ed9RxjTWzjQnzvzKh7FIzWxx+Lk0eN+K4/pAQ06dmti2hLMrl9bCZbTCzuVWUm5ndFcY928yOSyiLZHnVIKYxYSyzzex9MzsmoWyZmc0Jl9X0+oqpFrGdambbE36vWxPKql0HIo7rRwkxzQ3XqfZhWSTLzMx6mNlkM1tgZvPM7IYUdaJdv9y90X8IHnO9BDgUyANmAYOS6lwH/DnsHgU8E3YPCus3A/qE08luwLhOA1qG3ddWxhX274pxeY0F7k4xbntgafj3oLD7oIaKK6n+9wkebx7p8gqnfTJwHDC3ivKzgVcJ3ro3DJjWAMtrfzGdVDkv4KzKmML+ZUDHGJfXqcDf67oO1HdcSXXPIXhHSqTLDOgKHBd2twY+TfH/GOn61VRaBEOAQndf6u4lwARgZFKdkcBjYfdE4Awzs3D4BHff6+6fAYXh9BokLnef7O5FYe9Ugje5Ra0my6sqXwfecPct7r4VeAMYEVNcFwFP19O8q+Xu71L92/NGAo97YCrQzsy6EuHy2l9M7v5+OE9ouHWrct77W15Vqcu6Wd9xNcj65e5r3f3jsHsnsIDgfe6JIl2/mkoi6AasTOhfxZcX5Od13L0M2A50qOG4UcaV6AqCrF+puZlNN7OpZnZePcVUm7guCJuhE82s8rWjabG8wkNofYC3EwZHtbxqoqrYo1xetZG8bjnwupnNMLNxMcQDcKKZzTKzV83siHBYWiwvM2tJsEF9LmFw5MvMgkPWg4FpSUWRrl+RvpimAVmKYcnXxVZVpybjHqgaT9vMvgsUAKckDO7p7mvM7FDgbTOb4+5LGiiul4Cn3X2vmV1D0Jo6vYbjRhlXpVHARHcvTxgW1fKqiTjWrxoxs9MIEsFXEwZ/JVxWnYE3zGxhuLfcUD4mePbNLjM7G/gb0I80WF6hc4D33D2x9RDpMjOzVgSJ50Z335FcnGKUelu/mkqLYBXQI6G/O7CmqjpmlgO0JWgi1mTcKOPCzIYDtwDnuvveyuHuvib8uxSYQrCn0CBxufvmhFgeAI6v6bhRxpVgFEnN9giXV01UFXuUy2u/zOxo4EFgpLtvrhyesKw2AC9Qf4dDa8Tdd7j7rrD7FSDXzDoS8/JKUN36Ve/LzMxyCZLAX9z9+RRVol2/6vvERxwfgpbNUoJDBZUnmI5IqvM9vniy+Nmw+wi+eLJ4KfV3srgmcQ0mODnWL2n4QUCzsLsjsJh6OmlWw7i6JnSfD0z1fSenPgvjOyjsbt9QcYX1Dic4cWcNsbwS5tGbqk9+foMvnsz7MOrlVYOYehKc8zopaXg+0Dqh+31gRH0uqxrEdnDl70ewQV0RLrsarQNRxRWWV+4k5jfEMgu/9+PA/1VTJ9L1q15/+Dg/BGfVPyXYqN4SDrudYC8boDnw1/Af40Pg0IRxbwnHWwSc1cBxvQmsBz4JP5PC4ScBc8J/hDnAFQ0c1y+BeeH8JwMDEsa9PFyOhcBlDRlX2H8bcGfSeFEvr6eBtUApwV7YFcA1wDVhuQH3hHHPAQqiXl41iOlBYGvCujU9HH5ouJxmhb/xLfW5rGoY2/iE9WsqCckq1TrQUHGFdcYSXECSOF5ky4zgkJ0DsxN+q7Mbcv3SIyZERDJcUzlHICIiB0iJQEQkwykRiIhkOCUCEZEMp0QgIpLhlAhERDKcEoGISIZTIhCpB2Z2e/is+k9jfIibyAFRIhCpIwteZjQYOBa4AGjoJ5+K1IkSgUjdnQs8CuQSPDrhuWpri6QZJQKRujue4M1SmwmeG9MgL8sRqS9KBCJ1YGZZQHd3f5TgqaczgJtiDUqklpQIROrmcIJHXuPue4D3CN67K9JoKBGI1M1goJmZZZtZM2A0wdu2RBqNpvKqSpG4HAu0IHhO/CbgXnefFW9IIrWjRCBSN4OBi919btyBiBwovZhGpA7MbCXQx93L4o5F5EApEYiIZDidLBYRyXBKBCIiGU6JQEQkwykRiIhkOCUCEZEMp0QgIpLhlAhERDLc/wdyHEhudNz0DAAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This displays the behaviour we expect (approximately) for low beta below $1/s$ the temperature is above $s$ and so $q=0$ (non-magnetic) above this point the system is in the glassy phase. Since we have only approximated here there is some noise around the transition point. As we add more approximation points the transition should become sharper at $\beta = 1/s$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this blog post we have introduced the assumptions of the Sherrington-Kirkpatrick (fully connected Ising) spin glass model. We have seen that although fairly involved we can &quot;solve&quot; this model analytically to uncover its properties. We have also a basic implementation in Python - however as we noted this has bad convergence properties so shouldn't really be used other than for illustration.&lt;/p&gt;
&lt;h2 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This blog post was inspired by chapter 5 of &quot;Spin Glasses and Complexity&quot; by Daniel L Stein and Charles M Newman.&lt;/p&gt;
&lt;p&gt;Some relevant papers include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The original paper: &quot;Solvable Model of a Spin-Glass&quot; - Sherrington, Kirkpatrick 1975&lt;/li&gt;
&lt;li&gt;Summary of Parisi Method: &quot;The Sherrington-Kirkpatrick model: an overview&quot; - Panchenko 2012&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the first blog post in a series - you can find the next blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models-3&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/fully-connected.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/fully-connected.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Spin Glass Models</title><link href="https://www.lewiscoleblog.com/spin-glass-models" rel="alternate" type="text/html" title="Spin Glass Models" /><published>2020-03-03T00:00:00-06:00</published><updated>2020-03-03T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Spin-Glass-Models</id><content type="html" xml:base="https://www.lewiscoleblog.com/spin-glass-models">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-03-Spin-Glass-Models.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;What-is-a-Spin-Glass?&quot;&gt;What is a Spin Glass?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-a-Spin-Glass?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A spin glass is not something you find down the pub (well it could be, but thats not what we're talking about here). Instead spin glasses are models of certain magnetic materials. Very loosely we can think of the atoms of a magnetic material as having a &quot;spin&quot; relating to the magnetic polarity (&quot;north&quot; or &quot;south&quot; ends of a bar magnet) - we typically call these up-spin and down-spin. In this context we use the term &quot;atom&quot; loosely, it may be an atom in a chemical sense but it could also be a molecule - essentially a minimal element of the material.&lt;/p&gt;
&lt;p&gt;In a ferromagnetic material (such as iron) spins orient in the same direction. In contrast antiferromagnetic materials the spins orient to oppose each other. In a spin glass we have some ferromagnetic interactions and some antiferromagnetic interactions, we say the system is &quot;disordered&quot;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;In the image above we can see various spin configurations. The spins are indicated by arrows (yellow for up and green for down) the ferromagnetic interactions are denoted by blue lines while antiferromagnetic interactions by red. However it is somewhat misleading to think of these occuring only within a square lattice in 2d such as this. Spins also do not have to be 180 degree rotations of each other - they can be at arbitrary angles from each other (but this would make for a messy diagram). A spin glass can also occur in arbitrarily many dimensions, and the interactions do not only have to occur between &quot;nearest neighbours&quot; any atom can have any number of interacting partners.&lt;/p&gt;
&lt;p&gt;We can represent the energy of a spin glass system using the Hamiltonian:

$$ H = - \sum_{x,y} J_{xy} \sigma_x \sigma_y  - h \sum_x \sigma_x $$

Where $J_{xy}$ denotes an interaction strength between atoms $x$ and $y$. $\sigma_x$ represents the spin/magnetism of an atom $x$ (can be a vector in which case all products are dot products). A system will tend to a state of lowest energy and so $J_{xy} &amp;gt; 0$ represents a ferromagnetic interaction (minimised for pairs of matching spin) and $J_{xy} &amp;lt; 0$ for antiferromagnetic interactions. The range over which the sum applies has been left purposely ambiguous as to allow for various lattice topologies. The second summation reflects an interaction with an external magnetic field (denoted by $h$) if there is no external field the term can be ignored. (It is worth noting that magnetic spins for a specific atom can only take one of two values (rotated through 180 degrees) since electrons have half integer spin)&lt;/p&gt;
&lt;p&gt;This allows us to define an important term relating to spin glasses. We can note that at a minimal energy (&quot;ground state&quot;) the spin glass will not be &quot;ordered&quot; (it will appear &quot;random&quot;). We call this property &lt;strong&gt;&quot;quenched disorder&quot;&lt;/strong&gt; - this is due to the similarity to glass materials that are essentially cooled down liquids that get &quot;frozen&quot; into a state of disorder.&lt;/p&gt;
&lt;p&gt;It is important to note this is different to pure &quot;randomness&quot;. If we think of a continuum whereby we have complete order on one side (think of a crystalline type structure as an example) and pure randomness on the other the spin glass lives somewhere in the middle - partially structured and ordered but partially random. This is a particularly interesting place to be: in the pure ordered end of the scale there are many established mathematical tools to deal with this situation. Similarly in a pure random situation probability and statistics can provide us tools for study. In the middle things get complicated since you cannot necessarily assume that any one element will &quot;look the same&quot; as any other - thus mean field methods fall down. This occurs in many &quot;real world&quot; phenomena, this can result in a lack of study since it &quot;falls inbetween&quot; different disciplines.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/Continuum.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;There is another important term relating to spin glasses called &lt;strong&gt;&quot;frustration&quot;&lt;/strong&gt;. This is where an atom has interactions with other atoms that are in conflict with each other - one interaction would suggest a lowest energy state for the atom is an up spin and another interaction suggests a down spin. An example of this can be seen below:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/frustration.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;We can see that the spin of the centre atom is not clearly defined by interaction with its neighbours. The vertical neighbours interactions suggest the lowest energy state would be a yellow up spin, while horizontal neighbours suggest a green down spin. In a large spin glass with random (or nearly random) configuartions there may be many such frustrated atoms. This gives rise to complexity and questions such as &quot;what is the lowest energy state for a system?&quot; becomes very difficult to answer. In many cases we are not able to determine this analytically. The energy landscape (the Hamiltonian energy for a given configuration of spins given a fixed topology of interactions) can become very complex with lots of local minima, which means &quot;typical&quot; optimization procedures based around greedy hill climbing (and the like) will struggle to find the global minimum. See the plot of energy landscape below as an example:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/energy_landscape.png&quot; alt=&quot;&quot; title=&quot;Source: https://ps.uci.edu/~cyu/p115A/LectureNotes/Lecture18/html_version/lecture18.html&quot; /&gt;&lt;/p&gt;
&lt;p&gt;If one ends up in a configuration near one of these local minima it requires relatively large changes to the configuration to escape the valley. This leads to a kind of &quot;metastability&quot; in the system where the configuration will &quot;stick&quot; around these points for a long time. As such spin glasses tend to violate the Ergodic principle, this again adds to the mathematical complication in dealing with these systems.&lt;/p&gt;
&lt;p&gt;Although the system would &quot;prefer&quot; to be in a lower energy state through the application of a temperature (or placing the system within an external magnetic field) the atoms can have sufficient energy to escape this lower energy state. For high enough temperatures this means a ferromagnetic material can become antiferromagnetic. In most cases there exists a critical temperature where a phase transition occurs. Phase transitions are interesting examples of &lt;strong&gt;emergence&lt;/strong&gt; - one example of a phase transition that everybody is familiar with is the phenomena of melting a solid to create a liquid. It is interesting that this is a very sharp transition - why is it not the case that a solid gradually becomes &quot;softer&quot; and more liquid like? Instead small temperature fluctuations can cause the state of matter to change. It is not immediately obvious why this is the case, other phase transitions exist in other systems and they are often interesting to analyse.&lt;/p&gt;
&lt;p&gt;The eagle eyed amongst you may notice that we have ignored the interference between spins themselves. It is true that this will have an impact but in most mathematical models of spin glasses it can be ignored. As with all mathematical models we look for a &quot;minimal description&quot; that captures the behaviour of interest, it turns out that this complication tends not to add much to the model (although I'm sure there exists research with interesting results capturing this interference).&lt;/p&gt;
&lt;p&gt;So what are some physical examples of a spin glass in the real world? Technically any iron magnet subject to rust (which is antiferromagnetic) will be a spin glass, however typically the ferromagnetic atoms will still be so prevelent that we can think of it as a ferromagnet. There are other &quot;exotic&quot; molecules (e.g. europium strontium sulphide) that are spin glasses also. Many of the experiments on spin glasses involve melting down a noble metal (e.g. gold or silver) and adding a small amount of dispersed molten iron (typically around 0.1-5%) and cooling the mixture very quickly. Many counter-intuitive and contradictory properties have been found through these experiments including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;By cooling quickly one can avoid the transition from liquid to solid - creating a viscous liquid spin glass&lt;/li&gt;
&lt;li&gt;Relaxation times (how long it takes the system to adjust to changes in temperature) can be very slow, way beyond experimental time frames&lt;/li&gt;
&lt;li&gt;Interactions with magnetic fields are odd. Absent of a magnetic field a spin glass is not magnetic. By carefully applying and removing external magnetic fields one can create a magnetic spin glass with varying properties (decays, apparent permanence etc.)&lt;/li&gt;
&lt;li&gt;Spin glasses appear to have a &quot;memory&quot; of previous states and undergo something akin to an aging process
Creating theoretical explanations of these (and other) phenomena is the subject of much research on the subject.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Why-do-we-care?&quot;&gt;Why do we care?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-do-we-care?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ok, so at this point we may have a base understanding of what a spin glass is and some of the complications and properties therein, but you may be thinking: &quot;but who cares about magnets anyway?&quot; (Unless of course you are &lt;a href=&quot;https://i.imgur.com/wZfi1wk.jpg&quot;&gt;Charlie Kelly&lt;/a&gt;) It does seem like a lot of work and as a non-physicist it might seem interesting. However in dealing with the complications of spin glasses we can gain a lot of insight into other systems. In the next few bullet points I will try and convince you that it is worth time playing around with spin glasses:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;They're interesting!&lt;/strong&gt; - Spin glasses exhibit a number of properties that I personally find very interesting, for example: emergent behaviour, &quot;in between&quot; order and randomness, simple concepts to explain but difficult to write down mathematically, etc.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-ergodic systems are everywhere!&lt;/strong&gt; - Although spin glasses themselves are quite stylised if they can give insight into the behaviour of non-Ergodic systems this is very useful. Loosely speaking an Ergodic system does not exhibit path depedence (e.g. whatever the state at present eventually any other state can be reached). When looking at complex systems this is typically not the case.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Frustration occurs more than we would like&lt;/strong&gt; - We often end up in the situation with &quot;conflicting&quot; information and dealing with this gives rise to many opportunities.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;They're easy to simulate&lt;/strong&gt; - while some of the properties above make mathematical analysis difficult in all but a few special cases, spin glasses are fairly easy to code up and simulate. If you wonder &quot;what would happen if....?&quot; you can quickly modify a model and play around to see what happens, you don't need to spend much time thinking about boundary/initial conditions or other technical aspects.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;There are many different applications&lt;/strong&gt; - Given the ubiquity of some of the complications relating to spin glasses the techniques and theory have been applied to many situations including (but not limited to): optimization techniques, neural networks (biological and artificial), machine learning, protein folding, materials science, evolutionary models. The study of quantum spin glasses is also fairly active with applications in quantum computing.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this blog post we have been on a whistle-stop tour of the very basic concepts of spin glasses and models of spin glasses. We have seen some of the difficulties with them and what makes them interesting and useful to study. In future blog posts we will look at specific models and mathematical techniques used to study them.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;This is the first blog post in a series - you can find the next blog post &lt;a href=&quot;https://lewiscoleblog.com/spin-glass-models-2&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass_img.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass_img.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Standing Ovation Model</title><link href="https://www.lewiscoleblog.com/standing-ovation" rel="alternate" type="text/html" title="Standing Ovation Model" /><published>2020-02-25T00:00:00-06:00</published><updated>2020-02-25T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Standing-Ovation</id><content type="html" xml:base="https://www.lewiscoleblog.com/standing-ovation">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-25-Standing-Ovation.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Standing-Ovations---as-a-Phenomena&quot;&gt;Standing Ovations - as a Phenomena&lt;a class=&quot;anchor-link&quot; href=&quot;#Standing-Ovations---as-a-Phenomena&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Although not particularly &quot;exciting&quot; for a subject to model, standing ovations have many interesting properties. A truly fantastic performance may elicit an instantaneous standing ovation whereby all audience members instinctively decide to stand. However this cannot be the only factor, we can observe in other performances a few hardcore fans may initially stand and then pass through the crowd as a &quot;wave&quot; through social pressure (or perhaps the inability to see the stage if others in front of you stand!) Eventually resulting in a standing ovation. At other times maybe only a handful of audience members stand, notice very few people around them are standing and then sheepishly sit down again. There is a clear temporal aspect to standing ovations but there is also some sense of criticality whereby a phase transition occurs. While understanding the mechanisms behind this for standing ovations may not have much &quot;value&quot; in of itself these principles turn up in many complex systems and so understanding here can be transferable to more &quot;interesting&quot; situations.&lt;/p&gt;
&lt;h2 id=&quot;Modelling-Standard-Ovations&quot;&gt;Modelling Standard Ovations&lt;a class=&quot;anchor-link&quot; href=&quot;#Modelling-Standard-Ovations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now move onto the question: how can we model standing ovations? We first consider the initial (instinctive) decision of standing or not following a performance. Clearly for a &quot;perfect&quot; performance (however that may be defined) everybody would show their appreciation and stand. However when the performance is not &quot;perfect&quot; why do some stand and some not? We could model each audience member as having some &quot;error function&quot; that clouds their judgement of the performance, so for (objectively) a good performance we could have that some percieve the performance as bad owing to their error function, and so they decide not to stand. We can express this mathematically: we denote the performance quality as $P$. Each individual has an error-rate $\epsilon$ - this defines a signal $S$ as:

$$ S = P + \epsilon $$

We can then state that an individual will stand for a signal that is in excess of their threshold $T$. We can take this threshold to be fixed for all individuals by adjusting their $\epsilon$ accordingly.&lt;/p&gt;
&lt;p&gt;But what does the error-rate represent? There are a number of interpretations. For example it could represent &quot;stubborness&quot;, some may be difficult to impress. It could also represent differences in knowledge, somebody unfamiliar with jazz-club etiquette may stand/stay seated at the wrong times whereas somebody more seasoned will be more closely tied to the quality of the performance.&lt;/p&gt;
&lt;p&gt;For arguments sake let's say that $P$ can vary from 0 to 1. The error rates are uniformly distributed. We can then code up this initial standing ovation model as below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set audience size&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix performance quality as 50%&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix all audience as seated (0) initially&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set error functions for audience members&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# We set up an array to vary the threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop over all thresholds and plot the percentage of audience standing&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Threshold&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Percent Standing&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3dd3hUddrG8e+ThF5CSVCEQOiIdEMPBEUUEIFXQUWxIihSxK67urq6+9pRsFEU64pgpYiAIL0HqaFJkyZNEZAe+L1/zOibjSEZIJOTydyf65qLOTNnzjyHduecXzPnHCIiEr4ivC5ARES8pSAQEQlzCgIRkTCnIBARCXMKAhGRMBfldQFnKyYmxsXHx3tdhohISFmyZMk+51xsRu+FXBDEx8eTnJzsdRkiIiHFzH4603u6NSQiEuYUBCIiYU5BICIS5hQEIiJhTkEgIhLmghYEZjbSzPaY2aozvG9mNsTMNpjZCjNrGKxaRETkzIJ5RfA+0C6T99sD1fyP3sDbQaxFRETOIGhB4JybBfyayS6dgQ+dzwKghJmVDVY9m/cd5qXJazl56nSwvkJEJCR52UZQDtiWZnu7/7W/MLPeZpZsZsl79+49py+bkrKLN6dv5MbhC9j529FzOoaISF7kZRBYBq9luEqOc264cy7BOZcQG5vhCOks3Z1Uhde7N2DdrkN0GDKb79fuPqfjiIjkNV4GwXYgLs12eWBnML/wmnoXMb5/ImWjC3Hn+8kMm7kRrdAmIuHOyyAYB9zq7z3UFDjgnPs52F9aKaYIX93bnKvrlOW5b9fy5NhVpKrdQETCWNAmnTOzUUBrIMbMtgNPAfkAnHNDgYlAB2ADcAS4I1i1pFcwXySvd29A+VKFGDZzEzv2H+W1GxoQXThfTpUgIpJrWKjdGklISHDZOfvoxwt+4qlxKcQWLcCLXevSqvq5tUGIiORmZrbEOZeQ0XthP7K4R9OKfHVvc4oWjOLWkYt48utVHD6e6nVZIiI5JuyDAKBu+RJM6J9Iz8RKfLzwJ9oOmsmUlF1elyUikiMUBH4F80XyZMdafH5Pc4oXykfvj5bQ+8Nk9hw65nVpIiJBpSBI59KKJRnfP5HH29dk1o976TB4NrPWn9sgNhGRUKAgyEC+yAjuTqrC+H6JlC5SgFtHLuKFSWs5kapupiKS9ygIMlHtgmJ83bcF3RvH8faMjVz+ygxGL96q+YpEJE9REGShUP5Inru2Lu/f0YhSRfLz6BcrafPKTKau1hQVIpI3KAgC1LpGGcb2bcE7tyZQKF8kd32YzONfrlBXUxEJeQqCs2BmXFHrAsb1b8HdSZX5dPE2rh4ym3kb9nldmojIOVMQnIMCUZE83v5iRvVqyslTjpveWcjN7yzgh637vS5NROSsKQjOQ9PKpZn2YBJPdqzF2p8Pce1b8+j7yQ/s+/2416WJiARMQXCeCuaLpGdiJWY9chkDr6jGdym7ufLVWYxfvlNTXItISFAQZJMiBaIYeEV1JgxIJK5UYfqPWkq/UUs5eOyk16WJiGRKQZDNql9QjC/uacbDV9Vg0qpdXPP6HFbtOOB1WSIiZ6QgCIKoyAj6XlaV0b2bciL1NNe+NY+P5m/RrSIRyZUUBEGUEF+Kbwa0pHnV0jw5NoV+o5ZySLeKRCSXURAEWaki+Rl5WyMebVeTSat20emNuaTs1K0iEck9FAQ5ICLC6NO6Cp/2bsrRE6e49q15jEne5nVZIiKAgiBHNYovxTcDEkmIL8kjn6/g8S9XcOzkKa/LEpEwpyDIYaWLFuDDO5twb+sqjFq0jevenqdbRSLiKQWBByIjjEfa1WTErQnsPniMTm/M5blv13D0hK4ORCTnKQg81LbWBUx9IImuDcszbOYm2g2eRfKWX70uS0TCjILAYyUK5+eFrnUZ1aspp52j27D5PPftGo6n6upARHKGgiCXaFalNN/e14obG8UxbOYmrnl9DnM1vbWI5AAFQS5StEAUz11bl5G3J3D4+Clufmchd76/mA17DnldmojkYQqCXOjymhcw7cEkHmtfk8Wbf+Wq12bzxNcrNb21iASFgiCXKpgvknuSqjDj4dbc3KQCoxZto/VLM3hrxgZOpJ72ujwRyUMUBLlc6aIFeKZzbabc34qmlUvz4qR1/M9bc3W7SESyjYIgRFSJLco7tyUw7JZL+fnAMa4eMocP5m3h9GnNaCoi50dBEGKuuuRCJg1sSbMqpXlqXApdh87Tegcicl4UBCGoTLGCvHd7I17qWpeffjlCpzfm8MTXK9l/+ITXpYlICApqEJhZOzNbZ2YbzOyxDN6vYGbTzWypma0wsw7BrCcvMTO6JcTx/UOtubVZPJ8s3Errl2fw3tzNnDylxmQRCZwFa9UsM4sE1gNtge3AYqC7c251mn2GA0udc2+bWS1gonMuPrPjJiQkuOTk5KDUHMrW7TrEsxNWM2fDPqrEFuFfXerQrEppr8sSkVzCzJY45xIyei+YVwSNgQ3OuU3OuRPAp0DndPs4oLj/eTSwM4j15Gk1LizGRz0b8+5tCaSednQfsYCnx6Vw5ESq16WJSC4XzCAoB6RdfWW7/7W0ngZ6mNl2YCLQP6MDmVlvM0s2s+S9e/cGo9Y8wcxoc/EFTLqvFbc3j+f9eVtoP3g28zf+4nVpIpKLBTMILIPX0t+H6g6875wrD3QAPjKzv9TknBvunEtwziXExsYGodS8pVD+SJ7udAmf9vZNZNd9xALuH72MvYc0MllE/iqYQbAdiEuzXZ6/3vrpCYwBcM7NBwoCMUGsKaw0rVyaKQOT6H95VSas2Mnlr8zgowU/aeyBiPyXYAbBYqCamVUys/zAjcC4dPtsBdoAmNnF+IJA936yUaH8kTx4ZQ0mDWxF3fLRPPn1Kq4fNp8fd2tksoj4BC0InHOpQD9gMrAGGOOcSzGzZ8ysk3+3B4FeZrYcGAXc7oLVjSnMVYktysc9m/Byt3ps2Ps7HYbMZsi0H0lVV1ORsBe07qPBou6j52/f78f55/jVjF++k4SKJXn1hvrElSrsdVkiEkRedR+VXCqmaAFe796A126oz7pdh+gweDZfLd1OqP1QICLZQ0EQxro0KMfE+1pS48Ji3D96Ofd8vERrHoiEIQVBmIsrVZjRdzfj8fY1mb52L1e+OotvV/7sdVkikoMUBEJkhHF3UhW+GZBI+ZKF6POfH/j7Vys5dvKU16WJSA5QEMifql1QjC/6NOfuVpX5z8KtdHlzLhv2/O51WSISZAoC+S/5IiN4vMPFvHdHI/YcOk7H12fzzuxNnNIgNJE8S0EgGbqsRhkm3deSxKox/OubNXQbOk9XByJ5lIJAzqhM8YKMuDWB126oz8a9h+kwZDaDp/7I8VS1HYjkJQoCyZSZ0aVBOb57oBVXXXIhr05drxlNRfIYBYEEpEyxgrzevQEf3NmYk6dO033EAh4cs5xftTymSMhTEMhZSaoey5SBSfS9rApjl+2gzSszGJO8TTOaioQwBYGctUL5I3n4qppMvK8lVWKL8sjnK+g2bD6rdhzwujQROQcKAjln1S8oxpi7m/Fi17ps2XeYTm/M4cmvV3Hg6EmvSxORs5BlEJjZITM7mO6xzcy+MrPKOVGk5F4REcb1CXF8/1Brbm0Wz38W/kTbQTP5duXPmsROJEQEckUwCHgY33rD5YGHgBH4FqMfGbzSJJREF8rH050uYWzfRGKLFaDPf36g14dL2LLvsNeliUgWslyPwMwWOueapHttgXOuqZktd87VC2qF6Wg9gtwv9dRp3pu7hUHfrefkqdPc2DiOAZdXo0zxgl6XJhK2znc9gtNmdr2ZRfgf16d5T9f+8hdRkRH0alWZmQ+3pnvjCny6aBtJL83gzekbOJGqFdFEcptAguBm4BZgD7Db/7yHmRXCtxSlSIbKFC/Is11qM+3BJJKqx/LS5HVcPWQ2i7f86nVpIpKGlqqUHDNtzW7+MTaFHb8dpWdiJR5tV5P8Ueq4JpITMrs1FBXAh2OBXkB82v2dc3dmV4ESHtpcfAHNqpTm+W/X8u6czSz5aT9v3NSA8iW1XrKIlwL5cWwsEA1MBb5J8xA5a4XzR/FM59q8dXNDNu75nauHzGHCip3qairioSyvCIDCzrlHg16JhJUOdcpSq2xxBny6lH6fLOWrmjt4tkttLipRyOvSRMJOIFcEE8ysQ9ArkbATH1OEL/s054mrL2bexl9oO2gmoxdv9boskbATSBDchy8MjvpHFR8ys4PBLkzCQ1RkBHe1rMyU+1tRv0IJHv1iJY98vlzrJYvkoCyDwDlXzDkX4Zwr5Jwr7t8unhPFSfiIK1WYD+9sQv/LqzImeTvXvT1Po5JFcsgZg8DMavp/bZjRI+dKlHARGWE8eGUN3r0tgW2/HqHtqzN5elwKew8d97o0kTztjOMIzGyEc66XmU3P4G3nnLs8uKVlTOMIwsPug8cYPO1HRi/eRoGoCPokVeHupCoadyByjjIbR6ABZZKrbdr7Oy9NXse3q3ZR88JivHBdXerFlfC6LJGQc05BYGbXZnZQ59yX2VDbWVMQhKepq3fzxNer2HPoGLc2i6ff5VWJKVrA67JEQsa5jiy+xv9rGaA58L1/+zJgBuBJEEh4uqLWBTSuXIoXvl3Lh/O3MCZ5G3e0iKd3yypEF87ndXkiIS2QaagnAL2ccz/7t8sCbzrnMr1iCBZdEcjGvb/z6nfrmbDiZ4oXjKJ3q8rc0aISRQoEMj5SJDyd7zTU8X+EgN9uoHqAX9zOzNaZ2QYze+wM+1xvZqvNLMXMPgnkuBLeqsQW5Y2bGjJxQEsaVyrFy1PW0/LF6Yycs5nUU5rmWuRsBXJF8AZQDRiFb/2BG4ENzrn+WXwuElgPtAW2A4uB7s651Wn2qQaMAS53zu03szLOuT2ZHVdXBJLe0q37eWXKeuZs2EftcsV5/tq61C4X7XVZIrnKeV0ROOf6AcOAekB9YHhWIeDXGF9gbHLOncC3tGXndPv0wnebab//uzINAZGMNKhQko96Nuatmxuy++BxOr85l/+duEajk0UCFNBNVX8PobNtHC4HbEuzvR1okm6f6gBmNheIBJ52zk1KfyAz6w30BqhQocJZliHhwMzoUKcsLarE8PykNQyftYnvVu/mxa51aRRfyuvyRHK1LK8IzOxaM/vRzA6c5VxDlsFr6e9DReG77dQa6A68Y2Z/6STunBvunEtwziXExsYG8NUSrqIL5+O5a+vyyV1NOHnqNNcPm8/T41I4cPSk16WJ5FqBNBa/CHRyzkWf5VxD24G4NNvlgZ0Z7DPWOXfSObcZWIcvGETOS/OqMUwe2Ipbm1bkg/lbaP3SdN6fu5mTakwW+YtAgmC3c27NORx7MVDNzCqZWX58jczj0u3zNb5xCZhZDL5bRZvO4btE/qJIgSj+2bk2E/onUuui4jw9fjVXvTaLH7bu97o0kVwlkCBINrPRZtbdf5vo2qxGHQM451LxLW4/GVgDjHHOpZjZM2bWyb/bZOAXM1sNTAceds79co7nIpKhSy6K5uOeTRh5ewLHT56m29D5DJ76o7qaivgF0n30vQxedl6tWazuo3I+Dh47yZNfr2Lssp0kVCzJv/+nDjUuLOZ1WSJBp0nnRNL5eukO/jF2Fb8fT+WGRnHc37Y6ZYoV9LoskaA517mG/vhwQaAncAnw578Ur64IRLJDlwblaF0jliHTNvDRgi2MW7aTR9rV5JamFYmIyKjDm0jeFUgbwUfAhcBVwEx8vX8OBbMokZxQonB+/nFNLb67P4mE+FI8NS6Fm99ZyLZfj3hdmkiOCiQIqjrnngQOO+c+AK4G6gS3LJGcEx9ThPfvaMQL19Vh5Y4DtHttFh/O38Lp06F121TkXAUSBH+MxPnNzGoD0UB80CoS8YCZcUOjCkwa2JKGFUvyj7EpdB06j3W7dPEreV8gQTDczEoCT+AbB7AaeCGoVYl4pHzJwnx4Z2MGXV+PzfsO0/H12bwwaS1HTqR6XZpI0ATSfbSSf9Rvpq/lFPUakpzyy+/H+ffENXz5ww7KRhfkiatr0aHOhZipMVlCz/muR/BFBq99fn4lieR+pYsWYND19fn8nmaUKJyfvp/8wE0jFup2keQ5Z+w+amY18XUZjU43krg4abqRiuR1CfGlGN+vBZ8s2sorU9bTYchsejSpwANta2iZTMkTMhtHUAPoCJTg/9cvBl/X0V7BLEokt4mKjODWZvFcU/ciXvluHR8t+IkJK37myY616Fz/It0ukpAWSBtBM+fc/ByqJ0tqI5DcIGXnAf7+1SqWbfuNxKox/KtLbeJjinhdlsgZnVMbgZn1MrNqzrn55jPSvybBCjNrGLxyRXK/Sy6K5os+zXm28yUs3/Yb7QfP5pOFWwm1KVtEIPPG4vuALf7n3fEtVVkZeAAYHNyyRHK/yAjjlmbxfPdAEpdWLMnfvlpJrw+T2XvouNeliZyVzIIg1Tn3x2CyjsCHzrlfnHNTAV0Di/hdGF2QD+9szJMdazHrx320fXUmoxZt1chkCRmZBcFpMyvrn3SuDTA1zXuFgluWSGiJiDB6Jlbim/6JVL+gGI9/uZJr355Hys4DXpcmkqXMguAfQDK+20PjnHMpAGaWhFYRE8lQtQuKMbp3UwZdX4/t+4/Q6Y25vDBpLcdOnvK6NJEzyrTXkJlFAcWcc/vTvFbE/7nfc6C+v1CvIQkVB46c5N8TVzMmeTuVY4rwQte6NIov5XVZEqbOeWSxcy41bQj4XzvsVQiIhJLowvl4sWs9Pu7ZhBOnTnPDsPm8+t16TqntQHKZQKaYEJHzkFgthskDW9GlQTkGT/uRm0YsYNeBY16XJfInBYFIDihSIIpB19fn5W71WLH9AO0Gz+JT9SySXCLLIDCzaYG8JiJZ63ppecb3T6R6mWI89uVKrhuqnkXivcxGFhc0s1JAjJmVNLNS/kc8cFFOFSiS11QtU5TRdzfl5W712PqLr2fR89+qZ5F4J7NJ5+4GBuL7T38J8MesWgeBN4Ncl0ieZmZ0vbQ8V1xchucmrmXozI1MSdnF89fVpXEl9SySnBXIpHP9nXOv51A9WVL3UcmL5vy4j8e/WsG2X49yU5MKPNquJtGFNMW1ZJ/Muo9mGQT+AzTHt07xn1cQzrkPs6vAs6EgkLzqyIlUBk1Zz8i5m4kpWoB/drqE9nXKel2W5BHntUKZmX0EvAwkAo38jwwPJiLnrnD+KJ7oWIuxfROJLVaAPv/5gce+WKG2Awm6zNoI/pAA1HKaX1ckR9QpH83Yvi14dep63py+kRXbD/B2j4ZULK25HiU4AhlHsAq4MNiFiMj/i4qM4OGrajLy9gR2/HaUjkPmMHLOZo6n6upAsl8gQRADrDazyWY27o9HsAsTEbi85gV8MyCRenEleGbCaq4YNJOxy3ZoARzJVoH0GkrK6HXn3MygVJQFNRZLOHLOMevHfTz/7VrW/HyQxKoxvNC1LuVKaEZ4Ccx5NRb7/8PfAuTzP18M/JCtFYpIpsyMpOqxfNM/kX91qc0PW/dz1auzGL1Yy2PK+Quk11Av4HNgmP+lcsDXgRzczNqZ2Toz22Bmj2WyX1czc2am3kgimYiIMHo0rcjkga2oXa44j36xkl4fLmH/4RNelyYhLJA2gr5AC3wjinHO/QiUyepDZhaJbwRye6AW0N3MamWwXzFgALAw8LJFwltcqcJ8cldTnrj6Ymau30P7wbOZv/EXr8uSEBVIEBx3zv3544Z/sZpArkUbAxucc5v8n/8U6JzBfs8CLwKal1fkLEREGHe1rMxX97agcP5IbnpnAX//aqWmuJazFkgQzDSzvwGFzKwt8BkwPoDPlQO2pdne7n/tT2bWAIhzzk3I7EBm1tvMks0see/evQF8tUj4qF0umvH9E7mlaUVGL95G0kvT+deE1fx2RLeLJDCBBMFjwF5gJb6J6CYCTwTwOcvgtT+vJMwsAngVeDCrAznnhjvnEpxzCbGxsQF8tUh4KVIgimc61+b7B1vTse5FjJy7mauHzGHVDk1xLVkLJAgKASOdc92cc12Bkf7XsrIdiEuzXR7YmWa7GFAbmGFmW4CmwDg1GIucuwqlC/PK9fX46t4WnHaOrkPnMXbZDq/LklwukCCYxn//x18ImBrA5xYD1cyskpnlB24E/hyI5pw74JyLcc7FO+figQVAJ+ecBgmInKd6cSUY1y+RuuVKcN+ny/jn+BTNWSRnFEgQFEy7WL3/eeGsPuScSwX6AZOBNcAY51yKmT1jZp3OtWARCUxssQJ8fFcTbm8ez3tzt9D5jbms3nnQ67IkFwpkZPFcoL9z7gf/9qXAG865ZjlQ319oZLHI2Zuxbg8Pf76CA0dOMrBtNXq1rEy+SC1ZHk7Oa2QxcB/wmZnNNrPZwGh8P+mLSIhoXaMMkwe2os3FZXhx0jqueX0OS3761euyJJfINAj8PXvyAzWBPsC9wMXOuSU5UJuIZKNSRfLzdo9LGXFrAgePnuS6t+fzt69WcvDYSa9LE49lGgTOudPAK865k865Vc65lc45/a0RCWFta13Adw8kcVdiJT5dtJUrB81i2prdXpclHgrk1tAUM7vOzDIaFyAiIahIAd9qaF/e24LoQvno+UEyff/zAz/9ctjr0sQDgTQWHwKKAKeAo/gGijnnXPHgl/dXaiwWyV4nUk/z9oyNvD1zA6mnHDc2jmPA5dUoU7yg16VJNjrvxetzEwWBSHDsOXiM17/fwKhFWymUL5Jnu9SmS4NyWX9QQsL5Ll5vZtbDzJ70b8eZWePsLlJEvFWmeEGe7VKbqQ8kUbNsMQaOXsbAT5eqMTkMBNJG8BbQDLjJv/07vumlRSQPio8pwqe9m/Fg2+qMX/Ez7V+bzaz1muwxLwskCJo45/rinybaObcfX5dSEcmjIiOM/m2q8dk9zSiQL4JbRy7ioc+Wa0bTPCqQIDjpX2TGAZhZLHA6qFWJSK7QsEJJJg5oSd/LqvDV0h1cMWgWE1bs1PKYeUwgQTAE+AooY2b/BuYA/xvUqkQk1yiYL5KHr6rJuH4tKBtdkH6fLOWuD5LZ+dtRr0uTbBJQryEzqwm0wdd1dJpzbk2wCzsT9RoS8U7qqdO8P28Lr0xZT4TBkx1rcUOjODTMKPc7p+6jZlYQuAeoim9Rmnf9M4p6SkEg4r1tvx7h0S9WMG/jL1xeswzPX1eHMsU07iA3O9fuox8ACfhCoD3wchBqE5EQFFeqMB/3bMJT19Ri7oZ9XPXqLMYtV9tBqMosCGo553o454YBXYFWOVSTiISAiAjjjhaV+GZASyqWLsKAUUu5+6Ml7Dl0zOvS5CxlFgR/jiLJDbeERCR3qlqmKF/0ac7fOtRkxvq9tB00i0mrdnldlpyFzIKgnpkd9D8OAXX/eG5mWuZIRP4UGWH0blWFiQNaUrF0Ye75eAn/HJ/CiVT1NA8FZwwC51ykc664/1HMOReV5rknE86JSO5WtUxRPrunGXe08C2P2W3oPLb+csTrsiQLWqtORLJVgahInrrmEob2aMimfYdpP3gWYxZvU0NyLqYgEJGgaFe7LJMGtqJO+Wge+WIF93y8hF8Pa4qK3EhBICJBU65EIT65qyl/61CT6Wv30nHIbJZu3e91WZKOgkBEgirC35D8RZ/mREQY1w+bz/tzN+tWUS6iIBCRHFGnfDTf9G9Jq2qxPD1+NT0/SGb7fjUk5wYKAhHJMdGF8zHi1gSe7FiLBZt+oe2gWQyftZGTp9TN1EsKAhHJURERRs/ESnz3QBItqsbwvxPXcu1b8/hx9yGvSwtbCgIR8US5EoV457YE3r65ITt+O8rVr8/hndmbOH1abQc5TUEgIp5qX6cskwe2olW1GP71zRq6j1jAtl/VdpCTFAQi4rnYYgUYcWsCL15Xl5SdB2k/eLYGoeUgBYGI5ApmxvWN4vj2vpZcclFxHvliBXe8v5jN+w57XVqepyAQkVwlrlRhRvVqypMda5G8ZT9XvjqT579dy+/HNQlysCgIRCTX+aNn0fcPJdG5fjmGztzIZS/PYEzyNjUmB0FQg8DM2pnZOjPbYGaPZfD+A2a22sxWmNk0M6sYzHpEJLSUKVaQl7vV4+u+LShfshCPfL6CTm/OYcGmX7wuLU8JWhCYWSTwJr5lLmsB3c2sVrrdlgIJzrm6wOfAi8GqR0RCV/24EnzZpzmDb6zPr7+f4MbhC+jxzkKW/PSr16XlCcG8ImgMbHDObXLOnQA+BTqn3cE5N90590c/sQVA+SDWIyIhzMzoXL8c0x5szRNXX8zaXQe57u353P7eIjbs+d3r8kJaMIOgHLAtzfZ2/2tn0hP4NqM3zKy3mSWbWfLevXuzsUQRCTWF8kdyV8vKzHrkMh5vX5MlP+2n3WuzeG7iGjUon6NgBoFl8FqGrTxm1gNIAF7K6H3n3HDnXIJzLiE2NjYbSxSRUFU4fxR3J1Vh+kOtubZhOYbN2sQVr8xk9o/6YfFsBTMItgNxabbLAzvT72RmVwB/Bzo5544HsR4RyYNiihbgxa71+KJPc4oWjOKWdxfxz/EpHDt5yuvSQkYwg2AxUM3MKplZfuBGYFzaHcysATAMXwjsCWItIpLHXVqxJBP6J3J7c996yde8PoeUnQe8LiskBC0InHOpQD9gMrAGGOOcSzGzZ8ysk3+3l4CiwGdmtszMxp3hcCIiWSqYL5KnO13CB3c25sDRk3R5cy5DZ27klMYeZMpCbS6PhIQEl5yc7HUZIpLL7T98gse/XMmklF00ji/F4x1q0qBCSa/L8oyZLXHOJWT0nkYWi0ieVLJIft7u0ZCXutZl3e5D/M9b87hx+Hxmrt+ryezSURCISJ5lZnRLiGPuY5fzxNUXs2XfEW4buYj7Ry/jsLqa/klBICJ5XtECUX+OPXigbXXGLt9J5zfnsmGPVkUDBYGIhJH8UREMaFONj+5swv7DJ+j0xlzGLf9Lr/awoyAQkbCTWC2Gbwa0pFbZ4gwYtZSnx6VwIvW012V5RkEgImHpwuiCjOrdlDtaxPP+vC10H7GAnw8c9bosTygIRCRs5YuM4KlrLmFI9was+fkg7V6bzYQV4XerSEEgImGvU72L+GZAS+JjitDvk6XcP3oZBzk/BOAAAAoOSURBVI6e9LqsHKMgEBEBKsUU4fN7mnFfm2qMW76TNq/M5OulO8JizIGCQETEL19kBPe3rc7X97agXImCDBy9jO4jFrB+d97uZqogEBFJp075aL68twX/6lKb1TsP0u61WTz6+Qp2HTjmdWlBoSAQEclAZITRo2lFZj58GXe0qMSXS7fT+uXpvDZ1PcdT89YU1woCEZFMlCySnyc71uL7B1tzxcUX8NrUH+kweDaLt+Sd9ZIVBCIiAYgrVZg3bmrIe3c04tjJ03QbOp+/fbWSg8dCv3eRgkBE5CxcVqMM3z3QirsSK/Hpoq1cOWgW36/d7XVZ50VBICJylgrnj+KJjrX48t4WRBfKx53vJ9P3kx/Y9usRr0s7JwoCEZFzVD+uBOP7J3L/FdWZtmY3bQbN5Llv14Tc7SIFgYjIecgfFcF9V1Rj+kOt6Vi3LMNmbuLyl2eE1GA0BYGISDYoG12IQdfXZ3y/RMqVLMzA0cu45d1FbN532OvSsqQgEBHJRnXKR/Nln+Y82/kSlm/7jatem8XbMzaSeir3TnOtIBARyWaREcYtzeKZ9mASl9cowwuT1tLlrbmk7DzgdWkZUhCIiARJmeIFGXrLpbx9c0N2HThOlzfn8u6czbmu7UBBICISZO3rlGXqA61oXaMMz05Yzd0fLeHAkdzTs0hBICKSA0oUzs/wWy7liasv5vu1e7j69dks2pw7pqlQEIiI5BAz466WlRlzTzMizLhh+Hyem7iGYye9ncROQSAiksMaVijJxPtacmOjCgybtYlOb8xh7oZ9ntWjIBAR8UDRAlE8d20d3ru9EYePn+LmdxZy28hFrPn5YI7XoiAQEfHQZTXLMO3BJP7e4WKWbfuNDkNmM+i79Zw6nXM9ixQEIiIeK5gvkl6tKjPr4cu4rmF5hkz7kR7vLGTPoZxZEU1BICKSS0QXzsfL3erxUte6LN22nw6D5zA5ZVfQvzeoQWBm7cxsnZltMLPHMni/gJmN9r+/0Mzig1mPiEgo6JYQx9i+icQUzc/dHy3hrg+S2fHb0aB9X9CCwMwigTeB9kAtoLuZ1Uq3W09gv3OuKvAq8EKw6hERCSU1LizG+P6JPN6+JnM37KPtoJmMW74zKN8VzCuCxsAG59wm59wJ4FOgc7p9OgMf+J9/DrQxMwtiTSIiISNfZAR3J1Vhyv2taF4lhsoxRYLyPVFBOapPOWBbmu3tQJMz7eOcSzWzA0BpwLsOtSIiuUxcqcK8c1tC0I4fzCuCjH6yT98fKpB9MLPeZpZsZsl79+7NluJERMQnmEGwHYhLs10eSH+D6899zCwKiAb+MvmGc264cy7BOZcQGxsbpHJFRMJTMINgMVDNzCqZWX7gRmBcun3GAbf5n3cFvne5bX5WEZE8LmhtBP57/v2AyUAkMNI5l2JmzwDJzrlxwLvAR2a2Ad+VwI3BqkdERDIWzMZinHMTgYnpXvtHmufHgG7BrEFERDKnkcUiImFOQSAiEuYUBCIiYc5CrZOOme0FfjrHj8cQnoPVwvG8w/GcITzPOxzPGc7+vCs65zLsfx9yQXA+zCzZORe84Xm5VDiedzieM4TneYfjOUP2nrduDYmIhDkFgYhImAu3IBjudQEeCcfzDsdzhvA873A8Z8jG8w6rNgIREfmrcLsiEBGRdBQEIiJhLk8GQTiulRzAOT9gZqvNbIWZTTOzil7Umd2yOu80+3U1M2dmId/NMJBzNrPr/X/eKWb2SU7XGAwB/B2vYGbTzWyp/+95By/qzE5mNtLM9pjZqjO8b2Y2xP97ssLMGp7TFznn8tQD30ynG4HKQH5gOVAr3T73AkP9z28ERntddw6c82VAYf/zPqF+zoGet3+/YsAsYAGQ4HXdOfBnXQ1YCpT0b5fxuu4cOu/hQB//81rAFq/rzobzbgU0BFad4f0OwLf4FvlqCiw8l+/Ji1cE4bhWcpbn7Jyb7pw74t9cgG+hoFAXyJ81wLPAi8CxnCwuSAI5517Am865/QDOuT05XGMwBHLeDijufx7NXxfCCjnOuVlksFhXGp2BD53PAqCEmZU92+/Ji0GQ0VrJ5c60j3MuFfhjreRQFcg5p9UT308RoS7L8zazBkCcc25CThYWRIH8WVcHqpvZXDNbYGbtcqy64AnkvJ8GepjZdnzT3/fPmdI8dbb/9jMU1PUIPJJtayWHkIDPx8x6AAlAUlAryhmZnreZRQCvArfnVEE5IJA/6yh8t4da47vym21mtZ1zvwW5tmAK5Ly7A+87514xs2b4Fr2q7Zw7HfzyPJMt/5flxSuCbFsrOYQEcs6Y2RXA34FOzrnjOVRbMGV13sWA2sAMM9uC7x7quBBvMA707/dY59xJ59xmYB2+YAhlgZx3T2AMgHNuPlAQ38RseVlA//azkheDIBzXSs7ynP23SIbhC4G8cM8Ysjhv59wB51yMcy7eORePr22kk3Mu2Ztys0Ugf7+/xtc5ADOLwXeraFOOVpn9AjnvrUAbADO7GF8Q7M3RKnPeOOBWf++hpsAB59zPZ3uQPHdryIXhWskBnvNLQFHgM3+7+FbnXCfPis4GAZ53nhLgOU8GrjSz1cAp4GHn3C/eVX3+AjzvB4ERZnY/vtsjt4f4D3iY2Sh8t/hi/G0fTwH5AJxzQ/G1hXQANgBHgDvO6XtC/PdJRETOU168NSQiImdBQSAiEuYUBCIiYU5BICIS5hQEIiJhTkEgYcPMSpvZMv9jl5nt8D//zd/VMru/r7WZndXUFmY2I6MBb2Z2u5m9kX3Vifw/BYGEDefcL865+s65+sBQ4FX/8/pAltMQ+Eehi+Q5CgIRn0gzG+Gfv3+KmRWCP39C/18zmwncZ2axZvaFmS32P1r490tKc7Wx1MyK+Y9b1Mw+N7O1ZvafP2a5NbM2/v1W+uecL5C+IDO7w8zW+7+7RQ79PkgYUhCI+FTDN3XzJcBvwHVp3ivhnEtyzr0CDMZ3JdHIv887/n0eAvr6rzBaAkf9rzcABuKbH78y0MLMCgLvAzc45+rgG+HfJ20x/qmE/4kvANr6Py8SFAoCEZ/Nzrll/udLgPg0741O8/wK4A0zW4Zvnpfi/p/+5wKDzGwAvuBI9e+/yDm33T8D5jL/cWv4v2+9f58P8C1AklYTYIZzbq9//v3RiASJ7nmK+KSdjfUUUCjN9uE0zyOAZs65o/y3583sG3zzvizwz/Sa0XGjyHjq4Ixo/hfJEboiEDk7U4B+f2yYWX3/r1Wccyudcy8AyUDNTI6xFog3s6r+7VuAmen2WQi09vd0ygd0y64TEElPQSBydgYACf6FwlcD9/hfH2hmq8xsOb72gTOuAOecO4ZvlsjPzGwlvh5LQ9Pt8zO+FbfmA1OBH7L7RET+oNlHRUTCnK4IRETCnIJARCTMKQhERMKcgkBEJMwpCEREwpyCQEQkzCkIRETC3P8BBm68IjNtfk0AAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As expected we get a straight line decreasing with threshold. From the discussion before we know that standing ovations are not entirely determined by the performance quality (and resulting threshold) behaviour. There is a social aspect to the phenomena. We now move onto looking at a temporal model. One way we could do this is that an individual takes a survey of all their neighbours and if enough of them are standing they also decide to stand (somewhat similar to the movement mechanism in a &lt;a href=&quot;https://demonstrations.wolfram.com/SchellingsModelOfResidentialSegregation/&quot;&gt;Schelling Segregation Model&lt;/a&gt;). However if you are sat in the audience it is unlikely you'll turn round to see what the people behind you are doing, you will only notice those in front of you. You may also notice those from many rows in front of you rather than just proximal neighbours. Page/Miller suggest a viewing &quot;funnel&quot; where each agent can see as:
&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Where we can adjust the number of rows somebody can see as a paramter (with 3 presented here). We will make a small adjustment to this method; let's place more weight on the audience members closest to us. We will calculate the proportion standing in each row in or field of vision and take a weighted sum of these according to the square distance away (e.g. row 2 will be weighted 1/4 of row 1, row 3 will be 1/9 weighted and so on.) This should capture the behaviour that there is more social pressure from those around us, this might lead to a slow &quot;wave&quot; propagating through the audience as this pressure grows. For this model lets also assume that the lights are on in the theatre and we can see all rows up to the front in detail.&lt;/p&gt;
&lt;p&gt;For this &quot;funnel&quot; we will ignore the proximal &quot;next door&quot; neighbours from this calculation. We will assume there is a different mechanism for these individuals, we will look at the proportion of neighbours standing (either 0, 0.5 or 1) and we will apply a &quot;neighbour weight&quot; which will weight between this score and the funnel score to give an overall social pressure score as:

$$ Social\_Pressure = (1 - neighbour\_weight) \times Funnel\_Pressure + neighbour\_weight \times Neighbour\_Pressure $$
&lt;/p&gt;
&lt;p&gt;We will use this mechanism of seperating out next door neighbours since if we go to a performance with others they will typically be sat next to us. Further one could argue that somebody is more likely to stand/sit based on their friend/partner's behaviour than those of a stranger. The neighbour weight parameter allows us to vary the relative importance.&lt;/p&gt;
&lt;p&gt;Using the overall social pressure metric a sitting individual will stand if the social pressure exceeds a fixed threshold, similarly a standing individual will sit if the social pressure is smaller than one-less the fixed threshold. We are assuming that there is a symmetry invoked here which may not be the case. For example the &quot;embarrassment&quot; of standing while others are sitting might mean people are quicker to sit if they're in a small minority standing. However for a first quick and dirty implementation of a model the symmetry assumption will suffice (it will be easy enough to modify later should we desire).&lt;/p&gt;
&lt;p&gt;We will also add 2 random components to this model: the first being a rate that if one is sitting down they stand up regardless of the information presented. The other being the reverse of this: a rate by which individuals sit down if they're standing. We will denote these rates as $\delta, \gamma$ respectively. This might allow for the possiblity of a &quot;spontaneous ovation&quot; occuring.&lt;/p&gt;
&lt;p&gt;We now have one choice remaining before we can implement this model: how will the updates be made? There are 2 main classes of updates in an agent based model: asynchronous and synchronous. The former essentially means each agent updates &quot;one by one&quot;, the order of upates can be random or by some defined order (in this example we could update those nearest the stage and iterate backwards for example). In a synchronous updating scheme all agents updated their state together once per time-step, of course by doing this one has to be careful in some situations (e.g. if there is an asset that can get depleted who gets to use it first?) but in this simple model there are no such concerns. For this model I think synchronous modelling is appropriate since I believe this is how ovations work in practice (e.g. we do not wait for &quot;our turn&quot; to make a decision), we could investigate how this affects the outcome later if we wish to.&lt;/p&gt;
&lt;p&gt;My implementation of this model can be seen below. We will look at how the proportion of audience members standing evolves over time (functions use njit decorator to simply improve run time - looping over the array multiple times in the funnel calculation is fairly slow in pure python):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set audience size&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix performance quality as 50%&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Performance threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix all audience as seated (0) initially&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set error functions for audience members&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of timesteps&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix social pressure threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix neighbour weight&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix probaility of spontaneous standing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix probability of spontaneous sitting&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate initial reactions to performance&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Function to calculate social pressure&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;active_row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;active_row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate pressure from (nextdoor) neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;neighbour_pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;
        
&lt;span class=&quot;c1&quot;&gt;# Calculate overall pressure score&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;neighbour_pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spontaneous sitting/standing function&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spontaneous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dlt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dlt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Main Code Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;up_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;down_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;spontaneous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time Step&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Percent Standing&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;By selecting particular parameters we can see a few different behaviours in the model. These include an inital peak of enthusiasm that dies down, a gradual increase as the applause trickles from the front of the auditorium to the back and a rapturous applause leading to nearly all participants standing up very quickly. These are all behaviours that we do see in real life audiences. If we were particularly motivated we could look for real world phenomena in standing ovations and see if these rules are able to replicate them.&lt;/p&gt;
&lt;h2 id=&quot;Potential-Improvements&quot;&gt;Potential Improvements&lt;a class=&quot;anchor-link&quot; href=&quot;#Potential-Improvements&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;With agent based models there are always &quot;extra&quot; things that could be added/modified. A few select suggestions include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Revisit the &quot;funnel&quot; mechanism and compare various schemes&lt;/li&gt;
&lt;li&gt;What happens if there are various levels/balconies or perhaps aisles between seats?&lt;/li&gt;
&lt;li&gt;What happens with &quot;stooges&quot;? That is if we add agents who always applaud regardless, what is the minimum number required to guarantee a standing ovation? Where are they best placed (perhaps taking into account ticket cost - 10 in the middle compared to 2 at the front), etc.&lt;/li&gt;
&lt;li&gt;We could code in &quot;partners&quot; or &quot;groups&quot; more precisely to investigate the impact that has&lt;/li&gt;
&lt;li&gt;How does changing to asynchronous updating change the behaviour?&lt;/li&gt;
&lt;li&gt;What if every so often an agent &quot;turns round&quot; to view the seats behind them?&lt;/li&gt;
&lt;li&gt;and so on&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen how we can code up a basic agent based model for standing ovations. While the subject itself isn't particularly &quot;useful&quot; in of itself the principles are common to many other systems. We have also seen some of the considerations that go into an agent based model.&lt;/p&gt;
&lt;p&gt;As a final remark it is worth noting that this is not how you would produce an agent based model in practice. Typically you would start with a simple model and add features gradually and test the impact, I did not want to write a series of long posts on this model so I &quot;skipped to the end&quot; coding in what I thought some pertinent features could be all at once (although I did not spend long thinking about them!)&lt;/p&gt;
&lt;h2 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The original paper on standing ovation models presented by Scott Page and John Miller (&lt;a href=&quot;https://www2.econ.iastate.edu/tesfatsi/StandingOvation.MillerPage.pdf&quot;&gt;can be seen here!&lt;/a&gt; for those wanting to read more about their version of the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Barnes-Hut Algorithm</title><link href="https://www.lewiscoleblog.com/barnes-hut" rel="alternate" type="text/html" title="Barnes-Hut Algorithm" /><published>2020-02-18T00:00:00-06:00</published><updated>2020-02-18T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Barnes-Hut</id><content type="html" xml:base="https://www.lewiscoleblog.com/barnes-hut">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-18-Barnes-Hut.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;The-N-Body-Problem&quot;&gt;The N-Body Problem&lt;a class=&quot;anchor-link&quot; href=&quot;#The-N-Body-Problem&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;It is well understood that for $N &amp;gt; 2$ that the problem of determining trajectories under gravitation for N-bodies cannot be solved analytically. Instead we must rely on computation to create trajectories. From Newton's equations we can write the force $\pmb{F_{i,j}}$ between two bodies $i, j$ with masses $m_i, m_j$ and positions $\pmb{p_i}, \pmb{p_j}$ as:

$$ \pmb{F_{i,j}} = \frac{G m_i m_j (\pmb{p_i} - \pmb{p_j})} {\lVert \pmb{p_i} - \pmb{p_j} \rVert^3} $$
&lt;/p&gt;
&lt;p&gt;For $N$ bodies we therefore have $\frac{N(N-1)}{2}$ forces to be calculated. For small $N$ this is not a problem, however if we want to model galaxy dynamics with thousands (or more) of bodies this becomes a computational issue.&lt;/p&gt;
&lt;h2 id=&quot;Barnes-Hut-Process&quot;&gt;Barnes Hut Process&lt;a class=&quot;anchor-link&quot; href=&quot;#Barnes-Hut-Process&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;With Barnes Hut we can move from $O(N^2)$ complexity to $O(Nln(N))$ - this is a significant improvement for large $N$.&lt;/p&gt;
&lt;p&gt;The crux of the Barnes Hut scheme is to approximate the effect of &quot;far away&quot; bodies but calculate exactly the forces attributed to &quot;near&quot; bodies. To do this a quadtree data structure is used (in 3d an octree or higher dimensions a $2^d$tree). To do this the space is partitioned into 4 equal squares at depth 1 (or 8 cubes in 3d or $2^d$ hypercubes in higher dimension) - at depth 2 each of these squares is then partitioned into 4 equal squares and so on. From this a tree is constructed with each node representing the number of bodies within the quadrant at that depth. This is repeated recursively until a depth is reached where each quadrant has 1 or 0 bodies in it. It is easier to understand this with a visual example:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png&quot; alt=&quot;&quot; title=&quot;Source: https://developer.apple.com/documentation/gameplaykit/gkquadtree&quot; /&gt;&lt;/p&gt;
&lt;p&gt;With this data structure in place we can begin to simulate. For each quadrant in the quadtree we can calculate a centre of mass (in the obvious way). Then given a body we can calculate the force acting on it from a given quadrant by applying the Newtonian force calculation using the centre of mass. We could, for example, apply this to the 4 quadrants at depth 1 to approximate the force acting on the body. This of course might not be particularly accurate if there are many bodies present. To overcome this the Barnes Hut algorithm specifies a critical distance $\theta$ if the distance beween the body and the centre of mass of the quadrant is greater than $\theta$ then it is used as an approximation, if not the algorithm moves to the next depth of the quadtree and tries again, this happens recursively until the distance becomes below $\theta$ or there is only 1 body in the quadrant (as such setting $\theta = 0$ returns to the $O(N^2)$ brute force approach).&lt;/p&gt;
&lt;p&gt;While this is presented as an algorithm for the N-body problem it can be used in other situations that involve a spatial dimension and many entities. I am currently considering an application to speed up an agent based model (potentially the subject of another blog post).&lt;/p&gt;
&lt;h2 id=&quot;Implementation&quot;&gt;Implementation&lt;a class=&quot;anchor-link&quot; href=&quot;#Implementation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Initially I will code up an example in Python, I may revisit this and create a more efficient implementation in Cython/C++/etc. I will ignore all &quot;complications&quot; for example I will not give each body a size nor will it consider collisions, etc. Each body is a &quot;point mass&quot; in this example. For now I'll also ignore the issues relating to plotting trajectories.&lt;/p&gt;
&lt;p&gt;We first create a node class to represent nodes within the quadtree. Using this data structure we will then apply a verlet time step to calculate positions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;copy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    A class for a node within the quadtree.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    We use the terminology &amp;quot;child&amp;quot; for nodes in the next depth level - consistent with tree nomenclature&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    If a node is &amp;quot;childless&amp;quot; then it represents a body&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Initializes a childless node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        m - Mass of node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        x - x-coordinate centre of mass&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        y - y-coordinate centre of mass&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        px - x- coordinate of momentum&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        py - y-coordinate of momentum&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        pos - centre of mass array&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        mom - momentum array&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        child - child node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        s - side-length (depth=0 s=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        relpos = relative position&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Places node in next quadrant and returns quadrant number&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Places node in next level quadrant and recomputes relative position&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reset_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Repositions to the zeroth depth quadrant (full space)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Calculates distance between node and another node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Force applied from current node to other&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Adds body to a node of quadtree. A minimum quadrant size is imposed&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    to limit the recursion depth.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;min_quad_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-5&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_quad_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;verlet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;model_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;verlet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;########## Main Code ##########&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Theta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.7&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Main Model Loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Model_Loop_BH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; Model_Loop_BH(N_steps)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;7.97 s  446 ms per loop (mean  std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This code is not the most efficient possible for this model (in all likelihood one would only use Barnes-Hut for large galaxy simulations and so it's unlikely that Python would be the best choice). For 100 bodies and 1000 time steps this code runs on my machine in around 8s.&lt;/p&gt;
&lt;p&gt;We can also code up a &quot;brute force&quot; approach (calculating forces between all pairs of bodies) to compare, it is likely that the cost of computing the quadtree could be more costly than just computing all forces directly when the number of bodies is suitably small. We could run these codes multiple times to find where this is the case.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# from numba import njit&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; main_loop(N_steps, pos, mom)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1min 18s  1.89 s per loop (mean  std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This brute force code is not implemented in a particularly efficient way, however it is good enough for illustration purposes. Even for relatively small model sizes (100 bodies for 1000 time steps) the code takes considerably longer than the Barnes-Hut algorithm, with timeit giving an approximate timing of around 78s - about 10 times slower than the Barnes-Hut implementation.&lt;/p&gt;
&lt;p&gt;If we use Numba with the njit decorator we can improve this to 3s - which while quicker is not considerably better than the Barnes-Hut algorithm. As the number of bodies increases (and perhaps some fine tuning of the Barnes-Hut parameters) we would expect even more drastic improvements.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; main_loop(N_steps, pos, mom)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3 s  33.1 ms per loop (mean  std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen that even for relatively modest models the Barnes-Hut algorithm provides fairly efficient computation for the N-body problem. We would expect the improvement to be even more marked for larger models. However Python on its own is not the best place to implement this and a C++ implementation would offer better performance. With some work a Cython approach should be possible and offer performance improvements. The code would require some major re-working if Numba is to be used instead owing to the reliance on classes to generate the quadtree.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Cython Vs Numba: An Example</title><link href="https://www.lewiscoleblog.com/cython-numba-2" rel="alternate" type="text/html" title="Cython Vs Numba: An Example" /><published>2020-02-11T00:00:00-06:00</published><updated>2020-02-11T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Cython-Numba-2</id><content type="html" xml:base="https://www.lewiscoleblog.com/cython-numba-2">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-11-Cython-Numba-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Following on from the previous blog post &lt;a href=&quot;https://lewiscoleblog.com/cython-numba&quot;&gt;here&lt;/a&gt; comparing the relative merits of Cython Vs Numba I thought I'd illustrate this with implementations of a relatively simple model: a vanilla 2d Ising Model. This is a prime target for a performance boost since it is a very &quot;loopy&quot; code. I will not cover what the Ising Model is/how it works (&lt;a href=&quot;https://en.wikipedia.org/wiki/Ising_model&quot;&gt;you can check that here!&lt;/a&gt;). It is a very interesting model and I may return to it at a later date to look at some of its properties and explore it more deeply (and maybe spin glass models more generally). For now it will just be a test subject to explore performant python type code.&lt;/p&gt;
&lt;p&gt;In this blog I will present a few different versions, I won't throw the kitchen sink at them to get the absolute best performance but will adopt an 80/20 principle. I will not try any parallelisation or clever memory management outside of what comes pre-canned.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Python&quot;&gt;Python&lt;a class=&quot;anchor-link&quot; href=&quot;#Python&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This is a basic python implementation using a lot of looping. Even for a relatively small models this code will likely be fairl slow due to the looping.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Numba&quot;&gt;Numba&lt;a class=&quot;anchor-link&quot; href=&quot;#Numba&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;For this code we will just take the above code and use the njit decorator (forcing the use of LLVM - a jit decorator will fall back to Python object mode if it cannot work out how to use LLVM). This is literally a few seconds of coding updates.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Cython&quot;&gt;Cython&lt;a class=&quot;anchor-link&quot; href=&quot;#Cython&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Again we will modify the python code. We will see that while not too onerous it does require a little more work than the Numba example. The code is largely boilerplate but requires a little more thinking than the Numba example (e.g. in implementing this I initially forgot a static type definition of 1 variable which was causing a 300% increase in runtime).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;load_ext&lt;/span&gt; Cython
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cython&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cython&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cnp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;libc.math&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;libc.stdlib&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;limits.h&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RAND_MAX&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;kTinv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cy_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cy_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cy_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;x_offset&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;j&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dEtmp&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kTinv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RAND_MAX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cpdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cpy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Timing-Results&quot;&gt;Timing Results&lt;a class=&quot;anchor-link&quot; href=&quot;#Timing-Results&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Python&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; _main_code(10, spins)

&lt;span class=&quot;c1&quot;&gt;# Numba&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; nb_main_code(10, spins)

&lt;span class=&quot;c1&quot;&gt;# Cython&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; cpy_main_code(10, spins)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;52 s  2.53 s per loop (mean  std. dev. of 7 runs, 1 loop each)
244 ms  4.48 ms per loop (mean  std. dev. of 7 runs, 1 loop each)
395 ms  6.92 ms per loop (mean  std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For our purposes the %timeout magic will be good enough a proxy for performance. We can see that the intial python implementation is very slow. For a 1000x1000 lattice and looping over 10 times, for my machine the python interation takes 50-55s. This would be fairly problematic if we wanted to sweep over the parameter space, find critical temperatures, perform random seed analyses etc.&lt;/p&gt;
&lt;p&gt;In contrast Numba only takes 240-250ms, an impressive 2000% speed up. Running the code multiple times now seems much less onerous.&lt;/p&gt;
&lt;p&gt;Cython is not quite as quick as the Numba implementation taking 390-400ms but still represents a significant speedup compared to Python. For practical applications the difference between Numba and Cython in this case may be insignificant.&lt;/p&gt;
&lt;p&gt;It is worth noting that these times are from my machine on at a specific time. The times achieved on your machine might be slightly different. Similarly changing the size of the lattice may change the ordering of which option is &quot;quickest&quot; - as always it's worth checking the code how it will be used rather than performing a benchmark like this for determining which option to use.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;From the results above it may be tempting to claim Numba is the obvious choice given it is not only easier to implement than cython but also offers faster speeds. However I selected the 2d Ising model as an example since I knew the code would work well in Numba (in a sense I have been p-value hacking the experiment!) In certain situations (e.g. a code relying very heavily on class structures) Numba is either unusable or requires a complete code overhaul whereas cython can require only a few lines of boilerplate code.&lt;/p&gt;
&lt;p&gt;In other examples you can also see that Cython can severely outperform Numba, I am not sure why this is and the only real way to determine which will perform better is to perform testing (if somebody has an explanation/heuristic I'd love to hear it). It is also possible to interface numba and cython which has been useful to me in the past. For a quick example suppose we want to perform an inverse transform of a Beta(2,0.5) distribution:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.4681225665264196&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This cannot be optimised in Numba as it is (beta.ppf is currently not supported functionality - this may change by the time you read this). However we can take the address of the cython special function that this calls. We can then build the function in such a way as it can be seen by Numba:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ctypes&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba.extending&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_cython_function_address&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;betaaddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_cython_function_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;scipy.special.cython_special&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;btdtri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;functype3d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CFUNCTYPE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;functype3d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;betaaddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_beta_ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_beta_ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.4681225665264196&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see this is a little ugly but it works.&lt;/p&gt;
&lt;p&gt;As a result of everything covered in these blog posts I do not believe that one option offers a significant advantage over the other and both offer valid tools for improving runtime. The choise of which to use in a given situation will depend on many factors and requires careful thought as to what is needed in a given setting.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Cython Vs Numba</title><link href="https://www.lewiscoleblog.com/cython-numba" rel="alternate" type="text/html" title="Cython Vs Numba" /><published>2020-02-04T00:00:00-06:00</published><updated>2020-02-04T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Cython-Numba</id><content type="html" xml:base="https://www.lewiscoleblog.com/cython-numba">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-04-Cython-Numba.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Outline-of-the-Problem&quot;&gt;Outline of the Problem&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-the-Problem&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Python at its core is slow for certain things. By being a dynamically typed and interpreted language you incur certain runtime overheads. In some cases these are not much of an issue. At other times they can be critical.&lt;/p&gt;
&lt;p&gt;Typically we will try and &quot;vectorize&quot; the code as much as possible (avoiding extraneous loops) and force as much code as we can into NumPy array operations which are typically &quot;quick&quot; (compiled C code). This is fine when it works, but it is not always possible to vectorize the code or, in some cases, the vectorization leads to code that is very hard to read/understand.&lt;/p&gt;
&lt;p&gt;Both Numba and Cython (not to be confused with CPython) aim to provide tools to deal with such situations.&lt;/p&gt;
&lt;h2 id=&quot;Outline-of-Cython&quot;&gt;Outline of Cython&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-Cython&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Cython is a programming language that is part Python and part C/C++, it can be compiled into a python extension and/or an executable. If you are familiar with Python it is reasonably easy to understand Cython code, it largely just has a few &quot;boiler-plate&quot; code blocks along with a few static type declarations (familiar to those who know C/C++/related languages).&lt;/p&gt;
&lt;p&gt;Since there are no dynamic types (in well written Cython code) and it is compiled typically the resulting code is orders of magnitude faster than Python. Compared to vectorised NumPy there may not be a significant improvement but this depends on the exact implementation.&lt;/p&gt;
&lt;p&gt;Cython itself is very flexible, if you can express the code in Python it is unlikely you will not be able to express it in Cython. Any arbitrary class structure can work within Cython, as a result it is used for many &quot;high performance&quot; Python packages (e.g. SciPy).&lt;/p&gt;
&lt;p&gt;It is possible to parallelize the code or utilise GPU computation using Cython. This normally requires a bit of work but typically does not require nearly as much work as using Cuda in C++ (for example). As usual the normal caveats relating to multi-thread applications also apply to Cython code.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://cython.readthedocs.io/en/latest/&quot;&gt;You can read the Cython documentation here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Outline-of-Numba&quot;&gt;Outline of Numba&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-Numba&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Numba is a slightly different beast. It uses the concept of a &quot;just in time&quot; compiler (JIT). Essentially this means that code is compiled &quot;on the fly&quot; during runtime instead of requiring compilation prior to execution. Numba compiles the python code using a LLVM compiler.&lt;/p&gt;
&lt;p&gt;The syntax is very simple and most of the time just requires a simple decorator on a Python function. It also allows for parallelisation and GPU computation very simply (typically just a &quot;target = 'cuda'&quot; type statement in a decorator). In my experience a lot less thinking is required to set this up compared to Cython.&lt;/p&gt;
&lt;p&gt;The downside of Numba (at least for me) is that it is a (comparatively) new package and as such does not have support for absolutely everything you would want, unlike with Cython it is possible to just &quot;hit the wall&quot; where you simply cannot use Numba without a major re-writing of the code. (One such example being you cannot call @guvectorize functions inside the @njit decorator). It is worth checking the github issues log regularly as often these issues are on the docket to be corrected in future releases.&lt;/p&gt;
&lt;p&gt;Another downside of Numba is the lack of useful traceback, typically you need to &quot;switch off&quot; Numba and run in regular python to track down an error. This is typically only a minor inconvenience but if the code is particularly slow it can get frustrating trying to find an error without the Numba speed up.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://numba.pydata.org/&quot;&gt;You can read more about Numba here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Which-is-better?&quot;&gt;Which is better?&lt;a class=&quot;anchor-link&quot; href=&quot;#Which-is-better?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;From a raw performance perspective I do not see either Cython nor Numba consistently beating the other in all situations. Typically the performance will be comparable and you will rarely find one being many orders of magnitude quicker (assuming you're using both correctly).&lt;/p&gt;
&lt;p&gt;The choice of which to use, in my opinion, comes down to other factors. Convenience being a big one, I typically find Numba easier and quicker to implement when it works. As noted above however it doesn't always work (e.g. if using class structures, custom data types, etc.) With familiarity you do get an instinct as to whether a code will work or not. Cython on the other hand offers much more flexibility.&lt;/p&gt;
&lt;p&gt;There is also the issue of how the code will be used. Cython is well established for creating efficient extension modules that sit nicely within the Python eco-system. Numba can be used in a similar way but I have found it a bit more finnicky to deal with (for example through Numba itself changing its API fairly regularly since it's a relatively new module, some code from previous iterations of Numba simply does not work at all with the later versions).&lt;/p&gt;
&lt;h2 id=&quot;What-is-the-catch?&quot;&gt;What is the catch?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-the-catch?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Unfortunately things are not perfect, typically we will still be interfacing Cython/Numba functions via Python and so using repeated calls to these functions we will still incur overheads (typically through the conversion to Python types). This can mean that certain code is still significantly slower than C/C++ equivalents. These packages are therefore most useful for when you have profiled your code and can see that a handful of functions/operations are the real bottleneck.&lt;/p&gt;
&lt;p&gt;These packages may not help if your code is particularly memory intensive, in which case it is better to spend time thinking about memory management instead. In some cases these packages provide some help in that respect also (e.g. NumPy is prone to creating many cached variables for simple operations, if the variables are large arrays this can become a pain.)&lt;/p&gt;
&lt;h2 id=&quot;What-about-PyPy/etc?&quot;&gt;What about PyPy/etc?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-about-PyPy/etc?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another option for performant Python code is to use PyPy instead of CPython. I have not used this very much yet, if I get the time to really kick the tyres I may write another blog on my findings. There are some features that appear useful but the eco-system is not as well supported (yet?) and so may require some additional work to recreate some high level functionality.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.pypy.org/&quot;&gt;You can read more about PyPy here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Why-not-just-C/C++?&quot;&gt;Why not just C/C++?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-not-just-C/C++?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ultimately if you require peak performance at all costs these options are still no substitute for well written C/C++. However as I often warn people: computation time is generally cheaper than human time - it is often better to use a slightly sub-optimal (but still respectable) code than devote months to R&amp;amp;D and slow down the development cycle. Since Numba/Cython are so similar to Python (and it is possible to just &quot;tack on&quot; some Python to the end of these codes) you can prototype much more quickly in my experience. All these factors (along with many others such as where the code is to be deployed, what other tools are being used, etc.) need to be weighed up.&lt;/p&gt;
&lt;h2 id=&quot;What-about-Julia?&quot;&gt;What about Julia?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-about-Julia?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Some readers may be familiar with the Julia language as an option for high performance scientific computing. I have a little experience (but am far from an expert). As I understand Julia is based around JIT (as with Numba), however being a language to itself it never needs to interface with Python and its limitations. It can therefore create more efficient code for larger scale projects since they never have to worry about Python overheads. Typically the benchmarks seen online are for smaller &quot;toy&quot; problems and so the performance does not appear to be too different from Cython/Numba.&lt;/p&gt;
&lt;p&gt;I have not switched to Julia for a few reasons, firstly the popularity of Python - it is typically fairly easy to learn Cython/Numba for somebody who understands Python/NumPy making collaboration easier. Secondly the Python eco-system is well developed there is typically a package available to do almost anything you would want. Thirdly at this point it is fairly easy to get Python to &quot;speak&quot; with other systems if you need to turn something from a prototype to production. These concerns are ultimately just related to uptake however, as more people use Julia I see this becoming less of a concern.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://julialang.org/&quot;&gt;You can read more about Julia here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hopefully now we can see that Cython/Numba provide useful tools for bridging the gap between Python and C/C++ runtimes. As the old saying goes &quot;you cannot have your cake and eat it too&quot; and so it may not be possible to get performance as quick using these options. However we can often get performance that is &quot;good enough&quot; in practical terms.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Jackknife Methods</title><link href="https://www.lewiscoleblog.com/jackknife" rel="alternate" type="text/html" title="Jackknife Methods" /><published>2020-01-28T00:00:00-06:00</published><updated>2020-01-28T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Jackknife</id><content type="html" xml:base="https://www.lewiscoleblog.com/jackknife">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-28-Jackknife.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this blog post we are concerned with a specific problem: we have a Monte-Carlo type model that produces some simulated output. With this we want to estimate an arbitrary statistic (for example percentiles, expected shortfall or more complicated statistics relating to many variables). We know however that calculated in this way the calculated statistic is just one realisation of a distribution of outcomes. We would like to be able to say something about this distribution, in particular we would like to have some idea of the variability in the statistic.&lt;/p&gt;
&lt;p&gt;The &quot;obvious&quot; (and most accurate) way to do this would be to re-run the model many times with different random seeds and create an empirical distribution of the statistic. However if the model is particularly complex this might mean a lot of compute time. Instead we would like to find an approximate method that does not require us to re-run the model at all. To do this in a general way we will introduce the Jackknife method.&lt;/p&gt;
&lt;p&gt;It is worth noting that in certain situations other methods can be easier to implement/more accurate, for example if we only wanted to estimate the 90th percentile we can construct an argument using a binomial distribution (and normal approximation thereof) - however this method will not generalise to (for example) expected shortfall or even more complicated statistics.&lt;/p&gt;
&lt;h2 id=&quot;Justification-of-the-Method&quot;&gt;Justification of the Method&lt;a class=&quot;anchor-link&quot; href=&quot;#Justification-of-the-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We begin by supposing we have $N$ un-ordered observations $\{ X_i \}_{i=1}^{N}$ from our Monte-Carlo model. We use these observations to create an estimate of a statistic $\hat{Q}$. We denote the estimate from the model $\hat{Q}_{\{1:N\}}$, which itself is a random variable. Through a Taylor expansion we can note:

$$ \mathbb{E}\left(\hat{Q}_{\{1:N\}}\right) = \hat{Q} + \frac{a_1}{N} + \frac{a_2}{N^2} + ...$$

For some constants $a_x$.&lt;/p&gt;
&lt;p&gt;If we now consider partitioning the $N$ observations as: $N = mk$ for integers $m$ and $k$ - that is we create $m$ collections of $k$ obervations ($k \gg m$). We denote a set: $A_i = \{ X_j | \quad  j &amp;lt; (i-1) k , \quad j \geq i k  \}$ to contain all observations bar $k$, each set removes a different set of $k$ observations. Each has $|A_i| = (m-1)k$. We can then write:

$$ \mathbb{E}\left(\hat{Q}_{A_i}\right) \approx \hat{Q} + \frac{a_1}{(m-1)k} + \frac{a_2}{(m-1)^2k^2} $$

Via a second order approximation.&lt;/p&gt;
&lt;p&gt;If we then define a new variable: $\hat{q}_i = m\hat{Q}_{\{1:N\}} - (m-1)\hat{Q}_{A_i}$. Then via a second-order approximation we have:
$$\mathbb{E}\left( \hat{q}_i \right) \approx m\left( \hat{Q} + \frac{a_1}{N} + \frac{a_2}{N^2}\right) - (m-1)\left(\hat{Q} + \frac{a_1}{(m-1)k} + \frac{a_2}{(m-1)^2k^2}\right)$$ 
Through some simplification this becomes:

$$\mathbb{E}\left( \hat{q}_i \right) \approx \hat{Q} - \frac{a_2}{m(m-1)k^2} $$

Asymptotically this has bias $O(N^{-2})$. If the estimator only has bias $O(N^{-1})$ (i.e. $a_i =0$ for $i \geq 2$) then the approximation is unbiased.&lt;/p&gt;
&lt;p&gt;We can now define two new variables: &lt;br /&gt;
$\hat{\hat{Q}}_N = \frac{1}{m} \sum_{i=1}^{m} \hat{q}_i$ &lt;br /&gt;
$\hat{\hat{V}}_N =  \frac{1}{m-1} \sum_{i=1}^{m} \left( \hat{q}_i - \hat{\hat{Q}}_N \right)^2$ &lt;br /&gt;
Then via CLT we have that $\hat{\hat{Q}}_N \sim \mathcal{N}(\hat{Q}, \hat{V})$ for some unknown variance $\hat{V}$. We can thus create an $X\%$ confidence interval as:&lt;br /&gt;
$\hat{Q} \in \left[ \hat{\hat{Q}}_N - t \sqrt{\frac{\hat{\hat{V}}_N}{m}}, \hat{\hat{Q}}_N + t \sqrt{\frac{\hat{\hat{V}}_N}{m}} \right] $ &lt;br /&gt;
With $t$ as the $(1-X)\%$ point of a double-tail student-t distribution with $(m-1)$ degrees of freedom.&lt;/p&gt;
&lt;p&gt;We can see from the construction of this confidence interval there has been no restriction on the type of statistic $\hat{Q}$ used, in this sense this is a generic method.&lt;/p&gt;
&lt;p&gt;(Note this is strongly related to a bootstrap method, in fact it is a first order approximation to a bootstrap)&lt;/p&gt;
&lt;h2 id=&quot;An-Example&quot;&gt;An Example&lt;a class=&quot;anchor-link&quot; href=&quot;#An-Example&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The explanation above is quite notation dense, it will be easier to look at an example. In this case we will take one of the simplest examples of a Monte-Carlo model: estimating the value of $\pi$. To do this we will take a unit square and a unit quarter circle inside it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/circle.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;We will simulate random points within the square and calculate the proportion $p$ of points landing within the quarter circle (red). If we simulate $N$ points we get an estimate $\pi \approx \frac{4p}{N}$. A simple vectorised numpy for this can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Estimating pi using Monte-Carlo&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;points_in_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns an array that contains 1 if a random point (x,y)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    is within the unit circle of 0 otherwise&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    N: Number of simulations (int)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Random seed fixed for repeatability&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Return an estimate of pi using the output of points_in_circle&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points_in_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimate of pi:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimate of pi: 3.1456
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can use the jackknife method to now construct a confidence interval. (Obviously in this case we have the sample estimator of an average and so CLT applies, in practice we wouldn't use a jackknife here. But for this example I wanted something simple as to not distract attention from the jackknife method itself.) We know what the result &quot;should&quot; be in this example, however we shall pretend we don't have access to np.pi (or similar).&lt;/p&gt;
&lt;p&gt;We can code up an implementation of the jackknife method as:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This function implements the jackknife method outlined above&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    The function takes an array (arr) and an estimate function (pi_fn)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    and a number of discrete buckets (m) - in this implementation m &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    needs to divide size(arr) exactly&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    The function returns Q-double hat, V-double hat, (m-1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Qn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Vjk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;onfidence interval: [&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;95 % confidence interval: [ 3.103649740420917 , 3.187550259579082 ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that the 95% confidence interval range is fairly large (around 3.10 to 3.19) in this case. We will now show that by using a &quot;better&quot; method we can reduce this range. We start by reconsidering the square-quarter-circle: we notice that we can add 2 additional squares to this setup:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Apart from looking like a Mondrian painting we can notice that all points generated in the yellow area will add &quot;1&quot; to the estimator array and all points in the black area will add &quot;0&quot;. The only areas of &quot;contention&quot; are the blue/red rectangles, if we focus only in generating points in these areas we will increase the accuracy of the estimator. By symmetry these 2 rectangles are identical, we only need to generate points within the rectangle: $\left\{\left(1, \frac{1}{\sqrt{2}}\right), \left( 1,0\right), \left(\frac{1}{\sqrt{2}},0\right), \left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right)\right\}$. This has the area: $\frac{\sqrt{2}-1}{2}$ or both rectangles together having total area: $\sqrt{2}-1$. Therefore generating $N$ points within these rectangles is equivalent to generating: $\frac{N}{\sqrt{2}-1}$ points in the original scheme (approximately 2.5 times as many). This should reduce the standard deviation of the estimate by about a third (by CLT). We can code this estimator up in a similar way to before:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;points_in_rect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns an array that contains 1 if a random point (x,y)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    is within the unit circle of 0 otherwise&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This uses the &amp;quot;imporved&amp;quot; method&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    N: Number of simulations (int)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Random seed fixed for repeatability&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Return an estimate of pi using the output of points_in_rect&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This applies a correction since points are only simulated&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    in smaller rectangles&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;approx_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx_pi&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points_in_rect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimate of pi:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimate of pi: 3.144554915549336
95 % confidence interval: [ 3.1247314678035196 , 3.164378363295143 ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As expected we can see the confidence interval has decreased significantly through an improved estimator.&lt;/p&gt;
&lt;h2 id=&quot;Notes-on-Implementation&quot;&gt;Notes on Implementation&lt;a class=&quot;anchor-link&quot; href=&quot;#Notes-on-Implementation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As we have seen the jackknife is a general tool. In certain situations other tools exist. There are a couple of points we have to keep in mind when implementing these methods:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;The selection of m:&lt;/strong&gt; this is fairly arbitrary, if the statistic being analysed is very cumbersome to calculate then a smaller choice of m is helpful (or if we wish to run this method over very many statistics).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Properties of the statistic:&lt;/strong&gt; in some instances we know the statistic must be bounded (e.g. a correlation coefficient must be between $[-1,1]$) This additional information can and should be used to improve the confidence interval.
It often becomes more art than science when deciding how to present the results of this method.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this post we have seen what a jackknife method is, why it works and a basic implementation. Hopefully now it is obvious the power these methods hold for reporting on the results of a Monte-Carlo simulation. In more sophisticated situations it can really give insight into which parts of a model suffer most from simulation error and also how confident we should be with an estimate it produces.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Neuron Models 3: Ensembles</title><link href="https://www.lewiscoleblog.com/neuron-models-3" rel="alternate" type="text/html" title="Neuron Models 3: Ensembles" /><published>2020-01-21T00:00:00-06:00</published><updated>2020-01-21T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Neuron-Models-3</id><content type="html" xml:base="https://www.lewiscoleblog.com/neuron-models-3">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-21-Neuron-Models-3.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;This is the third blog post in a series - you can find the previous blog post &lt;a href=&quot;https://lewiscoleblog.com/neuron-models-2&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;Justifying-Gaussian-White-Noise&quot;&gt;Justifying Gaussian White Noise&lt;a class=&quot;anchor-link&quot; href=&quot;#Justifying-Gaussian-White-Noise&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We first begin with a small diversion, in the previous HH and EIF neuron firing examples we have assumed some sort of Gaussian white noise as an input signal. We briefly mentioned that this is a reasonable assumption but we will justify this in a bit more detail here. First we note that each neuron will typically take input signal from the order of 10,000 neurons. As such even in a low firing rate scheme a neuron will likely receive relatively large amount of input spikes. We can express this signal as: &lt;br /&gt;

$$I_p(t) = \sum^{N}_{i=0} J_{i} \sum_k \delta(t-t_i^k)$$

Where: &lt;br /&gt;
$N$ is the number of connected neurons &lt;br /&gt;
$J_{i}$ is the synaptic connection strength from neuron $i$ &lt;br /&gt;
$t_i^k$ is the time of the kth spike recieved from neuron i&lt;/p&gt;
&lt;p&gt;If we assume that these spikes arrive in an uncorrelated, memoryless fashion in the form of a Poisson process and that the connection strengths are suitably small: $\langle J_i \rangle \ll V_{Th} - V_{Re}$ (where angle brackets denote population average). Then we can apply a diffusion approximation:

$$I_p(t) = \sum^{N}_{i=0} J_{i} \sum_k \delta(t-t_i^k) \approx \mu + \sigma \xi(t)$$

Where: &lt;br /&gt;
$\mu = \langle J_i \rangle N \nu $ &lt;br /&gt;
$\sigma = \langle J_i^2 \rangle N \nu $ &lt;br /&gt;
$\nu$ is the mean firing rate over all connected neurons &lt;br /&gt;
$\xi(t)$ is a Gaussian white noise process&lt;/p&gt;
&lt;p&gt;Of course as with all approximations this is subject to &quot;small sample size&quot; and $N$ needs to be suitably large.&lt;/p&gt;
&lt;h2 id=&quot;Fokker-Planck&quot;&gt;Fokker-Planck&lt;a class=&quot;anchor-link&quot; href=&quot;#Fokker-Planck&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Recall that we specified the EIF model with Gaussian white noise as having dynamics:

$$\tau \frac{dV_m}{dt} = (V_L - V_m) + \Delta_T e^{\left( \frac{V_m - V_T}{\Delta_T} \right)} + \sigma \sqrt{2 \tau}\xi_t $$
&lt;/p&gt;
&lt;p&gt;This is nothing more than an Ito process of the form:

$$dX_t = \mu(X_t,t)dt + \sigma(X_t, t)dW_t $$

With standard Wiener process $W_t$. The Fokker-Planck equation gives us a probability distribution of this process $p(x,t)$ through the PDE:

$$\frac{\partial}{\partial t} p(x,t) = -\frac{\partial}{\partial x}\left[\mu(x,t)p(x,t)\right] + \frac{\partial^2}{\partial x^2}\left[\frac{1}{2}\sigma^2(x,t)p(x,t)\right]  $$

This formula can also be extended to higher dimensions in an obvious way. The derivation of this formula is fairly involved so not included in this blog post, most good textbooks on stochastic analysis should have a derivation for the interested reader.&lt;/p&gt;
&lt;p&gt;In the case of the EIF model we can thus write down:

$$ \frac{\partial p}{\partial t} = \frac{\sigma^2}{\tau}\frac{\partial^2p}{\partial V_m^2} + \frac{\partial}{\partial V_m} \left[ \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) \right] $$

With $\psi(V_m)$ represnting the exponential firing term.&lt;/p&gt;
&lt;p&gt;By the continuity equation we can write:

$$ \frac{\partial p}{\partial t} = - \frac{\partial J}{\partial V_m} $$
&lt;/p&gt;
&lt;p&gt;Where $J$ represents the flux. By using this relation in the Fokker-Planck equation and integrating over voltage we get:

$$ J(V_m, t) = - \frac{\sigma^2}{\tau}\frac{\partial p}{\partial V_m} - \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;We can also note that:

$$J(V_{Re}^+,t) = J(V_{Re}^-, t) + r(t)$$
&lt;/p&gt;
&lt;p&gt;Where $V_{Re}^\pm$ represents the limit from above (+) or below (-) the reset voltage. the function $r(t)$ represents the average neuron firing rate. This is due to the implementaion of the voltage reset mechanism post spike. We can also note that for $V_m &amp;lt; V_{Re}$ we have $J(V_m, t) = 0$ and for $V_m &amp;gt; V_{Re}$ we have $J(V_m, t) = - r(t)$. We can then solve the flux equation to give:

$$P(V_m, t) = \frac{r(t)\tau}{\sigma^2} \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du $$
&lt;/p&gt;
&lt;p&gt;Since the probability measure needs to integrate to 1, we can then write:

$$r(t) = \left( \frac{\tau}{\sigma^2} \int_{-\infty}^{V_{Th}} \left( \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du \right) dV_m \right)^{-1} $$
&lt;/p&gt;
&lt;p&gt;(Note under the scheme presented there is no time dependence to any of these equations. Under time dependent signals we would have to be more careful and typically further approximations are made.)&lt;/p&gt;
&lt;p&gt;So far we have not allowed for the refractory period, we have assumed that after reset the voltage trajectories continue as normal. Given we have chosen a deterministic refractory period we can just add this to the euqation above:

$$r_{ref}(t) = \left( \frac{\tau}{\sigma^2} \int_{-\infty}^{V_{Th}} \left( \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du \right) dV_m + T_{Ref} \right)^{-1} $$
&lt;/p&gt;
&lt;p&gt;We can see that this integral will not give rise to an analytic solution in the case of EIF neurons. The forward Euler scheme we relied upon in the past will not perform well here. Instead we will use a slightly different numerical scheme.&lt;/p&gt;
&lt;h2 id=&quot;Numerical-Integration&quot;&gt;Numerical Integration&lt;a class=&quot;anchor-link&quot; href=&quot;#Numerical-Integration&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;(This is taken from Richardson [2007] - see references for further details) &lt;br /&gt;
Presented now is a numerical scheme for calculating the firing rate. Recall from above:

$$ J(V_m, t) = - r(t) \Theta(V - V_{Re}) = - \frac{\sigma^2}{\tau}\frac{\partial p}{\partial V_m} - \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;Where $\Theta(V)$ is the Heaviside step-function. Re-arranged this gives:

$$- \frac{\partial p}{\partial V_m} = - \frac {\tau}{\sigma^2} r(t) \Theta(V - V_{Re}) + \sigma^{-2}(V_m - V_L - \psi(V_m)) p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;Which is of the form:

$$ \frac{\partial p}{\partial V_m} = G(V_m)p(V_m) + H(V_m) $$
&lt;/p&gt;
&lt;p&gt;By applying a voltage discretization scheme: $V_k = V_{Lb} + k \Delta_V $ with $V_n = V_{Th}$ we can write down:

$$ p(V_{k-1}) = p(V_k) e^{\int^{V_k}_{V_{k-1}} G(V)dV} + \int^{V_k}_{V_{k-1}} H(V) e^{\int^V_{V_{k-1}}G(U)dU} $$
&lt;/p&gt;
&lt;p&gt;We can approximate this as:

$$ p(V_{k-1}) = p(V_k) e^{\Delta_V G(V_k)} + \Delta_V H(V_k) \left( \frac{e^{\Delta_V G(V_k)} - 1}{\Delta_V G(V_k)} \right) $$
&lt;/p&gt;
&lt;p&gt;Substituting back in the necessary formulae for $G$ and $H$ gives:

$$ p(V_{k-1}) = p(V_k) e^{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k)) } + \Delta_V \frac{\tau}{\sigma^2}r(t)  \Theta(V_k - V_{Re})\left( \frac{e^{\Delta_V   \sigma^{-2}(V_k - V_L - \psi(V_k))} - 1}{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k))} \right)   $$
&lt;/p&gt;
&lt;p&gt;However this still has unknown $r(t)$ in it. If we apply a transform: $q(V,t) = \frac{p(V,t)}{r(t)}$ then: $\sum q(V_k) = (r(t))^{-1}$ and:

$$ q(V_{k-1}) = q(V_k) e^{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k)) } + \Delta_V \frac{\tau}{\sigma^2} \Theta(V_k - V_{Re})\left( \frac{e^{\Delta_V   \sigma^{-2}(V_k - V_L - \psi(V_k))} - 1}{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k))} \right)$$
&lt;/p&gt;
&lt;p&gt;To simplify this expression we define functions $A$ and $B$ so that:

$$ q(V_{k-1}) = q(V_k) A(V_k) + \Theta(V_k - V_{Re}) B(V_k) $$
&lt;/p&gt;
&lt;p&gt;And so we can calculate the firing rate. This scheme has a much better performance than an Euler scheme. We instantiate the scheme with $q(V_n) = 0$, we also select a value $V_{Lb}$ as a cut-off to stop iterating. An implementation of this method can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Evaluating the solution to the Fokker-Planck Equation to calculate the firing rate of an EIF neuron subject to Gaussian white noise&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Membrane time constant tau (ms) and leak reversal potential VL (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spike sharpness DelT (mV) and exponential potential threshold VT (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variation in gaussian noise sig&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage spike threshold Vth (mV), reset voltage Vr (mV) and refractory period Tref (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up additional parameters for solving Fokker-Planck. DelV (mV) and VLb (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# For ease define function psi&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;psi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;psi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Shut off numpy divide errors&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seterr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Firing rate:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Firing rate: 21.6 Hz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can modify the previous EIF firing code to estimate the firing rate, the results should be similar (note: for this I used 10m time steps, it is a slow running code!):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Implementation of a noisy EIF neuron using a forward Euler scheme&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Reduce N for quicker running code&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set seed for repeatability&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set time step dt (ms) and number of steps N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Membrane time constant tau (ms) and leak reversal potential VL (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spike sharpness DelT (mV) and exponential potential threshold VT (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variation in gaussian noise sig&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage spike threshold Vth (mV), reset voltage Vr (mV) and refractory period Tref (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up voltage Vold (mV) and spike count Sp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up refractory period counter Tc (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated firing rate:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated firing rate: 20.2 Hz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Which we can see is similar to the solution of the Fokker-Planck equation. In the limit $N \to \infty$ and decreasing the lattice sizes these approximations should become much closer.&lt;/p&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen that by using the Fokker-Planck framework we are able to calculate the mean firing rate of the EIF neuron. We can also notice that the numerical scheme to integrate the Fokker-Planck runs significantly faster than taking a Monte-Carlo approximation by simulating the EIF directly. We can also notice that the Fokker-Planck framework is easy to extend (e.g. to modulated noise or other applied signals) and further we can extend this to allow for connected networks of neurons (I may write an additional blog post on this in the future but will likely end up being quite similar to this one).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://neuronaldynamics.epfl.ch/online/Ch13.html&quot;&gt;https://neuronaldynamics.epfl.ch/online/Ch13.html&lt;/a&gt; - Online Neuronal Dynamics Textbook by Wulfram Gerstner, Werner M. Kistler, Richard Naud and Liam Paninski&lt;/li&gt;
&lt;li&gt;How Spike Generation Mechanisms Determine the Neuronal Response to Fluctuating Inputs - Nicolas Fourcaud-Trocme, David Hansel, Carl van Vreeswijk, and Nicolas Brunel [2003]&lt;/li&gt;
&lt;li&gt;Firing-rate response of linear and nonlinear integrate-and-fire neurons to modulated current-based and conductance-based synaptic drive - Magnus J Richardson [2007]&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/fokker-planck.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/fokker-planck.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>