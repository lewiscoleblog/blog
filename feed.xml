<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://www.lewiscoleblog.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://www.lewiscoleblog.com/" rel="alternate" type="text/html" /><updated>2020-04-06T08:00:01-05:00</updated><id>https://www.lewiscoleblog.com/feed.xml</id><title type="html">Lewis Cole Blog</title><subtitle>A blog about maths, probability, modelling and computing.</subtitle><entry><title type="html">Spin Glass Models</title><link href="https://www.lewiscoleblog.com/spin-glass-models" rel="alternate" type="text/html" title="Spin Glass Models" /><published>2020-03-03T00:00:00-06:00</published><updated>2020-03-03T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Spin-Glass-Models</id><content type="html" xml:base="https://www.lewiscoleblog.com/spin-glass-models">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-03-Spin-Glass-Models.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;What-is-a-Spin-Glass?&quot;&gt;What is a Spin Glass?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-a-Spin-Glass?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A spin glass is not something you find down the pub (well it could be, but thats not what we're talking about here). Instead spin glasses are models of certain magnetic materials. Very loosely we can think of the atoms of a magnetic material as having a &quot;spin&quot; relating to the magnetic polarity (&quot;north&quot; or &quot;south&quot; ends of a bar magnet) - we typically call these up-spin and down-spin. In this context we use the term &quot;atom&quot; loosely, it may be an atom in a chemical sense but it could also be a molecule - essentially a minimal element of the material.&lt;/p&gt;
&lt;p&gt;In a ferromagnetic material (such as iron) spins orient in the same direction. In contrast antiferromagnetic materials the spins orient to oppose each other. In a spin glass we have some ferromagnetic interactions and some antiferromagnetic interactions, we say the system is &quot;disordered&quot;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;In the image above we can see various spin configurations. The spins are indicated by arrows (yellow for up and green for down) the ferromagnetic interactions are denoted by blue lines while antiferromagnetic interactions by red. However it is somewhat misleading to think of these occuring only within a square lattice in 2d such as this. Spins also do not have to be 180 degree rotations of each other - they can be at arbitrary angles from each other (but this would make for a messy diagram). A spin glass can also occur in arbitrarily many dimensions, and the interactions do not only have to occur between &quot;nearest neighbours&quot; any atom can have any number of interacting partners.&lt;/p&gt;
&lt;p&gt;We can represent the energy of a spin glass system using the Hamiltonian:

$$ H = - \sum_{x,y} J_{xy} \sigma_x \sigma_y  - h \sum_x \sigma_x $$

Where $J_{xy}$ denotes an interaction strength between atoms $x$ and $y$. $\sigma_x$ represents the spin/magnetism of an atom $x$ (can be a vector in which case all products are dot products). A system will tend to a state of lowest energy and so $J_{xy} &amp;gt; 0$ represents a ferromagnetic interaction (minimised for pairs of matching spin) and $J_{xy} &amp;lt; 0$ for antiferromagnetic interactions. The range over which the sum applies has been left purposely ambiguous as to allow for various lattice topologies. The second summation reflects an interaction with an external magnetic field (denoted by $h$) if there is no external field the term can be ignored. (It is worth noting that magnetic spins for a specific atom can only take one of two values (rotated through 180 degrees) since electrons have half integer spin)&lt;/p&gt;
&lt;p&gt;This allows us to define an important term relating to spin glasses. We can note that at a minimal energy (&quot;ground state&quot;) the spin glass will not be &quot;ordered&quot; (it will appear &quot;random&quot;). We call this property &lt;strong&gt;&quot;quenched disorder&quot;&lt;/strong&gt; - this is due to the similarity to glass materials that are essentially cooled down liquids that get &quot;frozen&quot; into a state of disorder.&lt;/p&gt;
&lt;p&gt;It is important to note this is different to pure &quot;randomness&quot;. If we think of a continuum whereby we have complete order on one side (think of a crystalline type structure as an example) and pure randomness on the other the spin glass lives somewhere in the middle - partially structured and ordered but partially random. This is a particularly interesting place to be: in the pure ordered end of the scale there are many established mathematical tools to deal with this situation. Similarly in a pure random situation probability and statistics can provide us tools for study. In the middle things get complicated since you cannot necessarily assume that any one element will &quot;look the same&quot; as any other - thus mean field methods fall down. This occurs in many &quot;real world&quot; phenomena, this can result in a lack of study since it &quot;falls inbetween&quot; different disciplines.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/Continuum.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;There is another important term relating to spin glasses called &lt;strong&gt;&quot;frustration&quot;&lt;/strong&gt;. This is where an atom has interactions with other atoms that are in conflict with each other - one interaction would suggest a lowest energy state for the atom is an up spin and another interaction suggests a down spin. An example of this can be seen below:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/frustration.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;We can see that the spin of the centre atom is not clearly defined by interaction with its neighbours. The vertical neighbours interactions suggest the lowest energy state would be a yellow up spin, while horizontal neighbours suggest a green down spin. In a large spin glass with random (or nearly random) configuartions there may be many such frustrated atoms. This gives rise to complexity and questions such as &quot;what is the lowest energy state for a system?&quot; becomes very difficult to answer. In many cases we are not able to determine this analytically. The energy landscape (the Hamiltonian energy for a given configuration of spins given a fixed topology of interactions) can become very complex with lots of local minima, which means &quot;typical&quot; optimization procedures based around greedy hill climbing (and the like) will struggle to find the global minimum. See the plot of energy landscape below as an example:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/energy_landscape.png&quot; alt=&quot;&quot; /&gt;
(Source: &lt;a href=&quot;https://ps.uci.edu/~cyu/p115A/LectureNotes/Lecture18/html_version/lecture18.html&quot;&gt;https://ps.uci.edu/~cyu/p115A/LectureNotes/Lecture18/html_version/lecture18.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;If one ends up in a configuration near one of these local minima it requires relatively large changes to the configuration to escape the valley. This leads to a kind of &quot;metastability&quot; in the system where the configuration will &quot;stick&quot; around these points for a long time. As such spin glasses tend to violate the Ergodic principle, this again adds to the mathematical complication in dealing with these systems.&lt;/p&gt;
&lt;p&gt;Although the system would &quot;prefer&quot; to be in a lower energy state through the application of a temperature (or placing the system within an external magnetic field) the atoms can have sufficient energy to escape this lower energy state. For high enough temperatures this means a ferromagnetic material can become antiferromagnetic. In most cases there exists a critical temperature where a phase transition occurs. Phase transitions are interesting examples of &lt;strong&gt;emergence&lt;/strong&gt; - one example of a phase transition that everybody is familiar with is the phenomena of melting a solid to create a liquid. It is interesting that this is a very sharp transition - why is it not the case that a solid gradually becomes &quot;softer&quot; and more liquid like? Instead small temperature fluctuations can cause the state of matter to change. It is not immediately obvious why this is the case, other phase transitions exist in other systems and they are often interesting to analyse.&lt;/p&gt;
&lt;p&gt;The eagle eyed amongst you may notice that we have ignored the interference between spins themselves. It is true that this will have an impact but in most mathematical models of spin glasses it can be ignored. As with all mathematical models we look for a &quot;minimal description&quot; that captures the behaviour of interest, it turns out that this complication tends not to add much to the model (although I'm sure there exists research with interesting results capturing this interference).&lt;/p&gt;
&lt;p&gt;So what are some physical examples of a spin glass in the real world? Technically any iron magnet subject to rust (which is antiferromagnetic) will be a spin glass, however typically the ferromagnetic atoms will still be so prevelent that we can think of it as a ferromagnet. There are other &quot;exotic&quot; molecules (e.g. europium strontium sulphide) that are spin glasses also. Many of the experiments on spin glasses involve melting down a noble metal (e.g. gold or silver) and adding a small amount of dispersed molten iron (typically around 0.1-5%) and cooling the mixture very quickly. Many counter-intuitive and contradictory properties have been found through these experiments including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;By cooling quickly one can avoid the transition from liquid to solid - creating a viscous liquid spin glass&lt;/li&gt;
&lt;li&gt;Relaxation times (how long it takes the system to adjust to changes in temperature) can be very slow, way beyond experimental time frames&lt;/li&gt;
&lt;li&gt;Interactions with magnetic fields are odd. Absent of a magnetic field a spin glass is not magnetic. By carefully applying and removing external magnetic fields one can create a magnetic spin glass with varying properties (decays, apparent permanence etc.)&lt;/li&gt;
&lt;li&gt;Spin glasses appear to have a &quot;memory&quot; of previous states and undergo something akin to an aging process
Creating theoretical explanations of these (and other) phenomena is the subject of much research on the subject.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Why-do-we-care?&quot;&gt;Why do we care?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-do-we-care?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ok, so at this point we may have a base understanding of what a spin glass is and some of the complications and properties therein, but you may be thinking: &quot;but who cares about magnets anyway?&quot; (Unless of course you are &lt;a href=&quot;https://i.imgur.com/wZfi1wk.jpg&quot;&gt;Charlie Kelly&lt;/a&gt;) It does seem like a lot of work and as a non-physicist it might seem interesting. However in dealing with the complications of spin glasses we can gain a lot of insight into other systems. In the next few bullet points I will try and convince you that it is worth time playing around with spin glasses:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;They're interesting!&lt;/strong&gt; - Spin glasses exhibit a number of properties that I personally find very interesting, for example: emergent behaviour, &quot;in between&quot; order and randomness, simple concepts to explain but difficult to write down mathematically, etc.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-ergodic systems are everywhere!&lt;/strong&gt; - Although spin glasses themselves are quite stylised if they can give insight into the behaviour of non-Ergodic systems this is very useful. Loosely speaking an Ergodic system does not exhibit path depedence (e.g. whatever the state at present eventually any other state can be reached). When looking at complex systems this is typically not the case.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Frustration occurs more than we would like&lt;/strong&gt; - We often end up in the situation with &quot;conflicting&quot; information and dealing with this gives rise to many opportunities.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;They're easy to simulate&lt;/strong&gt; - while some of the properties above make mathematical analysis difficult in all but a few special cases, spin glasses are fairly easy to code up and simulate. If you wonder &quot;what would happen if....?&quot; you can quickly modify a model and play around to see what happens, you don't need to spend much time thinking about boundary/initial conditions or other technical aspects.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;There are many different applications&lt;/strong&gt; - Given the ubiquity of some of the complications relating to spin glasses the techniques and theory have been applied to many situations including (but not limited to): optimization techniques, neural networks (biological and artificial), machine learning, protein folding, materials science, evolutionary models. The study of quantum spin glasses is also fairly active with applications in quantum computing.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this blog post we have been on a whistle-stop tour of the very basic concepts of spin glasses and models of spin glasses. We have seen some of the difficulties with them and what makes them interesting and useful to study. In future blog posts we will look at specific models and mathematical techniques used to study them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/spin-glass/spin_glass.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Standing Ovation Model</title><link href="https://www.lewiscoleblog.com/standing-ovation" rel="alternate" type="text/html" title="Standing Ovation Model" /><published>2020-02-25T00:00:00-06:00</published><updated>2020-02-25T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Standing-Ovation</id><content type="html" xml:base="https://www.lewiscoleblog.com/standing-ovation">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-25-Standing-Ovation.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Standing-Ovations---as-a-Phenomena&quot;&gt;Standing Ovations - as a Phenomena&lt;a class=&quot;anchor-link&quot; href=&quot;#Standing-Ovations---as-a-Phenomena&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Although not particularly &quot;exciting&quot; for a subject to model, standing ovations have many interesting properties. A truly fantastic performance may elicit an instantaneous standing ovation whereby all audience members instinctively decide to stand. However this cannot be the only factor, we can observe in other performances a few hardcore fans may initially stand and then pass through the crowd as a &quot;wave&quot; through social pressure (or perhaps the inability to see the stage if others in front of you stand!) Eventually resulting in a standing ovation. At other times maybe only a handful of audience members stand, notice very few people around them are standing and then sheepishly sit down again. There is a clear temporal aspect to standing ovations but there is also some sense of criticality whereby a phase transition occurs. While understanding the mechanisms behind this for standing ovations may not have much &quot;value&quot; in of itself these principles turn up in many complex systems and so understanding here can be transferable to more &quot;interesting&quot; situations.&lt;/p&gt;
&lt;h2 id=&quot;Modelling-Standard-Ovations&quot;&gt;Modelling Standard Ovations&lt;a class=&quot;anchor-link&quot; href=&quot;#Modelling-Standard-Ovations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now move onto the question: how can we model standing ovations? We first consider the initial (instinctive) decision of standing or not following a performance. Clearly for a &quot;perfect&quot; performance (however that may be defined) everybody would show their appreciation and stand. However when the performance is not &quot;perfect&quot; why do some stand and some not? We could model each audience member as having some &quot;error function&quot; that clouds their judgement of the performance, so for (objectively) a good performance we could have that some percieve the performance as bad owing to their error function, and so they decide not to stand. We can express this mathematically: we denote the performance quality as $P$. Each individual has an error-rate $\epsilon$ - this defines a signal $S$ as:

$$ S = P + \epsilon $$

We can then state that an individual will stand for a signal that is in excess of their threshold $T$. We can take this threshold to be fixed for all individuals by adjusting their $\epsilon$ accordingly.&lt;/p&gt;
&lt;p&gt;But what does the error-rate represent? There are a number of interpretations. For example it could represent &quot;stubborness&quot;, some may be difficult to impress. It could also represent differences in knowledge, somebody unfamiliar with jazz-club etiquette may stand/stay seated at the wrong times whereas somebody more seasoned will be more closely tied to the quality of the performance.&lt;/p&gt;
&lt;p&gt;For arguments sake let's say that $P$ can vary from 0 to 1. The error rates are uniformly distributed. We can then code up this initial standing ovation model as below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set audience size&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix performance quality as 50%&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix all audience as seated (0) initially&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set error functions for audience members&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# We set up an array to vary the threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop over all thresholds and plot the percentage of audience standing&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Threshold&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Percent Standing&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As expected we get a straight line decreasing with threshold. From the discussion before we know that standing ovations are not entirely determined by the performance quality (and resulting threshold) behaviour. There is a social aspect to the phenomena. We now move onto looking at a temporal model. One way we could do this is that an individual takes a survey of all their neighbours and if enough of them are standing they also decide to stand (somewhat similar to the movement mechanism in a &lt;a href=&quot;https://demonstrations.wolfram.com/SchellingsModelOfResidentialSegregation/&quot;&gt;Schelling Segregation Model&lt;/a&gt;). However if you are sat in the audience it is unlikely you'll turn round to see what the people behind you are doing, you will only notice those in front of you. You may also notice those from many rows in front of you rather than just proximal neighbours. Page/Miller suggest a viewing &quot;funnel&quot; where each agent can see as:
&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Where we can adjust the number of rows somebody can see as a paramter (with 3 presented here). We will make a small adjustment to this method; let's place more weight on the audience members closest to us. We will calculate the proportion standing in each row in or field of vision and take a weighted sum of these according to the square distance away (e.g. row 2 will be weighted 1/4 of row 1, row 3 will be 1/9 weighted and so on.) This should capture the behaviour that there is more social pressure from those around us, this might lead to a slow &quot;wave&quot; propagating through the audience as this pressure grows. For this model lets also assume that the lights are on in the theatre and we can see all rows up to the front in detail.&lt;/p&gt;
&lt;p&gt;For this &quot;funnel&quot; we will ignore the proximal &quot;next door&quot; neighbours from this calculation. We will assume there is a different mechanism for these individuals, we will look at the proportion of neighbours standing (either 0, 0.5 or 1) and we will apply a &quot;neighbour weight&quot; which will weight between this score and the funnel score to give an overall social pressure score as:

$$ Social\_Pressure = (1 - neighbour\_weight) \times Funnel\_Pressure + neighbour\_weight \times Neighbour\_Pressure $$
&lt;/p&gt;
&lt;p&gt;We will use this mechanism of seperating out next door neighbours since if we go to a performance with others they will typically be sat next to us. Further one could argue that somebody is more likely to stand/sit based on their friend/partner's behaviour than those of a stranger. The neighbour weight parameter allows us to vary the relative importance.&lt;/p&gt;
&lt;p&gt;Using the overall social pressure metric a sitting individual will stand if the social pressure exceeds a fixed threshold, similarly a standing individual will sit if the social pressure is smaller than one-less the fixed threshold. We are assuming that there is a symmetry invoked here which may not be the case. For example the &quot;embarrassment&quot; of standing while others are sitting might mean people are quicker to sit if they're in a small minority standing. However for a first quick and dirty implementation of a model the symmetry assumption will suffice (it will be easy enough to modify later should we desire).&lt;/p&gt;
&lt;p&gt;We will also add 2 random components to this model: the first being a rate that if one is sitting down they stand up regardless of the information presented. The other being the reverse of this: a rate by which individuals sit down if they're standing. We will denote these rates as $\delta, \gamma$ respectively. This might allow for the possiblity of a &quot;spontaneous ovation&quot; occuring.&lt;/p&gt;
&lt;p&gt;We now have one choice remaining before we can implement this model: how will the updates be made? There are 2 main classes of updates in an agent based model: asynchronous and synchronous. The former essentially means each agent updates &quot;one by one&quot;, the order of upates can be random or by some defined order (in this example we could update those nearest the stage and iterate backwards for example). In a synchronous updating scheme all agents updated their state together once per time-step, of course by doing this one has to be careful in some situations (e.g. if there is an asset that can get depleted who gets to use it first?) but in this simple model there are no such concerns. For this model I think synchronous modelling is appropriate since I believe this is how ovations work in practice (e.g. we do not wait for &quot;our turn&quot; to make a decision), we could investigate how this affects the outcome later if we wish to.&lt;/p&gt;
&lt;p&gt;My implementation of this model can be seen below. We will look at how the proportion of audience members standing evolves over time (functions use njit decorator to simply improve run time - looping over the array multiple times in the funnel calculation is fairly slow in pure python):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set audience size&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix performance quality as 50%&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Performance threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix all audience as seated (0) initially&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set error functions for audience members&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix number of timesteps&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix social pressure threshold&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix neighbour weight&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix probaility of spontaneous standing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix probability of spontaneous sitting&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.05&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate initial reactions to performance&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Function to calculate social pressure&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rows&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;active_row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;active_row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pct_sum&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate pressure from (nextdoor) neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;neighbour_pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;right&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;
        
&lt;span class=&quot;c1&quot;&gt;# Calculate overall pressure score&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;neighbour_pressure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_weight&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spontaneous sitting/standing function&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;spontaneous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dlt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dlt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;aud&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Main Code Loop&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_stand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;up_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;down_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pressure_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;down_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Pressure_T&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience_old&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;spontaneous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;audience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pct_Hold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time Step&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Percent Standing&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;By selecting particular parameters we can see a few different behaviours in the model. These include an inital peak of enthusiasm that dies down, a gradual increase as the applause trickles from the front of the auditorium to the back and a rapturous applause leading to nearly all participants standing up very quickly. These are all behaviours that we do see in real life audiences. If we were particularly motivated we could look for real world phenomena in standing ovations and see if these rules are able to replicate them.&lt;/p&gt;
&lt;h2 id=&quot;Potential-Improvements&quot;&gt;Potential Improvements&lt;a class=&quot;anchor-link&quot; href=&quot;#Potential-Improvements&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;With agent based models there are always &quot;extra&quot; things that could be added/modified. A few select suggestions include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Revisit the &quot;funnel&quot; mechanism and compare various schemes&lt;/li&gt;
&lt;li&gt;What happens if there are various levels/balconies or perhaps aisles between seats?&lt;/li&gt;
&lt;li&gt;What happens with &quot;stooges&quot;? That is if we add agents who always applaud regardless, what is the minimum number required to guarantee a standing ovation? Where are they best placed (perhaps taking into account ticket cost - 10 in the middle compared to 2 at the front), etc.&lt;/li&gt;
&lt;li&gt;We could code in &quot;partners&quot; or &quot;groups&quot; more precisely to investigate the impact that has&lt;/li&gt;
&lt;li&gt;How does changing to asynchronous updating change the behaviour?&lt;/li&gt;
&lt;li&gt;What if every so often an agent &quot;turns round&quot; to view the seats behind them?&lt;/li&gt;
&lt;li&gt;and so on&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen how we can code up a basic agent based model for standing ovations. While the subject itself isn't particularly &quot;useful&quot; in of itself the principles are common to many other systems. We have also seen some of the considerations that go into an agent based model.&lt;/p&gt;
&lt;p&gt;As a final remark it is worth noting that this is not how you would produce an agent based model in practice. Typically you would start with a simple model and add features gradually and test the impact, I did not want to write a series of long posts on this model so I &quot;skipped to the end&quot; coding in what I thought some pertinent features could be all at once (although I did not spend long thinking about them!)&lt;/p&gt;
&lt;h2 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The original paper on standing ovation models presented by Scott Page and John Miller (&lt;a href=&quot;https://www2.econ.iastate.edu/tesfatsi/StandingOvation.MillerPage.pdf&quot;&gt;can be seen here!&lt;/a&gt; for those wanting to read more about their version of the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/ovation/Funnel.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Barnes-Hut Algorithm</title><link href="https://www.lewiscoleblog.com/barnes-hut" rel="alternate" type="text/html" title="Barnes-Hut Algorithm" /><published>2020-02-18T00:00:00-06:00</published><updated>2020-02-18T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Barnes-Hut</id><content type="html" xml:base="https://www.lewiscoleblog.com/barnes-hut">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-18-Barnes-Hut.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;The-N-Body-Problem&quot;&gt;The N-Body Problem&lt;a class=&quot;anchor-link&quot; href=&quot;#The-N-Body-Problem&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;It is well understood that for $N &amp;gt; 2$ that the problem of determining trajectories under gravitation for N-bodies cannot be solved analytically. Instead we must rely on computation to create trajectories. From Newton's equations we can write the force $\pmb{F_{i,j}}$ between two bodies $i, j$ with masses $m_i, m_j$ and positions $\pmb{p_i}, \pmb{p_j}$ as:

$$ \pmb{F_{i,j}} = \frac{G m_i m_j (\pmb{p_i} - \pmb{p_j})} {\lVert \pmb{p_i} - \pmb{p_j} \rVert^3} $$
&lt;/p&gt;
&lt;p&gt;For $N$ bodies we therefore have $\frac{N(N-1)}{2}$ forces to be calculated. For small $N$ this is not a problem, however if we want to model galaxy dynamics with thousands (or more) of bodies this becomes a computational issue.&lt;/p&gt;
&lt;h2 id=&quot;Barnes-Hut-Process&quot;&gt;Barnes Hut Process&lt;a class=&quot;anchor-link&quot; href=&quot;#Barnes-Hut-Process&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;With Barnes Hut we can move from $O(N^2)$ complexity to $O(Nln(N))$ - this is a significant improvement for large $N$.&lt;/p&gt;
&lt;p&gt;The crux of the Barnes Hut scheme is to approximate the effect of &quot;far away&quot; bodies but calculate exactly the forces attributed to &quot;near&quot; bodies. To do this a quadtree data structure is used (in 3d an octree or higher dimensions a $2^d$tree). To do this the space is partitioned into 4 equal squares at depth 1 (or 8 cubes in 3d or $2^d$ hypercubes in higher dimension) - at depth 2 each of these squares is then partitioned into 4 equal squares and so on. From this a tree is constructed with each node representing the number of bodies within the quadrant at that depth. This is repeated recursively until a depth is reached where each quadrant has 1 or 0 bodies in it. It is easier to understand this with a visual example:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png&quot; alt=&quot;&quot; /&gt;
(Source: &lt;a href=&quot;https://developer.apple.com/documentation/gameplaykit/gkquadtree&quot;&gt;https://developer.apple.com/documentation/gameplaykit/gkquadtree&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;With this data structure in place we can begin to simulate. For each quadrant in the quadtree we can calculate a centre of mass (in the obvious way). Then given a body we can calculate the force acting on it from a given quadrant by applying the Newtonian force calculation using the centre of mass. We could, for example, apply this to the 4 quadrants at depth 1 to approximate the force acting on the body. This of course might not be particularly accurate if there are many bodies present. To overcome this the Barnes Hut algorithm specifies a critical distance $\theta$ if the distance beween the body and the centre of mass of the quadrant is greater than $\theta$ then it is used as an approximation, if not the algorithm moves to the next depth of the quadtree and tries again, this happens recursively until the distance becomes below $\theta$ or there is only 1 body in the quadrant (as such setting $\theta = 0$ returns to the $O(N^2)$ brute force approach).&lt;/p&gt;
&lt;p&gt;While this is presented as an algorithm for the N-body problem it can be used in other situations that involve a spatial dimension and many entities. I am currently considering an application to speed up an agent based model (potentially the subject of another blog post).&lt;/p&gt;
&lt;h2 id=&quot;Implementation&quot;&gt;Implementation&lt;a class=&quot;anchor-link&quot; href=&quot;#Implementation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Initially I will code up an example in Python, I may revisit this and create a more efficient implementation in Cython/C++/etc. I will ignore all &quot;complications&quot; for example I will not give each body a size nor will it consider collisions, etc. Each body is a &quot;point mass&quot; in this example. For now I'll also ignore the issues relating to plotting trajectories.&lt;/p&gt;
&lt;p&gt;We first create a node class to represent nodes within the quadtree. Using this data structure we will then apply a verlet time step to calculate positions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;copy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    A class for a node within the quadtree.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    We use the terminology &amp;quot;child&amp;quot; for nodes in the next depth level - consistent with tree nomenclature&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    If a node is &amp;quot;childless&amp;quot; then it represents a body&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Initializes a childless node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        m - Mass of node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        x - x-coordinate centre of mass&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        y - y-coordinate centre of mass&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        px - x- coordinate of momentum&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        py - y-coordinate of momentum&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        pos - centre of mass array&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        mom - momentum array&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        child - child node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        s - side-length (depth=0 s=1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        relpos = relative position&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Places node in next quadrant and returns quadrant number&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;divide_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Places node in next level quadrant and recomputes relative position&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quadrant&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reset_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Repositions to the zeroth depth quadrant (full space)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relpos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Calculates distance between node and another node&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Force applied from current node to other&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Adds body to a node of quadtree. A minimum quadrant size is imposed&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    to limit the recursion depth.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;min_quad_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-5&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_quad_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_node&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_ap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;child&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;verlet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;model_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_quad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add_body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;verlet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;########## Main Code ##########&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Theta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.7&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PX0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Main Model Loop&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Model_Loop_BH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; Model_Loop_BH(N_steps)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;7.97 s ± 446 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This code is not the most efficient possible for this model (in all likelihood one would only use Barnes-Hut for large galaxy simulations and so it's unlikely that Python would be the best choice). For 100 bodies and 1000 time steps this code runs on my machine in around 8s.&lt;/p&gt;
&lt;p&gt;We can also code up a &quot;brute force&quot; approach (calculating forces between all pairs of bodies) to compare, it is likely that the cost of computing the quadtree could be more costly than just computing all forces directly when the number of bodies is suitably small. We could run these codes multiple times to find where this is the case.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# from numba import njit&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; main_loop(N_steps, pos, mom)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;1min 18s ± 1.89 s per loop (mean ± std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This brute force code is not implemented in a particularly efficient way, however it is good enough for illustration purposes. Even for relatively small model sizes (100 bodies for 1000 time steps) the code takes considerably longer than the Barnes-Hut algorithm, with timeit giving an approximate timing of around 78s - about 10 times slower than the Barnes-Hut implementation.&lt;/p&gt;
&lt;p&gt;If we use Numba with the njit decorator we can improve this to 3s - which while quicker is not considerably better than the Barnes-Hut algorithm. As the number of bodies increases (and perhaps some fine tuning of the Barnes-Hut parameters) we would expect even more drastic improvements.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.e-2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Seed for Initialization&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initial Conditions&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_bodies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PX&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros_like&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_mom&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_mom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_arr&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_loop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_mom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update_pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mom_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Masses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_arr&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; main_loop(N_steps, pos, mom)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3 s ± 33.1 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen that even for relatively modest models the Barnes-Hut algorithm provides fairly efficient computation for the N-body problem. We would expect the improvement to be even more marked for larger models. However Python on its own is not the best place to implement this and a C++ implementation would offer better performance. With some work a Cython approach should be possible and offer performance improvements. The code would require some major re-working if Numba is to be used instead owing to the reliance on classes to generate the quadtree.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/barnes-hut/Quadtree.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Cython Vs Numba: An Example</title><link href="https://www.lewiscoleblog.com/cython-numba-2" rel="alternate" type="text/html" title="Cython Vs Numba: An Example" /><published>2020-02-11T00:00:00-06:00</published><updated>2020-02-11T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Cython-Numba-2</id><content type="html" xml:base="https://www.lewiscoleblog.com/cython-numba-2">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-11-Cython-Numba-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Following on from the previous blog post comparing the relative merits of Cython Vs Numba I thought I'd illustrate this with implementations of a relatively simple model: a vanilla 2d Ising Model. This is a prime target for a performance boost since it is a very &quot;loopy&quot; code. I will not cover what the Ising Model is/how it works (&lt;a href=&quot;https://en.wikipedia.org/wiki/Ising_model&quot;&gt;you can check that here!&lt;/a&gt;). It is a very interesting model and I may return to it at a later date to look at some of its properties and explore it more deeply (and maybe spin glass models more generally). For now it will just be a test subject to explore performant python type code.&lt;/p&gt;
&lt;p&gt;In this blog I will present a few different versions, I won't throw the kitchen sink at them to get the absolute best performance but will adopt an 80/20 principle. I will not try any parallelisation or clever memory management outside of what comes pre-canned.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Python&quot;&gt;Python&lt;a class=&quot;anchor-link&quot; href=&quot;#Python&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This is a basic python implementation using a lot of looping. Even for a relatively small models this code will likely be fairl slow due to the looping.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Numba&quot;&gt;Numba&lt;a class=&quot;anchor-link&quot; href=&quot;#Numba&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;For this code we will just take the above code and use the njit decorator (forcing the use of LLVM - a jit decorator will fall back to Python object mode if it cannot work out how to use LLVM). This is literally a few seconds of coding updates.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nb_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_tmp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Cython&quot;&gt;Cython&lt;a class=&quot;anchor-link&quot; href=&quot;#Cython&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Again we will modify the python code. We will see that while not too onerous it does require a little more work than the Numba example. The code is largely boilerplate but requires a little more thinking than the Numba example (e.g. in implementing this I initially forgot a static type definition of 1 variable which was causing a 300% increase in runtime).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;load_ext&lt;/span&gt; Cython
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cython&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cython&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cnp&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;libc.math&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;libc.stdlib&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;cimport&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;limits.h&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RAND_MAX&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Grid size: N (int) NxN square latice&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Fix Temp&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;kT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;kTinv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kT&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Fix seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Random Initialize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Get sum of neighbours&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cy_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;north&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;south&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;east&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;west&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cy_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cy_neighbour_sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;x_offset&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;j&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dEtmp&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_offset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_dE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dEtmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kTinv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RAND_MAX&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;cdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundscheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@cython&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wraparound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cpdef&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;cnp&lt;/span&gt;.&lt;span class=&quot;kt&quot;&gt;int32_t&lt;/span&gt;[&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cpy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32_t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cy_main_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spin_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Timing-Results&quot;&gt;Timing Results&lt;a class=&quot;anchor-link&quot; href=&quot;#Timing-Results&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Python&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; _main_code(10, spins)

&lt;span class=&quot;c1&quot;&gt;# Numba&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; nb_main_code(10, spins)

&lt;span class=&quot;c1&quot;&gt;# Cython&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;timeit&lt;/span&gt; cpy_main_code(10, spins)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;52 s ± 2.53 s per loop (mean ± std. dev. of 7 runs, 1 loop each)
244 ms ± 4.48 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
395 ms ± 6.92 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For our purposes the %timeout magic will be good enough a proxy for performance. We can see that the intial python implementation is very slow. For a 1000x1000 lattice and looping over 10 times, for my machine the python interation takes 50-55s. This would be fairly problematic if we wanted to sweep over the parameter space, find critical temperatures, perform random seed analyses etc.&lt;/p&gt;
&lt;p&gt;In contrast Numba only takes 240-250ms, an impressive 2000% speed up. Running the code multiple times now seems much less onerous.&lt;/p&gt;
&lt;p&gt;Cython is not quite as quick as the Numba implementation taking 390-400ms but still represents a significant speedup compared to Python. For practical applications the difference between Numba and Cython in this case may be insignificant.&lt;/p&gt;
&lt;p&gt;It is worth noting that these times are from my machine on at a specific time. The times achieved on your machine might be slightly different. Similarly changing the size of the lattice may change the ordering of which option is &quot;quickest&quot; - as always it's worth checking the code how it will be used rather than performing a benchmark like this for determining which option to use.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;From the results above it may be tempting to claim Numba is the obvious choice given it is not only easier to implement than cython but also offers faster speeds. However I selected the 2d Ising model as an example since I knew the code would work well in Numba (in a sense I have been p-value hacking the experiment!) In certain situations (e.g. a code relying very heavily on class structures) Numba is either unusable or requires a complete code overhaul whereas cython can require only a few lines of boilerplate code.&lt;/p&gt;
&lt;p&gt;In other examples you can also see that Cython can severely outperform Numba, I am not sure why this is and the only real way to determine which will perform better is to perform testing (if somebody has an explanation/heuristic I'd love to hear it). It is also possible to interface numba and cython which has been useful to me in the past. For a quick example suppose we want to perform an inverse transform of a Beta(2,0.5) distribution:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.4681225665264196&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This cannot be optimised in Numba as it is (beta.ppf is currently not supported functionality - this may change by the time you read this). However we can take the address of the cython special function that this calls. We can then build the function in such a way as it can be seen by Numba:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ctypes&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;njit&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numba.extending&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_cython_function_address&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;betaaddr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_cython_function_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;scipy.special.cython_special&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;btdtri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;functype3d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CFUNCTYPE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_double&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;beta_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;functype3d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;betaaddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@njit&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nb_beta_ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nb_beta_ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.4681225665264196&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see this is a little ugly but it works.&lt;/p&gt;
&lt;p&gt;As a result of everything covered in these blog posts I do not believe that one option offers a significant advantage over the other and both offer valid tools for improving runtime. The choise of which to use in a given situation will depend on many factors and requires careful thought as to what is needed in a given setting.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Cython Vs Numba</title><link href="https://www.lewiscoleblog.com/cython-numba" rel="alternate" type="text/html" title="Cython Vs Numba" /><published>2020-02-04T00:00:00-06:00</published><updated>2020-02-04T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Cython-Numba</id><content type="html" xml:base="https://www.lewiscoleblog.com/cython-numba">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-04-Cython-Numba.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Outline-of-the-Problem&quot;&gt;Outline of the Problem&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-the-Problem&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Python at its core is slow for certain things. By being a dynamically typed and interpreted language you incur certain runtime overheads. In some cases these are not much of an issue. At other times they can be critical.&lt;/p&gt;
&lt;p&gt;Typically we will try and &quot;vectorize&quot; the code as much as possible (avoiding extraneous loops) and force as much code as we can into NumPy array operations which are typically &quot;quick&quot; (compiled C code). This is fine when it works, but it is not always possible to vectorize the code or, in some cases, the vectorization leads to code that is very hard to read/understand.&lt;/p&gt;
&lt;p&gt;Both Numba and Cython (not to be confused with CPython) aim to provide tools to deal with such situations.&lt;/p&gt;
&lt;h2 id=&quot;Outline-of-Cython&quot;&gt;Outline of Cython&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-Cython&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Cython is a programming language that is part Python and part C/C++, it can be compiled into a python extension and/or an executable. If you are familiar with Python it is reasonably easy to understand Cython code, it largely just has a few &quot;boiler-plate&quot; code blocks along with a few static type declarations (familiar to those who know C/C++/related languages).&lt;/p&gt;
&lt;p&gt;Since there are no dynamic types (in well written Cython code) and it is compiled typically the resulting code is orders of magnitude faster than Python. Compared to vectorised NumPy there may not be a significant improvement but this depends on the exact implementation.&lt;/p&gt;
&lt;p&gt;Cython itself is very flexible, if you can express the code in Python it is unlikely you will not be able to express it in Cython. Any arbitrary class structure can work within Cython, as a result it is used for many &quot;high performance&quot; Python packages (e.g. SciPy).&lt;/p&gt;
&lt;p&gt;It is possible to parallelize the code or utilise GPU computation using Cython. This normally requires a bit of work but typically does not require nearly as much work as using Cuda in C++ (for example). As usual the normal caveats relating to multi-thread applications also apply to Cython code.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://cython.readthedocs.io/en/latest/&quot;&gt;You can read the Cython documentation here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Outline-of-Numba&quot;&gt;Outline of Numba&lt;a class=&quot;anchor-link&quot; href=&quot;#Outline-of-Numba&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Numba is a slightly different beast. It uses the concept of a &quot;just in time&quot; compiler (JIT). Essentially this means that code is compiled &quot;on the fly&quot; during runtime instead of requiring compilation prior to execution. Numba compiles the python code using a LLVM compiler.&lt;/p&gt;
&lt;p&gt;The syntax is very simple and most of the time just requires a simple decorator on a Python function. It also allows for parallelisation and GPU computation very simply (typically just a &quot;target = 'cuda'&quot; type statement in a decorator). In my experience a lot less thinking is required to set this up compared to Cython.&lt;/p&gt;
&lt;p&gt;The downside of Numba (at least for me) is that it is a (comparatively) new package and as such does not have support for absolutely everything you would want, unlike with Cython it is possible to just &quot;hit the wall&quot; where you simply cannot use Numba without a major re-writing of the code. (One such example being you cannot call @guvectorize functions inside the @njit decorator). It is worth checking the github issues log regularly as often these issues are on the docket to be corrected in future releases.&lt;/p&gt;
&lt;p&gt;Another downside of Numba is the lack of useful traceback, typically you need to &quot;switch off&quot; Numba and run in regular python to track down an error. This is typically only a minor inconvenience but if the code is particularly slow it can get frustrating trying to find an error without the Numba speed up.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://numba.pydata.org/&quot;&gt;You can read more about Numba here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Which-is-better?&quot;&gt;Which is better?&lt;a class=&quot;anchor-link&quot; href=&quot;#Which-is-better?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;From a raw performance perspective I do not see either Cython nor Numba consistently beating the other in all situations. Typically the performance will be comparable and you will rarely find one being many orders of magnitude quicker (assuming you're using both correctly).&lt;/p&gt;
&lt;p&gt;The choice of which to use, in my opinion, comes down to other factors. Convenience being a big one, I typically find Numba easier and quicker to implement when it works. As noted above however it doesn't always work (e.g. if using class structures, custom data types, etc.) With familiarity you do get an instinct as to whether a code will work or not. Cython on the other hand offers much more flexibility.&lt;/p&gt;
&lt;p&gt;There is also the issue of how the code will be used. Cython is well established for creating efficient extension modules that sit nicely within the Python eco-system. Numba can be used in a similar way but I have found it a bit more finnicky to deal with (for example through Numba itself changing its API fairly regularly since it's a relatively new module, some code from previous iterations of Numba simply does not work at all with the later versions).&lt;/p&gt;
&lt;h2 id=&quot;What-is-the-catch?&quot;&gt;What is the catch?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-the-catch?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Unfortunately things are not perfect, typically we will still be interfacing Cython/Numba functions via Python and so using repeated calls to these functions we will still incur overheads (typically through the conversion to Python types). This can mean that certain code is still significantly slower than C/C++ equivalents. These packages are therefore most useful for when you have profiled your code and can see that a handful of functions/operations are the real bottleneck.&lt;/p&gt;
&lt;p&gt;These packages may not help if your code is particularly memory intensive, in which case it is better to spend time thinking about memory management instead. In some cases these packages provide some help in that respect also (e.g. NumPy is prone to creating many cached variables for simple operations, if the variables are large arrays this can become a pain.)&lt;/p&gt;
&lt;h2 id=&quot;What-about-PyPy/etc?&quot;&gt;What about PyPy/etc?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-about-PyPy/etc?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another option for performant Python code is to use PyPy instead of CPython. I have not used this very much yet, if I get the time to really kick the tyres I may write another blog on my findings. There are some features that appear useful but the eco-system is not as well supported (yet?) and so may require some additional work to recreate some high level functionality.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.pypy.org/&quot;&gt;You can read more about PyPy here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Why-not-just-C/C++?&quot;&gt;Why not just C/C++?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-not-just-C/C++?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ultimately if you require peak performance at all costs these options are still no substitute for well written C/C++. However as I often warn people: computation time is generally cheaper than human time - it is often better to use a slightly sub-optimal (but still respectable) code than devote months to R&amp;amp;D and slow down the development cycle. Since Numba/Cython are so similar to Python (and it is possible to just &quot;tack on&quot; some Python to the end of these codes) you can prototype much more quickly in my experience. All these factors (along with many others such as where the code is to be deployed, what other tools are being used, etc.) need to be weighed up.&lt;/p&gt;
&lt;h2 id=&quot;What-about-Julia?&quot;&gt;What about Julia?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-about-Julia?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Some readers may be familiar with the Julia language as an option for high performance scientific computing. I have a little experience (but am far from an expert). As I understand Julia is based around JIT (as with Numba), however being a language to itself it never needs to interface with Python and its limitations. It can therefore create more efficient code for larger scale projects since they never have to worry about Python overheads. Typically the benchmarks seen online are for smaller &quot;toy&quot; problems and so the performance does not appear to be too different from Cython/Numba.&lt;/p&gt;
&lt;p&gt;I have not switched to Julia for a few reasons, firstly the popularity of Python - it is typically fairly easy to learn Cython/Numba for somebody who understands Python/NumPy making collaboration easier. Secondly the Python eco-system is well developed there is typically a package available to do almost anything you would want. Thirdly at this point it is fairly easy to get Python to &quot;speak&quot; with other systems if you need to turn something from a prototype to production. These concerns are ultimately just related to uptake however, as more people use Julia I see this becoming less of a concern.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://julialang.org/&quot;&gt;You can read more about Julia here!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hopefully now we can see that Cython/Numba provide useful tools for bridging the gap between Python and C/C++ runtimes. As the old saying goes &quot;you cannot have your cake and eat it too&quot; and so it may not be possible to get performance as quick using these options. However we can often get performance that is &quot;good enough&quot; in practical terms.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/cython-numba/cython-numba.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Jackknife Methods</title><link href="https://www.lewiscoleblog.com/jackknife" rel="alternate" type="text/html" title="Jackknife Methods" /><published>2020-01-28T00:00:00-06:00</published><updated>2020-01-28T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Jackknife</id><content type="html" xml:base="https://www.lewiscoleblog.com/jackknife">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-28-Jackknife.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this blog post we are concerned with a specific problem: we have a Monte-Carlo type model that produces some simulated output. With this we want to estimate an arbitrary statistic (for example percentiles, expected shortfall or more complicated statistics relating to many variables). We know however that calculated in this way the calculated statistic is just one realisation of a distribution of outcomes. We would like to be able to say something about this distribution, in particular we would like to have some idea of the variability in the statistic.&lt;/p&gt;
&lt;p&gt;The &quot;obvious&quot; (and most accurate) way to do this would be to re-run the model many times with different random seeds and create an empirical distribution of the statistic. However if the model is particularly complex this might mean a lot of compute time. Instead we would like to find an approximate method that does not require us to re-run the model at all. To do this in a general way we will introduce the Jackknife method.&lt;/p&gt;
&lt;p&gt;It is worth noting that in certain situations other methods can be easier to implement/more accurate, for example if we only wanted to estimate the 90th percentile we can construct an argument using a binomial distribution (and normal approximation thereof) - however this method will not generalise to (for example) expected shortfall or even more complicated statistics.&lt;/p&gt;
&lt;h2 id=&quot;Justification-of-the-Method&quot;&gt;Justification of the Method&lt;a class=&quot;anchor-link&quot; href=&quot;#Justification-of-the-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We begin by supposing we have $N$ un-ordered observations $\{ X_i \}_{i=1}^{N}$ from our Monte-Carlo model. We use these observations to create an estimate of a statistic $\hat{Q}$. We denote the estimate from the model $\hat{Q}_{\{1:N\}}$, which itself is a random variable. Through a Taylor expansion we can note:

$$ \mathbb{E}\left(\hat{Q}_{\{1:N\}}\right) = \hat{Q} + \frac{a_1}{N} + \frac{a_2}{N^2} + ...$$

For some constants $a_x$.&lt;/p&gt;
&lt;p&gt;If we now consider partitioning the $N$ observations as: $N = mk$ for integers $m$ and $k$ - that is we create $m$ collections of $k$ obervations ($k \gg m$). We denote a set: $A_i = \{ X_j | \quad  j &amp;lt; (i-1) k , \quad j \geq i k  \}$ to contain all observations bar $k$, each set removes a different set of $k$ observations. Each has $|A_i| = (m-1)k$. We can then write:

$$ \mathbb{E}\left(\hat{Q}_{A_i}\right) \approx \hat{Q} + \frac{a_1}{(m-1)k} + \frac{a_2}{(m-1)^2k^2} $$

Via a second order approximation.&lt;/p&gt;
&lt;p&gt;If we then define a new variable: $\hat{q}_i = m\hat{Q}_N - (m-1)\hat{Q}_{A_i}$. Then via a second-order approximation we have:
$$\mathbb{E}\left( \hat{q}_i \right) \approx m\left( \hat{Q} + \frac{a_1}{N} + \frac{a_2}{N^2}\right) - (m-1)\left(\hat{Q} + \frac{a_1}{(m-1)k} + \frac{a_2}{(m-1)^2k^2}\right)$$ 
Through some simplification this becomes:

$$\mathbb{E}\left( \hat{q}_i \right) \approx \hat{Q} - \frac{a_2}{m(m-1)k^2} $$

Asymptotically this has bias $O(N^{-2})$. If the estimator only has bias $O(N_{-1})$ (i.e. $a_i =0$ for $i \geq 2$) then the approximation is unbiased.&lt;/p&gt;
&lt;p&gt;We can now define two new variables: &lt;br /&gt;
$\hat{\hat{Q}}_N = \frac{1}{m} \sum_{i=1}^{m} \hat{q}_i$ &lt;br /&gt;
$\hat{\hat{V}}_N =  \frac{1}{m-1} \sum_{i=1}^{m} \left( \hat{q}_i - \hat{\hat{Q}}_N \right)^2$ &lt;br /&gt;
Then via CLT we have that $\hat{\hat{Q}}_N \sim \mathcal{N}(\hat{Q}, \hat{V})$ for some unknown variance $\hat{V}$. We can thus create an $X\%$ confidence interval as:&lt;br /&gt;
$\hat{Q} \in \left[ \hat{\hat{Q}}_N - t \sqrt{\frac{\hat{\hat{V}}_N}{m}}, \hat{\hat{Q}}_N + t \sqrt{\frac{\hat{\hat{V}}_N}{m}} \right] $ &lt;br /&gt;
With $t$ as the $(1-X)\%$ point of a double-tail student-t distribution with $(m-1)$ degrees of freedom.&lt;/p&gt;
&lt;p&gt;We can see from the construction of this confidence interval there has been no restriction on the type of statistic $\hat{Q}$ used, in this sense this is a generic method.&lt;/p&gt;
&lt;p&gt;(Note this is strongly related to a bootstrap method, in fact it is a first order approximation to a bootstrap)&lt;/p&gt;
&lt;h2 id=&quot;An-Example&quot;&gt;An Example&lt;a class=&quot;anchor-link&quot; href=&quot;#An-Example&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The explanation above is quite notation dense, it will be easier to look at an example. In this case we will take one of the simplest examples of a Monte-Carlo model: estimating the value of $\pi$. To do this we will take a unit square and a unit quarter circle inside it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/circle.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;We will simulate random points within the square and calculate the proportion $p$ of points landing within the quarter circle (red). If we simulate $N$ points we get an estimate $\pi \approx \frac{4p}{N}$. A simple vectorised numpy for this can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Estimating pi using Monte-Carlo&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;points_in_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns an array that contains 1 if a random point (x,y)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    is within the unit circle of 0 otherwise&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    N: Number of simulations (int)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Random seed fixed for repeatability&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Return an estimate of pi using the output of points_in_circle&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points_in_circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimate of pi:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimate of pi: 3.1456
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can use the jackknife method to now construct a confidence interval. (Obviously in this case we have the sample estimator of an average and so CLT applies, in practice we wouldn't use a jackknife here. But for this example I wanted something simple as to not distract attention from the jackknife method itself.) We know what the result &quot;should&quot; be in this example, however we shall pretend we don't have access to np.pi (or similar).&lt;/p&gt;
&lt;p&gt;We can code up an implementation of the jackknife method as:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This function implements the jackknife method outlined above&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    The function takes an array (arr) and an estimate function (pi_fn)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    and a number of discrete buckets (m) - in this implementation m &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    needs to divide size(arr) exactly&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    The function returns Q-double hat, V-double hat, (m-1)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Qn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Vjk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Qjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vjk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;down&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% c&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;onfidence interval: [&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;down&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;]&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;95 % confidence interval: [ 3.103649740420917 , 3.187550259579082 ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that the 95% confidence interval range is fairly large (around 3.10 to 3.19) in this case. We will now show that by using a &quot;better&quot; method we can reduce this range. We start by reconsidering the square-quarter-circle: we notice that we can add 2 additional squares to this setup:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Apart from looking like a Mondrian painting we can notice that all points generated in the yellow area will add &quot;1&quot; to the estimator array and all points in the black area will add &quot;0&quot;. The only areas of &quot;contention&quot; are the blue/red rectangles, if we focus only in generating points in these areas we will increase the accuracy of the estimator. By symmetry these 2 rectangles are identical, we only need to generate points within the rectangle: $\left\{\left(1, \frac{1}{\sqrt{2}}\right), \left( 1,0\right), \left(\frac{1}{\sqrt{2}},0\right), \left(\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\right)\right\}$. This has the area: $\frac{\sqrt{2}-1}{2}$ or both rectangles together having total area: $\sqrt{2}-1$. Therefore generating $N$ points within these rectangles is equivalent to generating: $\frac{N}{\sqrt{2}-1}$ points in the original scheme (approximately 2.5 times as many). This should reduce the standard deviation of the estimate by about a third (by CLT). We can code this estimator up in a similar way to before:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;points_in_rect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Returns an array that contains 1 if a random point (x,y)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    is within the unit circle of 0 otherwise&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This uses the &amp;quot;imporved&amp;quot; method&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    N: Number of simulations (int)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Random seed fixed for repeatability&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Return an estimate of pi using the output of points_in_rect&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    This applies a correction since points are only simulated&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    in smaller rectangles&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;approx_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;approx_pi&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points_in_rect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimate of pi:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jackknife_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;est_pi_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jk_pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;conf_int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Qtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dof&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimate of pi: 3.144554915549336
95 % confidence interval: [ 3.1247314678035196 , 3.164378363295143 ]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As expected we can see the confidence interval has decreased significantly through an improved estimator.&lt;/p&gt;
&lt;h2 id=&quot;Notes-on-Implementation&quot;&gt;Notes on Implementation&lt;a class=&quot;anchor-link&quot; href=&quot;#Notes-on-Implementation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As we have seen the jackknife is a general tool. In certain situations other tools exist. There are a couple of points we have to keep in mind when implementing these methods:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;The selection of m:&lt;/strong&gt; this is fairly arbitrary, if the statistic being analysed is very cumbersome to calculate then a smaller choice of m is helpful (or if we wish to run this method over very many statistics).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Properties of the statistic:&lt;/strong&gt; in some instances we know the statistic must be bounded (e.g. a correlation coefficient must be between $[-1,1]$) This additional information can and should be used to improve the confidence interval.
It often becomes more art than science when deciding how to present the results of this method.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this post we have seen what a jackknife method is, why it works and a basic implementation. Hopefully now it is obvious the power these methods hold for reporting on the results of a Monte-Carlo simulation. In more sophisticated situations it can really give insight into which parts of a model suffer most from simulation error and also how confident we should be with an estimate it produces.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/Jackknife/Mondrian.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Neuron Models 3: Ensembles</title><link href="https://www.lewiscoleblog.com/neuron-models-3" rel="alternate" type="text/html" title="Neuron Models 3: Ensembles" /><published>2020-01-21T00:00:00-06:00</published><updated>2020-01-21T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Neuron-Models-3</id><content type="html" xml:base="https://www.lewiscoleblog.com/neuron-models-3">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-21-Neuron-Models-3.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Justifying-Gaussian-White-Noise&quot;&gt;Justifying Gaussian White Noise&lt;a class=&quot;anchor-link&quot; href=&quot;#Justifying-Gaussian-White-Noise&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We first begin with a small diversion, in the previous HH and EIF neuron firing examples we have assumed some sort of Gaussian white noise as an input signal. We briefly mentioned that this is a reasonable assumption but we will justify this in a bit more detail here. First we note that each neuron will typically take input signal from the order of 10,000 neurons. As such even in a low firing rate scheme a neuron will likely receive relatively large amount of input spikes. We can express this signal as: &lt;br /&gt;

$$I_p(t) = \sum^{N}_{i=0} J_{i} \sum_k \delta(t-t_i^k)$$

Where: &lt;br /&gt;
$N$ is the number of connected neurons &lt;br /&gt;
$J_{i}$ is the synaptic connection strength from neuron $i$ &lt;br /&gt;
$t_i^k$ is the time of the kth spike recieved from neuron i&lt;/p&gt;
&lt;p&gt;If we assume that these spikes arrive in an uncorrelated, memoryless fashion in the form of a Poisson process and that the connection strengths are suitably small: $\langle J_i \rangle \ll V_{Th} - V_{Re}$ (where angle brackets denote population average). Then we can apply a diffusion approximation:

$$I_p(t) = \sum^{N}_{i=0} J_{i} \sum_k \delta(t-t_i^k) \approx \mu + \sigma \xi(t)$$

Where: &lt;br /&gt;
$\mu = \langle J_i \rangle N \nu $ &lt;br /&gt;
$\sigma = \langle J_i^2 \rangle N \nu $ &lt;br /&gt;
$\nu$ is the mean firing rate over all connected neurons &lt;br /&gt;
$\xi(t)$ is a Gaussian white noise process&lt;/p&gt;
&lt;p&gt;Of course as with all approximations this is subject to &quot;small sample size&quot; and $N$ needs to be suitably large.&lt;/p&gt;
&lt;h2 id=&quot;Fokker-Planck&quot;&gt;Fokker-Planck&lt;a class=&quot;anchor-link&quot; href=&quot;#Fokker-Planck&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Recall that we specified the EIF model with Gaussian white noise as having dynamics:

$$\tau \frac{dV_m}{dt} = (V_L - V_m) + \Delta_T e^{\left( \frac{V_m - V_T}{\Delta_T} \right)} + \sigma \sqrt{2 \tau}\xi_t $$
&lt;/p&gt;
&lt;p&gt;This is nothing more than an Ito process of the form:

$$dX_t = \mu(X_t,t)dt + \sigma(X_t, t)dW_t $$

With standard Wiener process $W_t$. The Fokker-Planck equation gives us a probability distribution of this process $p(x,t)$ through the PDE:

$$\frac{\partial}{\partial t} p(x,t) = -\frac{\partial}{\partial x}\left[\mu(x,t)p(x,t)\right] + \frac{\partial^2}{\partial x^2}\left[\frac{1}{2}\sigma^2(x,t)p(x,t)\right]  $$

This formula can also be extended to higher dimensions in an obvious way. The derivation of this formula is fairly involved so not included in this blog post, most good textbooks on stochastic analysis should have a derivation for the interested reader.&lt;/p&gt;
&lt;p&gt;In the case of the EIF model we can thus write down:

$$ \frac{\partial p}{\partial t} = \frac{\sigma^2}{\tau}\frac{\partial^2p}{\partial V_m^2} + \frac{\partial}{\partial V_m} \left[ \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) \right] $$

With $\psi(V_m)$ represnting the exponential firing term.&lt;/p&gt;
&lt;p&gt;By the continuity equation we can write:

$$ \frac{\partial p}{\partial t} = - \frac{\partial J}{\partial V_m} $$
&lt;/p&gt;
&lt;p&gt;Where $J$ represents the flux. By using this relation in the Fokker-Planck equation and integrating over voltage we get:

$$ J(V_m, t) = - \frac{\sigma^2}{\tau}\frac{\partial p}{\partial V_m} - \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;We can also note that:

$$J(V_{Re}^+,t) = J(V_{Re}^-, t) + r(t)$$
&lt;/p&gt;
&lt;p&gt;Where $V_{Re}^\pm$ represents the limit from above (+) or below (-) the reset voltage. the function $r(t)$ represents the average neuron firing rate. This is due to the implementaion of the voltage reset mechanism post spike. We can also note that for $V_m &amp;lt; V_{Re}$ we have $J(V_m, t) = 0$ and for $V_m &amp;gt; V_{Re}$ we have $J(V_m, t) = - r(t)$. We can then solve the flux equation to give:

$$P(V_m, t) = \frac{r(t)\tau}{\sigma^2} \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du $$
&lt;/p&gt;
&lt;p&gt;Since the probability measure needs to integrate to 1, we can then write:

$$r(t) = \left( \frac{\tau}{\sigma^2} \int_{-\infty}^{V_{Th}} \left( \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du \right) dV_m \right)^{-1} $$
&lt;/p&gt;
&lt;p&gt;(Note under the scheme presented there is no time dependence to any of these equations. Under time dependent signals we would have to be more careful and typically further approximations are made.)&lt;/p&gt;
&lt;p&gt;So far we have not allowed for the refractory period, we have assumed that after reset the voltage trajectories continue as normal. Given we have chosen a deterministic refractory period we can just add this to the euqation above:

$$r_{ref}(t) = \left( \frac{\tau}{\sigma^2} \int_{-\infty}^{V_{Th}} \left( \int_{max(V_m,V_{Re})}^{V_{Th}} exp \left( -\sigma^2 \int_{V_m}^u (x - V_L - \psi(x) )dx \right)du \right) dV_m + T_{Ref} \right)^{-1} $$
&lt;/p&gt;
&lt;p&gt;We can see that this integral will not give rise to an analytic solution in the case of EIF neurons. The forward Euler scheme we relied upon in the past will not perform well here. Instead we will use a slightly different numerical scheme.&lt;/p&gt;
&lt;h2 id=&quot;Numerical-Integration&quot;&gt;Numerical Integration&lt;a class=&quot;anchor-link&quot; href=&quot;#Numerical-Integration&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;(This is taken from Richardson [2007] - see references for further details) &lt;br /&gt;
Presented now is a numerical scheme for calculating the firing rate. Recall from above:

$$ J(V_m, t) = - r(t) \Theta(V - V_{Re}) = - \frac{\sigma^2}{\tau}\frac{\partial p}{\partial V_m} - \frac{(V_m - V_L - \psi(V_m) )}{\tau} p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;Where $\Theta(V)$ is the Heaviside step-function. Re-arranged this gives:

$$- \frac{\partial p}{\partial V_m} = - \frac {\tau}{\sigma^2} r(t) \Theta(V - V_{Re}) + \sigma^{-2}(V_m - V_L - \psi(V_m)) p(V_m,t) $$
&lt;/p&gt;
&lt;p&gt;Which is of the form:

$$ \frac{\partial p}{\partial V_m} = G(V_m)p(V_m) + H(V_m) $$
&lt;/p&gt;
&lt;p&gt;By applying a voltage discretization scheme: $V_k = V_{Lb} + k \Delta_V $ with $V_n = V_{Th}$ we can write down:

$$ p(V_{k-1}) = p(V_k) e^{\int^{V_k}_{V_{k-1}} G(V)dV} + \int^{V_k}_{V_{k-1}} H(V) e^{\int^V_{V_{k-1}}G(U)dU} $$
&lt;/p&gt;
&lt;p&gt;We can approximate this as:

$$ p(V_{k-1}) = p(V_k) e^{\Delta_V G(V_k)} + \Delta_V H(V_k) \left( \frac{e^{\Delta_V G(V_k)} - 1}{\Delta_V G(V_k)} \right) $$
&lt;/p&gt;
&lt;p&gt;Substituting back in the necessary formulae for $G$ and $H$ gives:

$$ p(V_{k-1}) = p(V_k) e^{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k)) } + \Delta_V \frac{\tau}{\sigma^2}r(t)  \Theta(V_k - V_{Re})\left( \frac{e^{\Delta_V   \sigma^{-2}(V_k - V_L - \psi(V_k))} - 1}{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k))} \right)   $$
&lt;/p&gt;
&lt;p&gt;However this still has unknown $r(t)$ in it. If we apply a transform: $q(V,t) = \frac{p(V,t)}{r(t)}$ then: $\sum q(V_k) = (r(t))^{-1}$ and:

$$ q(V_{k-1}) = q(V_k) e^{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k)) } + \Delta_V \frac{\tau}{\sigma^2} \Theta(V_k - V_{Re})\left( \frac{e^{\Delta_V   \sigma^{-2}(V_k - V_L - \psi(V_k))} - 1}{\Delta_V  \sigma^{-2}(V_k - V_L - \psi(V_k))} \right)$$
&lt;/p&gt;
&lt;p&gt;To simplify this expression we define functions $A$ and $B$ so that:

$$ q(V_{k-1}) = q(V_k) A(V_k) + \Theta(V_k - V_{Re}) B(V_k) $$
&lt;/p&gt;
&lt;p&gt;And so we can calculate the firing rate. This scheme has a much better performance than an Euler scheme. We instantiate the scheme with $q(V_n) = 0$, we also select a value $V_{Lb}$ as a cut-off to stop iterating. An implementation of this method can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Evaluating the solution to the Fokker-Planck Equation to calculate the firing rate of an EIF neuron subject to Gaussian white noise&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Membrane time constant tau (ms) and leak reversal potential VL (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spike sharpness DelT (mV) and exponential potential threshold VT (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variation in gaussian noise sig&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage spike threshold Vth (mV), reset voltage Vr (mV) and refractory period Tref (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up additional parameters for solving Fokker-Planck. DelV (mV) and VLb (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VLb&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# For ease define function psi&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;psi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;psi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelV&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Shut off numpy divide errors&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seterr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;divide&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Firing rate:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Firing rate: 21.6 Hz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can modify the previous EIF firing code to estimate the firing rate, the results should be similar (note: for this I used 10m time steps, it is a slow running code!):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Implementation of a noisy EIF neuron using a forward Euler scheme&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Reduce N for quicker running code&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set seed for repeatability&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set time step dt (ms) and number of steps N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Membrane time constant tau (ms) and leak reversal potential VL (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spike sharpness DelT (mV) and exponential potential threshold VT (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variation in gaussian noise sig&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage spike threshold Vth (mV), reset voltage Vr (mV) and refractory period Tref (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up voltage Vold (mV) and spike count Sp&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up refractory period counter Tc (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Vold&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vnew&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated firing rate:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Sp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated firing rate: 20.2 Hz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Which we can see is similar to the solution of the Fokker-Planck equation. In the limit $N \to \infty$ and decreasing the lattice sizes these approximations should become much closer.&lt;/p&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We have seen that by using the Fokker-Planck framework we are able to calculate the mean firing rate of the EIF neuron. We can also notice that the numerical scheme to integrate the Fokker-Planck runs significantly faster than taking a Monte-Carlo approximation by simulating the EIF directly. We can also notice that the Fokker-Planck framework is easy to extend (e.g. to modulated noise or other applied signals) and further we can extend this to allow for connected networks of neurons (I may write an additional blog post on this in the future but will likely end up being quite similar to this one).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://neuronaldynamics.epfl.ch/online/Ch13.html&quot;&gt;https://neuronaldynamics.epfl.ch/online/Ch13.html&lt;/a&gt; - Online Neuronal Dynamics Textbook by Wulfram Gerstner, Werner M. Kistler, Richard Naud and Liam Paninski&lt;/li&gt;
&lt;li&gt;How Spike Generation Mechanisms Determine the Neuronal Response to Fluctuating Inputs - Nicolas Fourcaud-Trocme´, David Hansel, Carl van Vreeswijk, and Nicolas Brunel [2003]&lt;/li&gt;
&lt;li&gt;Firing-rate response of linear and nonlinear integrate-and-fire neurons to modulated current-based and conductance-based synaptic drive - Magnus J Richardson [2007]&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/fokker-planck.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/fokker-planck.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Neuron Models 2: Exponential Integrate and Fire Model</title><link href="https://www.lewiscoleblog.com/neuron-models-2" rel="alternate" type="text/html" title="Neuron Models 2: Exponential Integrate and Fire Model" /><published>2020-01-14T00:00:00-06:00</published><updated>2020-01-14T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Neuron-Models-2</id><content type="html" xml:base="https://www.lewiscoleblog.com/neuron-models-2">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-14-Neuron-Models-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Integrate-and-Fire-Models&quot;&gt;Integrate and Fire Models&lt;a class=&quot;anchor-link&quot; href=&quot;#Integrate-and-Fire-Models&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Throughout this blog post we will focus on integrate and fire models. This class of model has been around for a long time, in fact longer than the Hodgkin-Huxley model. The first model was presented by Lapicque in 1907. Since then many alternative formulations have been presented. We can express the models in the form:

$$ \tau \frac{dV}{dt} = -(V - E) + \psi(V) + R_m I(t) $$
&lt;/p&gt;
&lt;p&gt;Where: &lt;br /&gt;
$\tau$ represents membrane time constant ($C_m / g_L$ in notation used previously) &lt;br /&gt;
$E$ represents the rest potential &lt;br /&gt;
$\psi(V)$ is the spike generating current term &lt;br /&gt;
$R_m$ represents membrane resistance ($1/g_L$) &lt;br /&gt;
$I(t)$ is a function representing an applied current (in the Hodgkin-Huxley example we took a Gaussian white noise)&lt;/p&gt;
&lt;p&gt;With integrate and fire models we have the issue that (typically) the action potential will shoot off to infinity. In order to stop this we implement a threshold ($V_{Th}$), when the process reaches this value it is reset (to $V_{Re}$) and the dynamics start again. This is not a big issue because for our purposes we are noly interested in the dynamics of an onset of an action potential, the mechanism of returning to normal levels is not of (much) interest. When modelling we may wish to hold the voltage at $V_{Re}$ following a spike for a short time ($\Delta_{T_{Rf}}$) to reflect the refractory period of a neuron. The refractory period can be modelled stochastically but usually a static value is succficient.&lt;/p&gt;
&lt;p&gt;Integrate and fire models are thus defined by the form of the function $\psi(V)$ - this function may be linear or non-linear. Examples include the leaky-integrate and fire model (linear), Fitzhugh-Nagumo (polynomial) and the exponential integrate and fire (non-linear).&lt;/p&gt;
&lt;h2 id=&quot;From-Hodgkin-Huxley-to-Integrate-and-Fire&quot;&gt;From Hodgkin-Huxley to Integrate and Fire&lt;a class=&quot;anchor-link&quot; href=&quot;#From-Hodgkin-Huxley-to-Integrate-and-Fire&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now take a quick de-tour to justify the use of the integrate and fire model as an approximation to the Hodgkin-Huxley dynamics.&lt;/p&gt;
&lt;p&gt;First we notice that gate m operates on a much faster time scale than gates n or h (and similarly much faster than the leak channel which controls the potential dynamics with all gates closed.) Given it is so much faster we can apply an instantaneous approximation, namely: $m(t) = \hat{m}(V_m(t))$ that is: the dynamics are defined by the membrane voltage. From plotting gate dynamics we can also observe that gates n and h are approximately translated reflections of each other. As an approximation we can create an adaptation variable $w$ with $n = aw$ and $h = b - w$ for constants $a, b$. We can then write down the equation:
$ C_m \frac{dV_m}{dt} = I_p - \overline{g_K}(aw)^4(V_m-V_K) - \overline{g_{Na}}(\hat{m}(V_m))^3(b - w)(V_m-V_{Na}) - \overline{g_L}(V_m-V_L) $&lt;/p&gt;
&lt;p&gt;There is a corresponding equation for the adaptation variable $w$ which we shall not concern ourselves with. We are only interested in the onset of spiking not the refractory period dynamics so we will take $w = w_{rest}$ to be a fixed value. We can therefore express the voltage dynamics as: &lt;br /&gt;
$ C_m \frac{dV_m}{dt} = I_p - \overline{g_{eff}}(V_m-V_{eff}) - \lambda (\hat{m}(V_m))^3(V_m-V_{Na}) $&lt;/p&gt;
&lt;p&gt;By collecting terms and some re-arrangement. $g_{eff}, V_{eff}$ and $\lambda$ are all constant values. Therefore via the approximations outlined above we are left with an equation of the form: &lt;br /&gt;
$ \tau \frac{dV}{dt} = -(V - E) + \psi(V) + R_m I(t) $&lt;/p&gt;
&lt;p&gt;Namely an integrate and fire model.&lt;/p&gt;
&lt;h2 id=&quot;Exponential-Integrate-and-Fire&quot;&gt;Exponential Integrate and Fire&lt;a class=&quot;anchor-link&quot; href=&quot;#Exponential-Integrate-and-Fire&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Continuing with the line of reasoning above we shall consider the function: $\hat{m}(V_m)$. We assume the dynamics are so rapid that they are essentially in equilibrium: &lt;br /&gt;
$ \frac{dm}{dt} = \alpha_m(V_m)(1-m) - \beta_m(V_m)m = 0 $ &lt;br /&gt;
So: &lt;br /&gt;
$ \hat{m}(V_m) = \frac{\alpha_m(V_m)}{\alpha_m(V_m) + \beta_m(V_m)}$&lt;/p&gt;
&lt;p&gt;Since Hodgkin-Huxley suggested the following forms of these equations: &lt;br /&gt;
$\alpha_m(V_m) = \frac{0.1(25-V_m)}{e^{(2.5-0.1V_m)}-1} $ &lt;br /&gt;
$\beta_m(V_m) = 4 e^{-V_m / 18} $ &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;We can approximate $\hat{m}(V_m)$ with a logistic function: &lt;br /&gt;
$ \hat{m}(V_m) \approx (1 + e^{-\beta(V_m - \theta)})^{-1}$ &lt;br /&gt;
We can then express the Taylor expansion of this as:&lt;br /&gt;
$ \hat{m}(V_m) = \sum (-1)^k e^{\beta(V_m - \theta)(1+k)}$ &lt;br /&gt;
Which we can see from the expansion of $1/(1+y)$ with $y = e^{-\beta(V_m - \theta)}$. So a first order approximation is: &lt;br /&gt;
$ \hat{m}(V_m) \approx e^{\beta(V_m - \theta)}$&lt;/p&gt;
&lt;p&gt;Then the current corresponding to the sodium channel can be expressed approximately: &lt;br /&gt;
$I_{Na} = g_{Na}(b - w_{rest})(V_m - V_{Na}) e^{3\beta(V_m - \theta)} $&lt;/p&gt;
&lt;p&gt;If we take $(V_m - V_{Na}) \approx (V_{rest} - V_{Na}) &amp;lt; 0$ as an approximation we get approximate voltage dynamics as: &lt;br /&gt;
$ C_m \frac{dV_m}{dt} = I_p - \overline{g_{eff}}(V_m-V_{eff}) + \hat{\lambda} e^{\beta (V_m - \theta)} $&lt;/p&gt;
&lt;p&gt;This is known as the exponential integrate and fire (EIF) model.This model has been shown to fit experimental data (and the Hodgkin-Huxley model) very well in practice. Typically we use a parameterization of the spiking term: &lt;br /&gt;

$$ \psi(V) = \Delta_T e^{\left( \frac{V - V_T}{\Delta_T} \right)} $$

We can see this model is highly non-linear and without applying the threshold mechanics the membrane potential would shoot to infinity. The 2 new parameters in this model are: &lt;br /&gt;
$V_T$ which represents the voltage scale at which the exponential term becomes significant in the dynamics &lt;br /&gt;
$\Delta_T$ representing the sharpness of the spike&lt;/p&gt;
&lt;p&gt;With a Gaussian white noise term $\xi_t$ we can fully specify the dynamics using:

$$\tau \frac{dV_m}{dt} = (V_L - V_m) + \Delta_T e^{\left( \frac{V_m - V_T}{\Delta_T} \right)} + \sigma \sqrt{2 \tau}\xi_t $$
&lt;/p&gt;
&lt;p&gt;As before we can solve this using a foward Euler scheme (although the forcing term is non-linear this still provides a reasonable solution for small enough time steps.) An implementation of this can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Implementation of a noisy EIF neuron using a forward Euler scheme&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set seed for repeatability&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set time step dt (ms) and number of steps N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Membrane time constant tau (ms) and leak reversal potential VL (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Spike sharpness DelT (mV) and exponential potential threshold VT (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variation in gaussian noise sig&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage spike threshold Vth (mV), reset voltage Vr (mV) and refractory period Tref (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;70&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up arrays for time T (ms) and voltage V (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up refractory period counter Tc (ms)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;    
        &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DelT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tau&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vr&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Tc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Tref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vtemp&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot voltage trajectory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time (ms)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Membrane Potential (mV)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Membrane Voltage Trajectory&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY0AAAEWCAYAAACaBstRAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3dd5hU9dXA8e9h6R2kSF+aCoh0pGjEjqJi7yX2gj15rYkBK7HFJJYEe4kxRCxELAiKiggKCtIVZJHee9l63j/und07s1Pulmk75/M88zC3zMy5w+w99/6qqCrGGGOMH9WSHYAxxpj0YUnDGGOMb5Y0jDHG+GZJwxhjjG+WNIwxxvhmScMYY4xvljRMyhCR0SLyRrLjiAcRURHpkuw4KpuIvCAi9yQ7DpM4ljRMWCKSIyJ5ItIsZP1c9wSYnZzIEk9ELnC/DwlZX11ENorIKWV8v1dE5MHKjdLX5/5DRHa7jzwRyfcsf1Se91TVq1T14QrGdZWITKvIe5jEsaRholkBXBBYEJGeQJ3khVNCRKon8OPeBRoDR4WsHw4o8HECYyk3Vb1OVeuran3gYeA/gWVVPSl0/wR/x+WWLnFWFZY0TDSvA5d6li8DXvPuICK1RORxEflVRDa4V7N13G3DRGS1iNzhXpGvE5HTReRkEflJRLaGKdqoLSL/EZFdIvK9iPTyfFaOiNwpIj8Ce9wr/btEZLm7/yIROcOz/29FZLob3zYRWSEiJ3m2NxKRF9241ojIgyKSFfolqOp+YHzId4G7/C9VLXDf72oRWeYe10QRaR36XiJyDXARcId7hf8/d32048gSkSdEZLN7DDe6d3vVy3IcsYhIF/d9LxeRX4HJIlJNRN4WkfUisl1EpolIN89r3hCR0Z7l00RknrvvdBE51LOtg4i8JyKb3GP5q3sh8jRwpPt9bHb3bey+9yb3//3uwJ2ee2fypYj8TUS2Ag+6n+eNq5WI7BWRA8r6PZgYVNUe9ij1AHKA44ClQDcgC1gFdMC5us5293sKmAg0BRoA/wMecbcNAwqA+4AawNXAJuBNd98ewH6gk7v/aCAfONvd//c4dzs1PDHNBdoBddx15wCtcS6AzgP2AK3cbb913+9qN/7rgbWAuNvfA/4J1ANaAN8C10b4PoYCOz2f2wjYB/R2l48BNgN9gVrA34EvPa9XoIv7/BXgwZD3j3Yc1wGLgLZAE2CK+37Vy3ocns8bDbwRsq6L+74vA3Vx7iqrud9jA6A2zgl+tuc1bwCj3ecDgA3uv1nAFcByoCZQHVgAPO7GWQcY6r7uKmBaSCxvAu+4n9sJWAZc5tm/wP3/zHLfaxzwkOf1vwPeTfbfUVV8JD0Ae6Tmg5Kk8QfgEZyimE/dP34FsgFxT26dPa8bDKxwnw9zT6xZ7nID97WHe/afA5zuPh8NzPRsqwasA470xHRFjLjnAiPd578Flnm21XU//0CgJZCLmwTc7RcAn0d575+BC93nVwPzPNteBB71LNfHSVjZ7nLUpBHjOD7DkwTc/xd1/y/KfBye7zpS0mgf5XXN3H3qucvepPE88KeQ/ZfjJNwjgfWB30LIPkFJA+eCoQA4yLNuFDDFs/8vIe8xFOcCI3BBMBc4M9l/R1XxYWWBJpbXgS+BjoQUTQHNcU7Ec6Skjlhwrv4Ctqhqoft8n/vvBs/2fTgn2IBVgSeqWiQiq3GuwEttBxCRS4HbcZIY7nt5K+/Xe95vrxtnfZw7oxrAOk/s1ULfP8RrOEVSbwKXAK96trUGvvd81m4R2QK0wUl2UcU4jtYhcXmfdyjHccRS/Fq3mOsRnLu/ZkCRu6kZzgWDVwfgIhG5zbOuJs53UB3I8fwWommB8xta6Vm30n2fUjECqOrXIlIAHCEi24D2wCQfn2XKyJKGiUpVV4rICuBk4MqQzZtxTvo9VHVNJX1ku8ATEamGUySz1huSZ3sHnKvbY4FvVLVQRObiJK5YVuFcoTdTt07Ch9eA+0RkMDAIONezbS3OSTMQWz3gACDc9xI0tLSP41iH8z0EtPM8L89xRKXupbrrUpz/+2NwTtwH4BQxhvuOVwFjVPXPoRtE5Eigg4hkhUkcoUNtbwQKcb7Pn9x17Qn+LsMNz/0acDGwHRivqrlh9jEVZBXhxo8rgWNUNejKUlWLcE52fxGRFgAi0kZETqzAZ/UTkTPdSt5bcU6IMyPsWw/n5LHJ/ezLgUMj7BtEVdcBk4EnRKShW+HbWURCW0h5X7MSmA78G/hUVdd7Nr8JXC4ivUWkFk7rpFmqmhPmrTbglNP7PY7xwC3ud9sYuLMix1FGDXD+D7bg3FU+FGXfccAoERkgjvoicqqbQL9x3+NhEakrInVEZKj7ug1AWxGp4R5TPvC2u299EekI3IZTFBbN6zh3RBdS+q7YVBJLGiYmVV2uqrMjbL4Tp5JypojsxKmkPbgCH/c+TkXwNpwioDPdk0i4uBYBT+CckDYAPYGvy/BZl+IUnyxyP+9toFWM17yKcwUcdFJS1anAH4EJOHcGnYHzI7zHi0B3t8XPez6O43mcxPAj8APwIU6Zf+CKvTzH4dfLOHdRa4GFwIxIO6rqLJzK6efcOH7CufLHvQs6BadRxSrgV5wTPDh1ZT8DG0QkkIhvAPJw6im+wPneoyYCN0HPB/JUNWKcpmIk+E7UGJPqxGk2/A9V7RBz5/jH8iawQCvYwa+yiMhrOJXko5MdS1VldxrGpDi3KOdkcfqltAH+hNPhMNlxVce5q1yR7FgARKQTMBJ4KdmxVGWWNIxJfQKMwSny+QFYjNP3Jdk241Rap0ICewSYBzysqr8mO56qLCWLp0SkHU755YE4TfzGqepfRaQp8B+cZok5wLmqui1ZcRpjTKZJ1aTRCqc37Pci0gC3AxhOZ62tqjpWRO4CmqjqnVHeyhhjTCVKyaQRSkTexxm+4GlgmKqucxPLNFWN2FKnWbNmmp2dnaAojTGmapgzZ85mVW0eblvKd+4TZwjuPsAsoKXbLh03cbQIs/81wDUA7du3Z/bsSC1FjTHGhCMiKyNtS+mKcBGpj9Pu/VZV3ennNao6TlX7q2r/5s3DJkpjjDHllLJJw+0dOgFn6Ol33NUb3GKpQL3HxmTFZ4wxmSglk4Y7bv6LwGJVfdKzaSLOnA64/76f6NiMMSaTpWqdxlCcISTmuwO3AdwDjAXGi8iVOMMQnJOk+IwxJiOlZNJQ1elEHqn02ETGYowxpkRKFk8ZY4xJTZY0jDHG+GZJI4V9snA9G3ftT3YYxhhTzJJGitqfX8i1r8/h4hdmJTsUY4wpZkkjRRW5w7us2rovxp7GGJM4ljSMMcb4ZknDGGOMb5Y0jDHG+GZJwxhjjG+WNIwxxvhmScMYY4xvljSMMcb4ZknDGGOMb5Y0jDHG+GZJwxhjjG+WNIwxxvhmScMYY4xvljSMMcb4ZknDGGOMb5Y0jDHG+GZJwxhjjG+WNIwxxvhmScMYY4xvljSMMcb4ZknDGGOMb5Y0jDHG+JZ2SUNEhovIUhFZJiJ3JTseY4zJJGmVNEQkC3gGOAnoDlwgIt2TG5UxxmSOtEoawEBgmar+oqp5wFvAyCTHZIwxGSPdkkYbYJVnebW7zhhjTAKkW9KQMOs0aAeRa0RktojM3rRpU4LCMsaYzJBuSWM10M6z3BZY691BVcepan9V7d+8efOEBmeMMYm2a38+D3ywiNyCwoR8Xrolje+AriLSUURqAucDE5MckzHGJM1TU37mxekrGP/dqtg7V4LqCfmUSqKqBSJyI/AJkAW8pKoLkxyWMcYkTUFhEQCFRRpjz8qRVkkDQFU/BD5MdhzGGJOJ0q14KmNoYi4ajDGmTCxppDgJ117MGGOSxJKGMcYY3yxpmCphb14BM5ZvTnYYxlR5ljRMlXDnhPlc+PwsVm3dm+xQjKnSfLeeEpEmQGtgH5CjqkVxi8qYMvpp/S4A9uQVJDkSY6q2qElDRBoBo4ALgJrAJqA20FJEZgLPqurncY/SGGNMSoh1p/E28BpwpKpu924QkX7AJSLSSVVfjFeAxhhjUkfUpKGqx0fZNgeYU+kRGWOMSVlRK8JFZJGI3CsinRMVkDHGmNQVq/XUBUB9YLKIzBKRW0WkdQLiMsYYk4KiJg1Vnaeqd6tqZ+AWoAMwU0Q+E5GrExKhMcaYlOG7n4aqzlTV24BLgSbA03GLyhhjTEry1U9DRAbgFFWdBeQA44D/xi8sY4wxqShWP42HgfOAbcBbwFBVXZ2IwIwxxqSeWHcaucBJqvpTIoIxxhiT2mL10xgDICJZwAgg2/saVX0ynsEZY4xJLX7HnvofsB+YD9iYUyblKDZrlTGJ4DdptFXVw+IaiTGVQLBZq4yJJ79Nbj8SkRPiGokxxpiU5/dOYybwrohUA/IBAVRVG8YtMmOMMSnHb9J4AhgMzFdVKzw2xpgM5bd46mdggSUMY4zJbH7vNNYB00TkI5y+G4A1uTXGmEzjN2mscB813YcxxpgM5CtpBDr5GWOMyWyxJmEaJyI9I2yrJyJXiMhF8QnNGGNMqol1p/Es8Ec3cSwANgG1ga5AQ+Al4F+VGZCIPAacCuQBy4HLA/OTi8jdwJVAIXCzqn5SmZ9tjDEmulhjT80FzhWR+kB/oBWwD1isqkvjFNOnwN2qWiAifwbuBu4Uke7A+UAPoDUwRUQOUtXCOMVhjDEmhN86jd3AtPiGUvxZkz2LM4Gz3ecjgbdUNRdYISLLgIHAN4mIyxhjTBlm7kuSK4CP3OdtgFWebavddUFE5BoRmS0iszdt2pSAEI0xJnP4bXJbqURkCnBgmE33qur77j73AgWU1JmEG4muVGdDVR2HM7Mg/fv3t86IGcK6nRqTGElJGqp6XLTtInIZcApwrKcX+mqgnWe3tsDa+ESYfHYOLB+xQW6NiatY073+jyjnL1U9rbIDEpHhwJ3AUaq617NpIvCmiDyJUxHeFfi2sj8/1dg50BiTSmLdaTyekCiCPQ3UAj4V57Jxpqpep6oLRWQ8sAin2GpUVW45ZcN8GWNSUawmt18kKhDPZ3aJsu0h4KEEhpM0gZQhVt5ijIki0ZeXvuo0RKQr8AjQHadzHwCq2ilOcRmXpQxjTDSBQolq1RJztvDb5PZl4DmcYqGjgdeA1+MVlLHWQMYYf4rck0WiSiX8Jo06qjoVEFVdqaqjgWPiF5YpKZ9KahTGmBRXFLjTSNC5wm+T2/3uVK8/i8iNwBqgRfzCMgGWM4wx0QQazVRLsTuNW4G6wM1AP+AS4LJ4BWVAraeGMcaHouKkkZjP8zv21Hfu093A5fELxwQE6jSs9ZQxJpqiBJ8rYnXue0pVb43UyS8enftMMMsZxphoiivCE/R5se40Ai2kktHJL6NZ4ZQxxpfiivAUuNNQ1Tnu096q+lfvNhG5BUh4579MoQm+ekh3lmRNpiqu00jQmOV+PyZcpfdvKzEOE4HVafijCa4MNCZVFKXSnYaIXABcCHQUkYmeTQ2ALfEMLNPZlXPZlHSGtKxhMkuiO/fFqtOYAawDmgFPeNbvAn6MV1DG03oquWGkjUDOsDsNk2k0lTr3qepKYCUwODHhmFBWOuVPoq+2jEkVRanYuU9EzhSRn0Vkh4jsFJFdIrIz3sFlMuvcVzaJvtoyJlWkZOc+4FHgVFVdHM9gjIeV0ZdJSVt1+75MZkl05z6/rac2WMJIDitt8aekB31y4zAm0RLdPN/vncZsEfkP8B6QG1ipqu/EJSpjhVPlZEnDZBpNpSa3Hg2BvcAJnnUKWNKIE2s9VTZWEW4yVaI79/kdsNAGKUwSOwf6YxXhJlOlZJ2GiBwkIlNFZIG7fJiI/CG+oWU2az1VNlYRbjJVSja5BZ4H7gbyAVT1R+D8eAVlvMVTdhL0wzr3mUyV6Ltsv0mjrqp+G7KuoLKDMSUKCp1fQo3qdhb0Q60SyGSoRN9l+00am0WkM+4FnYicjTO8iImTvMIiAGokqnYrzdmdmclUKTWMiMcoYBxwiIisAVYAF8UtKkNBkZs0sixp+FGkVgdkMlOqDVgYoKp6nIjUA6qp6i4R6RjPwDJdfoEVT5WFpQyTqRLdsdXvZewEAFXdo6q73HVvxyckA57iKbvT8CXwh2OtzkymCfzmU6Jzn4gcAvQAGonImZ5NDYHa8QxMRH4PPAY0V9XN4tx7/RU4Gaej4W9V9ft4xpBM+ZY0yqSoyJKFyUxFKVancTBwCtAYONWzfhdwdbyCEpF2wPHAr57VJwFd3cfhwHPuv1VSSdKw4ik/8t06IGMyTUrVaajq+8D7IjJYVb9JSESOvwB3AO971o0EXlOnbeVMEWksIq1UtUq24rI7jbLJL7Q7DZOZilK0TmOViLwrIhtFZIOITBCRtvEISEROA9ao6ryQTW2AVZ7l1e66KilwErSk4U+hFU+ZDJXoolm/radeBt4EznGXL3bXHV+eDxWRKcCBYTbdC9xD8MCIxS8Ls67UtyUi1wDXALRv37484aWEwJ1GTUsaxpgo5q/ZkdDP85s0Wqjqy57lV0Tk1vJ+qKoeF269iPQEOgLz3PK5tsD3IjIQ586inWf3tsDaMO89DqdPCf3790/by0+r0zDGpCK/l7GbRORiEclyHxcDWyo7GFWdr6otVDVbVbNxEkVfVV0PTAQuFccgYEdVrc8ATz8Nu9MwxqQQv2ekK4BzgfU4w4ec7a5LpA+BX4BlOAMo3pDgz0+YzbtzuWPCjwBUt6RhjEkhfoun9qrqaXGNJAz3biPwXHGGM6nyFq7dWfxcbXiMmKyPhslUBYWJb2oe9TJWRE4VkU3AfBFZLSJDEhRXRpuxbHPx8zaN6yQxkvQw7aeNyQ7BmKS4fXxoI9P4i1X28RBwpKq2As4CHol/SOafX/5S/Nxm7ovNpng1mWrivFJtgeIuVtIoUNUlAKo6C2gQ/5Ay26CHpyY7hPRjpVMmA+3Yl5+Uz41Vp9FCRG6PtKyqT8YnrMy0bOMu1u/cn+ww0oaq8uL0FdSv5bdqzpiqo9eYyUn53Fh/bc8TfHcRumwq0aMfL012CGll6uKNPDhpcbLDMCbhklEBHhBr7KkxiQrEwORFG5IdQlq56rXZyQ7BmKR44INFSfts6wSQQhrULsnh795gDdWisabIJpMlsxjbkkYKuemYLsXPWzaM63QlaW9ffmGyQzAmoSb9uI7Nu3OB5I7qbEkjhXh/CNUTNaNKmvpk4fpkh2BMwqzbsY9Rb37PZS99C8Da7fuSFouvpCEiLUXkRRH5yF3uLiJXxje0zPP2nNUAPHFOL5rUq5nkaFLb5IVW/2MyR87mvUDJaBFL1u+Ktntc+b3TeAX4BGjtLv8ElHuUWxPefrfI5ax+cZmqpEqx+TNMVbdx537+/PESioqU//0YuRPf6b1bR9wWD36TRjNVHQ8UAahqAWCFypXo+1+3sW6H9dHwy1qamarutKe/5rlpy/lh1TbenFUy87V3rLXXrhjI6X0SOxed36SxR0QOwO17GxiaPG5RZaAzn52R7BDS0vAe4ebyMib9BVpILV2/O2j9RwtK6vMO79Q0oTGB/6RxO858Fp1F5GvgNeCmuEWVYfIKktdRJ92M+d9Csu+aVLx8/+k9ADi5pyUPUzW1axo8aOnbc0pmva5VPSvR4fhLGqr6PXAUMAS4Fuihqj/GM7BMMm/19mSHkBa+/3UbL3+dE7SuRYPa5IwdwZDOzZITlDFxtmxj8J3G50s3JSkSR1kG7RkIZLuv6SsiqOprcYkqw5zzj2+SHULKe+TDxUGj/xqTKcb8L3m9v8PxlTRE5HWgMzCXkgpwxSmmMibuLGGYdLdjbz6rtu3l0DaNited/szXzF21nUGdmvLWNYOTGJ1/fu80+gPd1cZuqHTLNwXfeg7MTnzFVrp6YGSPZIdgjG+97ndGpV3xyMnFc8DMXeUUTc/8ZWvxfs9/+Qsn9GgZ8/2WPXRSHKKMzW9F+ALAahrj4PVvVgYtn3iofc2h8iOM6HnxoA4JjsSYitu0Kzfith1783now8Uc9di0mO9TPSs5A3r47qcBLBKRT0RkYuARz8AyxSszcoqfN6xdnZMsaZTyxsySxDqiZ6vi5zZjn0lHAx+eyiMfLQ476ObyzbvDvCK1+C2eGh3PIAw0rluDufedkOwwUsr+/EI+X7KR9+eW9IZ95qK+jFq7kx9WbUtiZMaUzVc/B7d4+ucXv/DxgtLjp73z/Wpf7/fRLUdWSlzl4StpqOoX8Q4k091zcrdkh5ByfvffeUz6cV2p9d1bN6R764ZJiMiYspmxbDMNatfgkhe/LbVt5Za9xc/bNK7DnJXbeGPmr0H7DDu4OdPcJravXzmQS178lg9uOoJurZL3+/c7YOEgEflORHaLSJ6IFIrIzngHV9UtXlfyFZ7d18abChUuYRiTTi58YRanPj097LZz+5f8za/Zvo+znis9KsSVR3Qsfn5k1+bkjB0R1PoqGfzWaTwNXAD8DNQBrnLXmQpY6hmpspoNhR7TE+f0SnYIaeP3/53HvFXWaTSVtW7s9PRu26ROxH0OPrABDWpX56nzeicqrJh8d+5T1WUikqWqhcDLImKDJVXAxp37ufU/c5MdRsq6+d8/lFpno//6s2NfPm/PWc3bc1aTM3ZEssMxYTSoXZ2npvwMwOptkefGaNGgNvNHn5iosHzxmzT2ikhNYK6IPAqsA+rFL6yqb+DDU4ufX+W5BTWOifMiDwVtolsT5SRk4mvBmh0UFim92jUOu71Xu8bMW7WdXfsLor5Px2b1OK1XYoc898tv8dQl7r43AnuAdsBZ8Qoq0xx8YINkh5DyJlyfHr1lU8GaJM7qlulO+ft0Rj7zNQ9/uJhfNpVuPvv+qKGlLhK90zwDjLukH5//fhi3HX9QXGMtr5h3GiKSBTykqhcD+4Ex8Q5KRG7CSVAFwCRVvcNdfzdwJc5QJjer6ifxjiURju8eu/dnJikI6cy37KGTktaRKR2t2VbSKqeoSK2+LM725BbQ40/Bp6JxX/5Clxb1w+5fp2bwyLShxVMnpPhw/zH/Et06jOZu8VTcicjRwEjgMFXtATzuru8OnA/0AIYDz7oJLe01rmtTu3rtyw+e38sSRtl4T0KnPRO+5Y6pPKGj0Abc8Xb4gcBDk8Yph7UKu1+q8vvXmAN8LSJ/FJHbA484xXQ9MFZVcwFUdaO7fiTwlqrmquoKYBnOyLtp7cHTD012CCknNGmYsvEmjQVrrGV8vNXweVHTt71Tz7Fjb37Q+mO7teStawZVelzx4jdprAU+cPdv4HnEw0HAkSIyS0S+EJEB7vo2wCrPfqvddUFE5BoRmS0iszdtSu64837Y+Eml7ctL/6QxZdEGjnz0s6RMsLV6+96g5eFPfVmqyM9Uno27ok/TPPV3R7FgzIlMuH4IEH7E5kGdDohLbPHgt0f4GAARaegs6q4YL4lKRKYQfgDEe92YmgCDgAHAeBHpBIQrmC01eIuqjgPGAfTv3z8lR+WN9SPLdIE7jX4dmqTVFZjXbePnsmt/ATv25dO8Qa24ftbWPXkI0KSeU8wZ2npqyfpdXPrSt7x5dXp+l6nu+a+iD9vfuXn4ug2AH0eXDB3076sH0bRe6hdV+51Poz/wMu7dhYjsAK5Q1Tnl+VBVPS7KZ10PvOMOw/6tiBThDJi4GqfVVkBbnDugtPPzhtQflCyZAncaNx7Txfetf6oJNKlcsGYHh3dqSt2aZZnvLLL9+YUUFCn1aznvtzu3gL4PfApQ3CdjW0jxB8CM5Vsq5fMz3ZyV29i0az/NG9SmX4cmqCpfLyvbd7vo/hM55vEv+OS239Cwdo3i9YM7p8fdht+/yJeAG1Q1W1WzgVE4SSQe3gOOARCRg4CawGacOcrPF5FaItIR6AqUHtAlDQSuJqw+I7wznnX6jdatkZ7tHIqKSm5wL3/lO7rfV75Gfut37Oe61+ewO9dJQCs27+GQP37MoZ6WOv+dXVJiGxg1dVAnm5MlXs56bgbXvfE9Zz03g/35hdzwr+9L7fP9H4+P+h51a1Zn5j3H0qhOjaj7pSq/lz+7VPWrwIKqTheRChVRRfES8JKILADygMvcu46FIjIeWITTFHeU27Ir7UxdvAGAnzfE6yuMn6tenU1eYRH/d8LB9GzrjIGjqmzZk0ez+pVbDLMnL3oHqFT1/rw1lfI+gx5xOoB+/Kf15IwdwVvflgxmt3DtDnq0bhQ0N8OvW/fS4YB6zFlpIwBXli27c+n34BTO6tuW7APqBm3bk1vAR56Raq89qhNn9mmbFkVMFRE1aYhIX/fptyLyT+DfOPUI5wHT4hGQquYBF0fY9hDwUDw+N1H25RXyF3f4gN256ZfzprgJ78ufNhUXh3S8+0MAPrjpiEodTC1d625fnL4iLu/rrUC96d8/8PZ1Q3h22vLidUvX76LDAfXo3Lw+S9an3wVJKpq+bDMAE8IMWZ4X8gNtWrdmRnTUjXWn8UTI8p88z1OykjnV3f3OjxS6xRfHdWuR5GjKJnTSmNvHz2W/p3nsKX+fXuGxjgo9RTtHH9y8Qu+VLMcc0rJCTV1HT1zI1j15Uff5ZdOe4rqMgI8XrueEHgdawqhErRpFHkwwNz84aXgvmNo2qcPqbft47qK+oS9Le1GThqoenahAMsV7ngmFBnRMr7LngqLgpPHO92Uvhrn85W/p074JNx/bNez2l78uuUpP1059+8P0M1FVXzMN7tqfHzSbY0D2XZNivvaog4KT7PQ7j+azJRu57/2FMV9rwpv5S+RK7v946pOevrAPQ7s0K16efucxcY0rmfzOp9FYRG4WkSdF5G+BR7yDq0rWbt/Hlz8F9xvxtpxIB+FOhqFyC6Lv8/nSTTz56U8Rtz84aTEA6TyT6zi3GMk7aF2uz/4aSytwl/DPL4KbfrZtUpdLB2eX+/0MfBOl1dlznqLBUw5LzcEF48HvpdyHQDYwH5jjeRifhoz9jEtfCm7sVbN6el1J+znxXfnK7Er5rEEd06P5YagJc0rKvt+5fggHtXTa6PstMvrip/J3SF20bifPTlsWcXtRkZUol9UZfUr1H854fs9atVX1dlV9WVVfDTziGplJupVb9gTdXfhJGoGKw3D8FLEEnJxm4/GA05rmd/+dV7ycVUDtmQsAABsDSURBVE34ye2Tc/ozX/t6j2oVvMV69OOlEbf5vdsxjq178vj+19It0Uaf2j0J0aQOv0njdRG5WkRaiUjTwCOukVUh03+OfCJNVfvzCznqsWkc/5cvgtaVV+hwGt6mogHrdngG2kvD2/2KfD8Any3ZwF+n/lzm13UIaQoayUtfx6dVVzo4/OEpXDBuZple0/eBT3nru1Wl1v8cYYDCTOE3aeQBjwHfUFI0VTnlEBng4hdnJTuEMnveLZdftbXkRB7aWqQstu8Nbg004KEpQct5BUUMfuSz4uVGddOrvmdfXmHYk0lo2/5o3pxV+gQ1655jg5afDdMa59Pbjor6vie4Q+8/9knku5CqbsPOXL75ZUtQ6zyv7LsmkX3XJPLdZrQPTVoUfr8D6nL50OD5MC48vH3lBpvi/CaN24Eubo/wju6jUzwDSwUPfrCIX7fsjb1jOaR6b9AnwlRW749RyR3Nzv2lh7Z41W0lpKoc9IePyv3eqaDbfR9zfpgr2am/G1b8PFbxXKAPDEDXFvXJGTuClg1rBzVjPrHHgbxzw5Cg14WrGxt3Sb/i55MXbSi1PVPFaqjR9d6PWLt9H89/FXxXtvTB4ax45GSm/d/RpebJOKtvZtV7+E0aC4H4nD1T1Dvfr+aF6Sv4zWOfA7BtTx6zojS/C1VYpMVFMMceUro/RjpWSka703jrmkE0q18z4jSXxz35Zal1f5roNAVdHmaGs3SyZH3kPhlZIRMgfZezlaIi5f7/LSJn856Ir3vhsv5ByzljR5AzdgRZ1YS+7ZuUugMJFWkin3T83VWmcL/hm0Lmo/9sycZS+9SqnhWxyXS/DplVUu83aRTizA/+z0xpcnv7+HlBy30e+JTzxs309Ue3csseOt/zIQMemsK2PXlMdX+Ef7+gT/E+fzwldSvTQjvxBYTrFRtwQL2a9GnfhF37St9RRDN31XaufyN4/J4WcR4VtrINf+qrUuuO7NoszJ5w/RtzWLRuJy99vYIrX/0u4nuGJptQB0QZquKVywcELZ/bv23x8582ZnbHv8A4Xl7/C5mPPtaotQD/vW4w95x8SIU7s6Yjv2NPvec+MpL3JJpXWETtapEH0ntz1q9MXlQyHs29780vfu49EZw7oB1+qAZ/fuj5PPT0Hu6EX3qf0O3BK575LHyzzbfd5qSTbj6CEX8LnhGufu3qfBqhGGRvlDGkwrUqmnl39KvoVHdct5b85bxeYbdt3p1X3Ipp+abIdxqto/REhtIdH3PGjmD+6h10a9Wg1LYxpx3K+NnO/12t6uk5CGRZrN2+j0tenMUbVx1Oq0Z1gu5k563eTrumJfVM//nu11KvX+mjSHpAdlMGZGfWHUaA3/k0XhWROkB7Va3ytWmrtgb/aNbvLJn/Yn9+IbUjjL6aX1jEPe/OD1r34fySBDLYnWjlipCKtHAC6eWJT38KW7+QSHtyC6hXq+SnEm64cu9wC3kFRcXl7LkFhUGjvE68cSinPR29+Wl55rQOJOSBD00t82sr23kD2tHA03HzqfN6c+t/5hYvb9wZPJ9KQWER1bOqMaTzAWzfm89rVw709R3cfEwXhnh6IQcGkAzlnV40GZNCJdrjnyxl+aY9vDIjh7tP6sa7npEL7n13QVBHvDsnzA/3FsVm/+G4iJXnqSLw2z/THR06oHe7xrw3amilf57f+TROxZmruybQUUR6A/er6mmVHlEKaBJy6//F0pIOV9H+6Gb9sjXm+y5/+GT8nBOrZ1XjL+f1CnvVI2HmowpX3BruY8LuF7IytJXN/DU7gmYWi/RH1KVFfZZt3M2M5ZsZdrBTj7NtT0lxVd/2jTmsbWNyxo4oU58NP07scSBb9+Ql5aQY2kx2WMiYWaf3aROUNK73DKf9wY9rufHNH5hy+2+YsXwLjerU8D1a8O0nHFzmWGNVBHvt3J/P3txCDmxUm315hfQaM5kJ1w+JmJxSxTs/OEnin1/8wt0ndePpz0vunHeUsfi0skdujocB2U25+6RD2Bsy42WrRrXj8nl+i6dG48zHPQ1AVee6c1pUSfVrBX8td71TcjXi7SB1xJ8/48LD23PDsC6Av6a1scqqvc7o0zb2TnEQmjSuenU2C8acWLzcsmFtPrrlSPIKioIqvts0rsOyjbvZsjuPPbkFfLJwfdCon36KRkYd3blcMTetV5NRR3cp12srKjRpxJo4qnaNaux3K2RvfNOphP0ux+lEVtaTml9HdGnG9GWbiz/Xj8NGTwbgi/8bxp0TfiSvsIhTn674oJTxFNq0O1QvT8Lz1k/2bNOI+Wt2xC2ueKpdI4trjyrf3015+K0IL1DV0G80te/ZKui+CBXV3uGQV2/bV9wDN1wFm9eQNJmVC+CywcHzlu/OLWD73jxaNarNiMNa0bReTbq1aliqpdTVRzqtsNs2qcOwx6dx+/h53PH2j8Xba9WI/nN7+sI+/N+Jh1TSUSTOSYeGb6nk9dUdJWN/hrbzB7j7nejFJBV1wUCnL8EDH4TvfxDNzW/NZabnLnp2zlZe/yYnJVti9b7/06jbhx9aMtKA92/5mQtL93/58OYjKy+wKsRv0lggIhcCWSLSVUT+DsyI9aJ0dsURHYNanQQEij+8xSCqyu790ZPG+QPTpwPQmJGH8vSFfWhYu+SOq/f9n7JjXz6No/Qvqe0mhZVb9hY3N164tqQ56jRPMV9o67F7T+6WtoO+PXdxPz66JfoJxlv5ui8vchFRuN9cZfjFrQwuz9X0vFXbg5bP/sc3/PH9hTw2ObWqNyO1+vP688dLip97k0bT+jVZ8cjJPH5OSQOG7q0bVm6AVYTfpHET0APIxZmIaSdwa7yCShUn9yw9/lHgjsL7h3/LW3NjDiGRbs1ITzmsNT/cd0LQutAy01Brtju9x++YUHJ30StC+feVRwRfbV/9m/TuK1qWwSfXbt8XcVu8ytCPDtNXqKK8o7ymgi0hc5AMjNG6aePOkqFs6teqjohE7TtjHL5+6aq6V1XvVdUBqtrffb4/9ivTW6Ay1+ucf3wDBE9FOnHe2qDiqbn3lZ4j+PA0mzsDwte//GtW6SaKAce7w1V4LU3DKW3Lw89Vble3J/GOffk0iTBMygtfxWd8qB4ZcNXc/8HgoWlE4Mkwd0OBRhjHPflFqW3pNvJ0MsSa7nVitO1VtfWUH6F9D7ytnGpVz+K7e49j8bqdxcOh+5mAJ93VrVn65+SteA0MEx7w2yHZvDIjp0qMGuqnkn+FexU7a0XkVnahU4hWFhGhX4cmxUWImSCvsIi/Rehz5NWpWb3i54Gm5X6axWeqWK2nBgOrcIqkZhG+FWfG2Z9fWKpj1qg3S5pR1qmZRZ2aWTRv4DS9PK5b6SvwdHHtbzoFzU1dEYFhwgNGn9aD0af1qJT3TrZ2Tesy7pJ+DIrS4KFfhyZRE0a81amRxb78Qqb/vJmPF67jjD5t6dehSdh9h479LOz6dBKtpdgbM1cWP//FUyQV6GnfsmF6FScnUqykcSBwPHABcCEwCfi3qmb0/JEzlm/m2tfDz0H16NmHBS2ncvNEP7I9V2EAdw6P3rqpR+uGQZXfXp//flhlhZWSIo33FDCo0wExk8bBLRtE3V4R2/bmsXDtzuKm4W/M/DXi73NNlHqXdLF43U5G9m7N++4Uy4E7W4A/vLegeL//O7Gkv8tpvVojAiPC1GcaR9R7VVUtVNWPVfUyYBCwDJgmIjclJLoUMvV3JcNP168VuQVRuMrzdHZOv+DWPNcdFb3COtLggzljR9AxJAFlms4ho6OGk93M/1DqZRUumd/labRQHmXpLJgo33oGcwwkjJl3Hxvxrtbbv6daNWFk7zZpOz99IsT8ZkSkloicCbwBjAL+BrwT78BSxUe3HMmlgzvQuXl97jrJuco+95/fFG8fHnJ1WTfCECPpqnpWteJy8MfP6RWzbiZQJNCnffjRbjPZUQc1j7lPuD4c8fTWd6sY9a/gASOjVep/dcfR/Oag5sV9eWI1NU+U2Tkld3AtGpbuCR0obnrz6sMTFlNVFTVpiMirOP0x+gJj3NZTD6jqmmivq0q6tWrI/SMPjbi9WYPgIUfKM25SqlvywEnkjB3B2f389yFYuKbkqjbc0PCZyFsJHXoH9/AZPenbvnHQcC2JMmn+uqDlrZ6mq6FNpts1rctrVwzksLbORcGu/U7P/yP+/FnxBEYAO/bmF1f8x9vS9bs4+x/fBK3rFHJXG7jYGdI5/OjDxr9YdxqXAAcBtwAzRGSn+9glIpEnEaiiwjWT9A5MZ0rUq5XFkgeGc1bftow967DYL8gA3hZWQ7s043fHHwTAdUd15sLD2/PODZU/uJzXBzcd4Wu/bz31LhOuHxL2YqGB2/Fz8+5crn19Dqu37eM2z/have6fzNGPTyP7rklxGxoFYNf+fE58qvRcLYe28Tc+lt/vxJSIVadRTVUbuI+GnkcDVa36Db9DnN6n9Axd3nGqYk2MkwkedRPE1N8No3aNLJ44txfN06xjYyJs2pXLjcd04anzenPb8V0T8pl+T6TePkfVs6pxymGl6+kC/ZS8V/gf/Liu1H4AvcZMLkuYZdJzdPB793SP8eMFJaNLP3B65JICv9+JKZFytT0i0ltEZorIXBGZLSID3fXiTv60TER+FJHSg8XEWWhb/G/vOTYoabQMU5aaac4d0I6csSNoGmWSION0PBMRTu/TJilzXFwaMr7YlEUbyL5rEpt357IhZOj2QP+bEzydN/fkJr8CfFeYKYQnXO9Mhes9vksGdSi1nym/lEsawKM49Se9gfvcZYCTgK7u4xrgueSE51jxyMm0aFi7eMpSY/wIzO990eHJOZEN7NiUU3u1LlVPd9VrswGnV3Vg/phAn4UB2U3406ndecwzLtOZEebFfnbasqA6kXi6K8wgj4Ee3XeddAjVq0mp+dShZPDIf3rmUTf++R0aPZEUCBR9NQICczGOBF5Tp2nHTBFpLCKtVDX8PXGcBSrWmtWvxebduTH2NsbRt32TpPbdGX/t4Jj7LFnnDP1yoDsfg4iUatUVrvc/wKMfLy0e+Tng9N7xGYhyUoTiMHCK1ZY9fHLYbe2a1k37/lPJlIpJ41bgExF5HOdOKHCp0Aand3rAandd0C9HRK7BuROhffvKH1l2yQPDg4Z6+O7eY7n0pW+5Iw2H9DYmnNkrnbk9ft0ae9pTPxav8zf+2N68Al74agU3H5uYOh5TPklJGiIyBae3eah7gWOB21R1goicC7wIHEf4IUxKNShX1XHAOID+/ftX+oD/tWtkBU33KiK8fqW1/Tbp5+Ezepaantjrjhi9//3yO2hlYFrgxnVrcOng7DJ/Ttsm0edVN5UjKXUaqnqcqh4a5vE+cBklnQf/izNjIDh3Fu08b9OWkqIrY0wZXXh4+6jFNLFGxn3XU1/w8uUDwu7Tu13ZO3k+MfmnMu0fKHJ76rzeZf4sU3apWDy1FjgKZ2rZY4DAXJoTgRtF5C3gcGBHsuozjKlKamZVCzu6bt/24QczDOjTvglvXn04i9ftYnWEoqy57gROm3bl+m567adfh3f4koEdm1odRQKlYuupq4EnRGQe8DBu/QTwIfALzvhXzwM3JCc8Y6qW+WNO4MEofRmiGdK5GVce0ZHe7UonGO8Ut4VlnBo2P8YQ8ZEGDDXxl3JJQ1Wnq2o/Ve2lqoer6hx3varqKFXtrKo9VXV2smM1piqoVT2Liwd1KDXne1n0bNuIl37bn1n3HMuFh7fn4JYNaNe0bnHHOu/0yOF4x46C2Hcb3qmDTWKlXNIwxiTHRYeXtDb86/llrx845pCWtGxYm4fP6Mknt/0GgEbunPIXvTgz6mvPHxe8feWWPVGnUA4MHuq9mzGJkYp1GsaYJMjyjGA8snf4zntltWmX04dp1dbo83MUhBRfnfWcMzxJpLqKwHz1TWzkgYSzOw1jDAAjwowxVVGxhk7PLSjk2tcjlzSv27GPGcs3l1r/t6lO+5jaNqd3wtmdhjEGcPogVXYrpAHZJRXkRUVaauqAOTnb+GThhoivH/yIM+3sFUM7cl+YueRtsqTEs2/cGBM3Q7qUzF+xbud++j/4Ke/9UDIdT60a/k5BL329gnlu812TXJY0jDEJsWHnfjbvzuNWz7wbdWoEF3Y8cmbPiK//y5SSTn/N6ttw+8liScMYkxBnPjuj1LpV24I7BZ4/oF2pfQK8zWxtkNDksaRhjImrIZ0jT2Eb2kkv1hz0JvksaRhj4uqGYV2Clkf0jN5Ka/H9w4Hwc8t/tmQDRWXsXW4qlyUNY0xchd48bNy1P/yOrjo1nVZcgQ58Xi98tcKKppLMkoYxJq6qhWSN73K2+Xpd5+b1Abj9+IOK13U4oC657pAk3vUmcayfhjEmrurWLD0H+oI1Ozi0TaPi5XD9Q6pVk+L1T37qtJz697erOKtvW8CZd8Mknt1pGGPi6rC2jUqtO+Xv03Fmbi67u925wR/7ZGmMPU08WNIwxsSViLDkgeEseWB40PryTif788bdAJzbP3LzXBM/ljSMMXEXmCb5ssEditd5O/n5dUL3lsXPhx3cvFJiM2VjScMYkzBjRpZM9vTDr/6HBQkMgT55Uck4Vd1aRZ+O1sSHJQ1jTMpr17RuqXU2lEhyWNIwxiRUaKun2X84LkmRmPKwpGGMSajzB7QPWg7M7hdL9gGl7zZM4lnSMMYkVK2QiZNq+JwTI2dL+VpbmcplScMYk1CfLdmY7BBMBVjSMMYkVJvGdYqf927X2Pfr7julZOa+4T0OrNSYjH+WNIwxCdWsQU0AbjvuIN4bNdT36y4fms1vh2QDcO1RneIRmvHBxp4yxiRUvZrOaadp/Zplep2IMPq0How+rUc8wjI+WdIwxiTUTcd2RYFz+rVNdiimHCxpGGMSqn6t6txzcrdkh2HKyeo0jDHG+JaUpCEi54jIQhEpEpH+IdvuFpFlIrJURE70rB/urlsmInclPmpjjDHJutNYAJwJfOldKSLdgfOBHsBw4FkRyRKRLOAZ4CSgO3CBu68xxpgESkqdhqouBqc1RIiRwFuqmgusEJFlwEB32zJV/cV93VvuvosSE7ExxhhIvTqNNsAqz/Jqd12k9aWIyDUiMltEZm/atClugRpjTCaK252GiEwBwnXbvFdV34/0sjDrlPDJLexckao6DhgH0L9///LNJ2mMMSasuCUNVS3PeMerAe8cjm2Bte7zSOuNMcYkSKoVT00EzheRWiLSEegKfAt8B3QVkY4iUhOnsnxiEuM0xpiMlJSKcBE5A/g70ByYJCJzVfVEVV0oIuNxKrgLgFGqWui+5kbgEyALeElVF8b6nDlz5mwWkZUVCLUZsLkCr09HmXbMmXa8YMecKSpyzB0ibRBVK/aPRERmq2r/2HtWHZl2zJl2vGDHnCnidcypVjxljDEmhVnSMMYY45sljejGJTuAJMi0Y8604wU75kwRl2O2Og1jjDG+2Z2GMcYY3yxpGGOM8c2SRhiZMAy7iLwkIhtFZIFnXVMR+VREfnb/bZLMGCubiLQTkc9FZLE7NP8t7voqe9wiUltEvhWRee4xj3HXdxSRWe4x/8ftNFtluKNj/yAiH7jLVfp4AUQkR0Tmi8hcEZntrqv037YljRAZNAz7KzjDz3vdBUxV1a7AVHe5KikAfqeq3YBBwCj3/7YqH3cucIyq9gJ6A8NFZBDwZ+Av7jFvA65MYozxcAuw2LNc1Y834GhV7e3pn1Hpv21LGqUNxB2GXVXzgMAw7FWKqn4JbA1ZPRJ41X3+KnB6QoOKM1Vdp6rfu8934ZxU2lCFj1sdu93FGu5DgWOAt931VeqYRaQtMAJ4wV0WqvDxxlDpv21LGqX5Hoa9CmqpquvAOcECLZIcT9yISDbQB5hFFT9ut6hmLrAR+BRYDmxX1QJ3l6r2G38KuAMocpcPoGofb4ACk0Vkjohc466r9N92UsaeSnGRhmc3VYSI1AcmALeq6s4wk4FVKe74bb1FpDHwLtAt3G6JjSo+ROQUYKOqzhGRYYHVYXatEscbYqiqrhWRFsCnIrIkHh9idxqlRRuevarbICKtANx/NyY5nkonIjVwEsa/VPUdd3WVP24AVd0OTMOpz2ksIoGLxqr0Gx8KnCYiOThFy8fg3HlU1eMtpqpr3X834lwcDCQOv21LGqVl8jDsE4HL3OeXAZEmy0pLbtn2i8BiVX3Ss6nKHreINHfvMBCROsBxOHU5nwNnu7tVmWNW1btVta2qZuP87X6mqhdRRY83QETqiUiDwHPgBGABcfhtW4/wMETkZJyrk8Aw7A8lOaRKJyL/BobhDJ+8AfgT8B4wHmgP/Aqco6qhleVpS0SOAL4C5lNS3n0PTr1GlTxuETkMpwI0C+cicbyq3i8inXCuxJsCPwAXq2pu8iKtfG7x1O9V9ZSqfrzu8b3rLlYH3lTVh0TkACr5t21JwxhjjG9WPGWMMcY3SxrGGGN8s6RhjDHGN0saxhhjfLOkYYwxxjfrEW5MGG5Txanu4oFAIbDJXd6rqkPi8Jl9gFGqelUF3+dGYI+qvlw5kRlTwprcGhODiIwGdqvq43H+nP8CD6rqvAq+T13ga1XtUzmRGVPCiqeMKSMR2e3+O0xEvhCR8SLyk4iMFZGL3Pkr5otIZ3e/5iIyQUS+cx9Dw7xnA+CwQMIQkdEi8qqITHbnSThTRB513/djdzgU3M9cJCI/isjjAKq6F8gRkYGJ+k5M5rCkYUzF9MKZu6EncAlwkKoOxBmW+yZ3n7/izOUwADjL3RaqP86wD16dcYb4Hgm8AXyuqj2BfcAIEWkKnAH0UNXDgAc9r50NHFnxwzMmmNVpGFMx3wWGnhaR5cBkd/184Gj3+XFAd89oug1FpIE7p0dAK0rqTAI+UtV8EZmPMwzIx573zgY+APYDL4jIJHc5YCNwSAWPzZhSLGkYUzHe8YuKPMtFlPx9VQMGq+q+KO+zD6gd7r1VtUhE8rWkArIIqK6qBW4R1LE4g/PdiDOqK+57Rfs8Y8rFiqeMib/JOCd0AESkd5h9FgNdyvKm7rwgjVT1Q+BWnOlcAw6idHGXMRVmScOY+LsZ6O9WVi8CrgvdQVWXAI0Cw1v71AD4QER+BL4AbvNsGwpMqUDMxoRlTW6NSREichuwS1XDVZSX5X36ALer6iWVE5kxJexOw5jU8RzBdSTl1Qz4YyW8jzGl2J2GMcYY3+xOwxhjjG+WNIwxxvhmScMYY4xvljSMMcb4ZknDGGOMb/8PjcDC7r/+XSQAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The voltage trajectory displays realistic neuron dynamics for the onset of spiking. However as expected through the use of the refractory period implementation the depolarizing phase is not captured well. This is ok since we consider the information to be carried by the spike itself not the behaviour shortly afterwards. We can also see that this implementation is considerably simpler than that of Hodgkin-Huxely since there is only one ODE. This is of benefit when modelling large networks of neurons where time/computational constraints become a consideration.&lt;/p&gt;
&lt;p&gt;It has been shown that the EIF model can predict spiking behaviour very well in practice, despite the somewhat cavalier assumptions made during its derivation from the Hodgkin-Huxley.&lt;/p&gt;
&lt;p&gt;In a future blog post we will make use of the mathematical tractability of the EIF model to analyse neurons in more depth.&lt;/p&gt;
&lt;h3 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://neuronaldynamics.epfl.ch/online/Ch5.S2.html&quot;&gt;https://neuronaldynamics.epfl.ch/online/Ch5.S2.html&lt;/a&gt; - Online Neuronal Dynamics Textbook by Wulfram Gerstner, Werner M. Kistler, Richard Naud and Liam Paninski&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/trajectory.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/trajectory.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Neuron Firing Models: Hodgkin-Huxley Model</title><link href="https://www.lewiscoleblog.com/neuron-models-1" rel="alternate" type="text/html" title="Neuron Firing Models: Hodgkin-Huxley Model" /><published>2020-01-07T00:00:00-06:00</published><updated>2020-01-07T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Neuron-Models-1</id><content type="html" xml:base="https://www.lewiscoleblog.com/neuron-models-1">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-07-Neuron-Models-1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Some-(very-basic)-Biology&quot;&gt;Some (very basic) Biology&lt;a class=&quot;anchor-link&quot; href=&quot;#Some-(very-basic)-Biology&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We start with a very limited description of what a neuron is and the mechanism by which it fires. For sake of completeness by neuron we will refer to pyramidal neurons, they make up a large proportion of neurons within the cortex of mammals. Other types of neurons are specialised for different functions. This background will be very brief and not cover the biology in any great detail. The literature and data on this topic is vast and I will not do it justice so any interested readers should look towards biology textbooks for more detailed descriptions.&lt;/p&gt;
&lt;p&gt;The neuron is made up of 3 main components: a &lt;strong&gt;soma&lt;/strong&gt; (cell body), an &lt;strong&gt;axon&lt;/strong&gt; and many &lt;strong&gt;dendrites&lt;/strong&gt;. In laymans terms the axon is the &quot;output&quot; of the neuron while the dendrites are &quot;inputs&quot; to the soma. The axon is covered in a &lt;strong&gt;myelin sheath&lt;/strong&gt; which acts &quot;insulation&quot; which can &quot;speed up&quot; signal flow. Dendrites can futher be broken down into the apical dendrite, basal dendrites and dendritic spines. Both dendrites and axons are highly branched and a single neuron can be linked to many 1000s of others. Signals are passed through &lt;strong&gt;synapses&lt;/strong&gt;. Synaptic inputs can be either &lt;strong&gt;excitatory&lt;/strong&gt; (making the target neuron more likely to fire) or &lt;strong&gt;inhibitory&lt;/strong&gt; (less likely).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/neuron/neuron_anatomy.jpg&quot; alt=&quot;&quot; /&gt;
(Source: &lt;a href=&quot;https://askabiologist.asu.edu/sites/default/files/resources/articles/neuron_anatomy.jpg&quot;&gt;https://askabiologist.asu.edu/sites/default/files/resources/articles/neuron_anatomy.jpg&lt;/a&gt; )&lt;/p&gt;
&lt;p&gt;The details of axons and dendrites are not that important for our purposes right now. Instead we are interested in the soma: essentially where the signal is generated. The cell wall contains many voltage gated ion channels, most notably: sodium (&lt;strong&gt;Na+&lt;/strong&gt;) and potassium (&lt;strong&gt;K+&lt;/strong&gt;) channels. There are 2 forces acting on ions inside/outside of the soma: namely the electrical potential within the body and the concentration gradient. Resting membrane potential is around -40mv to -90mv, in this state there is a higher concentration of potassium ions inside the cell than outside and the reverse for sodium ions. The channel for potassium is highly permeable and so potassium ions flow into the soma, the sodium channel is semi-permeable so sodium slowly flow out of the soma, to maintain a constant negative potential the cell &quot;pumps&quot; ions in the reverse direction to maintain equilibrium.&lt;/p&gt;
&lt;p&gt;An action potential (&lt;strong&gt;neuron spike&lt;/strong&gt;) is a shift away from the negative equilibrium membrane potential to a positive potential. This is as a result of ion flows due to voltage controlled gates. There are 3 gates of interest here:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Sodium activation gate - normally closed but opens with positive potential&lt;/li&gt;
&lt;li&gt;Sodium inactivation gate - normally open but closes with positive potential&lt;/li&gt;
&lt;li&gt;Potassium inactivation gate - normally closed but opens with large positive potential&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can break down the events that cause the action potential then as:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Depolarisation&lt;/strong&gt; - A depolarisation event occurs (e.g. a signal from the dendrites) which brings the cell's membrane potential to 0mv. This is as a result of positive charged ions flowing into the cell. As the potential increases to some threshold the sodium activation gate is opened which allows more positively charged sodium ions to enter. The potential then becomes positive.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Repolarisation&lt;/strong&gt; - The positive potential causes the sodium inactivation gate to close preventing more sodium ions entering. Meanwhile the potassium inactivation gate opens, since the concentration of potassium ions inside the cell is much greater than outside this leads to an outflow of potassium. The removal of positively charged ions moves the cell back towards equilibrium.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Refractory Period&lt;/strong&gt; - The potassium channel stays open slightly past the equilibrium point and the membrane potential becomes too negative (hyperpolarises). As the potassium channel closes the potential tends back to equilibrium. There is a short period after an action potential where the neuron is unable to fire again.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/neuron/action-potential.png&quot; alt=&quot;&quot; /&gt;
(Source: &lt;a href=&quot;https://teachmephysiology.com/wp-content/uploads/2018/08/action-potential.png&quot;&gt;https://teachmephysiology.com/wp-content/uploads/2018/08/action-potential.png&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;In the rest of this blog we will look at models of action potentials and will try and keep this real world description of action potentials in mind.&lt;/p&gt;
&lt;h2 id=&quot;Hodgkin-Huxley-Model&quot;&gt;Hodgkin Huxley Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Hodgkin-Huxley-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now consider a spiking neuron model as presented by Alan Hodgkin and Andrew Huxley in 1952, this model won them the Nobel prize for physiology in 1963. The model was developed by studying the axon of a giant squid neuron. The model itself tries to mimic the gates and ionic channels described above. Diagramatically we can represent the model as:
&lt;img src=&quot;https://github.com/lewiscoleblog/blog/raw/master/images/neuron/Hodgkin-Huxley.jpg&quot; alt=&quot;&quot; /&gt;
(Source: &lt;a href=&quot;https://vignette.wikia.nocookie.net/psychology/images/c/cf/Hodgkin-Huxley.jpg/revision/latest?cb=20061206001510&quot;&gt;https://vignette.wikia.nocookie.net/psychology/images/c/cf/Hodgkin-Huxley.jpg/revision/latest?cb=20061206001510&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;The voltage controlled ionic gates conductances are represented in the diagram by gn (only one represented in the diagram) and there is a leak conductance represented by gl. Cm represents the membrane capacitance and there is an external stimulus Ip which represents inputs from other neurons (or a test current applied by a probe in experiment). We can then represent the model as a set of 4 interacting PDEs: &lt;br /&gt;
$ \frac{dV_m}{dt} = \frac{I_p}{C_m} - \frac{\overline{g_K}n^4}{C_m}(V_m-V_K) - \frac{\overline{g_{Na}}m^3h}{C_m}(V_m-V_{Na}) - \frac{\overline{g_L}}{C_m}(V_m-V_L) $ &lt;br /&gt;
$ \frac{dn}{dt} = \alpha_n(V_m)(1-n) - \beta_n(V_m)n $ &lt;br /&gt;
$ \frac{dm}{dt} = \alpha_m(V_m)(1-m) - \beta_m(V_m)m $ &lt;br /&gt;
$ \frac{dh}{dt} = \alpha_h(V_m)(1-h) - \beta_h(V_m)h $ &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Where the functions $\alpha_x , \beta_x$ as suggested by Hodgkin and Huxley are: &lt;br /&gt;
$\alpha_n(V_m) = \frac{0.01(10-V_m)}{e^{(1.0-0.1V_m)}-1} $ &lt;br /&gt;
$\beta_n(V_m) = 0.125 e^{-V_m / 80} $ &lt;br /&gt;
$\alpha_m(V_m) = \frac{0.1(25-V_m)}{e^{(2.5-0.1V_m)}-1} $ &lt;br /&gt;
$\beta_m(V_m) = 4 e^{-V_m / 18} $ &lt;br /&gt;
$\alpha_h(V_m) =  0.07 e^{-V_m / 20} $ &lt;br /&gt;
$\beta_h(V_m) = \frac{1}{e^{(3.0-0.1V_m)}+1} $ &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;The following values are suggested for the model constants: &lt;br /&gt;
$C_m = 1 \mu F /cm^2$ - Capacitance per unit surface area of neuron membrane &lt;br /&gt;
$ \overline{g_{Na}} = 120 \mu S / cm^2$ - Voltage controlled  sodium conductance per unit surface area &lt;br /&gt;
$ \overline{g_{K}} = 36 \mu S / cm^2$ - Voltage controlled  potassium conductance per unit surface area &lt;br /&gt;
$ \overline{g_{L}} = 0.336 \mu S / cm^2$ - Voltage controlled  leak conductance per unit surface area &lt;br /&gt;
$V_{Na} = 115mV$ - Sodium voltage gradient &lt;br /&gt;
$V_{K} = -12mV$ - Potassium voltage gradient &lt;br /&gt;
$V_{L} = 10.613mV$ - Leak current voltage gradient &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;This is a non-linear system of differential equations and as such it is not possible to study analytically. However we can simulate this numerically. For this example we will assume that the external stimulus follows a white noise (Brownian motion). Under certain conditions this can be a reasonable assumption. We will define this as follows:
$I_p(t) = \sigma W_t$ for some positive constant $\sigma$ with units $\mu A / cm^2$&lt;/p&gt;
&lt;p&gt;By introducing stochastic noise such as this we unfortunately are unable to use any of the Python pre-made ODE integrators (e.g. scipy.integrate.ode) instead we will rely on a forward Euler scheme which will perform well enough for our purposes assuming the discrete time steps are selected to be sufficiently small. An example implementation of this can be seen below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set time step dt (ms) and number of steps for simulation N&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up time array T&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set model inputs, using nomenclature: K - Potassium, Na - Sodium, L - Leak&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set membrane capacitance per unit area (uF/cm^2)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set applied current density volatility (uA/cm^2)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set channel conductance per unit area (mS/cm^2)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gK&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;36.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gNa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;120.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set voltage gradients (mV)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VK&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VNa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;115.0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;10.613&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define ion channel rate functions&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alpha_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;beta_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.125&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;80.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alpha_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;25.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;2.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;beta_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;18.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;alpha_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.07&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;20.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;beta_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;3.0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define applied signal function - can be replaced to investigate different signals&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set up arrays for dynamic results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Initialize the system&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Loop through Euler-Forward scheme&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Signal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sigma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cm&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Signal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VK&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gNa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VNa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;VL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cm&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alpha_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;beta_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot sample path&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time ms&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Membrane voltage mV&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Hodgkin-Huxley Spiking&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot gate opening over time&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;n - K&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;m - Na&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;h - Na&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper right&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time ms&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Gate Proportion&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Gate Dynamics&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot Limit trajectories&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;n-Vm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;m-Vm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;h-Vm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Cycle Trajectories&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Gate Proportion&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Membrane Voltage mV&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/Hodgkin-Huxley.jpg" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/neuron/Hodgkin-Huxley.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Insurance Aggregation Model</title><link href="https://www.lewiscoleblog.com/insurance-aggregation-model" rel="alternate" type="text/html" title="Insurance Aggregation Model" /><published>2020-01-01T00:00:00-06:00</published><updated>2020-01-01T00:00:00-06:00</updated><id>https://www.lewiscoleblog.com/Insurance-Aggregation-Model</id><content type="html" xml:base="https://www.lewiscoleblog.com/insurance-aggregation-model">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-01-01-Insurance-Aggregation-Model.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Note: Thoughts epressed within this workbook are my own and do not represent any prior, current nor future employers or affiliates&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Background---An-Overview-of-Modelling-in-Specialty-Insurance&quot;&gt;Background - An Overview of Modelling in Specialty Insurance&lt;a class=&quot;anchor-link&quot; href=&quot;#Background---An-Overview-of-Modelling-in-Specialty-Insurance&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Within the specialty insurance space we are typically insuring economic interests of relatively rare events of high impact (for example: buildings damaged by hurricanes, aircraft crashes, impact of CEO wrong-doing, and so on.) These events are typically broken up into 2 broad classes: &lt;br /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Property &lt;/li&gt;
&lt;li&gt;Casualty&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Hence why the term &quot;P&amp;amp;C&quot; insurer is sometimes used. Property risks are, as the name suggests, related to property - historically phyiscal property but now can include non-physical property (e.g. data). Owing to the relative simplicity of these risks there is an entire universe of quantitative models that exist for risk management purposes, in particular there are a handful of vendors that create &quot;natural catastrophe&quot; (nat-cat) models. These models are sophisticated and all essentially rely on GIS style modelling: a portfolio of insured risks are placed on a geographical map (using lat-long co-ordinates) then &quot;storm tracks&quot; representing possible hurricane paths are run through the portfolio resulting in a statistical distribution of loss estimates. For other threats such as earthquakes, typhoons and wild-fires similar methods are used. &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;These nat-cat models allow for fairly detailed risk management procedures. For example it allows insurers to look for &quot;hot spots&quot; of exposure and can then allow for a reduction in exposure growth in these areas. They allow for counter-factual analysis: what would happen if the hurricane from last year took a slightly different track? It allows insurers to consider marginal impacts of certain portfolios, for example: what if we take on a portfolio a competitor is giving up, with our current portfolio will it aggregate or diversify? As a result of this explanatory power natural catastrophe risks are now well understood and for all intents and purposes these risks are now commodified and have allowed insurance linked securities (ILS) to form. &amp;lt;/br&amp;gt;&lt;/p&gt;
&lt;p&gt;Before this analytics boom specialty insurers made their money in natural catastrophe and property insurance, as such there has been a massive growth in recent years in the Casualty side of the business. Unfortunately the state of modelling on that side is, to put it politely, not quite at the same level. &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;As one would expect nat-cat model vendors have tried, and continue to try, to force the casualty business into their existing natural catastrophe models. This is a recipe for disaster as the network structure for something like the economy does not naturally lend itself to a geogprahic spatial representation. There is also a big problem of available data. Physical property risks give rise to data that is easy to cultivate. Casualty data is either hard to find or impossible - why would any corporation want to divulge all the details of their interactions? As such it does not appear that these approaches will become useful tools in this space. &lt;br /&gt;&lt;/p&gt;
&lt;p&gt;To fill this void there has been an increasing movement of actuaries into casualty risk modelling roles. While this overcomes some of the problems that face the nat-cat models they also introduce a whole new set of issues. Traditional actuarial models relying on statistical curve fitting to macro-level data. Even assuming a suitable distribution function can be constructed it is of limited use for risk management as it only informs them of the &quot;what&quot; but not the &quot;why&quot;, making it hard to orient a portfolio for a specific result. More recently actuaries have slowly began to model individual deals at a micro-level and aggregate them to get a portfolio view. To do this a &quot;correlation matrix&quot; is typically employed, this aproach also has issues: &lt;br /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Methods don't scale well with size, adding new risks often require the entire model to be recalibrated taking time and effort.&lt;/li&gt;
&lt;li&gt;They either require a lot of parameters or unable to capture multi-factor dependency (e.g. a double trigger policy where each trigger has its own sources of accumulation).&lt;/li&gt;
&lt;li&gt;It is usually not possible to vary the nature of dependency (e.g. add tail dependence or non-central dependency) &lt;/li&gt;
&lt;li&gt;Results are often meaningless in the real world, it is usually impossible to perform counter-factual analysis&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To bridge this gap I have developed a modelling framework that allows for the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Modelling occurs at an individual insured interest level &lt;/li&gt;
&lt;li&gt;Modelling is scalable in the sense that adding new insured interests requires relatively few new parameters and calibrations &lt;/li&gt;
&lt;li&gt;Counter-factual analysis is possible and the model can be interpreted in terms of the real world&lt;/li&gt;
&lt;li&gt;The framework itself is highly parallelizable, whereas nat-cat models require teams of analysts, large servers and IT infrastructure this framework lends itself to being run by multiple people on regular desktop computers with little additional workflow requirements&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;A-First-Step:-A-Simple-Driver-Method&quot;&gt;A First Step: A Simple Driver Method&lt;a class=&quot;anchor-link&quot; href=&quot;#A-First-Step:-A-Simple-Driver-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We will now look at a very stylised model of aggregation that will form a foundation on which we can build the more sophisticated model framework. We call this method of applying dependence a &quot;driver method&quot;, it is standard practice for applying dependence in banking credit risk models where there can be many thousands of risks modelled within a portfolio. The interpretation is that there is a central &quot;driver&quot;, each individual risk is &quot;driven&quot; by this and since this is common to all risks there is an induced dependence relation between them.&lt;/p&gt;
&lt;p&gt;The model relies on the generalised inverse transform method of generating random variates. Stated very simply: if you apply the inverse CDF of a random variable to a random number (U[0,1] variate) you will have samples distributed as that random variable. Therefore in order to apply dependence in a general form we only need to apply dependence between U[0,1] variates. We will also exploit the fact that normal distributions are closed under addition (that is the sum of normals is normal).&lt;/p&gt;
&lt;p&gt;We can now express the model as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;We sample standard normal (N(0,1)) variates to represent the &quot;driver&quot; variable&lt;/li&gt;
&lt;li&gt;For each risk sample an additional set of normal variates&lt;/li&gt;
&lt;li&gt;Take a weighted sum of the &quot;driver&quot; and the additional normal variates to give a new (dependent) normal variate&lt;/li&gt;
&lt;li&gt;Standardise the result from step 3) and convert to a U[0,1] variable using the standard gaussian CDF&lt;/li&gt;
&lt;li&gt;Use an inverse transform to convert the result of step 4) to a variate as specified by the risk model&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We can see that this method is completely general, it does not depend on any assumption about the stand-alone risk model distributions (it is a &quot;copula&quot; method). Another observation is that the normal variates here are in some sense &quot;synthetic&quot; and simply a tool for applying the dependence.&lt;/p&gt;
&lt;p&gt;For clarity an example is presented below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates X1 and X2 are used to apply dependence&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate temporary synthetic variable X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use normal CDF to convert X synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.4628059800990357
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The example above shows we have correlated gamma variates with around a 50% correlation coefficient (in this case we could calculate the correlation coefficient analytically but it is not necessary for our purposes, as we create more sophisticated models the analytic solutions become more difficult/impossible).&lt;/p&gt;
&lt;p&gt;Even from this example we can see how models of this form provide superior scalability: for each additional variable we only need to specify 1 parameter: the weight given to the central driver. In contrast a &quot;matrix&quot; method requires each pair-wise combination to be specified (and then we require a procedure to convert the matrix to positive semi-definite form in order to apply it). Say our model requires something more sophisticated: say the sum of a correlated gamma and a weibull distribution - the number of parameters in a matrix representation grows very quickly. However it is worth noting we do lose some control, by reducing the number of parameters in this way we lose the ability to express every possible correlation network. However in most cases this is not a big problem as there is insufficient data to estimate the correlation matrix anyway.&lt;/p&gt;
&lt;p&gt;It is worth pointing out that the type of dependency applied here is a &quot;rank normal&quot; dependency - this is the same dependency structure as in a multi-variate normal distribution, albeit generalised to any marginal distribution.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;An-Extension-to-the-Simple-Driver-Method&quot;&gt;An Extension to the Simple Driver Method&lt;a class=&quot;anchor-link&quot; href=&quot;#An-Extension-to-the-Simple-Driver-Method&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We can extend the model above by noticing the following: there is nothing stopping the &quot;synthetic&quot; variables being considered drivers in their own right. Gaussians being closed under addition does not require that each variable needs to be independent, sums of rank correlated normals are still normal! We can thus extend the model to:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2 additional drivers X1 and X2 are calculated off these&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates sX1 and sX2 are used to apply dependence&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional driver variables X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables sX and standardize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use normal CDF to convert sX synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.7851999480298125
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As before we have ended up with rank-normal correlated gamma variates. This time we have 3 potential &quot;driver&quot; variables Z, X1, X2 - all correlated with each other. It is not hard to see how this procedure can be iterated repeatedly to give arbitrarily many correlated driver variables. Further we can imagine these variables being oriented in a hierarchy, Z being at the bottom layer, X1 and X2 being a layer above, and so on.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;What-is-a-Driver?&quot;&gt;What is a Driver?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-a-Driver?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We should now take a step back and think about the implications for the insurance aggregation problem. As stated previously this method allows us to define dependency with far fewer parameters than using a matrix approach. When you start getting into the realms of 100,000s of modelled variables this becomes increasingly important from a calibration perspective.&lt;/p&gt;
&lt;p&gt;However there are other benefits: for example we can look at how the model variables relate to the driver variables. For example we can ask questions such as: &quot;What is the distribution of modelled variables when driver Z is above the 75th percentile&quot; and so on. This is a form of counter-factual analysis that can be performed using the model, with the matrix approaches you get no such ability. For counter-factual analysis to be useful however we require real-world interpretations of the drivers themselves. By limiting ourselves to counter-factual analysis based on driver percentiles (e.g. after the normal cdf is applied to Z, X1, X2 - leading to uniformly distributed driver variables) we make no assumption about the distribution about the driver itself, only its relationship with other drivers.&lt;/p&gt;
&lt;p&gt;By not making a distributional assumption a driver can represent any stochastic process. This is an important but subtle point. For example we could create a driver for &quot;global economy&quot; (Z) and by taking weighted sums of these create new drivers &quot;US economy&quot; (X1) and &quot;european economy&quot; (X2). In this example there may be data driven calibrations for suitable weights to select (e.g. using GDP figures) however it is also relatively easy to use expert judgement. In my experience it is actually easier to elicit parameters in this style of model compared to &quot;correlation&quot; parameters given this natural interpretation.&lt;/p&gt;
&lt;p&gt;Given this natural interpretation we can quite easily begin to answer questions such as: &quot;What might happen to the insurance portfolio in the case of a european economic downturn?&quot; and so on. Clearly the detail level of the driver structure controls what sort of questions can be answered.&lt;/p&gt;
&lt;p&gt;As stated previously we can repeat the mechanics of creating drivers to create new &quot;levels&quot; of drivers (e.g. moving from &quot;european economy&quot; to &quot;French economy&quot;, &quot;UK economy&quot; and so on). We can also create multiple &quot;families&quot; of driver, for example in addition to looking at economies we may consider a family relating to &quot;political unrest&quot;, again this could be broken down into region then country and so on. Other driver families may not have a geographic interpretation - for example commodity prices. In some cases the families may be completely independent of each other, in other cases they can depend on each other (e.g. commodity prices will have some relationship with the economy).&lt;/p&gt;
&lt;p&gt;In the examples so far we have presented a &quot;top down&quot; implementation in our examples: we start by modelling a global phenomena and then build &quot;smaller&quot; phenomena out of these. There is nothing special about this, we could have just as easily presented a &quot;bottom up&quot; implementation: take a number of &quot;Z&quot; variables to represent regions and combine these to form an &quot;X&quot; representing a global variable. Neither implementation is necessarily better than another and mathematically they lead to equivalent behaviours (through proper calibration). In practice however I have found the &quot;top down&quot; approach works better, typically you will start with a simple model and through time it can iterate and become more sophisticated. The top down approach makes it easier to create &quot;backward compatability&quot; which is a very useful feature for any modelling framework (e.g. suppose the first iteration of the framework only considers economic regions, next time a model is added which requires country splits - with top down adding new country variables keeps the economic regions identical without requiring any addtional thought.)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;The-need-for-more-Sophistication:-Tail-Dependence&quot;&gt;The need for more Sophistication: Tail Dependence&lt;a class=&quot;anchor-link&quot; href=&quot;#The-need-for-more-Sophistication:-Tail-Dependence&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Unfortunately the model presented so far is still quite a way from being useful. We may have found a way of calibrating a joint distribution using relatively few (O(N)) parameters and can (in some sense) perform counter-factual analysis, but there is still a big issue.&lt;/p&gt;
&lt;p&gt;So far the method only allows for rank-normal joint behaviour. From the analysis of complex systems we know that this is not necessarily a good assumption (please see other blog posts for details). We are particularly interested in &quot;tail dependence&quot;, in layman's terms: &quot;when things go bad, they go bad together&quot;. Tail dependence can arise for any number of reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Structual changes in the system&lt;/li&gt;
&lt;li&gt;Feedback&lt;/li&gt;
&lt;li&gt;State space reduction&lt;/li&gt;
&lt;li&gt;Multiplicative processes&lt;/li&gt;
&lt;li&gt;Herd mentality/other human behaviours&lt;/li&gt;
&lt;li&gt;And many others&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Given the framework we are working within we are not particularly interested in how these effects occur, we are just interested in replicating the behaviour.&lt;/p&gt;
&lt;p&gt;To do this we will extend the framework to cover a multivariate-student-T dependence structure. To do this we note the following:

$$ T_{\nu} \sim \frac{Z} {\sqrt{ \frac{\chi^2_{\nu}}  {\nu}}} $$

Where: &lt;br /&gt;
$ T_{\nu} $ follows a student-t distribution with $\nu$ degrees of freedom &lt;br /&gt;
$ Z $ follows a standard normal $N(0,1)$ &lt;br /&gt;
$ \chi^2_{\nu} $ follows Chi-Square with $\nu$ degrees of freedom&lt;/p&gt;
&lt;p&gt;Therefore we can easily extend the model to allow for tail dependence.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2 additional drivers X1 and X2 are calculated off these&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates sX1 and sX2 are used to apply dependence&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tail dependence is added through Chi&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional driver variables X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables sX and standardize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Chi-Square for tail-dependence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rvs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use t CDF to convert sX synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.7907911109201866
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Adding-Flexibility&quot;&gt;Adding Flexibility&lt;a class=&quot;anchor-link&quot; href=&quot;#Adding-Flexibility&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We can further extend this model by allowing each model variate to have its own tail-dependence. Why is this important one might ask? In the case of this framework we are spanning many different models, selecting a single degree of tail dependence might not be suitable for all variables. We can do this via applying another inverse transform:

$$ T_{\nu} \sim \frac{Z} {\sqrt{ \frac{F^{-1}_{\chi^2_{\nu}}(U)}  {\nu}}} $$

As before but where: &lt;br /&gt;
$U$ follows a uniform U[0,1] distribution &lt;br /&gt;
$F^{-1}_{\chi^2_{\nu}}$ is the inverse cdf of $\chi^2_{\nu}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2 additional drivers X1 and X2 are calculated off these&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates sX1 and sX2 are used to apply dependence&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tail dependence is added through Chi1 and Ch2 with varying degrees&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional driver variables X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables sX and standardize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Chi-Square for tail-dependence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use t CDF to convert sX synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.7703228652641819
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;There is a small practical issue relating to multivariate student-t distributions: namely that we lose the ability to assume independence. This is a direct result of allowing for tail dependence. In many situations this is not an issue, however within this framework we have models covering very disperate processes some of which may genuinely exhibit independence. To illustrate this issue we will re-run the existing model with zero driver weights (&quot;attempt to model independence&quot;):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.08220534833363176
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As we can see there is a dependence between Y1 and Y2 0 clearly through the chi-square variates. We can overcome this issue by &quot;copying&quot; the driver process. The common uniform distribution is then replaced a number of correlated uniform distributions. We can then allow for independence. An implemntation of this can be seen in the code sample below:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2 additional drivers X1 and X2 are calculated off these&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates sX1 and sX2 are used to apply dependence&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tail dependence is added through Chi1 and Ch2 with varying degrees&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Chi1 and Chi2 are driven by X1tail and X2tail which are copies of X1 and X2 drivers&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate copy of driver for tail process&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional driver variables X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional tail drivers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables sX and standardize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables for tail process&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Chi-Square for tail-dependence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use t CDF to convert sX synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.7406745557389065
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To show this allows full independence we repeat the zero-weight example:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: -0.01456173215652803
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that this is a much better scatter plot if we are looking for independence!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Non-Centrality&quot;&gt;Non-Centrality&lt;a class=&quot;anchor-link&quot; href=&quot;#Non-Centrality&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We now extend this model yet further. So far we have allowed for tail dependence however it treats both tails equally. In some instances this can be problematic. For example if we rely on output from the framework to do any kind of risk-reward comparison the upisde and downside behaviour are both important. While it is easy to think of structural changes leading to a downside tail dependence an upside tail dependence is typically harder to justify. We can allow for this with a simple change to the model, namely:

$$ T_{\nu, \mu} \sim \frac{Z + \mu} {\sqrt{ \frac{F^{-1}_{\chi^2_{\nu}}(U)}  {\nu}}} $$

The addition of the $\mu$ parameter means that $T_{\nu, \mu}$ follows non-central student-t distribution with $\nu$ degrees of freedom and non-centrality $\mu$. Details of this distribution can be found on &lt;a href=&quot;https://en.wikipedia.org/wiki/Noncentral_t-distribution&quot;&gt;wikipedia&lt;/a&gt;. By selecting large positive values of $\mu$ we can create tail dependence in the higher percentiles, large negative values can create tail dependence in the lower percentiles and a zero value leads to a symmetrical dependency. Adjusting the code futher we get:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Simple driver method example&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We model a central driver Z&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 2 additional drivers X1 and X2 are calculated off these&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We want to model 2 risks: Y1 and Y2 which follow a gamma distribution&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Synthetic normal variates sX1 and sX2 are used to apply dependence&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tail dependence is added through Chi1 and Ch2 with varying degrees&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Chi1 and Chi2 are driven by X1tail and X2tail which are copies of X1 and X2 drivers&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We add non-centrality through an additive scalar&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate driver variables&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate copy of driver for tail process&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional driver variables X1, X2 and standardise&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate additional tail drivers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ztail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables sX and standardize&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Synthetic Variables for tail process&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Chi-Square for tail-dependence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Specify the non-centrality values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use non-central t CDF to convert sX synthetic variables to uniforms U&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Correlation Coefficient: 0.7100911602838634
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the code example we have selected a non-centrality of -2 which is a fairly large negative value, we can see the dependency increasing in the lower percentiles (clustering around (0,0) on the plot).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Temporal-Considerations&quot;&gt;Temporal Considerations&lt;a class=&quot;anchor-link&quot; href=&quot;#Temporal-Considerations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;So far we have essentially considered a &quot;static&quot; model, we have modelled a number of drivers which represent values at a specific time period. For the majority of insurance contracts this is sufficient: we are only interested in losses occuring over the time period the contract is active. However in some instances the contracts relate to multiple time periods and it does not make sense to consider losses over the entire lifetime. Moreover it is not ideal to model time periods as independent from one another, to take the US economy example: if in 2020 the US enters recession it is (arguably) more likely that the US will also stay in recession in 2021. Clearly the dynamics of this are very complex and constructing a detailed temporal model is very difficult, however for the sake of creating the drivers we do not need to know the exact workings. Instead we are looking for a simple implementation that gives dynamics that are somewhat justifiable.&lt;/p&gt;
&lt;p&gt;Fortunately it is relatively easy to add this functionality to the model framework we have described so far. Essentially we will adopt a Markovian assumption whereby a driver in time period t+1 is a weighted sum of its value at time t and an idiosyncratic component. Of course this is not a perfect description of the temporal behaviour of every possible driver but it shouldn't be completely unjustifiable in most instances and the trajectories shouldn't appear to be totally alien (e.g. US economy being in the top 1% one year immediately followed by a bottom 1% performance very frequently).&lt;/p&gt;
&lt;p&gt;To illustrate this please see the code example below, for brevity I will change the model code above to a functional definition to avoid repeating blocks of code.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Creating temporally dependent variables&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.stats&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;# Set number of simulations and random seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define function to create correlated normal distributions&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;corr_driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Create driver Z&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Create drivers X1, X2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Z&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create drivers variables for time periods t0 and t1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corr_driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;driver_t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corr_driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create copy of drivers for tail process time periods t0 and t1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corr_driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tail_t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corr_driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define a standardise function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create sythetic variables sX1 sX2 for variable 1 and 2 at times t0 and t1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Note depending on the model idiosyncratic components may also be dependent&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;driver_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Repeat synthetic variable construction for tail process&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tailt0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1tailt1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tailt0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2tailt1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standardise&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail_t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIMS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Simulate Chi-Square for tail-dependence t0 and t1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Chi1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tailt0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tailt0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Chi1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1tailt1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Chi2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chi2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2tailt1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sX2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Chi2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Specify the non-centrality values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use non-central t CDF to convert sX synthetic variables to uniforms U for t0 and t1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1t0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2t0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX1t1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;U2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nct&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sX2t1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nc2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nu2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Use inverse transforms to create dependent samples of Y1 and Y2 at t0 and t1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U1t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y2t1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gamma&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ppf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;U2t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Plot a basic scatter to show dependence has been applied and calculate pearson coefficient&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1(t=t0)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Y1(t=t1)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrcoef&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y1t0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1t1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Estimated Pearson Auto-Correlation Coefficient:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Estimated Pearson Auto-Correlation Coefficient: 0.37600307233845764
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this code example we created to variables Y1 and Y2, each one taking a value from a Gamma distribution at times t0 and t1. Y1 and Y2 have a dependency between eachother but also temporally.&lt;/p&gt;
&lt;p&gt;As with any temporal model the time period chosen is very important, typically for insurance contracts yearly time periods make sense. However in one particular model I developed there was a need for monthly simulations, rather than re-parameterising the entire central driver structure to work on a monthly basis (creating lots of extra data that will not be used by the vast majority of the models) I applied a &lt;a href=&quot;https://en.wikipedia.org/wiki/Brownian_bridge&quot;&gt;&quot;Brownian Bridge&quot;&lt;/a&gt; type argument to interpolate driver simulations for each month.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Notes-on-Implementation&quot;&gt;Notes on Implementation&lt;a class=&quot;anchor-link&quot; href=&quot;#Notes-on-Implementation&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In this blog post I have not included the code exactly as it is implemented in production since this is my employer's IP. The implementation presented here is not very efficient and trying to run large portfolios in this way will be troublesome. In the full production implementation I used the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Strict memory management as the this is a memory hungry program&lt;/li&gt;
&lt;li&gt;Certain aspects of the implementation are slow in pure python (and even Numpy) Cython and Numba are used for performance&lt;/li&gt;
&lt;li&gt;The Scipy stats module is convenient but restrictive, it is better to either use the Cython address for Scipy special functions or implement functions from scratch. By implementing extended forms of some of the distribution functions one is also able to allow for non-integer degrees of freedom which is useful&lt;/li&gt;
&lt;li&gt;The model naturally lends itself to arrays (vectors, matrices, tensors) however these tend to be sparse in nature, it is often better to construct &quot;sparse multiply&quot; type operations rather than inbuilt functions like np.dot&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This blog posts represents the current iteration of the aggregation framework I have developed. It is considered a &quot;version 0.1&quot; implementation and is expected to develop as we use it more extensively and uncover further properties or issues. For example it is clear regardless of parameters selected the joint behaviour will always be (approximately) elliptical, as presented it is not possible to implement non-linearities (e.g. the price of some asset will only attain a maximum/minimum value dependent on some other driver indicator). It is not difficult to implement ideas like this when the need arises, the difficulty becomes more around how to implement the idea in a seamless way.&lt;/p&gt;
&lt;p&gt;There are a couple of additional benefits to this framework which we have not mentioned, I will outline these here briefly:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It is possible to parallelise this process quite effectively as there are minimal bottlenecks/race conditions&lt;/li&gt;
&lt;li&gt;The driver variables can be generated centrally and models can link to this central variable repository. From a work-flow perspective this means that individual underwriting teams can run models independently (quickly) leaving the risk teams to collate an analyse the results. (Sometimes called a federated workflow.)&lt;/li&gt;
&lt;li&gt;The federated workflow means no specialist hardware is required, even very large portfolios can be run on standard desktops/laptops.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The current production version of this framework has around 5-10,000 driver variables (&quot;X1, X2&quot;) over 5 different hierarchical layers. These influence dependence between around 500,000 individual modelled variables (&quot;Y1, Y2&quot;) with 20 time periods (&quot;t0, t1&quot;). The quality of risk management analysis and reporting has increased dramatically as a result.&lt;/p&gt;
&lt;p&gt;There are still some things left to do in relation to this framework and the work is on-going. These include:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Work relating to calibration and how to do this as efficiently as possible&lt;/li&gt;
&lt;li&gt;Further work on increasing code efficiency&lt;/li&gt;
&lt;li&gt;Further mathematical study of the framework's parameters&lt;/li&gt;
&lt;li&gt;Study of the implied network behaviour: since we're placing risks on a network (driver structure) can we gain additional insight by considering contagion, critical nodes, etc.?&lt;/li&gt;
&lt;li&gt;Further improvements to the workflow, how the model data is stored/collated etc.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Lewis Cole (2020)</name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://github.com/lewiscoleblog/blog/raw/master/images/insurance/scatter.png" /><media:content medium="image" url="https://github.com/lewiscoleblog/blog/raw/master/images/insurance/scatter.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>